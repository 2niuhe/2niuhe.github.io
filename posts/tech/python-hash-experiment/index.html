<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Pythonå®ç°MD5å’ŒSha256 | Niuhe&#39;s Blog</title>
<meta name="keywords" content="Python, å¯†ç å­¦">
<meta name="description" content="Python3å®ç°å“ˆå¸Œæ•£åˆ—ç®—æ³•ï¼ŒåŒ…å«MD5å’Œsha256ã€‚ Hashå‡½æ•°ç®—æ³•ç¼–å†™ æœ¬å®éªŒæ˜¯ä½¿ç”¨pythonæ¥ç¼–å†™MD5å’ŒSHA256åŠ å¯†å‡½æ•°ï¼Œå¹¶å¯¹åŠ å¯†å‡½æ•°çš„æ­£ç¡®æ€§è¿›è¡ŒéªŒè¯ã€‚ éªŒè¯çš„æ–¹å¼æ˜¯é€šè¿‡å’Œå·²æœ‰çš„æ ‡å‡†åº“åŠ å¯†ç»“æœè¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç»“æœç›¸åŒï¼Œåˆ™åŠ å¯†å‡½æ•°æ­£ç¡®ã€‚ 1.å®éªŒç›®çš„ ç†Ÿæ‚‰MD5å’ŒSHA25">
<meta name="author" content="Niuhe">
<link rel="canonical" href="https://blog.niuhemoon.win/posts/tech/python-hash-experiment/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css" integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe&#43;FVUFzPh7U=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://blog.niuhemoon.win/base/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://blog.niuhemoon.win/base/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="https://blog.niuhemoon.win/base/favicon.ico">
<link rel="apple-touch-icon" href="https://blog.niuhemoon.win/base/avatar.jpeg">
<link rel="mask-icon" href="https://blog.niuhemoon.win/base/avatar.jpeg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-116933089-1', 'auto');
	
	ga('send', 'pageview');
}
</script><meta property="og:title" content="Pythonå®ç°MD5å’ŒSha256" />
<meta property="og:description" content="Python3å®ç°å“ˆå¸Œæ•£åˆ—ç®—æ³•ï¼ŒåŒ…å«MD5å’Œsha256ã€‚ Hashå‡½æ•°ç®—æ³•ç¼–å†™ æœ¬å®éªŒæ˜¯ä½¿ç”¨pythonæ¥ç¼–å†™MD5å’ŒSHA256åŠ å¯†å‡½æ•°ï¼Œå¹¶å¯¹åŠ å¯†å‡½æ•°çš„æ­£ç¡®æ€§è¿›è¡ŒéªŒè¯ã€‚ éªŒè¯çš„æ–¹å¼æ˜¯é€šè¿‡å’Œå·²æœ‰çš„æ ‡å‡†åº“åŠ å¯†ç»“æœè¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç»“æœç›¸åŒï¼Œåˆ™åŠ å¯†å‡½æ•°æ­£ç¡®ã€‚ 1.å®éªŒç›®çš„ ç†Ÿæ‚‰MD5å’ŒSHA25" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.niuhemoon.win/posts/tech/python-hash-experiment/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-05-18T00:00:00+00:00" />
<meta property="article:modified_time" content="2018-05-18T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Pythonå®ç°MD5å’ŒSha256"/>
<meta name="twitter:description" content="Python3å®ç°å“ˆå¸Œæ•£åˆ—ç®—æ³•ï¼ŒåŒ…å«MD5å’Œsha256ã€‚ Hashå‡½æ•°ç®—æ³•ç¼–å†™ æœ¬å®éªŒæ˜¯ä½¿ç”¨pythonæ¥ç¼–å†™MD5å’ŒSHA256åŠ å¯†å‡½æ•°ï¼Œå¹¶å¯¹åŠ å¯†å‡½æ•°çš„æ­£ç¡®æ€§è¿›è¡ŒéªŒè¯ã€‚ éªŒè¯çš„æ–¹å¼æ˜¯é€šè¿‡å’Œå·²æœ‰çš„æ ‡å‡†åº“åŠ å¯†ç»“æœè¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç»“æœç›¸åŒï¼Œåˆ™åŠ å¯†å‡½æ•°æ­£ç¡®ã€‚ 1.å®éªŒç›®çš„ ç†Ÿæ‚‰MD5å’ŒSHA25"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ğŸ“šæ–‡ç« ",
      "item": "https://blog.niuhemoon.win/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "ğŸ‘¨ğŸ»â€ğŸ’» æŠ€æœ¯",
      "item": "https://blog.niuhemoon.win/posts/tech/"
    }, 
    {
      "@type": "ListItem",
      "position":  4 ,
      "name": "Pythonå®ç°MD5å’ŒSha256",
      "item": "https://blog.niuhemoon.win/posts/tech/python-hash-experiment/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Pythonå®ç°MD5å’ŒSha256",
  "name": "Pythonå®ç°MD5å’ŒSha256",
  "description": "Python3å®ç°å“ˆå¸Œæ•£åˆ—ç®—æ³•ï¼ŒåŒ…å«MD5å’Œsha256ã€‚ Hashå‡½æ•°ç®—æ³•ç¼–å†™ æœ¬å®éªŒæ˜¯ä½¿ç”¨pythonæ¥ç¼–å†™MD5å’ŒSHA256åŠ å¯†å‡½æ•°ï¼Œå¹¶å¯¹åŠ å¯†å‡½æ•°çš„æ­£ç¡®æ€§è¿›è¡ŒéªŒè¯ã€‚ éªŒè¯çš„æ–¹å¼æ˜¯é€šè¿‡å’Œå·²æœ‰çš„æ ‡å‡†åº“åŠ å¯†ç»“æœè¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç»“æœç›¸åŒï¼Œåˆ™åŠ å¯†å‡½æ•°æ­£ç¡®ã€‚ 1.å®éªŒç›®çš„ ç†Ÿæ‚‰MD5å’ŒSHA25",
  "keywords": [
    "Python", "å¯†ç å­¦"
  ],
  "articleBody": "Python3å®ç°å“ˆå¸Œæ•£åˆ—ç®—æ³•ï¼ŒåŒ…å«MD5å’Œsha256ã€‚\nHashå‡½æ•°ç®—æ³•ç¼–å†™ æœ¬å®éªŒæ˜¯ä½¿ç”¨pythonæ¥ç¼–å†™MD5å’ŒSHA256åŠ å¯†å‡½æ•°ï¼Œå¹¶å¯¹åŠ å¯†å‡½æ•°çš„æ­£ç¡®æ€§è¿›è¡ŒéªŒè¯ã€‚\néªŒè¯çš„æ–¹å¼æ˜¯é€šè¿‡å’Œå·²æœ‰çš„æ ‡å‡†åº“åŠ å¯†ç»“æœè¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç»“æœç›¸åŒï¼Œåˆ™åŠ å¯†å‡½æ•°æ­£ç¡®ã€‚\n1.å®éªŒç›®çš„ ç†Ÿæ‚‰MD5å’ŒSHA256åŠ å¯†å‡½æ•°çš„åŸç†å’Œåº”ç”¨ å®ç°MD5å’ŒSHA256åŠ å¯†å‡½æ•°å¹¶éªŒè¯ 2.å®éªŒå·¥å…· Jupyter Notebook Python3.5 3.å®éªŒç¯å¢ƒ Ubuntu16.04LTSæ“ä½œç³»ç»Ÿ Python3æ ‡å‡†åº“ 4.å®éªŒæ­¥éª¤ 4.1 å›é¡¾è¯¾ç¨‹ï¼ŒæŸ¥é˜…èµ„æ–™ 4.2 ç†Ÿæ‚‰MD5çš„åŸç† MD5(Message-Digest Algorithm)æ¶ˆæ¯æ‘˜è¦ç®—æ³•æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„å¯†ç æ•£åˆ—å‡½æ•°ï¼Œå¯ä»¥äº§ç”Ÿå‡ºä¸€ä¸ª128ä½ï¼ˆ16å­—èŠ‚ï¼‰çš„æ•£åˆ—å€¼ï¼ˆhash valueï¼‰ï¼Œç”¨äºç¡®ä¿ä¿¡æ¯ä¼ è¾“å®Œæ•´ä¸€è‡´ã€‚\nMD5å°†å¯å˜é•¿åº¦çš„æ¶ˆæ¯å¤„ç†æˆ128ä½çš„å›ºå®šé•¿åº¦è¾“å‡ºã€‚è¾“å…¥æ¶ˆæ¯è¢«åˆ†è§£æˆ512ä½å—ï¼ˆ16ä¸ª32ä½å­—ï¼‰å—;è¯¥æ¶ˆæ¯è¢«å¡«å……ä»¥ä½¿å…¶é•¿åº¦å¯ä»¥è¢«512æ•´é™¤ã€‚\nå¡«å……çš„å·¥ä½œåŸç†å¦‚ä¸‹ï¼š\né¦–å…ˆå°†å•ä¸ªä½1é™„åŠ åˆ°æ¶ˆæ¯çš„æœ«å°¾ æ¥ç€å¡«å……0ï¼Œç›´åˆ°æ¶ˆæ¯é•¿åº¦æ¯”512çš„æ•´æ•°å€å°‘64 åœ¨æ¥ä¸‹æ¥64ä½ä¸­å¡«å……çœŸå®æ¶ˆæ¯çš„é•¿åº¦å€¼ ä¸»MD5ç®—æ³•åœ¨128ä½çŠ¶æ€ä¸‹è¿è¡Œï¼Œåˆ†ä¸ºå››ä¸ª32ä½å­—ï¼Œåˆ†åˆ«è¡¨ç¤ºä¸ºAï¼ŒBï¼ŒCå’ŒD.è¿™äº›å­—è¢«åˆå§‹åŒ–ä¸ºæŸäº›å›ºå®šçš„å¸¸é‡ã€‚\nä¸»ç®—æ³•ç„¶åä¾æ¬¡ä½¿ç”¨æ¯ä¸ª512ä½æ¶ˆæ¯å—æ¥ä¿®æ”¹çŠ¶æ€ã€‚\næ¶ˆæ¯å—çš„å¤„ç†ç”±å››ä¸ªç›¸ä¼¼çš„é˜¶æ®µç»„æˆï¼Œç§°ä¸ºå¾ªç¯;æ¯è½®ç”±åŸºäºéçº¿æ€§å‡½æ•°Fï¼Œæ¨¡åŠ æ³•å’Œå·¦æ—‹ç­‰16ç§ç±»ä¼¼æ“ä½œç»„æˆã€‚\nå›¾1è¯´æ˜äº†ä¸€è½®å†…çš„ä¸€ä¸ªæ“ä½œæµç¨‹ã€‚ å›¾2è¡¨ç¤ºFæœ‰å››ç§å¯èƒ½çš„åŠŸèƒ½;æ¯ä¸€è½®ä½¿ç”¨ä¸åŒçš„ä¸€ä¸ªï¼š ä¸‹å›¾æ˜¯éçº¿æ€§å‡½æ•°çš„å››ç§å¯èƒ½\n4.3 æŸ¥é˜…å¾—MD5ç®—æ³•çš„ä¼ªä»£ç  //Note: All variables are unsigned 32 bit and wrap modulo 2^32 when calculating var int[64] s, K var int i //s specifies the per-round shift amounts s[ 0..15] := { 7, 12, 17, 22, 7, 12, 17, 22, 7, 12, 17, 22, 7, 12, 17, 22 } s[16..31] := { 5, 9, 14, 20, 5, 9, 14, 20, 5, 9, 14, 20, 5, 9, 14, 20 } s[32..47] := { 4, 11, 16, 23, 4, 11, 16, 23, 4, 11, 16, 23, 4, 11, 16, 23 } s[48..63] := { 6, 10, 15, 21, 6, 10, 15, 21, 6, 10, 15, 21, 6, 10, 15, 21 } //Use binary integer part of the sines of integers (Radians) as constants: for i from 0 to 63 K[i] := floor(232 Ã— abs(sin(i + 1))) end for //Initialize variables: var int a0 := 0x67452301 //A var int b0 := 0xefcdab89 //B var int c0 := 0x98badcfe //C var int d0 := 0x10325476 //D //Pre-processing: adding a single 1 bit append \"1\" bit to message // Notice: the input bytes are considered as bits strings, // where the first bit is the most significant bit of the byte.[48] //Pre-processing: padding with zeros append \"0\" bit until message length in bits â‰¡ 448 (mod 512) append original length in bits mod 264 to message //Process the message in successive 512-bit chunks: for each 512-bit chunk of padded message break chunk into sixteen 32-bit words M[j], 0 â‰¤ j â‰¤ 15 //Initialize hash value for this chunk: var int A := a0 var int B := b0 var int C := c0 var int D := d0 //Main loop: for i from 0 to 63 var int F, g if 0 â‰¤ i â‰¤ 15 then F := (B and C) or ((not B) and D) g := i else if 16 â‰¤ i â‰¤ 31 F := (D and B) or ((not D) and C) g := (5Ã—i + 1) mod 16 else if 32 â‰¤ i â‰¤ 47 F := B xor C xor D g := (3Ã—i + 5) mod 16 else if 48 â‰¤ i â‰¤ 63 F := C xor (B or (not D)) g := (7Ã—i) mod 16 //Be wary of the below definitions of a,b,c,d F := F + A + K[i] + M[g] A := D D := C C := B B := B + leftrotate(F, s[i]) end for //Add this chunk's hash to result so far: a0 := a0 + A b0 := b0 + B c0 := c0 + C d0 := d0 + D end for var char digest[16] := a0 append b0 append c0 append d0 //(Output is in little-endian) //leftrotate function definition leftrotate (x, c) return (x \u003c\u003c c) binary or (x \u003e\u003e (32-c)); 4.4 ç¼–å†™MD5ç®—æ³•æµ‹è¯•ç”¨ä¾‹ Pythonæ ‡å‡†åº“hashlibä¸­æä¾›äº†ç”ŸæˆMD5å€¼çš„æ–¹æ³•ï¼Œæ˜¯é€šè¿‡Cè¯­è¨€å®ç°çš„ï¼Œæˆ‘ä»¬ç”¨è‡ªå·±å®ç°çš„MD5å‡½æ•°è®¡ç®—å‡ºMD5å€¼ï¼Œåœ¨å’Œæ ‡å‡†åº“çš„ç»“æœè¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç»“æœç›¸åŒï¼Œé‚£ä¹ˆè¯æ˜äº†MD5åŠ å¯†æ˜¯æ­£ç¡®çš„ã€‚ æ³¨æ„ï¼š\nåªå®ç°äº†å¯¹ASCIIç å­—ç¬¦ä¸²çš„å¤„ç† demoä¸­å­˜å‚¨äº†æµ‹è¯•ç”¨ä¾‹ my_md5()è¿”å›è‡ªå·±ç”Ÿæˆçš„MD5å€¼ true_md5()è¿”å›Pythonæ ‡å‡†åº“ç”Ÿæˆçš„MD5å€¼ è‹¥ä¸¤è€…ç»“æœä¸åŒï¼ŒæŠ›å‡ºAssertionErrorå¼‚å¸¸ æµ‹è¯•ç¨‹åºå¦‚ä¸‹ï¼š\nimport hashlib def my_md5(message): pass def true_md5(message): m = hashlib.md5() m.update(message) return m.hexdigest() if __name__=='__main__': demo = [b\"\", b\"a\", b\"abc\", b\"message digest\", b\"abcdefghijklmnopqrstuvwxyz\", b\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\", b\"12345678901234567890123456789012345678901234567890123456789012345678901234567890\"] for message in demo: print(my_md5(message),' \u003c= \"',message.decode('ascii'),'\"', sep='') assert true_md5(message)==my_md5(message) # è‹¥å’Œæ ‡å‡†åº“ä¸­ä¸åŒï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ 4.5 æŸ¥é˜…sha256ç®—æ³•åŸç†å’Œä¼ªä»£ç  sha256æ˜¯SHA2(Secure Hash Algorithm 2)ç®—æ³•çš„ä¸€ä¸ªå˜ä½“ï¼Œå…·ä½“å†…å®¹ã€‚\nç¯‡å¹…åŸå› ä¸å†è´´sha256çš„ä¼ªä»£ç ï¼Œç»´åŸºç™¾ç§‘ä¸­æœ‰è¯¦ç»†è¯´æ˜ã€‚\n4.6 ç¼–å†™sha256ç®—æ³•çš„æµ‹è¯•ä»£ç  import hashlib def my_sha256(message): pass def true_sha256(message): m = hashlib.sha256() m.update(message) return m.hexdigest() if __name__=='__main__': demo = [b\"\", b\"a\", b\"abc\", b\"message digest\", b\"abcdefghijklmnopqrstuvwxyz\", b\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\", b\"12345678901234567890123456789012345678901234567890123456789012345678901234567890\"] for message in demo: print(my_sha256(message),' \u003c= \"',message.decode('ascii'),'\"', sep='') assert true_sha256(message)==my_sha256(message) # è‹¥å’Œæ ‡å‡†åº“ä¸­ä¸åŒï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ 4.7 ç¼–å†™MD5å’ŒSHA256çš„pythonå®ç°ï¼Œå¹¶è¿›è¡Œæµ‹è¯•éªŒè¯ ä»£ç å’Œæµ‹è¯•ç»“æœåœ¨æŠ¥å‘Šæœ€å\n4.8 æ€»ç»“å®éªŒï¼Œç¼–å†™å®éªŒæŠ¥å‘Š 5. å®éªŒæ€»ç»“ éœ€è¦å–„äºå€Ÿé‰´å‰äººç»éªŒï¼Œæœé›†èµ„æ–™ å®éªŒåªæ”¯æŒasciiç ï¼Œå¯¹å…¶ä»–å­—ç¬¦ç¼–ç æ²¡æœ‰è§£å†³ åˆ©ç”¨ä¼˜ç§€çš„å·¥å…·ï¼Œå¦‚Jupyterå¯ä»¥æé«˜å­¦ä¹ æ•ˆç‡ 6. å®éªŒå®Œæ•´ä»£ç  5.1 MD5å®ç° # MD5 å®ç°åŠå…¶éªŒè¯ import math import hashlib rotate_amounts = [7, 12, 17, 22, 7, 12, 17, 22, 7, 12, 17, 22, 7, 12, 17, 22, 5, 9, 14, 20, 5, 9, 14, 20, 5, 9, 14, 20, 5, 9, 14, 20, 4, 11, 16, 23, 4, 11, 16, 23, 4, 11, 16, 23, 4, 11, 16, 23, 6, 10, 15, 21, 6, 10, 15, 21, 6, 10, 15, 21, 6, 10, 15, 21] constants = [int(abs(math.sin(i+1)) * 2**32) \u0026 0xFFFFFFFF for i in range(64)] # A B C D init_values = [0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476] # éçº¿æ€§å‡½æ•° functions = 16*[lambda b, c, d: (b \u0026 c) | (~b \u0026 d)] + \\ 16*[lambda b, c, d: (d \u0026 b) | (~d \u0026 c)] + \\ 16*[lambda b, c, d: b ^ c ^ d] + \\ 16*[lambda b, c, d: c ^ (b | ~d)] index_functions = 16*[lambda i: i] + \\ 16*[lambda i: (5*i + 1)%16] + \\ 16*[lambda i: (3*i + 5)%16] + \\ 16*[lambda i: (7*i)%16] # å¯¹xå·¦ç§»amountä½ def left_rotate(x, amount): x \u0026= 0xFFFFFFFF return ((x\u003c\u003e(32-amount))) \u0026 0xFFFFFFFF def md5(message): message = bytearray(message) #copy our input into a mutable buffer orig_len_in_bits = (8 * len(message)) \u0026 0xffffffffffffffff message.append(0x80) while len(message)%64 != 56: message.append(0) message += orig_len_in_bits.to_bytes(8, byteorder='little') hash_pieces = init_values[:] for chunk_ofst in range(0, len(message), 64): a, b, c, d = hash_pieces chunk = message[chunk_ofst:chunk_ofst+64] for i in range(64): f = functions[i](b, c, d) g = index_functions[i](i) to_rotate = a + f + constants[i] + int.from_bytes(chunk[4*g:4*g+4], byteorder='little') new_b = (b + left_rotate(to_rotate, rotate_amounts[i])) \u0026 0xFFFFFFFF a, b, c, d = d, new_b, b, c for i, val in enumerate([a, b, c, d]): hash_pieces[i] += val hash_pieces[i] \u0026= 0xFFFFFFFF return sum(x\u003c\u003c(32*i) for i, x in enumerate(hash_pieces)) def md5_to_hex(digest): raw = digest.to_bytes(16, byteorder='little') return '{:032x}'.format(int.from_bytes(raw, byteorder='big')) def true_md5(message): m = hashlib.md5() m.update(message) return m.hexdigest() def my_md5(message): return md5_to_hex(md5(message)) if __name__=='__main__': demo = [b\"\", b\"a\", b\"abc\", b\"message digest\", b\"abcdefghijklmnopqrstuvwxyz\", b\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\", b\"12345678901234567890123456789012345678901234567890123456789012345678901234567890\"] for message in demo: print(my_md5(message),' \u003c= \"',message.decode('ascii'),'\"', sep='') assert true_md5(message)==my_md5(message) # è‹¥å’Œæ ‡å‡†åº“ä¸­ä¸åŒï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ print('\\nMD5æµ‹è¯•å…¨éƒ¨é€šè¿‡') # d41d8cd98f00b204e9800998ecf8427e \u003c= \"\" # 0cc175b9c0f1b6a831c399e269772661 \u003c= \"a\" # 900150983cd24fb0d6963f7d28e17f72 \u003c= \"abc\" # f96b697d7cb7938d525a2f31aaf161d0 \u003c= \"message digest\" # c3fcd3d76192e4007dfb496cca67e13b \u003c= \"abcdefghijklmnopqrstuvwxyz\" # d174ab98d277d9f5a5611c2c9f419d9f \u003c= \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\" # 57edf4a22be3c955ac49da2e2107b67a \u003c= \"12345678901234567890123456789012345678901234567890123456789012345678901234567890\" # # MD5æµ‹è¯•å…¨éƒ¨é€šè¿‡ 5.2 Sha256å®ç° import copy import struct import binascii import hashlib F32 = 0xFFFFFFFF _k = [0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5, 0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174, 0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da, 0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967, 0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85, 0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070, 0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3, 0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2] _h = [0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19] def _pad(msglen): mdi = msglen \u0026 0x3F length = struct.pack('!Q', msglen \u003c\u003c 3) if mdi \u003c 56: padlen = 55 - mdi else: padlen = 119 - mdi return b'\\x80' + (b'\\x00' * padlen) + length def _rotr(x, y): return ((x \u003e\u003e y) | (x \u003c\u003c (32 - y))) \u0026 F32 def _maj(x, y, z): return (x \u0026 y) ^ (x \u0026 z) ^ (y \u0026 z) def _ch(x, y, z): return (x \u0026 y) ^ ((~x) \u0026 z) class SHA256: _output_size = 8 blocksize = 1 block_size = 64 digest_size = 32 def __init__(self, m=None): self._counter = 0 self._cache = b'' self._k = copy.deepcopy(_k) self._h = copy.deepcopy(_h) self.update(m) def _compress(self, c): w = [0] * 64 w[0:16] = struct.unpack('!16L', c) for i in range(16, 64): s0 = _rotr(w[i-15], 7) ^ _rotr(w[i-15], 18) ^ (w[i-15] \u003e\u003e 3) s1 = _rotr(w[i-2], 17) ^ _rotr(w[i-2], 19) ^ (w[i-2] \u003e\u003e 10) w[i] = (w[i-16] + s0 + w[i-7] + s1) \u0026 F32 a, b, c, d, e, f, g, h = self._h for i in range(64): s0 = _rotr(a, 2) ^ _rotr(a, 13) ^ _rotr(a, 22) t2 = s0 + _maj(a, b, c) s1 = _rotr(e, 6) ^ _rotr(e, 11) ^ _rotr(e, 25) t1 = h + s1 + _ch(e, f, g) + self._k[i] + w[i] h = g g = f f = e e = (d + t1) \u0026 F32 d = c c = b b = a a = (t1 + t2) \u0026 F32 for i, (x, y) in enumerate(zip(self._h, [a, b, c, d, e, f, g, h])): self._h[i] = (x + y) \u0026 F32 def update(self, m): if not m: return self._counter += len(m) m = self._cache + m for i in range(0, len(m) // 64): self._compress(m[64 * i:64 * (i + 1)]) self._cache = m[-(len(m) % 64):] def digest(self): r = copy.deepcopy(self) r.update(_pad(self._counter)) data = [struct.pack('!L', i) for i in r._h[:self._output_size]] return b''.join(data) def hexdigest(self): return binascii.hexlify(self.digest()).decode('ascii') def true_sha256(message): m = hashlib.sha256() m.update(message) return m.hexdigest() def my_sha256(message): return SHA256(message).hexdigest() if __name__=='__main__': demo = [b\"\", b\"a\", b\"abc\", b\"message digest\", b\"abcdefghijklmnopqrstuvwxyz\", b\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\", b\"12345678901234567890123456789012345678901234567890123456789012345678901234567890\"] for message in demo: print(my_sha256(message),' \u003c= \"',message.decode('ascii'),'\"', sep='') assert true_sha256(message)==my_sha256(message) # è‹¥å’Œæ ‡å‡†åº“ä¸­ä¸åŒï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ print('\\nSHA256æµ‹è¯•å…¨éƒ¨é€šè¿‡') # e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855 \u003c= \"\" # ca978112ca1bbdcafac231b39a23dc4da786eff8147c4e72b9807785afee48bb \u003c= \"a\" # ba7816bf8f01cfea414140de5dae2223b00361a396177a9cb410ff61f20015ad \u003c= \"abc\" # f7846f55cf23e14eebeab5b4e1550cad5b509e3348fbc4efa3a1413d393cb650 \u003c= \"message digest\" # 71c480df93d6ae2f1efad1447c66c9525e316218cf51fc8d9ed832f2daf18b73 \u003c= \"abcdefghijklmnopqrstuvwxyz\" # db4bfcbd4da0cd85a60c3c37d3fbd8805c77f15fc6b1fdfe614ee0a7c8fdb4c0 \u003c= \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\" # f371bc4a311f2b009eef952dd83ca80e2b60026c8e935592d0f9c308453c813e \u003c= \"12345678901234567890123456789012345678901234567890123456789012345678901234567890\" # # SHA256æµ‹è¯•å…¨éƒ¨é€šè¿‡ ",
  "wordCount" : "2646",
  "inLanguage": "zh",
  "datePublished": "2018-05-18T00:00:00Z",
  "dateModified": "2018-05-18T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Niuhe"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://blog.niuhemoon.win/posts/tech/python-hash-experiment/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Niuhe's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://blog.niuhemoon.win/base/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://blog.niuhemoon.win" accesskey="h" title="Niuhe&#39;s Blog (Alt + H)">
                <img src="https://blog.niuhemoon.win/base/avatar.jpeg" alt="" aria-label="logo"
                    height="35">Niuhe&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://blog.niuhemoon.win/search" title="ğŸ”æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>ğŸ”æœç´¢</span>
                </a>
            </li>
            <li>
                <a href="https://blog.niuhemoon.win/" title="ğŸ ä¸»é¡µ">
                    <span>ğŸ ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://blog.niuhemoon.win/posts" title="ğŸ“šæ–‡ç« ">
                    <span>ğŸ“šæ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="https://blog.niuhemoon.win/tags" title="ğŸ”–æ ‡ç­¾">
                    <span>ğŸ”–æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://blog.niuhemoon.win/archives/" title="â±æ—¶é—´è½´">
                    <span>â±æ—¶é—´è½´</span>
                </a>
            </li>
            <li>
                <a href="https://blog.niuhemoon.win/about" title="ğŸ™‹ğŸ»â€â™‚ï¸å…³äº">
                    <span>ğŸ™‹ğŸ»â€â™‚ï¸å…³äº</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://blog.niuhemoon.win">ğŸ ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href="https://blog.niuhemoon.win/posts/">ğŸ“šæ–‡ç« </a>&nbsp;Â»&nbsp;<a href="https://blog.niuhemoon.win/posts/tech/">ğŸ‘¨ğŸ»â€ğŸ’» æŠ€æœ¯</a></div>
    <h1 class="post-title">
      Pythonå®ç°MD5å’ŒSha256
    </h1>
    <div class="post-meta"><span title='2018-05-18 00:00:00 +0000 UTC'>2018-05-18</span>&nbsp;Â·&nbsp;6 min&nbsp;Â·&nbsp;2646 å­—&nbsp;Â·&nbsp;Niuhe

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">æ–‡ç« ç›®å½•</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#hash%e5%87%bd%e6%95%b0%e7%ae%97%e6%b3%95%e7%bc%96%e5%86%99" aria-label="Hashå‡½æ•°ç®—æ³•ç¼–å†™">Hashå‡½æ•°ç®—æ³•ç¼–å†™</a><ul>
                        
                <li>
                    <a href="#1%e5%ae%9e%e9%aa%8c%e7%9b%ae%e7%9a%84" aria-label="1.å®éªŒç›®çš„">1.å®éªŒç›®çš„</a></li>
                <li>
                    <a href="#2%e5%ae%9e%e9%aa%8c%e5%b7%a5%e5%85%b7" aria-label="2.å®éªŒå·¥å…·">2.å®éªŒå·¥å…·</a></li>
                <li>
                    <a href="#3%e5%ae%9e%e9%aa%8c%e7%8e%af%e5%a2%83" aria-label="3.å®éªŒç¯å¢ƒ">3.å®éªŒç¯å¢ƒ</a></li>
                <li>
                    <a href="#4%e5%ae%9e%e9%aa%8c%e6%ad%a5%e9%aa%a4" aria-label="4.å®éªŒæ­¥éª¤">4.å®éªŒæ­¥éª¤</a><ul>
                        
                <li>
                    <a href="#41-%e5%9b%9e%e9%a1%be%e8%af%be%e7%a8%8b%e6%9f%a5%e9%98%85%e8%b5%84%e6%96%99" aria-label="4.1 å›é¡¾è¯¾ç¨‹ï¼ŒæŸ¥é˜…èµ„æ–™">4.1 å›é¡¾è¯¾ç¨‹ï¼ŒæŸ¥é˜…èµ„æ–™</a></li>
                <li>
                    <a href="#42-%e7%86%9f%e6%82%89md5%e7%9a%84%e5%8e%9f%e7%90%86" aria-label="4.2 ç†Ÿæ‚‰MD5çš„åŸç†">4.2 ç†Ÿæ‚‰MD5çš„åŸç†</a></li>
                <li>
                    <a href="#43-%e6%9f%a5%e9%98%85%e5%be%97md5%e7%ae%97%e6%b3%95%e7%9a%84%e4%bc%aa%e4%bb%a3%e7%a0%81" aria-label="4.3 æŸ¥é˜…å¾—MD5ç®—æ³•çš„ä¼ªä»£ç ">4.3 æŸ¥é˜…å¾—MD5ç®—æ³•çš„ä¼ªä»£ç </a></li>
                <li>
                    <a href="#44-%e7%bc%96%e5%86%99md5%e7%ae%97%e6%b3%95%e6%b5%8b%e8%af%95%e7%94%a8%e4%be%8b" aria-label="4.4 ç¼–å†™MD5ç®—æ³•æµ‹è¯•ç”¨ä¾‹">4.4 ç¼–å†™MD5ç®—æ³•æµ‹è¯•ç”¨ä¾‹</a></li>
                <li>
                    <a href="#45-%e6%9f%a5%e9%98%85sha256%e7%ae%97%e6%b3%95%e5%8e%9f%e7%90%86%e5%92%8c%e4%bc%aa%e4%bb%a3%e7%a0%81" aria-label="4.5 æŸ¥é˜…sha256ç®—æ³•åŸç†å’Œä¼ªä»£ç ">4.5 æŸ¥é˜…sha256ç®—æ³•åŸç†å’Œä¼ªä»£ç </a></li>
                <li>
                    <a href="#46-%e7%bc%96%e5%86%99sha256%e7%ae%97%e6%b3%95%e7%9a%84%e6%b5%8b%e8%af%95%e4%bb%a3%e7%a0%81" aria-label="4.6 ç¼–å†™sha256ç®—æ³•çš„æµ‹è¯•ä»£ç ">4.6 ç¼–å†™sha256ç®—æ³•çš„æµ‹è¯•ä»£ç </a></li>
                <li>
                    <a href="#47-%e7%bc%96%e5%86%99md5%e5%92%8csha256%e7%9a%84python%e5%ae%9e%e7%8e%b0%e5%b9%b6%e8%bf%9b%e8%a1%8c%e6%b5%8b%e8%af%95%e9%aa%8c%e8%af%81" aria-label="4.7 ç¼–å†™MD5å’ŒSHA256çš„pythonå®ç°ï¼Œå¹¶è¿›è¡Œæµ‹è¯•éªŒè¯">4.7 ç¼–å†™MD5å’ŒSHA256çš„pythonå®ç°ï¼Œå¹¶è¿›è¡Œæµ‹è¯•éªŒè¯</a></li>
                <li>
                    <a href="#48-%e6%80%bb%e7%bb%93%e5%ae%9e%e9%aa%8c%e7%bc%96%e5%86%99%e5%ae%9e%e9%aa%8c%e6%8a%a5%e5%91%8a" aria-label="4.8 æ€»ç»“å®éªŒï¼Œç¼–å†™å®éªŒæŠ¥å‘Š">4.8 æ€»ç»“å®éªŒï¼Œç¼–å†™å®éªŒæŠ¥å‘Š</a></li></ul>
                </li>
                <li>
                    <a href="#5-%e5%ae%9e%e9%aa%8c%e6%80%bb%e7%bb%93" aria-label="5. å®éªŒæ€»ç»“">5. å®éªŒæ€»ç»“</a></li>
                <li>
                    <a href="#6-%e5%ae%9e%e9%aa%8c%e5%ae%8c%e6%95%b4%e4%bb%a3%e7%a0%81" aria-label="6. å®éªŒå®Œæ•´ä»£ç ">6. å®éªŒå®Œæ•´ä»£ç </a><ul>
                        
                <li>
                    <a href="#51-md5%e5%ae%9e%e7%8e%b0" aria-label="5.1 MD5å®ç°">5.1 MD5å®ç°</a></li>
                <li>
                    <a href="#52-sha256%e5%ae%9e%e7%8e%b0" aria-label="5.2 Sha256å®ç°">5.2 Sha256å®ç°</a>
                </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>Python3å®ç°å“ˆå¸Œæ•£åˆ—ç®—æ³•ï¼ŒåŒ…å«MD5å’Œsha256ã€‚</p>
<h2 id="hashå‡½æ•°ç®—æ³•ç¼–å†™">Hashå‡½æ•°ç®—æ³•ç¼–å†™<a hidden class="anchor" aria-hidden="true" href="#hashå‡½æ•°ç®—æ³•ç¼–å†™">#</a></h2>
<p>æœ¬å®éªŒæ˜¯ä½¿ç”¨pythonæ¥ç¼–å†™MD5å’ŒSHA256åŠ å¯†å‡½æ•°ï¼Œå¹¶å¯¹åŠ å¯†å‡½æ•°çš„æ­£ç¡®æ€§è¿›è¡ŒéªŒè¯ã€‚<br>
éªŒè¯çš„æ–¹å¼æ˜¯é€šè¿‡å’Œå·²æœ‰çš„æ ‡å‡†åº“åŠ å¯†ç»“æœè¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç»“æœç›¸åŒï¼Œåˆ™åŠ å¯†å‡½æ•°æ­£ç¡®ã€‚</p>
<h3 id="1å®éªŒç›®çš„">1.å®éªŒç›®çš„<a hidden class="anchor" aria-hidden="true" href="#1å®éªŒç›®çš„">#</a></h3>
<ol>
<li>ç†Ÿæ‚‰MD5å’ŒSHA256åŠ å¯†å‡½æ•°çš„åŸç†å’Œåº”ç”¨</li>
<li>å®ç°MD5å’ŒSHA256åŠ å¯†å‡½æ•°å¹¶éªŒè¯</li>
</ol>
<h3 id="2å®éªŒå·¥å…·">2.å®éªŒå·¥å…·<a hidden class="anchor" aria-hidden="true" href="#2å®éªŒå·¥å…·">#</a></h3>
<ul>
<li>Jupyter Notebook</li>
<li>Python3.5</li>
</ul>
<h3 id="3å®éªŒç¯å¢ƒ">3.å®éªŒç¯å¢ƒ<a hidden class="anchor" aria-hidden="true" href="#3å®éªŒç¯å¢ƒ">#</a></h3>
<ul>
<li>Ubuntu16.04LTSæ“ä½œç³»ç»Ÿ</li>
<li>Python3æ ‡å‡†åº“</li>
</ul>
<h3 id="4å®éªŒæ­¥éª¤">4.å®éªŒæ­¥éª¤<a hidden class="anchor" aria-hidden="true" href="#4å®éªŒæ­¥éª¤">#</a></h3>
<h4 id="41-å›é¡¾è¯¾ç¨‹æŸ¥é˜…èµ„æ–™">4.1 å›é¡¾è¯¾ç¨‹ï¼ŒæŸ¥é˜…èµ„æ–™<a hidden class="anchor" aria-hidden="true" href="#41-å›é¡¾è¯¾ç¨‹æŸ¥é˜…èµ„æ–™">#</a></h4>
<h4 id="42-ç†Ÿæ‚‰md5çš„åŸç†">4.2 ç†Ÿæ‚‰MD5çš„åŸç†<a hidden class="anchor" aria-hidden="true" href="#42-ç†Ÿæ‚‰md5çš„åŸç†">#</a></h4>
<blockquote>
<p><em>MD5(Message-Digest Algorithm)æ¶ˆæ¯æ‘˜è¦ç®—æ³•æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„å¯†ç æ•£åˆ—å‡½æ•°ï¼Œå¯ä»¥äº§ç”Ÿå‡ºä¸€ä¸ª128ä½ï¼ˆ16å­—èŠ‚ï¼‰çš„æ•£åˆ—å€¼ï¼ˆhash valueï¼‰ï¼Œç”¨äºç¡®ä¿ä¿¡æ¯ä¼ è¾“å®Œæ•´ä¸€è‡´ã€‚</em><br>
MD5å°†å¯å˜é•¿åº¦çš„æ¶ˆæ¯å¤„ç†æˆ128ä½çš„å›ºå®šé•¿åº¦è¾“å‡ºã€‚è¾“å…¥æ¶ˆæ¯è¢«åˆ†è§£æˆ512ä½å—ï¼ˆ16ä¸ª32ä½å­—ï¼‰å—;è¯¥æ¶ˆæ¯è¢«å¡«å……ä»¥ä½¿å…¶é•¿åº¦å¯ä»¥è¢«512æ•´é™¤ã€‚<br>
å¡«å……çš„å·¥ä½œåŸç†å¦‚ä¸‹ï¼š</p>
</blockquote>
<ul>
<li>é¦–å…ˆå°†å•ä¸ªä½1é™„åŠ åˆ°æ¶ˆæ¯çš„æœ«å°¾</li>
<li>æ¥ç€å¡«å……0ï¼Œç›´åˆ°æ¶ˆæ¯é•¿åº¦æ¯”512çš„æ•´æ•°å€å°‘64</li>
<li>åœ¨æ¥ä¸‹æ¥64ä½ä¸­å¡«å……çœŸå®æ¶ˆæ¯çš„é•¿åº¦å€¼</li>
</ul>
<blockquote>
<p>ä¸»MD5ç®—æ³•åœ¨128ä½çŠ¶æ€ä¸‹è¿è¡Œï¼Œåˆ†ä¸ºå››ä¸ª32ä½å­—ï¼Œåˆ†åˆ«è¡¨ç¤ºä¸ºAï¼ŒBï¼ŒCå’ŒD.è¿™äº›å­—è¢«åˆå§‹åŒ–ä¸ºæŸäº›å›ºå®šçš„å¸¸é‡ã€‚<br>
ä¸»ç®—æ³•ç„¶åä¾æ¬¡ä½¿ç”¨æ¯ä¸ª512ä½æ¶ˆæ¯å—æ¥ä¿®æ”¹çŠ¶æ€ã€‚<br>
æ¶ˆæ¯å—çš„å¤„ç†ç”±å››ä¸ªç›¸ä¼¼çš„é˜¶æ®µç»„æˆï¼Œç§°ä¸ºå¾ªç¯;æ¯è½®ç”±åŸºäºéçº¿æ€§å‡½æ•°Fï¼Œæ¨¡åŠ æ³•å’Œå·¦æ—‹ç­‰16ç§ç±»ä¼¼æ“ä½œç»„æˆã€‚</p>
</blockquote>
<ul>
<li>å›¾1è¯´æ˜äº†ä¸€è½®å†…çš„ä¸€ä¸ªæ“ä½œæµç¨‹ã€‚</li>
<li>å›¾2è¡¨ç¤ºFæœ‰å››ç§å¯èƒ½çš„åŠŸèƒ½;æ¯ä¸€è½®ä½¿ç”¨ä¸åŒçš„ä¸€ä¸ªï¼š</li>
</ul>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/a/a5/MD5_algorithm.svg" alt="Drawing" style="width: 300px;text-align: center;vertical-align: middle"><img/></p>
<blockquote>
<p>ä¸‹å›¾æ˜¯éçº¿æ€§å‡½æ•°çš„å››ç§å¯èƒ½</p>
</blockquote>
<img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b105d494a376d11f2eefd810082e1944cd8e2dc4" alt="Drawing" style="width: 300px;"/>
<h4 id="43-æŸ¥é˜…å¾—md5ç®—æ³•çš„ä¼ªä»£ç ">4.3 æŸ¥é˜…å¾—MD5ç®—æ³•çš„ä¼ªä»£ç <a hidden class="anchor" aria-hidden="true" href="#43-æŸ¥é˜…å¾—md5ç®—æ³•çš„ä¼ªä»£ç ">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#007f7f">//Note: All variables are unsigned 32 bit and wrap modulo 2^32 when calculating
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>var <span style="color:#fff;font-weight:bold">int</span>[<span style="color:#ff0;font-weight:bold">64</span>] s, K
</span></span><span style="display:flex;"><span>var <span style="color:#fff;font-weight:bold">int</span> i
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//s specifies the per-round shift amounts
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>s[ <span style="color:#ff0;font-weight:bold">0..15</span>] := { <span style="color:#ff0;font-weight:bold">7</span>, <span style="color:#ff0;font-weight:bold">12</span>, <span style="color:#ff0;font-weight:bold">17</span>, <span style="color:#ff0;font-weight:bold">22</span>,  <span style="color:#ff0;font-weight:bold">7</span>, <span style="color:#ff0;font-weight:bold">12</span>, <span style="color:#ff0;font-weight:bold">17</span>, <span style="color:#ff0;font-weight:bold">22</span>,  <span style="color:#ff0;font-weight:bold">7</span>, <span style="color:#ff0;font-weight:bold">12</span>, <span style="color:#ff0;font-weight:bold">17</span>, <span style="color:#ff0;font-weight:bold">22</span>,  <span style="color:#ff0;font-weight:bold">7</span>, <span style="color:#ff0;font-weight:bold">12</span>, <span style="color:#ff0;font-weight:bold">17</span>, <span style="color:#ff0;font-weight:bold">22</span> }
</span></span><span style="display:flex;"><span>s[<span style="color:#ff0;font-weight:bold">16..31</span>] := { <span style="color:#ff0;font-weight:bold">5</span>,  <span style="color:#ff0;font-weight:bold">9</span>, <span style="color:#ff0;font-weight:bold">14</span>, <span style="color:#ff0;font-weight:bold">20</span>,  <span style="color:#ff0;font-weight:bold">5</span>,  <span style="color:#ff0;font-weight:bold">9</span>, <span style="color:#ff0;font-weight:bold">14</span>, <span style="color:#ff0;font-weight:bold">20</span>,  <span style="color:#ff0;font-weight:bold">5</span>,  <span style="color:#ff0;font-weight:bold">9</span>, <span style="color:#ff0;font-weight:bold">14</span>, <span style="color:#ff0;font-weight:bold">20</span>,  <span style="color:#ff0;font-weight:bold">5</span>,  <span style="color:#ff0;font-weight:bold">9</span>, <span style="color:#ff0;font-weight:bold">14</span>, <span style="color:#ff0;font-weight:bold">20</span> }
</span></span><span style="display:flex;"><span>s[<span style="color:#ff0;font-weight:bold">32..47</span>] := { <span style="color:#ff0;font-weight:bold">4</span>, <span style="color:#ff0;font-weight:bold">11</span>, <span style="color:#ff0;font-weight:bold">16</span>, <span style="color:#ff0;font-weight:bold">23</span>,  <span style="color:#ff0;font-weight:bold">4</span>, <span style="color:#ff0;font-weight:bold">11</span>, <span style="color:#ff0;font-weight:bold">16</span>, <span style="color:#ff0;font-weight:bold">23</span>,  <span style="color:#ff0;font-weight:bold">4</span>, <span style="color:#ff0;font-weight:bold">11</span>, <span style="color:#ff0;font-weight:bold">16</span>, <span style="color:#ff0;font-weight:bold">23</span>,  <span style="color:#ff0;font-weight:bold">4</span>, <span style="color:#ff0;font-weight:bold">11</span>, <span style="color:#ff0;font-weight:bold">16</span>, <span style="color:#ff0;font-weight:bold">23</span> }
</span></span><span style="display:flex;"><span>s[<span style="color:#ff0;font-weight:bold">48..63</span>] := { <span style="color:#ff0;font-weight:bold">6</span>, <span style="color:#ff0;font-weight:bold">10</span>, <span style="color:#ff0;font-weight:bold">15</span>, <span style="color:#ff0;font-weight:bold">21</span>,  <span style="color:#ff0;font-weight:bold">6</span>, <span style="color:#ff0;font-weight:bold">10</span>, <span style="color:#ff0;font-weight:bold">15</span>, <span style="color:#ff0;font-weight:bold">21</span>,  <span style="color:#ff0;font-weight:bold">6</span>, <span style="color:#ff0;font-weight:bold">10</span>, <span style="color:#ff0;font-weight:bold">15</span>, <span style="color:#ff0;font-weight:bold">21</span>,  <span style="color:#ff0;font-weight:bold">6</span>, <span style="color:#ff0;font-weight:bold">10</span>, <span style="color:#ff0;font-weight:bold">15</span>, <span style="color:#ff0;font-weight:bold">21</span> }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//Use binary integer part of the sines of integers (Radians) as constants:
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">for</span> i from <span style="color:#ff0;font-weight:bold">0</span> to <span style="color:#ff0;font-weight:bold">63</span>
</span></span><span style="display:flex;"><span>    K[i] := floor(<span style="color:#ff0;font-weight:bold">232</span> <span style="color:#f00">Ã—</span> abs(sin(i + <span style="color:#ff0;font-weight:bold">1</span>)))
</span></span><span style="display:flex;"><span>end <span style="color:#fff;font-weight:bold">for</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//Initialize variables:
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>var <span style="color:#fff;font-weight:bold">int</span> a0 := <span style="color:#ff0;font-weight:bold">0x67452301</span>   <span style="color:#007f7f">//A
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>var <span style="color:#fff;font-weight:bold">int</span> b0 := <span style="color:#ff0;font-weight:bold">0xefcdab89</span>   <span style="color:#007f7f">//B
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>var <span style="color:#fff;font-weight:bold">int</span> c0 := <span style="color:#ff0;font-weight:bold">0x98badcfe</span>   <span style="color:#007f7f">//C
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>var <span style="color:#fff;font-weight:bold">int</span> d0 := <span style="color:#ff0;font-weight:bold">0x10325476</span>   <span style="color:#007f7f">//D
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//Pre-processing: adding a single 1 bit
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>append <span style="color:#0ff;font-weight:bold">&#34;1&#34;</span> bit to message    
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// Notice: the input bytes are considered as bits strings,
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">//  where the first bit is the most significant bit of the byte.[48]
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//Pre-processing: padding with zeros
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>append <span style="color:#0ff;font-weight:bold">&#34;0&#34;</span> bit until message length in bits <span style="color:#f00">â‰¡</span> <span style="color:#ff0;font-weight:bold">448</span> (mod <span style="color:#ff0;font-weight:bold">512</span>)
</span></span><span style="display:flex;"><span>append original length in bits mod <span style="color:#ff0;font-weight:bold">264</span> to message
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//Process the message in successive 512-bit chunks:
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">for</span> each <span style="color:#ff0;font-weight:bold">512</span>-bit chunk of padded message
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">break</span> chunk into sixteen <span style="color:#ff0;font-weight:bold">32</span>-bit words M[j], <span style="color:#ff0;font-weight:bold">0</span> <span style="color:#f00">â‰¤</span> j <span style="color:#f00">â‰¤</span> <span style="color:#ff0;font-weight:bold">15</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//Initialize hash value for this chunk:
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    var <span style="color:#fff;font-weight:bold">int</span> A := a0
</span></span><span style="display:flex;"><span>    var <span style="color:#fff;font-weight:bold">int</span> B := b0
</span></span><span style="display:flex;"><span>    var <span style="color:#fff;font-weight:bold">int</span> C := c0
</span></span><span style="display:flex;"><span>    var <span style="color:#fff;font-weight:bold">int</span> D := d0
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//Main loop:
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">for</span> i from <span style="color:#ff0;font-weight:bold">0</span> to <span style="color:#ff0;font-weight:bold">63</span>
</span></span><span style="display:flex;"><span>        var <span style="color:#fff;font-weight:bold">int</span> F, g
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> <span style="color:#ff0;font-weight:bold">0</span> <span style="color:#f00">â‰¤</span> i <span style="color:#f00">â‰¤</span> <span style="color:#ff0;font-weight:bold">15</span> then
</span></span><span style="display:flex;"><span>            F := (B and C) or ((not B) and D)
</span></span><span style="display:flex;"><span>            g := i
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">else</span> <span style="color:#fff;font-weight:bold">if</span> <span style="color:#ff0;font-weight:bold">16</span> <span style="color:#f00">â‰¤</span> i <span style="color:#f00">â‰¤</span> <span style="color:#ff0;font-weight:bold">31</span>
</span></span><span style="display:flex;"><span>            F := (D and B) or ((not D) and C)
</span></span><span style="display:flex;"><span>            g := (<span style="color:#ff0;font-weight:bold">5</span><span style="color:#f00">Ã—</span>i + <span style="color:#ff0;font-weight:bold">1</span>) mod <span style="color:#ff0;font-weight:bold">16</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">else</span> <span style="color:#fff;font-weight:bold">if</span> <span style="color:#ff0;font-weight:bold">32</span> <span style="color:#f00">â‰¤</span> i <span style="color:#f00">â‰¤</span> <span style="color:#ff0;font-weight:bold">47</span>
</span></span><span style="display:flex;"><span>            F := B xor C xor D
</span></span><span style="display:flex;"><span>            g := (<span style="color:#ff0;font-weight:bold">3</span><span style="color:#f00">Ã—</span>i + <span style="color:#ff0;font-weight:bold">5</span>) mod <span style="color:#ff0;font-weight:bold">16</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">else</span> <span style="color:#fff;font-weight:bold">if</span> <span style="color:#ff0;font-weight:bold">48</span> <span style="color:#f00">â‰¤</span> i <span style="color:#f00">â‰¤</span> <span style="color:#ff0;font-weight:bold">63</span>
</span></span><span style="display:flex;"><span>            F := C xor (B or (not D))
</span></span><span style="display:flex;"><span>            g := (<span style="color:#ff0;font-weight:bold">7</span><span style="color:#f00">Ã—</span>i) mod <span style="color:#ff0;font-weight:bold">16</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//Be wary of the below definitions of a,b,c,d
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        F := F + A + K[i] + M[g]
</span></span><span style="display:flex;"><span>        A := D
</span></span><span style="display:flex;"><span>        D := C
</span></span><span style="display:flex;"><span>        C := B
</span></span><span style="display:flex;"><span>        B := B + leftrotate(F, s[i])
</span></span><span style="display:flex;"><span>    end <span style="color:#fff;font-weight:bold">for</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//Add this chunk&#39;s hash to result so far:
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    a0 := a0 + A
</span></span><span style="display:flex;"><span>    b0 := b0 + B
</span></span><span style="display:flex;"><span>    c0 := c0 + C
</span></span><span style="display:flex;"><span>    d0 := d0 + D
</span></span><span style="display:flex;"><span>end <span style="color:#fff;font-weight:bold">for</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>var <span style="color:#fff;font-weight:bold">char</span> digest[<span style="color:#ff0;font-weight:bold">16</span>] := a0 append b0 append c0 append d0 <span style="color:#007f7f">//(Output is in little-endian)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//leftrotate function definition
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>leftrotate (x, c)
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> (x &lt;&lt; c) binary or (x &gt;&gt; (<span style="color:#ff0;font-weight:bold">32</span>-c));
</span></span></code></pre></div><h4 id="44-ç¼–å†™md5ç®—æ³•æµ‹è¯•ç”¨ä¾‹">4.4 ç¼–å†™MD5ç®—æ³•æµ‹è¯•ç”¨ä¾‹<a hidden class="anchor" aria-hidden="true" href="#44-ç¼–å†™md5ç®—æ³•æµ‹è¯•ç”¨ä¾‹">#</a></h4>
<blockquote>
<p>Pythonæ ‡å‡†åº“hashlibä¸­æä¾›äº†ç”ŸæˆMD5å€¼çš„æ–¹æ³•ï¼Œæ˜¯é€šè¿‡Cè¯­è¨€å®ç°çš„ï¼Œæˆ‘ä»¬ç”¨è‡ªå·±å®ç°çš„MD5å‡½æ•°è®¡ç®—å‡ºMD5å€¼ï¼Œåœ¨å’Œæ ‡å‡†åº“çš„ç»“æœè¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç»“æœç›¸åŒï¼Œé‚£ä¹ˆè¯æ˜äº†MD5åŠ å¯†æ˜¯æ­£ç¡®çš„ã€‚ <br>
<strong>æ³¨æ„ï¼š</strong></p>
</blockquote>
<ul>
<li>åªå®ç°äº†å¯¹ASCIIç å­—ç¬¦ä¸²çš„å¤„ç†</li>
<li>demoä¸­å­˜å‚¨äº†æµ‹è¯•ç”¨ä¾‹</li>
<li>my_md5()è¿”å›è‡ªå·±ç”Ÿæˆçš„MD5å€¼</li>
<li>true_md5()è¿”å›Pythonæ ‡å‡†åº“ç”Ÿæˆçš„MD5å€¼</li>
<li>è‹¥ä¸¤è€…ç»“æœä¸åŒï¼ŒæŠ›å‡ºAssertionErrorå¼‚å¸¸</li>
</ul>
<blockquote>
<p>æµ‹è¯•ç¨‹åºå¦‚ä¸‹ï¼š</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> hashlib
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> my_md5(message):
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> true_md5(message):
</span></span><span style="display:flex;"><span>    m = hashlib.md5()
</span></span><span style="display:flex;"><span>    m.update(message)
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> m.hexdigest()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">if</span> __name__==<span style="color:#0ff;font-weight:bold">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    demo = [<span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;&#34;</span>, <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;a&#34;</span>, <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;abc&#34;</span>, <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;message digest&#34;</span>, <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;abcdefghijklmnopqrstuvwxyz&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;12345678901234567890123456789012345678901234567890123456789012345678901234567890&#34;</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">for</span> message in demo:
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">print</span>(my_md5(message),<span style="color:#0ff;font-weight:bold">&#39; &lt;= &#34;&#39;</span>,message.decode(<span style="color:#0ff;font-weight:bold">&#39;ascii&#39;</span>),<span style="color:#0ff;font-weight:bold">&#39;&#34;&#39;</span>, sep=<span style="color:#0ff;font-weight:bold">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> true_md5(message)==my_md5(message)  <span style="color:#007f7f"># è‹¥å’Œæ ‡å‡†åº“ä¸­ä¸åŒï¼Œä¼šæŠ›å‡ºå¼‚å¸¸</span>
</span></span></code></pre></div><h4 id="45-æŸ¥é˜…sha256ç®—æ³•åŸç†å’Œä¼ªä»£ç ">4.5 æŸ¥é˜…sha256ç®—æ³•åŸç†å’Œä¼ªä»£ç <a hidden class="anchor" aria-hidden="true" href="#45-æŸ¥é˜…sha256ç®—æ³•åŸç†å’Œä¼ªä»£ç ">#</a></h4>
<blockquote>
<p>sha256æ˜¯SHA2(Secure Hash Algorithm 2)ç®—æ³•çš„ä¸€ä¸ªå˜ä½“ï¼Œå…·ä½“<a href="https://zh.wikipedia.org/wiki/SHA-2">å†…å®¹</a>ã€‚<br>
ç¯‡å¹…åŸå› ä¸å†è´´sha256çš„ä¼ªä»£ç ï¼Œç»´åŸºç™¾ç§‘ä¸­æœ‰è¯¦ç»†è¯´æ˜ã€‚</p>
</blockquote>
<h4 id="46-ç¼–å†™sha256ç®—æ³•çš„æµ‹è¯•ä»£ç ">4.6 ç¼–å†™sha256ç®—æ³•çš„æµ‹è¯•ä»£ç <a hidden class="anchor" aria-hidden="true" href="#46-ç¼–å†™sha256ç®—æ³•çš„æµ‹è¯•ä»£ç ">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> hashlib
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> my_sha256(message):
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> true_sha256(message):
</span></span><span style="display:flex;"><span>    m = hashlib.sha256()
</span></span><span style="display:flex;"><span>    m.update(message)
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> m.hexdigest()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">if</span> __name__==<span style="color:#0ff;font-weight:bold">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    demo = [<span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;&#34;</span>, <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;a&#34;</span>, <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;abc&#34;</span>, <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;message digest&#34;</span>, <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;abcdefghijklmnopqrstuvwxyz&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;12345678901234567890123456789012345678901234567890123456789012345678901234567890&#34;</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">for</span> message in demo:
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">print</span>(my_sha256(message),<span style="color:#0ff;font-weight:bold">&#39; &lt;= &#34;&#39;</span>,message.decode(<span style="color:#0ff;font-weight:bold">&#39;ascii&#39;</span>),<span style="color:#0ff;font-weight:bold">&#39;&#34;&#39;</span>, sep=<span style="color:#0ff;font-weight:bold">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> true_sha256(message)==my_sha256(message)  <span style="color:#007f7f"># è‹¥å’Œæ ‡å‡†åº“ä¸­ä¸åŒï¼Œä¼šæŠ›å‡ºå¼‚å¸¸</span>
</span></span></code></pre></div><h4 id="47-ç¼–å†™md5å’Œsha256çš„pythonå®ç°å¹¶è¿›è¡Œæµ‹è¯•éªŒè¯">4.7 ç¼–å†™MD5å’ŒSHA256çš„pythonå®ç°ï¼Œå¹¶è¿›è¡Œæµ‹è¯•éªŒè¯<a hidden class="anchor" aria-hidden="true" href="#47-ç¼–å†™md5å’Œsha256çš„pythonå®ç°å¹¶è¿›è¡Œæµ‹è¯•éªŒè¯">#</a></h4>
<blockquote>
<p>ä»£ç å’Œæµ‹è¯•ç»“æœåœ¨æŠ¥å‘Šæœ€å</p>
</blockquote>
<h4 id="48-æ€»ç»“å®éªŒç¼–å†™å®éªŒæŠ¥å‘Š">4.8 æ€»ç»“å®éªŒï¼Œç¼–å†™å®éªŒæŠ¥å‘Š<a hidden class="anchor" aria-hidden="true" href="#48-æ€»ç»“å®éªŒç¼–å†™å®éªŒæŠ¥å‘Š">#</a></h4>
<h3 id="5-å®éªŒæ€»ç»“">5. å®éªŒæ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#5-å®éªŒæ€»ç»“">#</a></h3>
<ul>
<li>éœ€è¦å–„äºå€Ÿé‰´å‰äººç»éªŒï¼Œæœé›†èµ„æ–™</li>
<li>å®éªŒåªæ”¯æŒasciiç ï¼Œå¯¹å…¶ä»–å­—ç¬¦ç¼–ç æ²¡æœ‰è§£å†³</li>
<li>åˆ©ç”¨ä¼˜ç§€çš„å·¥å…·ï¼Œå¦‚Jupyterå¯ä»¥æé«˜å­¦ä¹ æ•ˆç‡</li>
</ul>
<h3 id="6-å®éªŒå®Œæ•´ä»£ç ">6. å®éªŒå®Œæ•´ä»£ç <a hidden class="anchor" aria-hidden="true" href="#6-å®éªŒå®Œæ•´ä»£ç ">#</a></h3>
<h4 id="51-md5å®ç°">5.1 MD5å®ç°<a hidden class="anchor" aria-hidden="true" href="#51-md5å®ç°">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># MD5 å®ç°åŠå…¶éªŒè¯</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> math
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> hashlib
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>rotate_amounts = [<span style="color:#ff0;font-weight:bold">7</span>, <span style="color:#ff0;font-weight:bold">12</span>, <span style="color:#ff0;font-weight:bold">17</span>, <span style="color:#ff0;font-weight:bold">22</span>, <span style="color:#ff0;font-weight:bold">7</span>, <span style="color:#ff0;font-weight:bold">12</span>, <span style="color:#ff0;font-weight:bold">17</span>, <span style="color:#ff0;font-weight:bold">22</span>, <span style="color:#ff0;font-weight:bold">7</span>, <span style="color:#ff0;font-weight:bold">12</span>, <span style="color:#ff0;font-weight:bold">17</span>, <span style="color:#ff0;font-weight:bold">22</span>, <span style="color:#ff0;font-weight:bold">7</span>, <span style="color:#ff0;font-weight:bold">12</span>, <span style="color:#ff0;font-weight:bold">17</span>, <span style="color:#ff0;font-weight:bold">22</span>,
</span></span><span style="display:flex;"><span>                  <span style="color:#ff0;font-weight:bold">5</span>,  <span style="color:#ff0;font-weight:bold">9</span>, <span style="color:#ff0;font-weight:bold">14</span>, <span style="color:#ff0;font-weight:bold">20</span>, <span style="color:#ff0;font-weight:bold">5</span>,  <span style="color:#ff0;font-weight:bold">9</span>, <span style="color:#ff0;font-weight:bold">14</span>, <span style="color:#ff0;font-weight:bold">20</span>, <span style="color:#ff0;font-weight:bold">5</span>,  <span style="color:#ff0;font-weight:bold">9</span>, <span style="color:#ff0;font-weight:bold">14</span>, <span style="color:#ff0;font-weight:bold">20</span>, <span style="color:#ff0;font-weight:bold">5</span>,  <span style="color:#ff0;font-weight:bold">9</span>, <span style="color:#ff0;font-weight:bold">14</span>, <span style="color:#ff0;font-weight:bold">20</span>,
</span></span><span style="display:flex;"><span>                  <span style="color:#ff0;font-weight:bold">4</span>, <span style="color:#ff0;font-weight:bold">11</span>, <span style="color:#ff0;font-weight:bold">16</span>, <span style="color:#ff0;font-weight:bold">23</span>, <span style="color:#ff0;font-weight:bold">4</span>, <span style="color:#ff0;font-weight:bold">11</span>, <span style="color:#ff0;font-weight:bold">16</span>, <span style="color:#ff0;font-weight:bold">23</span>, <span style="color:#ff0;font-weight:bold">4</span>, <span style="color:#ff0;font-weight:bold">11</span>, <span style="color:#ff0;font-weight:bold">16</span>, <span style="color:#ff0;font-weight:bold">23</span>, <span style="color:#ff0;font-weight:bold">4</span>, <span style="color:#ff0;font-weight:bold">11</span>, <span style="color:#ff0;font-weight:bold">16</span>, <span style="color:#ff0;font-weight:bold">23</span>,
</span></span><span style="display:flex;"><span>                  <span style="color:#ff0;font-weight:bold">6</span>, <span style="color:#ff0;font-weight:bold">10</span>, <span style="color:#ff0;font-weight:bold">15</span>, <span style="color:#ff0;font-weight:bold">21</span>, <span style="color:#ff0;font-weight:bold">6</span>, <span style="color:#ff0;font-weight:bold">10</span>, <span style="color:#ff0;font-weight:bold">15</span>, <span style="color:#ff0;font-weight:bold">21</span>, <span style="color:#ff0;font-weight:bold">6</span>, <span style="color:#ff0;font-weight:bold">10</span>, <span style="color:#ff0;font-weight:bold">15</span>, <span style="color:#ff0;font-weight:bold">21</span>, <span style="color:#ff0;font-weight:bold">6</span>, <span style="color:#ff0;font-weight:bold">10</span>, <span style="color:#ff0;font-weight:bold">15</span>, <span style="color:#ff0;font-weight:bold">21</span>]
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>constants = [<span style="color:#fff;font-weight:bold">int</span>(<span style="color:#fff;font-weight:bold">abs</span>(math.sin(i+<span style="color:#ff0;font-weight:bold">1</span>)) * <span style="color:#ff0;font-weight:bold">2</span>**<span style="color:#ff0;font-weight:bold">32</span>) &amp; <span style="color:#ff0;font-weight:bold">0xFFFFFFFF</span> <span style="color:#fff;font-weight:bold">for</span> i in <span style="color:#fff;font-weight:bold">range</span>(<span style="color:#ff0;font-weight:bold">64</span>)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># A B C D</span>
</span></span><span style="display:flex;"><span>init_values = [<span style="color:#ff0;font-weight:bold">0x67452301</span>, <span style="color:#ff0;font-weight:bold">0xefcdab89</span>, <span style="color:#ff0;font-weight:bold">0x98badcfe</span>, <span style="color:#ff0;font-weight:bold">0x10325476</span>]
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># éçº¿æ€§å‡½æ•°</span>
</span></span><span style="display:flex;"><span>functions = <span style="color:#ff0;font-weight:bold">16</span>*[<span style="color:#fff;font-weight:bold">lambda</span> b, c, d: (b &amp; c) | (~b &amp; d)] + \
</span></span><span style="display:flex;"><span>            <span style="color:#ff0;font-weight:bold">16</span>*[<span style="color:#fff;font-weight:bold">lambda</span> b, c, d: (d &amp; b) | (~d &amp; c)] + \
</span></span><span style="display:flex;"><span>            <span style="color:#ff0;font-weight:bold">16</span>*[<span style="color:#fff;font-weight:bold">lambda</span> b, c, d: b ^ c ^ d] + \
</span></span><span style="display:flex;"><span>            <span style="color:#ff0;font-weight:bold">16</span>*[<span style="color:#fff;font-weight:bold">lambda</span> b, c, d: c ^ (b | ~d)]
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>index_functions = <span style="color:#ff0;font-weight:bold">16</span>*[<span style="color:#fff;font-weight:bold">lambda</span> i: i] + \
</span></span><span style="display:flex;"><span>                  <span style="color:#ff0;font-weight:bold">16</span>*[<span style="color:#fff;font-weight:bold">lambda</span> i: (<span style="color:#ff0;font-weight:bold">5</span>*i + <span style="color:#ff0;font-weight:bold">1</span>)%<span style="color:#ff0;font-weight:bold">16</span>] + \
</span></span><span style="display:flex;"><span>                  <span style="color:#ff0;font-weight:bold">16</span>*[<span style="color:#fff;font-weight:bold">lambda</span> i: (<span style="color:#ff0;font-weight:bold">3</span>*i + <span style="color:#ff0;font-weight:bold">5</span>)%<span style="color:#ff0;font-weight:bold">16</span>] + \
</span></span><span style="display:flex;"><span>                  <span style="color:#ff0;font-weight:bold">16</span>*[<span style="color:#fff;font-weight:bold">lambda</span> i: (<span style="color:#ff0;font-weight:bold">7</span>*i)%<span style="color:#ff0;font-weight:bold">16</span>]
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># å¯¹xå·¦ç§»amountä½</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> left_rotate(x, amount):
</span></span><span style="display:flex;"><span>    x &amp;= <span style="color:#ff0;font-weight:bold">0xFFFFFFFF</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> ((x&lt;&lt;amount) | (x&gt;&gt;(<span style="color:#ff0;font-weight:bold">32</span>-amount))) &amp; <span style="color:#ff0;font-weight:bold">0xFFFFFFFF</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> md5(message):
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    message = <span style="color:#fff;font-weight:bold">bytearray</span>(message) <span style="color:#007f7f">#copy our input into a mutable buffer</span>
</span></span><span style="display:flex;"><span>    orig_len_in_bits = (<span style="color:#ff0;font-weight:bold">8</span> * <span style="color:#fff;font-weight:bold">len</span>(message)) &amp; <span style="color:#ff0;font-weight:bold">0xffffffffffffffff</span>
</span></span><span style="display:flex;"><span>    message.append(<span style="color:#ff0;font-weight:bold">0x80</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">while</span> <span style="color:#fff;font-weight:bold">len</span>(message)%<span style="color:#ff0;font-weight:bold">64</span> != <span style="color:#ff0;font-weight:bold">56</span>:
</span></span><span style="display:flex;"><span>        message.append(<span style="color:#ff0;font-weight:bold">0</span>)
</span></span><span style="display:flex;"><span>    message += orig_len_in_bits.to_bytes(<span style="color:#ff0;font-weight:bold">8</span>, byteorder=<span style="color:#0ff;font-weight:bold">&#39;little&#39;</span>)
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    hash_pieces = init_values[:]
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">for</span> chunk_ofst in <span style="color:#fff;font-weight:bold">range</span>(<span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#fff;font-weight:bold">len</span>(message), <span style="color:#ff0;font-weight:bold">64</span>):
</span></span><span style="display:flex;"><span>        a, b, c, d = hash_pieces
</span></span><span style="display:flex;"><span>        chunk = message[chunk_ofst:chunk_ofst+<span style="color:#ff0;font-weight:bold">64</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span> i in <span style="color:#fff;font-weight:bold">range</span>(<span style="color:#ff0;font-weight:bold">64</span>):
</span></span><span style="display:flex;"><span>            f = functions[i](b, c, d)
</span></span><span style="display:flex;"><span>            g = index_functions[i](i)
</span></span><span style="display:flex;"><span>            to_rotate = a + f + constants[i] + <span style="color:#fff;font-weight:bold">int</span>.from_bytes(chunk[<span style="color:#ff0;font-weight:bold">4</span>*g:<span style="color:#ff0;font-weight:bold">4</span>*g+<span style="color:#ff0;font-weight:bold">4</span>], byteorder=<span style="color:#0ff;font-weight:bold">&#39;little&#39;</span>)
</span></span><span style="display:flex;"><span>            new_b = (b + left_rotate(to_rotate, rotate_amounts[i])) &amp; <span style="color:#ff0;font-weight:bold">0xFFFFFFFF</span>
</span></span><span style="display:flex;"><span>            a, b, c, d = d, new_b, b, c
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span> i, val in <span style="color:#fff;font-weight:bold">enumerate</span>([a, b, c, d]):
</span></span><span style="display:flex;"><span>            hash_pieces[i] += val
</span></span><span style="display:flex;"><span>            hash_pieces[i] &amp;= <span style="color:#ff0;font-weight:bold">0xFFFFFFFF</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">sum</span>(x&lt;&lt;(<span style="color:#ff0;font-weight:bold">32</span>*i) <span style="color:#fff;font-weight:bold">for</span> i, x in <span style="color:#fff;font-weight:bold">enumerate</span>(hash_pieces))
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> md5_to_hex(digest):
</span></span><span style="display:flex;"><span>    raw = digest.to_bytes(<span style="color:#ff0;font-weight:bold">16</span>, byteorder=<span style="color:#0ff;font-weight:bold">&#39;little&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> <span style="color:#0ff;font-weight:bold">&#39;</span><span style="color:#0ff;font-weight:bold">{:032x}</span><span style="color:#0ff;font-weight:bold">&#39;</span>.format(<span style="color:#fff;font-weight:bold">int</span>.from_bytes(raw, byteorder=<span style="color:#0ff;font-weight:bold">&#39;big&#39;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> true_md5(message):
</span></span><span style="display:flex;"><span>    m = hashlib.md5()
</span></span><span style="display:flex;"><span>    m.update(message)
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> m.hexdigest()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> my_md5(message):
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> md5_to_hex(md5(message))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">if</span> __name__==<span style="color:#0ff;font-weight:bold">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    demo = [<span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;&#34;</span>, <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;a&#34;</span>, <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;abc&#34;</span>, <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;message digest&#34;</span>, <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;abcdefghijklmnopqrstuvwxyz&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;12345678901234567890123456789012345678901234567890123456789012345678901234567890&#34;</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">for</span> message in demo:
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">print</span>(my_md5(message),<span style="color:#0ff;font-weight:bold">&#39; &lt;= &#34;&#39;</span>,message.decode(<span style="color:#0ff;font-weight:bold">&#39;ascii&#39;</span>),<span style="color:#0ff;font-weight:bold">&#39;&#34;&#39;</span>, sep=<span style="color:#0ff;font-weight:bold">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> true_md5(message)==my_md5(message)  <span style="color:#007f7f"># è‹¥å’Œæ ‡å‡†åº“ä¸­ä¸åŒï¼Œä¼šæŠ›å‡ºå¼‚å¸¸</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#39;</span><span style="color:#0ff;font-weight:bold">\n</span><span style="color:#0ff;font-weight:bold">MD5æµ‹è¯•å…¨éƒ¨é€šè¿‡&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># d41d8cd98f00b204e9800998ecf8427e &lt;= &#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 0cc175b9c0f1b6a831c399e269772661 &lt;= &#34;a&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 900150983cd24fb0d6963f7d28e17f72 &lt;= &#34;abc&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># f96b697d7cb7938d525a2f31aaf161d0 &lt;= &#34;message digest&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># c3fcd3d76192e4007dfb496cca67e13b &lt;= &#34;abcdefghijklmnopqrstuvwxyz&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># d174ab98d277d9f5a5611c2c9f419d9f &lt;= &#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 57edf4a22be3c955ac49da2e2107b67a &lt;= &#34;12345678901234567890123456789012345678901234567890123456789012345678901234567890&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># MD5æµ‹è¯•å…¨éƒ¨é€šè¿‡</span>
</span></span></code></pre></div><h4 id="52-sha256å®ç°">5.2 Sha256å®ç°<a hidden class="anchor" aria-hidden="true" href="#52-sha256å®ç°">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> copy
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> struct
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> binascii
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> hashlib
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>F32 = <span style="color:#ff0;font-weight:bold">0xFFFFFFFF</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>_k = [<span style="color:#ff0;font-weight:bold">0x428a2f98</span>, <span style="color:#ff0;font-weight:bold">0x71374491</span>, <span style="color:#ff0;font-weight:bold">0xb5c0fbcf</span>, <span style="color:#ff0;font-weight:bold">0xe9b5dba5</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff0;font-weight:bold">0x3956c25b</span>, <span style="color:#ff0;font-weight:bold">0x59f111f1</span>, <span style="color:#ff0;font-weight:bold">0x923f82a4</span>, <span style="color:#ff0;font-weight:bold">0xab1c5ed5</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff0;font-weight:bold">0xd807aa98</span>, <span style="color:#ff0;font-weight:bold">0x12835b01</span>, <span style="color:#ff0;font-weight:bold">0x243185be</span>, <span style="color:#ff0;font-weight:bold">0x550c7dc3</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff0;font-weight:bold">0x72be5d74</span>, <span style="color:#ff0;font-weight:bold">0x80deb1fe</span>, <span style="color:#ff0;font-weight:bold">0x9bdc06a7</span>, <span style="color:#ff0;font-weight:bold">0xc19bf174</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff0;font-weight:bold">0xe49b69c1</span>, <span style="color:#ff0;font-weight:bold">0xefbe4786</span>, <span style="color:#ff0;font-weight:bold">0x0fc19dc6</span>, <span style="color:#ff0;font-weight:bold">0x240ca1cc</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff0;font-weight:bold">0x2de92c6f</span>, <span style="color:#ff0;font-weight:bold">0x4a7484aa</span>, <span style="color:#ff0;font-weight:bold">0x5cb0a9dc</span>, <span style="color:#ff0;font-weight:bold">0x76f988da</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff0;font-weight:bold">0x983e5152</span>, <span style="color:#ff0;font-weight:bold">0xa831c66d</span>, <span style="color:#ff0;font-weight:bold">0xb00327c8</span>, <span style="color:#ff0;font-weight:bold">0xbf597fc7</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff0;font-weight:bold">0xc6e00bf3</span>, <span style="color:#ff0;font-weight:bold">0xd5a79147</span>, <span style="color:#ff0;font-weight:bold">0x06ca6351</span>, <span style="color:#ff0;font-weight:bold">0x14292967</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff0;font-weight:bold">0x27b70a85</span>, <span style="color:#ff0;font-weight:bold">0x2e1b2138</span>, <span style="color:#ff0;font-weight:bold">0x4d2c6dfc</span>, <span style="color:#ff0;font-weight:bold">0x53380d13</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff0;font-weight:bold">0x650a7354</span>, <span style="color:#ff0;font-weight:bold">0x766a0abb</span>, <span style="color:#ff0;font-weight:bold">0x81c2c92e</span>, <span style="color:#ff0;font-weight:bold">0x92722c85</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff0;font-weight:bold">0xa2bfe8a1</span>, <span style="color:#ff0;font-weight:bold">0xa81a664b</span>, <span style="color:#ff0;font-weight:bold">0xc24b8b70</span>, <span style="color:#ff0;font-weight:bold">0xc76c51a3</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff0;font-weight:bold">0xd192e819</span>, <span style="color:#ff0;font-weight:bold">0xd6990624</span>, <span style="color:#ff0;font-weight:bold">0xf40e3585</span>, <span style="color:#ff0;font-weight:bold">0x106aa070</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff0;font-weight:bold">0x19a4c116</span>, <span style="color:#ff0;font-weight:bold">0x1e376c08</span>, <span style="color:#ff0;font-weight:bold">0x2748774c</span>, <span style="color:#ff0;font-weight:bold">0x34b0bcb5</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff0;font-weight:bold">0x391c0cb3</span>, <span style="color:#ff0;font-weight:bold">0x4ed8aa4a</span>, <span style="color:#ff0;font-weight:bold">0x5b9cca4f</span>, <span style="color:#ff0;font-weight:bold">0x682e6ff3</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff0;font-weight:bold">0x748f82ee</span>, <span style="color:#ff0;font-weight:bold">0x78a5636f</span>, <span style="color:#ff0;font-weight:bold">0x84c87814</span>, <span style="color:#ff0;font-weight:bold">0x8cc70208</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff0;font-weight:bold">0x90befffa</span>, <span style="color:#ff0;font-weight:bold">0xa4506ceb</span>, <span style="color:#ff0;font-weight:bold">0xbef9a3f7</span>, <span style="color:#ff0;font-weight:bold">0xc67178f2</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>_h = [<span style="color:#ff0;font-weight:bold">0x6a09e667</span>, <span style="color:#ff0;font-weight:bold">0xbb67ae85</span>, <span style="color:#ff0;font-weight:bold">0x3c6ef372</span>, <span style="color:#ff0;font-weight:bold">0xa54ff53a</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff0;font-weight:bold">0x510e527f</span>, <span style="color:#ff0;font-weight:bold">0x9b05688c</span>, <span style="color:#ff0;font-weight:bold">0x1f83d9ab</span>, <span style="color:#ff0;font-weight:bold">0x5be0cd19</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> _pad(msglen):
</span></span><span style="display:flex;"><span>    mdi = msglen &amp; <span style="color:#ff0;font-weight:bold">0x3F</span>
</span></span><span style="display:flex;"><span>    length = struct.pack(<span style="color:#0ff;font-weight:bold">&#39;!Q&#39;</span>, msglen &lt;&lt; <span style="color:#ff0;font-weight:bold">3</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> mdi &lt; <span style="color:#ff0;font-weight:bold">56</span>:
</span></span><span style="display:flex;"><span>        padlen = <span style="color:#ff0;font-weight:bold">55</span> - mdi
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">else</span>:
</span></span><span style="display:flex;"><span>        padlen = <span style="color:#ff0;font-weight:bold">119</span> - mdi
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#39;</span><span style="color:#0ff;font-weight:bold">\x80</span><span style="color:#0ff;font-weight:bold">&#39;</span> + (<span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#39;</span><span style="color:#0ff;font-weight:bold">\x00</span><span style="color:#0ff;font-weight:bold">&#39;</span> * padlen) + length
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> _rotr(x, y):
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> ((x &gt;&gt; y) | (x &lt;&lt; (<span style="color:#ff0;font-weight:bold">32</span> - y))) &amp; F32
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> _maj(x, y, z):
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> (x &amp; y) ^ (x &amp; z) ^ (y &amp; z)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> _ch(x, y, z):
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> (x &amp; y) ^ ((~x) &amp; z)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">class</span> SHA256:
</span></span><span style="display:flex;"><span>    _output_size = <span style="color:#ff0;font-weight:bold">8</span>
</span></span><span style="display:flex;"><span>    blocksize = <span style="color:#ff0;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>    block_size = <span style="color:#ff0;font-weight:bold">64</span>
</span></span><span style="display:flex;"><span>    digest_size = <span style="color:#ff0;font-weight:bold">32</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> __init__(self, m=<span style="color:#fff;font-weight:bold">None</span>):
</span></span><span style="display:flex;"><span>        self._counter = <span style="color:#ff0;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>        self._cache = <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>        self._k = copy.deepcopy(_k)
</span></span><span style="display:flex;"><span>        self._h = copy.deepcopy(_h)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self.update(m)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> _compress(self, c):
</span></span><span style="display:flex;"><span>        w = [<span style="color:#ff0;font-weight:bold">0</span>] * <span style="color:#ff0;font-weight:bold">64</span>
</span></span><span style="display:flex;"><span>        w[<span style="color:#ff0;font-weight:bold">0</span>:<span style="color:#ff0;font-weight:bold">16</span>] = struct.unpack(<span style="color:#0ff;font-weight:bold">&#39;!16L&#39;</span>, c)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span> i in <span style="color:#fff;font-weight:bold">range</span>(<span style="color:#ff0;font-weight:bold">16</span>, <span style="color:#ff0;font-weight:bold">64</span>):
</span></span><span style="display:flex;"><span>            s0 = _rotr(w[i-<span style="color:#ff0;font-weight:bold">15</span>], <span style="color:#ff0;font-weight:bold">7</span>) ^ _rotr(w[i-<span style="color:#ff0;font-weight:bold">15</span>], <span style="color:#ff0;font-weight:bold">18</span>) ^ (w[i-<span style="color:#ff0;font-weight:bold">15</span>] &gt;&gt; <span style="color:#ff0;font-weight:bold">3</span>)
</span></span><span style="display:flex;"><span>            s1 = _rotr(w[i-<span style="color:#ff0;font-weight:bold">2</span>], <span style="color:#ff0;font-weight:bold">17</span>) ^ _rotr(w[i-<span style="color:#ff0;font-weight:bold">2</span>], <span style="color:#ff0;font-weight:bold">19</span>) ^ (w[i-<span style="color:#ff0;font-weight:bold">2</span>] &gt;&gt; <span style="color:#ff0;font-weight:bold">10</span>)
</span></span><span style="display:flex;"><span>            w[i] = (w[i-<span style="color:#ff0;font-weight:bold">16</span>] + s0 + w[i-<span style="color:#ff0;font-weight:bold">7</span>] + s1) &amp; F32
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        a, b, c, d, e, f, g, h = self._h
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span> i in <span style="color:#fff;font-weight:bold">range</span>(<span style="color:#ff0;font-weight:bold">64</span>):
</span></span><span style="display:flex;"><span>            s0 = _rotr(a, <span style="color:#ff0;font-weight:bold">2</span>) ^ _rotr(a, <span style="color:#ff0;font-weight:bold">13</span>) ^ _rotr(a, <span style="color:#ff0;font-weight:bold">22</span>)
</span></span><span style="display:flex;"><span>            t2 = s0 + _maj(a, b, c)
</span></span><span style="display:flex;"><span>            s1 = _rotr(e, <span style="color:#ff0;font-weight:bold">6</span>) ^ _rotr(e, <span style="color:#ff0;font-weight:bold">11</span>) ^ _rotr(e, <span style="color:#ff0;font-weight:bold">25</span>)
</span></span><span style="display:flex;"><span>            t1 = h + s1 + _ch(e, f, g) + self._k[i] + w[i]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            h = g
</span></span><span style="display:flex;"><span>            g = f
</span></span><span style="display:flex;"><span>            f = e
</span></span><span style="display:flex;"><span>            e = (d + t1) &amp; F32
</span></span><span style="display:flex;"><span>            d = c
</span></span><span style="display:flex;"><span>            c = b
</span></span><span style="display:flex;"><span>            b = a
</span></span><span style="display:flex;"><span>            a = (t1 + t2) &amp; F32
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span> i, (x, y) in <span style="color:#fff;font-weight:bold">enumerate</span>(<span style="color:#fff;font-weight:bold">zip</span>(self._h, [a, b, c, d, e, f, g, h])):
</span></span><span style="display:flex;"><span>            self._h[i] = (x + y) &amp; F32
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> update(self, m):
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> not m:
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self._counter += <span style="color:#fff;font-weight:bold">len</span>(m)
</span></span><span style="display:flex;"><span>        m = self._cache + m
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span> i in <span style="color:#fff;font-weight:bold">range</span>(<span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#fff;font-weight:bold">len</span>(m) // <span style="color:#ff0;font-weight:bold">64</span>):
</span></span><span style="display:flex;"><span>            self._compress(m[<span style="color:#ff0;font-weight:bold">64</span> * i:<span style="color:#ff0;font-weight:bold">64</span> * (i + <span style="color:#ff0;font-weight:bold">1</span>)])
</span></span><span style="display:flex;"><span>        self._cache = m[-(<span style="color:#fff;font-weight:bold">len</span>(m) % <span style="color:#ff0;font-weight:bold">64</span>):]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> digest(self):
</span></span><span style="display:flex;"><span>        r = copy.deepcopy(self)
</span></span><span style="display:flex;"><span>        r.update(_pad(self._counter))
</span></span><span style="display:flex;"><span>        data = [struct.pack(<span style="color:#0ff;font-weight:bold">&#39;!L&#39;</span>, i) <span style="color:#fff;font-weight:bold">for</span> i in r._h[:self._output_size]]
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#39;&#39;</span>.join(data)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> hexdigest(self):
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> binascii.hexlify(self.digest()).decode(<span style="color:#0ff;font-weight:bold">&#39;ascii&#39;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> true_sha256(message):
</span></span><span style="display:flex;"><span>    m = hashlib.sha256()
</span></span><span style="display:flex;"><span>    m.update(message)
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> m.hexdigest()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> my_sha256(message):
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> SHA256(message).hexdigest()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">if</span> __name__==<span style="color:#0ff;font-weight:bold">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    demo = [<span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;&#34;</span>, <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;a&#34;</span>, <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;abc&#34;</span>, <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;message digest&#34;</span>, <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;abcdefghijklmnopqrstuvwxyz&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#0ff;font-weight:bold">b</span><span style="color:#0ff;font-weight:bold">&#34;12345678901234567890123456789012345678901234567890123456789012345678901234567890&#34;</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">for</span> message in demo:
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">print</span>(my_sha256(message),<span style="color:#0ff;font-weight:bold">&#39; &lt;= &#34;&#39;</span>,message.decode(<span style="color:#0ff;font-weight:bold">&#39;ascii&#39;</span>),<span style="color:#0ff;font-weight:bold">&#39;&#34;&#39;</span>, sep=<span style="color:#0ff;font-weight:bold">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> true_sha256(message)==my_sha256(message)  <span style="color:#007f7f"># è‹¥å’Œæ ‡å‡†åº“ä¸­ä¸åŒï¼Œä¼šæŠ›å‡ºå¼‚å¸¸</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#39;</span><span style="color:#0ff;font-weight:bold">\n</span><span style="color:#0ff;font-weight:bold">SHA256æµ‹è¯•å…¨éƒ¨é€šè¿‡&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855 &lt;= &#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ca978112ca1bbdcafac231b39a23dc4da786eff8147c4e72b9807785afee48bb &lt;= &#34;a&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ba7816bf8f01cfea414140de5dae2223b00361a396177a9cb410ff61f20015ad &lt;= &#34;abc&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># f7846f55cf23e14eebeab5b4e1550cad5b509e3348fbc4efa3a1413d393cb650 &lt;= &#34;message digest&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 71c480df93d6ae2f1efad1447c66c9525e316218cf51fc8d9ed832f2daf18b73 &lt;= &#34;abcdefghijklmnopqrstuvwxyz&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># db4bfcbd4da0cd85a60c3c37d3fbd8805c77f15fc6b1fdfe614ee0a7c8fdb4c0 &lt;= &#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># f371bc4a311f2b009eef952dd83ca80e2b60026c8e935592d0f9c308453c813e &lt;= &#34;12345678901234567890123456789012345678901234567890123456789012345678901234567890&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># SHA256æµ‹è¯•å…¨éƒ¨é€šè¿‡</span>
</span></span></code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://blog.niuhemoon.win/tags/python/">Python</a></li>
      <li><a href="https://blog.niuhemoon.win/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/">å¯†ç å­¦</a></li>
    </ul>
<div class="footer-comments">
  <p>For comments, please   <a href="mailto:carlton2tang@gmail.com" class="email-button" style="font-size: inherit; padding: 5px 10px; background-color: #3f6b9a; color: white; text-decoration: none; border-radius: 3px; transition: background-color 0.3s;">
    send an email
</a> to me</p>

</div>
<nav class="paginav">
  <a class="prev" href="https://blog.niuhemoon.win/posts/tech/python-symmetric-encryption/">
    <span class="title">Â« ä¸Šä¸€é¡µ</span>
    <br>
    <span>Pythonå¯¹ç§°AESå’ŒDESåŠ å¯†ç®—æ³•</span>
  </a>
  <a class="next" href="https://blog.niuhemoon.win/posts/tech/zhihu-daily-crawler/">
    <span class="title">ä¸‹ä¸€é¡µ Â»</span>
    <br>
    <span>åœ¨Linuxç»ˆç«¯é‡Œæµè§ˆçŸ¥ä¹æ—¥æŠ¥</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
      
    <span>&copy; 2024 <a href="https://blog.niuhemoon.win">Niuhe&#39;s Blog</a></span>
    <span xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/">
        Licensed under
        <a
          href="http://creativecommons.org/licenses/by-nc-sa/4.0/?ref=chooser-v1"
          target="_blank"
          rel="license noopener noreferrer"
          style="display:inline-block;"
          >CC BY-NC-SA 4.0 </a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'ğŸ“„å¤åˆ¶';

        function copyingDone() {
            copybutton.innerHTML = 'ğŸ‘ŒğŸ»å·²å¤åˆ¶!';
            setTimeout(() => {
                copybutton.innerHTML = 'ğŸ“„å¤åˆ¶';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
