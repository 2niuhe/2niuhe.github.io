<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Pythonå®ç°RSAå’ŒECC | Niuhe&#39;s Blog</title>
<meta name="keywords" content="Python, å¯†ç å­¦">
<meta name="description" content="Python3å®ç°RSAå’ŒECCéå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚ å…¬é’¥å¯†ç ç®—æ³•çš„ç¼–å†™ æœ¬å®éªŒæ˜¯ä½¿ç”¨pythonæ¥å®ç°RSAå’ŒECCå…¬é’¥åŠ å¯†ç®—æ³•ï¼Œå¹¶å¯¹åŠ å¯†è§£å¯†è¿‡ç¨‹">
<meta name="author" content="Niuhe">
<link rel="canonical" href="https://blog.niuhemoon.win/posts/tech/python-asymmetric-encryption/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css" integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>


<link rel="icon" href="https://blog.niuhemoon.win/base/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://blog.niuhemoon.win/base/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="https://blog.niuhemoon.win/base/favicon.ico">
<link rel="apple-touch-icon" href="https://blog.niuhemoon.win/base/avatar.jpeg">
<link rel="mask-icon" href="https://blog.niuhemoon.win/base/avatar.jpeg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-116933089-1', 'auto');
	
	ga('send', 'pageview');
}
</script><meta property="og:title" content="Pythonå®ç°RSAå’ŒECC" />
<meta property="og:description" content="Python3å®ç°RSAå’ŒECCéå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚ å…¬é’¥å¯†ç ç®—æ³•çš„ç¼–å†™ æœ¬å®éªŒæ˜¯ä½¿ç”¨pythonæ¥å®ç°RSAå’ŒECCå…¬é’¥åŠ å¯†ç®—æ³•ï¼Œå¹¶å¯¹åŠ å¯†è§£å¯†è¿‡ç¨‹" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.niuhemoon.win/posts/tech/python-asymmetric-encryption/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-18T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-05-18T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Pythonå®ç°RSAå’ŒECC"/>
<meta name="twitter:description" content="Python3å®ç°RSAå’ŒECCéå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚ å…¬é’¥å¯†ç ç®—æ³•çš„ç¼–å†™ æœ¬å®éªŒæ˜¯ä½¿ç”¨pythonæ¥å®ç°RSAå’ŒECCå…¬é’¥åŠ å¯†ç®—æ³•ï¼Œå¹¶å¯¹åŠ å¯†è§£å¯†è¿‡ç¨‹"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ğŸ“šæ–‡ç« ",
      "item": "https://blog.niuhemoon.win/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "ğŸ‘¨ğŸ»â€ğŸ’» æŠ€æœ¯",
      "item": "https://blog.niuhemoon.win/posts/tech/"
    }, 
    {
      "@type": "ListItem",
      "position":  4 ,
      "name": "Pythonå®ç°RSAå’ŒECC",
      "item": "https://blog.niuhemoon.win/posts/tech/python-asymmetric-encryption/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Pythonå®ç°RSAå’ŒECC",
  "name": "Pythonå®ç°RSAå’ŒECC",
  "description": "Python3å®ç°RSAå’ŒECCéå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚ å…¬é’¥å¯†ç ç®—æ³•çš„ç¼–å†™ æœ¬å®éªŒæ˜¯ä½¿ç”¨pythonæ¥å®ç°RSAå’ŒECCå…¬é’¥åŠ å¯†ç®—æ³•ï¼Œå¹¶å¯¹åŠ å¯†è§£å¯†è¿‡ç¨‹",
  "keywords": [
    "Python", "å¯†ç å­¦"
  ],
  "articleBody": "Python3å®ç°RSAå’ŒECCéå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚\nå…¬é’¥å¯†ç ç®—æ³•çš„ç¼–å†™ æœ¬å®éªŒæ˜¯ä½¿ç”¨pythonæ¥å®ç°RSAå’ŒECCå…¬é’¥åŠ å¯†ç®—æ³•ï¼Œå¹¶å¯¹åŠ å¯†è§£å¯†è¿‡ç¨‹çš„æ­£ç¡®æ€§è¿›è¡ŒéªŒè¯ã€‚ æœ€åï¼Œå’Œä¸Šä¸€èŠ‚çš„å¯¹ç§°åŠ å¯†ç®—æ³•è¿›è¡Œæ¯”è¾ƒã€‚\n1.å®éªŒç›®çš„ æŒæ¡éå¯¹ç§°åŠ å¯†ä½“åˆ¶åŸç† æŒæ¡RSAã€ECCå…¬é’¥ç®—æ³•çš„å®ç°æ–¹æ³•ï¼Œèƒ½å¯¹å…¶å®‰å…¨æ€§è¿›è¡Œåˆ†æ äº†è§£å…¬é’¥å¯†ç ä½“åˆ¶çš„åº”ç”¨ 2.å®éªŒå·¥å…· Jupyter Notebook Python3.5 3.å®éªŒç¯å¢ƒ Ubuntu16.04LTSæ“ä½œç³»ç»Ÿ Python3æ ‡å‡†åº“ 4.å®éªŒæ­¥éª¤ 4.1 å›é¡¾è¯¾ç¨‹ï¼ŒæŸ¥é˜…èµ„æ–™ 4.2 éå¯¹ç§°åŠ å¯†ä¸å¯¹ç§°åŠ å¯†æ¯”è¾ƒ Aå’ŒCè¦ä¼ è¾“æ•°æ®ï¼Œä½†æ•°æ®éœ€è¦ç»è¿‡B\nåŠ å¯†è¦è§£å†³ä¸¤ä¸ªåŸºæœ¬é—®é¢˜\nB èƒ½çœ‹åˆ° A å‘ç»™ C çš„å†…å®¹ã€‚ B å¯ä»¥ä¼ªé€  A å‘ç»™ C çš„å†…å®¹ã€‚ å¯¹ç§°åŠ å¯†è™½ç„¶è§£å†³äº†å‰é¢çš„ä¸¤ä¸ªé—®é¢˜ï¼Œå´å¸¦æ¥æ–°é—®é¢˜ï¼š\nåŠ è§£å¯†ç®—æ³•å¾—ä»¥å®ç°ï¼Œä¾èµ–äº A ä¸ C çš„å•ç‹¬åå•†ï¼Œè¿™ä¸å‰é¢è¯´çš„ A ä¸ C é€šä¿¡å¿…é¡»ç»è¿‡ B çš„å‰æçŸ›ç›¾ã€‚å³ä½¿è¿™ç§å•ç‹¬åå•†å¶å°”å¯ä»¥å®ç°ï¼Œå®ƒçš„æœºä¼šä¹Ÿå¿…å®šååˆ†ç¨€ç¼ºã€‚å¦‚æœéœ€è¦ä¸ C é€šä¿¡çš„ä¸æ­¢ä¸€ä¸ª Aï¼Œè€Œæ˜¯ A0ã€A1â€¦â€¦Anï¼Œæ¯ä¸ª Ai éƒ½è¦é¿å¼€å…¶å®ƒæ‰€æœ‰èŠ‚ç‚¹ä¸ C å•ç‹¬åå•†ï¼Œè¿™æ˜¯ä¸ç°å®çš„ã€‚ å¦‚æœè®©è¿™äº› A0ã€A1â€¦â€¦Anéƒ½ä½¿ç”¨åŒæ ·çš„ç®—æ³•å‘¢ï¼Ÿæ˜¾ç„¶ï¼Œæ¯ä¸ª Ai éƒ½ä¼šçŸ¥é“å®ƒä¸è¯¥çŸ¥é“çš„ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥å†’å……å…¶å®ƒ Ai å‘é€ä¿¡æ¯ã€‚\næ‰€ä»¥ï¼Œæ¯ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´è¦æœ‰ä¸€å¥—ä¸“ç”¨çš„åŠ è§£å¯†ç®—æ³•ï¼Œå¦‚æœä¸€ä¸ªç½‘ç»œä¸Šæœ‰ N ä¸ªèŠ‚ç‚¹ï¼Œä¸€å…±è¦æœ‰ N *ï¼ˆNï¼1ï¼‰ï¼2 å¥—ç®—æ³•ã€‚å¯¹äºåŠ¨è¾„æˆåƒä¸Šä¸‡ä¸ªèŠ‚ç‚¹çš„ç½‘ç»œï¼Œè¿™ä¸ªæ•°å­—å¤ªå¤§äº†ã€‚\näººä»¬å‘ç°ï¼Œå‰è¿°é—®é¢˜çš„ç—‡ç»“åœ¨äºå¯¹ç§°ã€‚\nå¦‚æœåŠ å¯†ç®—æ³•å’Œè§£å¯†ç®—æ³•æ— æ³•äº’ç›¸æ¨å¯¼ï¼Œäº‹æƒ…å°±å¥½åŠäº†ï¼š\næ‰€æœ‰å‘ç»™ C çš„ä¿¡æ¯éƒ½ç”¨åŒæ ·çš„åŠ å¯†ç®—æ³•ï¼Œè€Œåªæœ‰ C è‡ªå·±æ‰èƒ½è§£å¯†ã€‚Ai è™½ç„¶æ‡‚å¾—åŠ å¯†ï¼Œä½†å¹¶ä¸èƒ½ä»åŠ å¯†ç®—æ³•æ¨å¯¼å‡ºè§£å¯†ç®—æ³•æ¥ã€‚å› æ­¤ä¸€ä¸ª Ai å‘ç»™ C çš„ä¿¡æ¯ä¸ä¼šæ³„éœ²ç»™å…¶å®ƒ Aiï¼Œå°±è¿åŠ å¯†è€…è‡ªå·±ä¹Ÿä¸ä¼šè§£å¯†ã€‚ ç°åœ¨ï¼Œå¯¹äºæ¯ä¸ªèŠ‚ç‚¹ï¼Œåªè¦åˆ¶ä½œä¸€å¥—åŠ è§£å¯†ç®—æ³•ï¼Œè§£å¯†ç®—æ³•è‡ªå·±ç•™ç€ï¼Œå°†åŠ å¯†ç®—æ³•å…¬å¸ƒå‡ºå»ï¼šè°æƒ³å‘æ¶ˆæ¯ç»™æˆ‘å°±ç”¨è¿™ä¸ªæ–¹æ³•åŠ å¯†ï¼ŒåŠ å¯†ä¹‹ååªæœ‰æˆ‘èƒ½è§£å¯†ï¼Œåˆ«äººè°ä¹Ÿè§£ä¸å‡ºæ¥ã€‚åŠ å¯†ç®—æ³•æ˜¯å…¬å¼€çš„ï¼Œå¤§å®¶éƒ½çŸ¥é“ï¼Œä¸éœ€è¦ä¸æ¯ä¸ªèŠ‚ç‚¹å•ç‹¬åå•†äº†ã€‚\n4.3.RSAç®—æ³•ä»‹ç» RSA ç®—æ³•çš„å®è´¨æ˜¯ä¸‰ä¸ªè‡ªç„¶æ•°ï¼Œä¸€èˆ¬è®°ä½œ n, d, eã€‚n å’Œ d æ„æˆä¸€ä¸ªå¯†é’¥ï¼Œn å’Œ e æ„æˆå¦ä¸€ä¸ªå¯†é’¥ã€‚ å¯¹äºï¼ˆn, dï¼‰ä¸ï¼ˆn, eï¼‰è¿™ä¸¤ä¸ªå¯†é’¥ï¼Œæ— è®ºç”¨å“ªä¸ªå¯†é’¥åŠ å¯†å‡ºæ¥çš„å¯†æ–‡éƒ½å¯ä»¥ç”¨å¦ä¸€ä¸ªå¯†é’¥è§£å¼€ï¼Œ æ‰€ä»¥ä¸å¿…å¼ºè°ƒå“ªä¸ªç”¨äºåŠ å¯†ï¼Œå“ªä¸ªç”¨äºè§£å¯†ï¼Œåªè¦æŠŠä¸€ä¸ªå…¬å¸ƒå‡ºå»ï¼ˆç§°ä¸ºå…¬é’¥ï¼‰ï¼Œå¦ä¸€ä¸ªè‡ªå·±è—ç€ï¼ˆç§°ä¸ºç§é’¥ï¼‰å°±è¡Œäº†ã€‚\n4.3.1 ç”Ÿæˆå…¬é’¥å’Œç§é’¥ å‡è®¾Aliceæƒ³è¦é€šè¿‡ä¸€ä¸ªä¸å¯é çš„åª’ä½“æ¥æ”¶Bobçš„ä¸€æ¡ç§äººæ¶ˆæ¯ã€‚å¥¹å¯ä»¥ç”¨ä»¥ä¸‹çš„æ–¹å¼æ¥äº§ç”Ÿä¸€ä¸ªå…¬é’¥å’Œä¸€ä¸ªç§é’¥ï¼š\néšæ„é€‰æ‹©ä¸¤ä¸ªå¤§çš„è´¨æ•°\\(p\\)å’Œ\\(q\\)ï¼Œ\\(p\\)ä¸ç­‰äº\\(q\\)ï¼Œè®¡ç®—\\(N=pq\\)ã€‚ æ ¹æ®æ¬§æ‹‰å‡½æ•°ï¼Œæ±‚å¾—\\({\\displaystyle r=\\varphi (N)=\\varphi (p)\\varphi (q)=(p-1)(q-1)}\\) é€‰æ‹©ä¸€ä¸ªå°äº \\({\\displaystyle r}\\) çš„æ•´æ•°\\({\\displaystyle e}\\)ï¼Œä½¿ \\({\\displaystyle e}ä¸{\\displaystyle r}\\) äº’è´¨ã€‚å¹¶æ±‚å¾— \\({\\displaystyle e}å…³äº{\\displaystyle r}\\)çš„æ¨¡åå…ƒç´ ï¼Œå‘½åä¸º\\({\\displaystyle d}ï¼ˆæ±‚{\\displaystyle d}ä»¤{\\displaystyle ed\\equiv 1{\\pmod {r}}}\\)ï¼‰ã€‚\nï¼ˆæ¨¡åå…ƒç´ å­˜åœ¨ï¼Œå½“ä¸”ä»…å½“\\({\\displaystyle e}ä¸{\\displaystyle r}\\)äº’è´¨ï¼‰ å°† \\({\\displaystyle p}å’Œ {\\displaystyle q}\\)çš„è®°å½•é”€æ¯ã€‚ \\({\\displaystyle (N,e)}æ˜¯å…¬é’¥ï¼Œ {\\displaystyle (N,d)}æ˜¯ç§é’¥ã€‚Aliceå°†å¥¹çš„å…¬é’¥ {\\displaystyle (N,e)}ä¼ ç»™Bobï¼Œè€Œå°†å¥¹çš„ç§é’¥ {\\displaystyle (N,d)}\\)è—èµ·æ¥ã€‚\n4.3.2 åŠ å¯†æ¶ˆæ¯ å‡è®¾Bobæƒ³ç»™Aliceé€ä¸€ä¸ªæ¶ˆæ¯ \\({\\displaystyle m}ï¼Œä»–çŸ¥é“Aliceäº§ç”Ÿçš„ {\\displaystyle N}å’Œ {\\displaystyle e}ã€‚ä»–ä½¿ç”¨èµ·å…ˆä¸Aliceçº¦å¥½çš„æ ¼å¼å°† {\\displaystyle m}è½¬æ¢ä¸ºä¸€ä¸ªå°äº {\\displaystyle N}çš„éè´Ÿæ•´æ•° {\\displaystyle n}ï¼Œæ¯”å¦‚ä»–å¯ä»¥å°†æ¯ä¸€ä¸ªå­—è½¬æ¢ä¸ºè¿™ä¸ªå­—çš„Unicodeç ï¼Œç„¶åå°†è¿™äº›æ•°å­—è¿åœ¨ä¸€èµ·ç»„æˆä¸€ä¸ªæ•°å­—ã€‚å‡å¦‚ä»–çš„ä¿¡æ¯éå¸¸é•¿çš„è¯ï¼Œä»–å¯ä»¥å°†è¿™ä¸ªä¿¡æ¯åˆ†ä¸ºå‡ æ®µï¼Œç„¶åå°†æ¯ä¸€æ®µè½¬æ¢ä¸º {\\displaystyle n}ã€‚ç”¨ä¸‹é¢è¿™ä¸ªå…¬å¼ä»–å¯ä»¥å°† {\\displaystyle n}åŠ å¯†ä¸º {\\displaystyle c}\\)ï¼š\n\\({\\displaystyle c\\equiv n^{e}{\\pmod {N}}} è®¡ç®— {\\displaystyle c}å¹¶ä¸å¤æ‚ã€‚Bobç®—å‡º {\\displaystyle c}\\)åå°±å¯ä»¥å°†å®ƒä¼ é€’ç»™Aliceã€‚\n4.3.3 è§£å¯†æ¶ˆæ¯ 4.3.4 ç­¾åæ¶ˆæ¯ RSAä¹Ÿå¯ä»¥ç”¨æ¥ä¸ºä¸€ä¸ªæ¶ˆæ¯ç½²åã€‚å‡å¦‚Aliceæƒ³ç»™Bobä¼ é€’ä¸€ä¸ªç½²åçš„æ¶ˆæ¯çš„è¯ï¼Œé‚£ä¹ˆå¥¹å¯ä»¥ä¸ºå¥¹çš„æ¶ˆæ¯è®¡ç®—ä¸€ä¸ªæ•£åˆ—å€¼ï¼ˆMessage digestï¼‰ï¼Œç„¶åç”¨å¥¹çš„ç§é’¥â€œåŠ å¯†â€ï¼ˆå¦‚åŒå‰é¢â€œåŠ å¯†æ¶ˆæ¯â€çš„æ­¥éª¤ï¼‰è¿™ä¸ªæ•£åˆ—å€¼å¹¶å°†è¿™ä¸ªâ€œç½²åâ€åŠ åœ¨æ¶ˆæ¯çš„åé¢ã€‚è¿™ä¸ªæ¶ˆæ¯åªæœ‰ç”¨å¥¹çš„å…¬é’¥æ‰èƒ½è¢«è§£å¯†ã€‚Bobè·å¾—è¿™ä¸ªæ¶ˆæ¯åå¯ä»¥ç”¨Aliceçš„å…¬é’¥â€œè§£å¯†â€ï¼ˆå¦‚åŒå‰é¢â€œè§£å¯†æ¶ˆæ¯â€çš„æ­¥éª¤ï¼‰è¿™ä¸ªæ•£åˆ—å€¼ï¼Œç„¶åå°†è¿™ä¸ªæ•°æ®ä¸ä»–è‡ªå·±ä¸ºè¿™ä¸ªæ¶ˆæ¯è®¡ç®—çš„æ•£åˆ—å€¼ç›¸æ¯”è¾ƒã€‚å‡å¦‚ä¸¤è€…ç›¸ç¬¦çš„è¯ï¼Œé‚£ä¹ˆBobå°±å¯ä»¥çŸ¥é“å‘ä¿¡äººæŒæœ‰Aliceçš„ç§é’¥ï¼Œä»¥åŠè¿™ä¸ªæ¶ˆæ¯åœ¨ä¼ æ’­è·¯å¾„ä¸Šæ²¡æœ‰è¢«ç¯¡æ”¹è¿‡ã€‚\n4.4 ç¼–å†™RSAåŠ å¯†è§£å¯†çš„æµ‹è¯•ç”¨ä¾‹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 if __name__ == '__main__': # æµ‹è¯•å·²çŸ¥æ•°æ® public = PublicKey(n=2534665157, e=7) private = PrivateKey(n=2534665157, d=1810402843) assert public.encrypt(123) == 2463995467 assert public.encrypt(456) == 2022084991 assert public.encrypt(123456) == 1299565302 assert private.decrypt(2463995467) == 123 assert private.decrypt(2022084991) == 456 assert private.decrypt(1299565302) == 123456 # æµ‹è¯•éšæœºæ•°æ® for length in range(4, 17): public, private = make_key_pair(length) assert public.n == private.n assert len(bin(public.n)) - 2 == length x = random.randrange(public.n - 2) y = public.encrypt(x) assert private.decrypt(y) == x assert public.encrypt(public.n - 1) == public.n - 1 assert public.encrypt(public.n) == 0 assert private.decrypt(public.n - 1) == public.n - 1 assert private.decrypt(public.n) == 0 print('éªŒè¯å®Œæ¯•') 4.5 ECCç®—æ³•åŸç† æ¤­åœ†æ›²çº¿å¯†ç å­¦çš„è®¸å¤šå½¢å¼æœ‰ç¨å¾®çš„ä¸åŒï¼Œæ‰€æœ‰çš„éƒ½ä¾èµ–äºè¢«å¹¿æ³›æ‰¿è®¤çš„è§£å†³æ¤­åœ†æ›²çº¿ç¦»æ•£å¯¹æ•°é—®é¢˜çš„å›°éš¾æ€§ä¸Šï¼Œå¯¹åº”æœ‰é™åŸŸä¸Šæ¤­åœ†æ›²çº¿çš„ç¾¤ã€‚\nå¯¹äºECCç³»ç»Ÿæ¥è¯´ï¼Œå®Œæˆè¿è¡Œç³»ç»Ÿæ‰€å¿…é¡»çš„ç¾¤æ“ä½œæ¯”åŒæ ·å¤§å°çš„å› æ•°åˆ†è§£ç³»ç»Ÿæˆ–æ¨¡æ•´æ•°ç¦»æ•£å¯¹æ•°ç³»ç»Ÿè¦æ…¢ã€‚ä¸è¿‡ï¼ŒECCç³»ç»Ÿçš„æ‹¥æŠ¤è€…ç›¸ä¿¡ECDLPé—®é¢˜æ¯”DLPæˆ–å› æ•°åˆ†è§£é—®é¢˜è¦éš¾çš„å¤šï¼Œå¹¶ä¸”å› æ­¤ä½¿ç”¨ECCèƒ½ç”¨å°çš„å¤šçš„å¯†é’¥é•¿åº¦æ¥æä¾›åŒç­‰çš„å®‰å…¨ï¼Œåœ¨è¿™æ–¹é¢æ¥è¯´å®ƒç¡®å®æ¯”ä¾‹å¦‚RSAä¹‹ç±»çš„æ›´å¿«ã€‚åˆ°ç›®å‰ä¸ºæ­¢å·²ç»å…¬å¸ƒçš„ç»“æœè¶‹äºæ”¯æŒè¿™ä¸ªç»“è®ºï¼Œä¸è¿‡ä¸€äº›ä¸“å®¶è¡¨ç¤ºæ€€ç–‘ã€‚\n4.6 ç¼–å†™ECCç®—æ³•çš„æµ‹è¯•ä»£ç  4.7 ç¼–å†™RSAå’ŒECCå…¬é’¥åŠ å¯†çš„pythonå®ç°ï¼Œå¹¶è¿›è¡Œæµ‹è¯•éªŒè¯ ä»£ç å’Œæµ‹è¯•ç»“æœåœ¨æŠ¥å‘Šæœ€å\n4.8 æ€»ç»“å®éªŒï¼Œç¼–å†™å®éªŒæŠ¥å‘Š 5. å®éªŒæ€»ç»“ éœ€è¦å–„äºå€Ÿé‰´å‰äººç»éªŒï¼Œæœé›†èµ„æ–™ å®éªŒåªæ”¯æŒasciiç ï¼Œå¯¹å…¶ä»–å­—ç¬¦ç¼–ç æ²¡æœ‰è§£å†³ åˆ©ç”¨ä¼˜ç§€çš„å·¥å…·ï¼Œå¦‚Jupyterå¯ä»¥æé«˜å­¦ä¹ æ•ˆç‡ 6. å®éªŒå®Œæ•´ä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 \"\"\"RSAåŠ å¯†ç³»ç»Ÿçš„ç®€å•å®ç° æ¨¡å—å±•ç¤ºäº†ä¸€ç§ç®€å•æ¸…æ™°çš„RSAç®—æ³•çš„å®ç°ï¼Œå®ƒçš„ç›®çš„ä¸æ˜¯æ•ˆç‡ï¼Œè€Œæ˜¯ä¸ºäº†å¯è¯»æ€§ã€‚ The usage is simple. First, create a random key pair: \u003e\u003e\u003e public_key, private_key = make_key_pair(8) The number 8 is the _key length_. The higher this number, the stronger the encryption. The public key can be used to encrypt a message (in this module, a message is simply a positive integer number): \u003e\u003e\u003e message = 5 \u003e\u003e\u003e encrypted_message = public_key.encrypt(message) The encrypted information can be retrieved only with the private key: \u003e\u003e\u003e private_key.decrypt(encrypted_message) 5 Private and public keys are made of three numeric parameters: ``n``, ``d`` and ``e``. ``n`` has the bit length specified with ``make_key_pair`` and is shared between the two keys; ``e`` is used by the public key encrypt; ``d`` is used by the private key to decrypt. It's worth noting that ``n - 2`` is the highest number that can be safely encrypted or decrypted. For example, encrypting (or decrypting) the number ``n - 1`` does nothing, and encrypting (or decrypting) the number ``n`` always returns 0. \u003e\u003e\u003e key = PublicKey(n=143, e=113) \u003e\u003e\u003e key.encrypt(142) # n - 1 142 \u003e\u003e\u003e key.encrypt(143) # n 0 Also encrypting (or decrypting) 0 or 1 always returns 0 or 1: \u003e\u003e\u003e key.encrypt(0) 0 \u003e\u003e\u003e key.encrypt(1) 1 Note that sometimes the original and the encrypted messages are the same, as shown in the following example: \u003e\u003e\u003e for x in range(143): # n ... if key.encrypt(x) == x: ... print(x) 0 1 12 21 34 44 65 66 77 78 99 109 122 131 142 \"\"\" import random from collections import namedtuple def get_primes(start, stop): \"\"\"Return a list of prime numbers in ``range(start, stop)``.\"\"\" if start \u003e= stop: return [] primes = [2] for n in range(3, stop + 1, 2): for p in primes: if n % p == 0: break else: primes.append(n) while primes and primes[0] \u003c start: del primes[0] return primes def are_relatively_prime(a, b): \"\"\"Return ``True`` if ``a`` and ``b`` are two relatively prime numbers. Two numbers are relatively prime if they share no common factors, i.e. there is no integer (except 1) that divides both. \"\"\" for n in range(2, min(a, b) + 1): if a % n == b % n == 0: return False return True def make_key_pair(length): \"\"\"Create a public-private key pair. The key pair is generated from two random prime numbers. The argument ``length`` specifies the bit length of the number ``n`` shared between the two keys: the higher, the better. \"\"\" if length \u003c 4: raise ValueError('cannot generate a key of length less ' 'than 4 (got {!r})'.format(length)) # First step: find a number ``n`` which is the product of two prime # numbers (``p`` and ``q``). ``n`` must have the number of bits specified # by ``length``, therefore it must be in ``range(n_min, n_max + 1)``. n_min = 1 \u003c\u003c (length - 1) n_max = (1 \u003c\u003c length) - 1 # The key is stronger if ``p`` and ``q`` have similar bit length. We # choose two prime numbers in ``range(start, stop)`` so that the # difference of bit lengths is at most 2. start = 1 \u003c\u003c (length // 2 - 1) stop = 1 \u003c\u003c (length // 2 + 1) primes = get_primes(start, stop) # Now that we have a list of prime number candidates, randomly select # two so that their product is in ``range(n_min, n_max + 1)``. while primes: p = random.choice(primes) primes.remove(p) q_candidates = [q for q in primes if n_min \u003c= p * q \u003c= n_max] if q_candidates: q = random.choice(q_candidates) break else: raise AssertionError(\"cannot find 'p' and 'q' for a key of \" \"length={!r}\".format(length)) # Second step: choose a number ``e`` lower than ``(p - 1) * (q - 1)`` # which shares no factors with ``(p - 1) * (q - 1)``. stop = (p - 1) * (q - 1) for e in range(3, stop, 2): if are_relatively_prime(e, stop): break else: raise AssertionError(\"cannot find 'e' with p={!r} \" \"and q={!r}\".format(p, q)) # Third step: find ``d`` such that ``(d * e - 1)`` is divisible by # ``(p - 1) * (q - 1)``. for d in range(3, stop, 2): if d * e % stop == 1: break else: raise AssertionError(\"cannot find 'd' with p={!r}, q={!r} \" \"and e={!r}\".format(p, q, e)) # That's all. We can build and return the public and private keys. return PublicKey(p * q, e), PrivateKey(p * q, d) class PublicKey(namedtuple('PublicKey', 'n e')): \"\"\"Public key which can be used to encrypt data.\"\"\" __slots__ = () def encrypt(self, x): \"\"\"Encrypt the number ``x``. The result is a number which can be decrypted only using the private key. \"\"\" return pow(x, self.e, self.n) class PrivateKey(namedtuple('PrivateKey', 'n d')): \"\"\"Private key which can be used both to decrypt data.\"\"\" __slots__ = () def decrypt(self, x): \"\"\"Decrypt the number ``x``. The argument ``x`` must be the result of the ``encrypt`` method of the public key. \"\"\" return pow(x, self.d, self.n) if __name__ == '__main__': # Test with known results. public = PublicKey(n=2534665157, e=7) private = PrivateKey(n=2534665157, d=1810402843) assert public.encrypt(123) == 2463995467 assert public.encrypt(456) == 2022084991 assert public.encrypt(123456) == 1299565302 assert private.decrypt(2463995467) == 123 assert private.decrypt(2022084991) == 456 assert private.decrypt(1299565302) == 123456 # Test with random values. for length in range(4, 17): public, private = make_key_pair(length) assert public.n == private.n assert len(bin(public.n)) - 2 == length x = random.randrange(public.n - 2) y = public.encrypt(x) assert private.decrypt(y) == x assert public.encrypt(public.n - 1) == public.n - 1 assert public.encrypt(public.n) == 0 assert private.decrypt(public.n - 1) == public.n - 1 assert private.decrypt(public.n) == 0 print('éªŒè¯å®Œæ¯•') 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 # Basics of Elliptic Curve Cryptography implementation on Python import collections def inv(n, q): \"\"\"div on PN modulo a/b mod q as a * inv(b, q) mod q \u003e\u003e\u003e assert n * inv(n, q) % q == 1 \"\"\" # n*inv % q = 1 =\u003e n*inv = q*m + 1 =\u003e n*inv + q*-m = 1 # =\u003e egcd(n, q) = (inv, -m, 1) =\u003e inv = egcd(n, q)[0] (mod q) return egcd(n, q)[0] % q #[ref] naive implementation #for i in range(q): # if (n * i) % q == 1: # return i # pass #assert False, \"unreached\" #pass def egcd(a, b): \"\"\"extended GCD returns: (s, t, gcd) as a*s + b*t == gcd \u003e\u003e\u003e s, t, gcd = egcd(a, b) \u003e\u003e\u003e assert a % gcd == 0 and b % gcd == 0 \u003e\u003e\u003e assert a * s + b * t == gcd \"\"\" s0, s1, t0, t1 = 1, 0, 0, 1 while b \u003e 0: q, r = divmod(a, b) a, b = b, r s0, s1, t0, t1 = s1, s0 - q * s1, t1, t0 - q * t1 pass return s0, t0, a def sqrt(n, q): \"\"\"sqrt on PN modulo: returns two numbers or exception if not exist \u003e\u003e\u003e assert (sqrt(n, q)[0] ** 2) % q == n \u003e\u003e\u003e assert (sqrt(n, q)[1] ** 2) % q == n \"\"\" assert n \u003c q for i in range(1, q): if i * i % q == n: return (i, q - i) pass raise Exception(\"not found\") Coord = collections.namedtuple(\"Coord\", [\"x\", \"y\"]) class EC(object): \"\"\"System of Elliptic Curve\"\"\" def __init__(self, a, b, q): \"\"\"elliptic curve as: (y**2 = x**3 + a * x + b) mod q - a, b: params of curve formula - q: prime number \"\"\" assert 0 \u003c a and a \u003c q and 0 \u003c b and b \u003c q and q \u003e 2 assert (4 * (a ** 3) + 27 * (b ** 2)) % q != 0 self.a = a self.b = b self.q = q # just as unique ZERO value representation for \"add\": (not on curve) self.zero = Coord(0, 0) pass def is_valid(self, p): if p == self.zero: return True l = (p.y ** 2) % self.q r = ((p.x ** 3) + self.a * p.x + self.b) % self.q return l == r def at(self, x): \"\"\"find points on curve at x - x: int \u003c q - returns: ((x, y), (x,-y)) or not found exception \u003e\u003e\u003e a, ma = ec.at(x) \u003e\u003e\u003e assert a.x == ma.x and a.x == x \u003e\u003e\u003e assert a.x == ma.x and a.x == x \u003e\u003e\u003e assert ec.neg(a) == ma \u003e\u003e\u003e assert ec.is_valid(a) and ec.is_valid(ma) \"\"\" assert x \u003c self.q ysq = (x ** 3 + self.a * x + self.b) % self.q y, my = sqrt(ysq, self.q) return Coord(x, y), Coord(x, my) def neg(self, p): \"\"\"negate p \u003e\u003e\u003e assert ec.is_valid(ec.neg(p)) \"\"\" return Coord(p.x, -p.y % self.q) def add(self, p1, p2): \"\"\" of elliptic curve: negate of 3rd cross point of (p1,p2) line \u003e\u003e\u003e d = ec.add(a, b) \u003e\u003e\u003e assert ec.is_valid(d) \u003e\u003e\u003e assert ec.add(d, ec.neg(b)) == a \u003e\u003e\u003e assert ec.add(a, ec.neg(a)) == ec.zero \u003e\u003e\u003e assert ec.add(a, b) == ec.add(b, a) \u003e\u003e\u003e assert ec.add(a, ec.add(b, c)) == ec.add(ec.add(a, b), c) \"\"\" if p1 == self.zero: return p2 if p2 == self.zero: return p1 if p1.x == p2.x and (p1.y != p2.y or p1.y == 0): # p1 + -p1 == 0 return self.zero if p1.x == p2.x: # p1 + p1: use tangent line of p1 as (p1,p1) line l = (3 * p1.x * p1.x + self.a) * inv(2 * p1.y, self.q) % self.q pass else: l = (p2.y - p1.y) * inv(p2.x - p1.x, self.q) % self.q pass x = (l * l - p1.x - p2.x) % self.q y = (l * (p1.x - x) - p1.y) % self.q return Coord(x, y) def mul(self, p, n): \"\"\"n times of elliptic curve \u003e\u003e\u003e m = ec.mul(p, n) \u003e\u003e\u003e assert ec.is_valid(m) \u003e\u003e\u003e assert ec.mul(p, 0) == ec.zero \"\"\" r = self.zero m2 = p # O(log2(n)) add while 0 \u003c n: if n \u0026 1 == 1: r = self.add(r, m2) pass n, m2 = n \u003e\u003e 1, self.add(m2, m2) pass # [ref] O(n) add #for i in range(n): # r = self.add(r, p) # pass return r def order(self, g): \"\"\"order of point g \u003e\u003e\u003e o = ec.order(g) \u003e\u003e\u003e assert ec.is_valid(a) and ec.mul(a, o) == ec.zero \u003e\u003e\u003e assert o \u003c= ec.q \"\"\" assert self.is_valid(g) and g != self.zero for i in range(1, self.q + 1): if self.mul(g, i) == self.zero: return i pass raise Exception(\"Invalid order\") pass class ElGamal(object): \"\"\"ElGamal Encryption pub key encryption as replacing (mulmod, powmod) to (ec.add, ec.mul) - ec: elliptic curve - g: (random) a point on ec \"\"\" def __init__(self, ec, g): assert ec.is_valid(g) self.ec = ec self.g = g self.n = ec.order(g) pass def gen(self, priv): \"\"\"generate pub key - priv: priv key as (random) int \u003c ec.q - returns: pub key as points on ec \"\"\" return self.ec.mul(g, priv) def enc(self, plain, pub, r): \"\"\"encrypt - plain: data as a point on ec - pub: pub key as points on ec - r: randam int \u003c ec.q - returns: (cipher1, ciper2) as points on ec \"\"\" assert self.ec.is_valid(plain) assert self.ec.is_valid(pub) return (self.ec.mul(g, r), self.ec.add(plain, self.ec.mul(pub, r))) def dec(self, cipher, priv): \"\"\"decrypt - chiper: (chiper1, chiper2) as points on ec - priv: private key as int \u003c ec.q - returns: plain as a point on ec \"\"\" c1, c2 = cipher assert self.ec.is_valid(c1) and ec.is_valid(c2) return self.ec.add(c2, self.ec.neg(self.ec.mul(c1, priv))) pass class DiffieHellman(object): \"\"\"Elliptic Curve Diffie Hellman (Key Agreement) - ec: elliptic curve - g: a point on ec \"\"\" def __init__(self, ec, g): self.ec = ec self.g = g self.n = ec.order(g) pass def gen(self, priv): \"\"\"generate pub key\"\"\" assert 0 \u003c priv and priv \u003c self.n return self.ec.mul(self.g, priv) def secret(self, priv, pub): \"\"\"calc shared secret key for the pair - priv: my private key as int - pub: partner pub key as a point on ec - returns: shared secret as a point on ec \"\"\" assert self.ec.is_valid(pub) assert self.ec.mul(pub, self.n) == self.ec.zero return self.ec.mul(pub, priv) pass class DSA(object): \"\"\"ECDSA - ec: elliptic curve - g: a point on ec \"\"\" def __init__(self, ec, g): self.ec = ec self.g = g self.n = ec.order(g) pass def gen(self, priv): \"\"\"generate pub key\"\"\" assert 0 \u003c priv and priv \u003c self.n return self.ec.mul(self.g, priv) def sign(self, hashval, priv, r): \"\"\"generate signature - hashval: hash value of message as int - priv: priv key as int - r: random int - returns: signature as (int, int) \"\"\" assert 0 \u003c r and r \u003c self.n m = self.ec.mul(self.g, r) return (m.x, inv(r, self.n) * (hashval + m.x * priv) % self.n) def validate(self, hashval, sig, pub): \"\"\"validate signature - hashval: hash value of message as int - sig: signature as (int, int) - pub: pub key as a point on ec \"\"\" assert self.ec.is_valid(pub) assert self.ec.mul(pub, self.n) == self.ec.zero w = inv(sig[1], self.n) u1, u2 = hashval * w % self.n, sig[0] * w % self.n p = self.ec.add(self.ec.mul(self.g, u1), self.ec.mul(pub, u2)) return p.x % self.n == sig[0] pass if __name__ == \"__main__\": # shared elliptic curve system of examples ec = EC(1, 18, 19) g, _ = ec.at(7) assert ec.order(g) \u003c= ec.q # ElGamal enc/dec usage eg = ElGamal(ec, g) # mapping value to ec point # \"masking\": value k to point ec.mul(g, k) # (\"imbedding\" on proper n:use a point of x as 0 \u003c= n*v \u003c= x \u003c n*(v+1) \u003c q) mapping = [ec.mul(g, i) for i in range(eg.n)] plain = mapping[7] priv = 5 pub = eg.gen(priv) cipher = eg.enc(plain, pub, 15) decoded = eg.dec(cipher, priv) assert decoded == plain assert cipher != pub # ECDH usage dh = DiffieHellman(ec, g) apriv = 11 apub = dh.gen(apriv) bpriv = 3 bpub = dh.gen(bpriv) cpriv = 7 cpub = dh.gen(cpriv) # same secret on each pair assert dh.secret(apriv, bpub) == dh.secret(bpriv, apub) assert dh.secret(apriv, cpub) == dh.secret(cpriv, apub) assert dh.secret(bpriv, cpub) == dh.secret(cpriv, bpub) # not same secret on other pair assert dh.secret(apriv, cpub) != dh.secret(apriv, bpub) assert dh.secret(bpriv, apub) != dh.secret(bpriv, cpub) assert dh.secret(cpriv, bpub) != dh.secret(cpriv, apub) # ECDSA usage dsa = DSA(ec, g) priv = 11 pub = eg.gen(priv) hashval = 128 r = 7 print('å®Œæˆæµ‹è¯•') sig = dsa.sign(hashval, priv, r) assert dsa.validate(hashval, sig, pub) pass ",
  "wordCount" : "5379",
  "inLanguage": "en",
  "datePublished": "2022-05-18T00:00:00Z",
  "dateModified": "2022-05-18T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Niuhe"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://blog.niuhemoon.win/posts/tech/python-asymmetric-encryption/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Niuhe's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://blog.niuhemoon.win/base/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://blog.niuhemoon.win" accesskey="h" title="Niuhe&#39;s Blog (Alt + H)">
                <img src="https://blog.niuhemoon.win/base/avatar.jpeg" alt="" aria-label="logo"
                    height="35">Niuhe&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://blog.niuhemoon.win/search" title="ğŸ”æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>ğŸ”æœç´¢</span>
                </a>
            </li>
            <li>
                <a href="https://blog.niuhemoon.win/" title="ğŸ ä¸»é¡µ">
                    <span>ğŸ ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://blog.niuhemoon.win/posts" title="ğŸ“šæ–‡ç« ">
                    <span>ğŸ“šæ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="https://blog.niuhemoon.win/archives/" title="â±æ—¶é—´è½´">
                    <span>â±æ—¶é—´è½´</span>
                </a>
            </li>
            <li>
                <a href="https://blog.niuhemoon.win/tags" title="ğŸ”–æ ‡ç­¾">
                    <span>ğŸ”–æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://blog.niuhemoon.win/about" title="ğŸ™‹ğŸ»â€â™‚ï¸å…³äº">
                    <span>ğŸ™‹ğŸ»â€â™‚ï¸å…³äº</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://blog.niuhemoon.win">Home</a>&nbsp;Â»&nbsp;<a href="https://blog.niuhemoon.win/posts/">ğŸ“šæ–‡ç« </a>&nbsp;Â»&nbsp;<a href="https://blog.niuhemoon.win/posts/tech/">ğŸ‘¨ğŸ»â€ğŸ’» æŠ€æœ¯</a></div>
    <h1 class="post-title">
      Pythonå®ç°RSAå’ŒECC
    </h1>
    <div class="post-meta"><span title='2022-05-18 00:00:00 +0000 UTC'>2022-05-18</span>&nbsp;Â·&nbsp;11 min&nbsp;Â·&nbsp;Niuhe

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e5%85%ac%e9%92%a5%e5%af%86%e7%a0%81%e7%ae%97%e6%b3%95%e7%9a%84%e7%bc%96%e5%86%99" aria-label="å…¬é’¥å¯†ç ç®—æ³•çš„ç¼–å†™">å…¬é’¥å¯†ç ç®—æ³•çš„ç¼–å†™</a><ul>
                        
                <li>
                    <a href="#1%e5%ae%9e%e9%aa%8c%e7%9b%ae%e7%9a%84" aria-label="1.å®éªŒç›®çš„">1.å®éªŒç›®çš„</a></li>
                <li>
                    <a href="#2%e5%ae%9e%e9%aa%8c%e5%b7%a5%e5%85%b7" aria-label="2.å®éªŒå·¥å…·">2.å®éªŒå·¥å…·</a></li>
                <li>
                    <a href="#3%e5%ae%9e%e9%aa%8c%e7%8e%af%e5%a2%83" aria-label="3.å®éªŒç¯å¢ƒ">3.å®éªŒç¯å¢ƒ</a></li>
                <li>
                    <a href="#4%e5%ae%9e%e9%aa%8c%e6%ad%a5%e9%aa%a4" aria-label="4.å®éªŒæ­¥éª¤">4.å®éªŒæ­¥éª¤</a><ul>
                        
                <li>
                    <a href="#41-%e5%9b%9e%e9%a1%be%e8%af%be%e7%a8%8b%e6%9f%a5%e9%98%85%e8%b5%84%e6%96%99" aria-label="4.1 å›é¡¾è¯¾ç¨‹ï¼ŒæŸ¥é˜…èµ„æ–™">4.1 å›é¡¾è¯¾ç¨‹ï¼ŒæŸ¥é˜…èµ„æ–™</a></li>
                <li>
                    <a href="#42-%e9%9d%9e%e5%af%b9%e7%a7%b0%e5%8a%a0%e5%af%86%e4%b8%8e%e5%af%b9%e7%a7%b0%e5%8a%a0%e5%af%86%e6%af%94%e8%be%83" aria-label="4.2 éå¯¹ç§°åŠ å¯†ä¸å¯¹ç§°åŠ å¯†æ¯”è¾ƒ">4.2 éå¯¹ç§°åŠ å¯†ä¸å¯¹ç§°åŠ å¯†æ¯”è¾ƒ</a></li>
                <li>
                    <a href="#43rsa%e7%ae%97%e6%b3%95%e4%bb%8b%e7%bb%8d" aria-label="4.3.RSAç®—æ³•ä»‹ç»">4.3.RSAç®—æ³•ä»‹ç»</a><ul>
                        
                <li>
                    <a href="#431-%e7%94%9f%e6%88%90%e5%85%ac%e9%92%a5%e5%92%8c%e7%a7%81%e9%92%a5" aria-label="4.3.1 ç”Ÿæˆå…¬é’¥å’Œç§é’¥">4.3.1 ç”Ÿæˆå…¬é’¥å’Œç§é’¥</a></li>
                <li>
                    <a href="#432-%e5%8a%a0%e5%af%86%e6%b6%88%e6%81%af" aria-label="4.3.2 åŠ å¯†æ¶ˆæ¯">4.3.2 åŠ å¯†æ¶ˆæ¯</a></li>
                <li>
                    <a href="#433-%e8%a7%a3%e5%af%86%e6%b6%88%e6%81%af" aria-label="4.3.3 è§£å¯†æ¶ˆæ¯">4.3.3 è§£å¯†æ¶ˆæ¯</a></li>
                <li>
                    <a href="#434-%e7%ad%be%e5%90%8d%e6%b6%88%e6%81%af" aria-label="4.3.4 ç­¾åæ¶ˆæ¯">4.3.4 ç­¾åæ¶ˆæ¯</a></li></ul>
                </li>
                <li>
                    <a href="#44-%e7%bc%96%e5%86%99rsa%e5%8a%a0%e5%af%86%e8%a7%a3%e5%af%86%e7%9a%84%e6%b5%8b%e8%af%95%e7%94%a8%e4%be%8b" aria-label="4.4 ç¼–å†™RSAåŠ å¯†è§£å¯†çš„æµ‹è¯•ç”¨ä¾‹">4.4 ç¼–å†™RSAåŠ å¯†è§£å¯†çš„æµ‹è¯•ç”¨ä¾‹</a></li>
                <li>
                    <a href="#45-ecc%e7%ae%97%e6%b3%95%e5%8e%9f%e7%90%86" aria-label="4.5 ECCç®—æ³•åŸç†">4.5 ECCç®—æ³•åŸç†</a></li>
                <li>
                    <a href="#46-%e7%bc%96%e5%86%99ecc%e7%ae%97%e6%b3%95%e7%9a%84%e6%b5%8b%e8%af%95%e4%bb%a3%e7%a0%81" aria-label="4.6 ç¼–å†™ECCç®—æ³•çš„æµ‹è¯•ä»£ç ">4.6 ç¼–å†™ECCç®—æ³•çš„æµ‹è¯•ä»£ç </a></li>
                <li>
                    <a href="#47-%e7%bc%96%e5%86%99rsa%e5%92%8cecc%e5%85%ac%e9%92%a5%e5%8a%a0%e5%af%86%e7%9a%84python%e5%ae%9e%e7%8e%b0%e5%b9%b6%e8%bf%9b%e8%a1%8c%e6%b5%8b%e8%af%95%e9%aa%8c%e8%af%81" aria-label="4.7 ç¼–å†™RSAå’ŒECCå…¬é’¥åŠ å¯†çš„pythonå®ç°ï¼Œå¹¶è¿›è¡Œæµ‹è¯•éªŒè¯">4.7 ç¼–å†™RSAå’ŒECCå…¬é’¥åŠ å¯†çš„pythonå®ç°ï¼Œå¹¶è¿›è¡Œæµ‹è¯•éªŒè¯</a></li>
                <li>
                    <a href="#48-%e6%80%bb%e7%bb%93%e5%ae%9e%e9%aa%8c%e7%bc%96%e5%86%99%e5%ae%9e%e9%aa%8c%e6%8a%a5%e5%91%8a" aria-label="4.8 æ€»ç»“å®éªŒï¼Œç¼–å†™å®éªŒæŠ¥å‘Š">4.8 æ€»ç»“å®éªŒï¼Œç¼–å†™å®éªŒæŠ¥å‘Š</a></li></ul>
                </li>
                <li>
                    <a href="#5-%e5%ae%9e%e9%aa%8c%e6%80%bb%e7%bb%93" aria-label="5. å®éªŒæ€»ç»“">5. å®éªŒæ€»ç»“</a></li>
                <li>
                    <a href="#6-%e5%ae%9e%e9%aa%8c%e5%ae%8c%e6%95%b4%e4%bb%a3%e7%a0%81" aria-label="6. å®éªŒå®Œæ•´ä»£ç ">6. å®éªŒå®Œæ•´ä»£ç </a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>Python3å®ç°RSAå’ŒECCéå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚</p>
<h2 id="å…¬é’¥å¯†ç ç®—æ³•çš„ç¼–å†™">å…¬é’¥å¯†ç ç®—æ³•çš„ç¼–å†™<a hidden class="anchor" aria-hidden="true" href="#å…¬é’¥å¯†ç ç®—æ³•çš„ç¼–å†™">#</a></h2>
<p>æœ¬å®éªŒæ˜¯ä½¿ç”¨pythonæ¥å®ç°RSAå’ŒECCå…¬é’¥åŠ å¯†ç®—æ³•ï¼Œå¹¶å¯¹åŠ å¯†è§£å¯†è¿‡ç¨‹çš„æ­£ç¡®æ€§è¿›è¡ŒéªŒè¯ã€‚
æœ€åï¼Œå’Œä¸Šä¸€èŠ‚çš„å¯¹ç§°åŠ å¯†ç®—æ³•è¿›è¡Œæ¯”è¾ƒã€‚</p>
<h3 id="1å®éªŒç›®çš„">1.å®éªŒç›®çš„<a hidden class="anchor" aria-hidden="true" href="#1å®éªŒç›®çš„">#</a></h3>
<ol>
<li>æŒæ¡éå¯¹ç§°åŠ å¯†ä½“åˆ¶åŸç†</li>
<li>æŒæ¡RSAã€ECCå…¬é’¥ç®—æ³•çš„å®ç°æ–¹æ³•ï¼Œèƒ½å¯¹å…¶å®‰å…¨æ€§è¿›è¡Œåˆ†æ</li>
<li>äº†è§£å…¬é’¥å¯†ç ä½“åˆ¶çš„åº”ç”¨</li>
</ol>
<h3 id="2å®éªŒå·¥å…·">2.å®éªŒå·¥å…·<a hidden class="anchor" aria-hidden="true" href="#2å®éªŒå·¥å…·">#</a></h3>
<ul>
<li>Jupyter Notebook</li>
<li>Python3.5</li>
</ul>
<h3 id="3å®éªŒç¯å¢ƒ">3.å®éªŒç¯å¢ƒ<a hidden class="anchor" aria-hidden="true" href="#3å®éªŒç¯å¢ƒ">#</a></h3>
<ul>
<li>Ubuntu16.04LTSæ“ä½œç³»ç»Ÿ</li>
<li>Python3æ ‡å‡†åº“</li>
</ul>
<h3 id="4å®éªŒæ­¥éª¤">4.å®éªŒæ­¥éª¤<a hidden class="anchor" aria-hidden="true" href="#4å®éªŒæ­¥éª¤">#</a></h3>
<h4 id="41-å›é¡¾è¯¾ç¨‹æŸ¥é˜…èµ„æ–™">4.1 å›é¡¾è¯¾ç¨‹ï¼ŒæŸ¥é˜…èµ„æ–™<a hidden class="anchor" aria-hidden="true" href="#41-å›é¡¾è¯¾ç¨‹æŸ¥é˜…èµ„æ–™">#</a></h4>
<h4 id="42-éå¯¹ç§°åŠ å¯†ä¸å¯¹ç§°åŠ å¯†æ¯”è¾ƒ">4.2 éå¯¹ç§°åŠ å¯†ä¸å¯¹ç§°åŠ å¯†æ¯”è¾ƒ<a hidden class="anchor" aria-hidden="true" href="#42-éå¯¹ç§°åŠ å¯†ä¸å¯¹ç§°åŠ å¯†æ¯”è¾ƒ">#</a></h4>
<blockquote>
<p>Aå’ŒCè¦ä¼ è¾“æ•°æ®ï¼Œä½†æ•°æ®éœ€è¦ç»è¿‡B<br>
åŠ å¯†è¦è§£å†³ä¸¤ä¸ªåŸºæœ¬é—®é¢˜</p>
</blockquote>
<ul>
<li>B èƒ½çœ‹åˆ° A å‘ç»™ C çš„å†…å®¹ã€‚</li>
<li>B å¯ä»¥ä¼ªé€  A å‘ç»™ C çš„å†…å®¹ã€‚</li>
</ul>
<blockquote>
<p>å¯¹ç§°åŠ å¯†è™½ç„¶è§£å†³äº†å‰é¢çš„ä¸¤ä¸ªé—®é¢˜ï¼Œå´å¸¦æ¥æ–°é—®é¢˜ï¼š<br>
åŠ è§£å¯†ç®—æ³•å¾—ä»¥å®ç°ï¼Œä¾èµ–äº A ä¸ C çš„å•ç‹¬åå•†ï¼Œè¿™ä¸å‰é¢è¯´çš„ A ä¸ C é€šä¿¡å¿…é¡»ç»è¿‡ B çš„å‰æçŸ›ç›¾ã€‚å³ä½¿è¿™ç§å•ç‹¬åå•†å¶å°”å¯ä»¥å®ç°ï¼Œå®ƒçš„æœºä¼šä¹Ÿå¿…å®šååˆ†ç¨€ç¼ºã€‚å¦‚æœéœ€è¦ä¸ C é€šä¿¡çš„ä¸æ­¢ä¸€ä¸ª Aï¼Œè€Œæ˜¯ A0ã€A1â€¦â€¦Anï¼Œæ¯ä¸ª Ai éƒ½è¦é¿å¼€å…¶å®ƒæ‰€æœ‰èŠ‚ç‚¹ä¸ C å•ç‹¬åå•†ï¼Œè¿™æ˜¯ä¸ç°å®çš„ã€‚
å¦‚æœè®©è¿™äº› A0ã€A1â€¦â€¦Anéƒ½ä½¿ç”¨åŒæ ·çš„ç®—æ³•å‘¢ï¼Ÿæ˜¾ç„¶ï¼Œæ¯ä¸ª Ai éƒ½ä¼šçŸ¥é“å®ƒä¸è¯¥çŸ¥é“çš„ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥å†’å……å…¶å®ƒ Ai å‘é€ä¿¡æ¯ã€‚<br>
æ‰€ä»¥ï¼Œæ¯ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´è¦æœ‰ä¸€å¥—ä¸“ç”¨çš„åŠ è§£å¯†ç®—æ³•ï¼Œå¦‚æœä¸€ä¸ªç½‘ç»œä¸Šæœ‰ N ä¸ªèŠ‚ç‚¹ï¼Œä¸€å…±è¦æœ‰ N *ï¼ˆNï¼1ï¼‰ï¼2 å¥—ç®—æ³•ã€‚å¯¹äºåŠ¨è¾„æˆåƒä¸Šä¸‡ä¸ªèŠ‚ç‚¹çš„ç½‘ç»œï¼Œè¿™ä¸ªæ•°å­—å¤ªå¤§äº†ã€‚</p>
</blockquote>
<blockquote>
<p><strong>äººä»¬å‘ç°ï¼Œå‰è¿°é—®é¢˜çš„ç—‡ç»“åœ¨äºå¯¹ç§°ã€‚</strong></p>
</blockquote>
<blockquote>
<p>å¦‚æœåŠ å¯†ç®—æ³•å’Œè§£å¯†ç®—æ³•æ— æ³•äº’ç›¸æ¨å¯¼ï¼Œäº‹æƒ…å°±å¥½åŠäº†ï¼š<br>
æ‰€æœ‰å‘ç»™ C çš„ä¿¡æ¯éƒ½ç”¨åŒæ ·çš„åŠ å¯†ç®—æ³•ï¼Œè€Œåªæœ‰ C è‡ªå·±æ‰èƒ½è§£å¯†ã€‚Ai è™½ç„¶æ‡‚å¾—åŠ å¯†ï¼Œä½†å¹¶ä¸èƒ½ä»åŠ å¯†ç®—æ³•æ¨å¯¼å‡ºè§£å¯†ç®—æ³•æ¥ã€‚å› æ­¤ä¸€ä¸ª Ai å‘ç»™ C çš„ä¿¡æ¯ä¸ä¼šæ³„éœ²ç»™å…¶å®ƒ Aiï¼Œå°±è¿åŠ å¯†è€…è‡ªå·±ä¹Ÿä¸ä¼šè§£å¯†ã€‚
ç°åœ¨ï¼Œå¯¹äºæ¯ä¸ªèŠ‚ç‚¹ï¼Œåªè¦åˆ¶ä½œä¸€å¥—åŠ è§£å¯†ç®—æ³•ï¼Œè§£å¯†ç®—æ³•è‡ªå·±ç•™ç€ï¼Œå°†åŠ å¯†ç®—æ³•å…¬å¸ƒå‡ºå»ï¼šè°æƒ³å‘æ¶ˆæ¯ç»™æˆ‘å°±ç”¨è¿™ä¸ªæ–¹æ³•åŠ å¯†ï¼ŒåŠ å¯†ä¹‹ååªæœ‰æˆ‘èƒ½è§£å¯†ï¼Œåˆ«äººè°ä¹Ÿè§£ä¸å‡ºæ¥ã€‚åŠ å¯†ç®—æ³•æ˜¯å…¬å¼€çš„ï¼Œå¤§å®¶éƒ½çŸ¥é“ï¼Œä¸éœ€è¦ä¸æ¯ä¸ªèŠ‚ç‚¹å•ç‹¬åå•†äº†ã€‚</p>
</blockquote>
<h4 id="43rsaç®—æ³•ä»‹ç»">4.3.RSAç®—æ³•ä»‹ç»<a hidden class="anchor" aria-hidden="true" href="#43rsaç®—æ³•ä»‹ç»">#</a></h4>
<blockquote>
<p>RSA ç®—æ³•çš„å®è´¨æ˜¯ä¸‰ä¸ªè‡ªç„¶æ•°ï¼Œä¸€èˆ¬è®°ä½œ n, d, eã€‚n å’Œ d æ„æˆä¸€ä¸ªå¯†é’¥ï¼Œn å’Œ e æ„æˆå¦ä¸€ä¸ªå¯†é’¥ã€‚
å¯¹äºï¼ˆn, dï¼‰ä¸ï¼ˆn, eï¼‰è¿™ä¸¤ä¸ªå¯†é’¥ï¼Œæ— è®ºç”¨å“ªä¸ªå¯†é’¥åŠ å¯†å‡ºæ¥çš„å¯†æ–‡éƒ½å¯ä»¥ç”¨å¦ä¸€ä¸ªå¯†é’¥è§£å¼€ï¼Œ æ‰€ä»¥ä¸å¿…å¼ºè°ƒå“ªä¸ªç”¨äºåŠ å¯†ï¼Œå“ªä¸ªç”¨äºè§£å¯†ï¼Œåªè¦æŠŠä¸€ä¸ªå…¬å¸ƒå‡ºå»ï¼ˆç§°ä¸ºå…¬é’¥ï¼‰ï¼Œå¦ä¸€ä¸ªè‡ªå·±è—ç€ï¼ˆç§°ä¸ºç§é’¥ï¼‰å°±è¡Œäº†ã€‚</p>
</blockquote>
<h5 id="431-ç”Ÿæˆå…¬é’¥å’Œç§é’¥">4.3.1 ç”Ÿæˆå…¬é’¥å’Œç§é’¥<a hidden class="anchor" aria-hidden="true" href="#431-ç”Ÿæˆå…¬é’¥å’Œç§é’¥">#</a></h5>
<blockquote>
<p>å‡è®¾Aliceæƒ³è¦é€šè¿‡ä¸€ä¸ªä¸å¯é çš„åª’ä½“æ¥æ”¶Bobçš„ä¸€æ¡ç§äººæ¶ˆæ¯ã€‚å¥¹å¯ä»¥ç”¨ä»¥ä¸‹çš„æ–¹å¼æ¥äº§ç”Ÿä¸€ä¸ªå…¬é’¥å’Œä¸€ä¸ªç§é’¥ï¼š</p>
</blockquote>
<ol>
<li>éšæ„é€‰æ‹©ä¸¤ä¸ªå¤§çš„è´¨æ•°\(p\)å’Œ\(q\)ï¼Œ\(p\)ä¸ç­‰äº\(q\)ï¼Œè®¡ç®—\(N=pq\)ã€‚</li>
<li>æ ¹æ®æ¬§æ‹‰å‡½æ•°ï¼Œæ±‚å¾—\({\displaystyle r=\varphi (N)=\varphi (p)\varphi (q)=(p-1)(q-1)}\)</li>
<li>é€‰æ‹©ä¸€ä¸ªå°äº \({\displaystyle r}\) çš„æ•´æ•°\({\displaystyle e}\)ï¼Œä½¿ \({\displaystyle e}ä¸{\displaystyle r}\) äº’è´¨ã€‚å¹¶æ±‚å¾— \({\displaystyle e}å…³äº{\displaystyle r}\)çš„æ¨¡åå…ƒç´ ï¼Œå‘½åä¸º\({\displaystyle d}ï¼ˆæ±‚{\displaystyle d}ä»¤{\displaystyle ed\equiv 1{\pmod {r}}}\)ï¼‰ã€‚<br>
ï¼ˆæ¨¡åå…ƒç´ å­˜åœ¨ï¼Œå½“ä¸”ä»…å½“\({\displaystyle e}ä¸{\displaystyle r}\)äº’è´¨ï¼‰</li>
<li>å°† \({\displaystyle p}å’Œ {\displaystyle q}\)çš„è®°å½•é”€æ¯ã€‚</li>
</ol>
<blockquote>
<p>\({\displaystyle (N,e)}æ˜¯å…¬é’¥ï¼Œ {\displaystyle (N,d)}æ˜¯ç§é’¥ã€‚Aliceå°†å¥¹çš„å…¬é’¥ {\displaystyle (N,e)}ä¼ ç»™Bobï¼Œè€Œå°†å¥¹çš„ç§é’¥ {\displaystyle (N,d)}\)è—èµ·æ¥ã€‚</p>
</blockquote>
<h5 id="432-åŠ å¯†æ¶ˆæ¯">4.3.2 åŠ å¯†æ¶ˆæ¯<a hidden class="anchor" aria-hidden="true" href="#432-åŠ å¯†æ¶ˆæ¯">#</a></h5>
<blockquote>
<p>å‡è®¾Bobæƒ³ç»™Aliceé€ä¸€ä¸ªæ¶ˆæ¯ \({\displaystyle m}ï¼Œä»–çŸ¥é“Aliceäº§ç”Ÿçš„ {\displaystyle N}å’Œ {\displaystyle e}ã€‚ä»–ä½¿ç”¨èµ·å…ˆä¸Aliceçº¦å¥½çš„æ ¼å¼å°† {\displaystyle m}è½¬æ¢ä¸ºä¸€ä¸ªå°äº {\displaystyle N}çš„éè´Ÿæ•´æ•° {\displaystyle n}ï¼Œæ¯”å¦‚ä»–å¯ä»¥å°†æ¯ä¸€ä¸ªå­—è½¬æ¢ä¸ºè¿™ä¸ªå­—çš„Unicodeç ï¼Œç„¶åå°†è¿™äº›æ•°å­—è¿åœ¨ä¸€èµ·ç»„æˆä¸€ä¸ªæ•°å­—ã€‚å‡å¦‚ä»–çš„ä¿¡æ¯éå¸¸é•¿çš„è¯ï¼Œä»–å¯ä»¥å°†è¿™ä¸ªä¿¡æ¯åˆ†ä¸ºå‡ æ®µï¼Œç„¶åå°†æ¯ä¸€æ®µè½¬æ¢ä¸º {\displaystyle n}ã€‚ç”¨ä¸‹é¢è¿™ä¸ªå…¬å¼ä»–å¯ä»¥å°† {\displaystyle n}åŠ å¯†ä¸º {\displaystyle c}\)ï¼š</p>
</blockquote>
<blockquote>
<p>\({\displaystyle c\equiv n^{e}{\pmod {N}}}
è®¡ç®— {\displaystyle c}å¹¶ä¸å¤æ‚ã€‚Bobç®—å‡º {\displaystyle c}\)åå°±å¯ä»¥å°†å®ƒä¼ é€’ç»™Aliceã€‚</p>
</blockquote>
<h5 id="433-è§£å¯†æ¶ˆæ¯">4.3.3 è§£å¯†æ¶ˆæ¯<a hidden class="anchor" aria-hidden="true" href="#433-è§£å¯†æ¶ˆæ¯">#</a></h5>
<blockquote>
<p><img loading="lazy" src="/img/%e8%a7%a3%e5%af%86%e6%b6%88%e6%81%af.jpg" alt="å…¬é’¥è§£å¯†"  />
</p>
</blockquote>
<h5 id="434-ç­¾åæ¶ˆæ¯">4.3.4 ç­¾åæ¶ˆæ¯<a hidden class="anchor" aria-hidden="true" href="#434-ç­¾åæ¶ˆæ¯">#</a></h5>
<blockquote>
<p>RSAä¹Ÿå¯ä»¥ç”¨æ¥ä¸ºä¸€ä¸ªæ¶ˆæ¯ç½²åã€‚å‡å¦‚Aliceæƒ³ç»™Bobä¼ é€’ä¸€ä¸ªç½²åçš„æ¶ˆæ¯çš„è¯ï¼Œé‚£ä¹ˆå¥¹å¯ä»¥ä¸ºå¥¹çš„æ¶ˆæ¯è®¡ç®—ä¸€ä¸ªæ•£åˆ—å€¼ï¼ˆMessage digestï¼‰ï¼Œç„¶åç”¨å¥¹çš„ç§é’¥â€œåŠ å¯†â€ï¼ˆå¦‚åŒå‰é¢â€œåŠ å¯†æ¶ˆæ¯â€çš„æ­¥éª¤ï¼‰è¿™ä¸ªæ•£åˆ—å€¼å¹¶å°†è¿™ä¸ªâ€œç½²åâ€åŠ åœ¨æ¶ˆæ¯çš„åé¢ã€‚è¿™ä¸ªæ¶ˆæ¯åªæœ‰ç”¨å¥¹çš„å…¬é’¥æ‰èƒ½è¢«è§£å¯†ã€‚Bobè·å¾—è¿™ä¸ªæ¶ˆæ¯åå¯ä»¥ç”¨Aliceçš„å…¬é’¥â€œè§£å¯†â€ï¼ˆå¦‚åŒå‰é¢â€œè§£å¯†æ¶ˆæ¯â€çš„æ­¥éª¤ï¼‰è¿™ä¸ªæ•£åˆ—å€¼ï¼Œç„¶åå°†è¿™ä¸ªæ•°æ®ä¸ä»–è‡ªå·±ä¸ºè¿™ä¸ªæ¶ˆæ¯è®¡ç®—çš„æ•£åˆ—å€¼ç›¸æ¯”è¾ƒã€‚å‡å¦‚ä¸¤è€…ç›¸ç¬¦çš„è¯ï¼Œé‚£ä¹ˆBobå°±å¯ä»¥çŸ¥é“å‘ä¿¡äººæŒæœ‰Aliceçš„ç§é’¥ï¼Œä»¥åŠè¿™ä¸ªæ¶ˆæ¯åœ¨ä¼ æ’­è·¯å¾„ä¸Šæ²¡æœ‰è¢«ç¯¡æ”¹è¿‡ã€‚</p>
</blockquote>
<h4 id="44-ç¼–å†™rsaåŠ å¯†è§£å¯†çš„æµ‹è¯•ç”¨ä¾‹">4.4 ç¼–å†™RSAåŠ å¯†è§£å¯†çš„æµ‹è¯•ç”¨ä¾‹<a hidden class="anchor" aria-hidden="true" href="#44-ç¼–å†™rsaåŠ å¯†è§£å¯†çš„æµ‹è¯•ç”¨ä¾‹">#</a></h4>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">if</span> __name__ == <span style="color:#0ff;font-weight:bold">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># æµ‹è¯•å·²çŸ¥æ•°æ®</span>
</span></span><span style="display:flex;"><span>    public = PublicKey(n=<span style="color:#ff0;font-weight:bold">2534665157</span>, e=<span style="color:#ff0;font-weight:bold">7</span>)
</span></span><span style="display:flex;"><span>    private = PrivateKey(n=<span style="color:#ff0;font-weight:bold">2534665157</span>, d=<span style="color:#ff0;font-weight:bold">1810402843</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">assert</span> public.encrypt(<span style="color:#ff0;font-weight:bold">123</span>) == <span style="color:#ff0;font-weight:bold">2463995467</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">assert</span> public.encrypt(<span style="color:#ff0;font-weight:bold">456</span>) == <span style="color:#ff0;font-weight:bold">2022084991</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">assert</span> public.encrypt(<span style="color:#ff0;font-weight:bold">123456</span>) == <span style="color:#ff0;font-weight:bold">1299565302</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">assert</span> private.decrypt(<span style="color:#ff0;font-weight:bold">2463995467</span>) == <span style="color:#ff0;font-weight:bold">123</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">assert</span> private.decrypt(<span style="color:#ff0;font-weight:bold">2022084991</span>) == <span style="color:#ff0;font-weight:bold">456</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">assert</span> private.decrypt(<span style="color:#ff0;font-weight:bold">1299565302</span>) == <span style="color:#ff0;font-weight:bold">123456</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># æµ‹è¯•éšæœºæ•°æ®</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">for</span> length in <span style="color:#fff;font-weight:bold">range</span>(<span style="color:#ff0;font-weight:bold">4</span>, <span style="color:#ff0;font-weight:bold">17</span>):
</span></span><span style="display:flex;"><span>        public, private = make_key_pair(length)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> public.n == private.n
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> <span style="color:#fff;font-weight:bold">len</span>(<span style="color:#fff;font-weight:bold">bin</span>(public.n)) - <span style="color:#ff0;font-weight:bold">2</span> == length
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        x = random.randrange(public.n - <span style="color:#ff0;font-weight:bold">2</span>)
</span></span><span style="display:flex;"><span>        y = public.encrypt(x)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> private.decrypt(y) == x
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> public.encrypt(public.n - <span style="color:#ff0;font-weight:bold">1</span>) == public.n - <span style="color:#ff0;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> public.encrypt(public.n) == <span style="color:#ff0;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> private.decrypt(public.n - <span style="color:#ff0;font-weight:bold">1</span>) == public.n - <span style="color:#ff0;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> private.decrypt(public.n) == <span style="color:#ff0;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#39;éªŒè¯å®Œæ¯•&#39;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="45-eccç®—æ³•åŸç†">4.5 ECCç®—æ³•åŸç†<a hidden class="anchor" aria-hidden="true" href="#45-eccç®—æ³•åŸç†">#</a></h4>
<blockquote>
<p>æ¤­åœ†æ›²çº¿å¯†ç å­¦çš„è®¸å¤šå½¢å¼æœ‰ç¨å¾®çš„ä¸åŒï¼Œæ‰€æœ‰çš„éƒ½ä¾èµ–äºè¢«å¹¿æ³›æ‰¿è®¤çš„è§£å†³æ¤­åœ†æ›²çº¿ç¦»æ•£å¯¹æ•°é—®é¢˜çš„å›°éš¾æ€§ä¸Šï¼Œå¯¹åº”æœ‰é™åŸŸä¸Šæ¤­åœ†æ›²çº¿çš„ç¾¤ã€‚</p>
</blockquote>
<blockquote>
<p>å¯¹äºECCç³»ç»Ÿæ¥è¯´ï¼Œå®Œæˆè¿è¡Œç³»ç»Ÿæ‰€å¿…é¡»çš„ç¾¤æ“ä½œæ¯”åŒæ ·å¤§å°çš„å› æ•°åˆ†è§£ç³»ç»Ÿæˆ–æ¨¡æ•´æ•°ç¦»æ•£å¯¹æ•°ç³»ç»Ÿè¦æ…¢ã€‚ä¸è¿‡ï¼ŒECCç³»ç»Ÿçš„æ‹¥æŠ¤è€…ç›¸ä¿¡ECDLPé—®é¢˜æ¯”DLPæˆ–å› æ•°åˆ†è§£é—®é¢˜è¦éš¾çš„å¤šï¼Œå¹¶ä¸”å› æ­¤ä½¿ç”¨ECCèƒ½ç”¨å°çš„å¤šçš„å¯†é’¥é•¿åº¦æ¥æä¾›åŒç­‰çš„å®‰å…¨ï¼Œåœ¨è¿™æ–¹é¢æ¥è¯´å®ƒç¡®å®æ¯”ä¾‹å¦‚RSAä¹‹ç±»çš„æ›´å¿«ã€‚åˆ°ç›®å‰ä¸ºæ­¢å·²ç»å…¬å¸ƒçš„ç»“æœè¶‹äºæ”¯æŒè¿™ä¸ªç»“è®ºï¼Œä¸è¿‡ä¸€äº›ä¸“å®¶è¡¨ç¤ºæ€€ç–‘ã€‚</p>
</blockquote>
<h4 id="46-ç¼–å†™eccç®—æ³•çš„æµ‹è¯•ä»£ç ">4.6 ç¼–å†™ECCç®—æ³•çš„æµ‹è¯•ä»£ç <a hidden class="anchor" aria-hidden="true" href="#46-ç¼–å†™eccç®—æ³•çš„æµ‹è¯•ä»£ç ">#</a></h4>
<h4 id="47-ç¼–å†™rsaå’Œeccå…¬é’¥åŠ å¯†çš„pythonå®ç°å¹¶è¿›è¡Œæµ‹è¯•éªŒè¯">4.7 ç¼–å†™RSAå’ŒECCå…¬é’¥åŠ å¯†çš„pythonå®ç°ï¼Œå¹¶è¿›è¡Œæµ‹è¯•éªŒè¯<a hidden class="anchor" aria-hidden="true" href="#47-ç¼–å†™rsaå’Œeccå…¬é’¥åŠ å¯†çš„pythonå®ç°å¹¶è¿›è¡Œæµ‹è¯•éªŒè¯">#</a></h4>
<blockquote>
<p>ä»£ç å’Œæµ‹è¯•ç»“æœåœ¨æŠ¥å‘Šæœ€å</p>
</blockquote>
<h4 id="48-æ€»ç»“å®éªŒç¼–å†™å®éªŒæŠ¥å‘Š">4.8 æ€»ç»“å®éªŒï¼Œç¼–å†™å®éªŒæŠ¥å‘Š<a hidden class="anchor" aria-hidden="true" href="#48-æ€»ç»“å®éªŒç¼–å†™å®éªŒæŠ¥å‘Š">#</a></h4>
<h3 id="5-å®éªŒæ€»ç»“">5. å®éªŒæ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#5-å®éªŒæ€»ç»“">#</a></h3>
<ul>
<li>éœ€è¦å–„äºå€Ÿé‰´å‰äººç»éªŒï¼Œæœé›†èµ„æ–™</li>
<li>å®éªŒåªæ”¯æŒasciiç ï¼Œå¯¹å…¶ä»–å­—ç¬¦ç¼–ç æ²¡æœ‰è§£å†³</li>
<li>åˆ©ç”¨ä¼˜ç§€çš„å·¥å…·ï¼Œå¦‚Jupyterå¯ä»¥æé«˜å­¦ä¹ æ•ˆç‡</li>
</ul>
<h3 id="6-å®éªŒå®Œæ•´ä»£ç ">6. å®éªŒå®Œæ•´ä»£ç <a hidden class="anchor" aria-hidden="true" href="#6-å®éªŒå®Œæ•´ä»£ç ">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 44
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 45
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 46
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 47
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 48
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 49
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 50
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 51
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 52
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 53
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 54
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 55
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 56
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 57
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 58
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 59
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 60
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 61
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 62
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 63
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 64
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 65
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 66
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 67
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 68
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 69
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 70
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 71
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 72
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 73
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 74
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 75
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 76
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 77
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 78
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 79
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 80
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 81
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 82
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 83
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 84
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 85
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 86
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 87
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 88
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 89
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 90
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 91
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 92
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 93
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 94
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 95
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 96
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 97
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 98
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 99
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">100
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">101
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">102
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">103
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">104
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">105
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">106
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">107
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">108
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">109
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">110
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">111
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">112
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">113
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">114
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">115
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">116
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">117
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">118
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">119
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">120
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">121
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">122
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">123
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">124
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">125
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">126
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">127
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">128
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">129
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">130
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">131
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">132
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">133
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">134
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">135
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">136
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">137
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">138
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">139
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">140
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">141
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">142
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">143
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">144
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">145
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">146
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">147
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">148
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">149
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">150
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">151
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">152
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">153
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">154
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">155
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">156
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">157
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">158
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">159
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">160
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">161
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">162
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">163
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">164
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">165
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">166
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">167
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">168
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">169
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">170
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">171
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">172
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">173
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">174
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">175
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">176
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">177
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">178
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">179
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">180
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">181
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">182
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">183
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">184
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">185
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">186
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">187
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">188
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">189
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">190
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">191
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">192
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">193
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">194
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">195
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">196
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">197
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">198
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">199
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">200
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">201
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">202
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">203
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">204
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">205
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">206
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">207
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">208
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">209
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">210
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">211
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">212
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">213
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">214
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">215
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">216
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">217
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">218
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">219
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">220
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;RSAåŠ å¯†ç³»ç»Ÿçš„ç®€å•å®ç°
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">æ¨¡å—å±•ç¤ºäº†ä¸€ç§ç®€å•æ¸…æ™°çš„RSAç®—æ³•çš„å®ç°ï¼Œå®ƒçš„ç›®çš„ä¸æ˜¯æ•ˆç‡ï¼Œè€Œæ˜¯ä¸ºäº†å¯è¯»æ€§ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">The usage is simple. First, create a random key pair:
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    &gt;&gt;&gt; public_key, private_key = make_key_pair(8)
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">The number 8 is the _key length_. The higher this number, the stronger the
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">encryption. The public key can be used to encrypt a message (in this module,
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">a message is simply a positive integer number):
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    &gt;&gt;&gt; message = 5
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    &gt;&gt;&gt; encrypted_message = public_key.encrypt(message)
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">The encrypted information can be retrieved only with the private key:
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    &gt;&gt;&gt; private_key.decrypt(encrypted_message)
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    5
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">Private and public keys are made of three numeric parameters: ``n``, ``d`` and
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">``e``. ``n`` has the bit length specified with ``make_key_pair`` and is shared
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">between the two keys; ``e`` is used by the public key encrypt; ``d`` is used
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">by the private key to decrypt.
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">It&#39;s worth noting that ``n - 2`` is the highest number that can be safely
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">encrypted or decrypted. For example, encrypting (or decrypting) the number
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">``n - 1`` does nothing, and encrypting (or decrypting) the number ``n`` always
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">returns 0.
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    &gt;&gt;&gt; key = PublicKey(n=143, e=113)
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    &gt;&gt;&gt; key.encrypt(142)  # n - 1
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    142
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    &gt;&gt;&gt; key.encrypt(143)  # n
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    0
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">Also encrypting (or decrypting) 0 or 1 always returns 0 or 1:
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    &gt;&gt;&gt; key.encrypt(0)
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    0
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    &gt;&gt;&gt; key.encrypt(1)
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    1
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">Note that sometimes the original and the encrypted messages are the same, as
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">shown in the following example:
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    &gt;&gt;&gt; for x in range(143):  # n
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    ...     if key.encrypt(x) == x:
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    ...         print(x)
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    0
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    1
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    12
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    21
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    34
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    44
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    65
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    66
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    77
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    78
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    99
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    109
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    122
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    131
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    142
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> random
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">from</span> collections <span style="color:#fff;font-weight:bold">import</span> namedtuple
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> get_primes(start, stop):
</span></span><span style="display:flex;"><span>    <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;Return a list of prime numbers in ``range(start, stop)``.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> start &gt;= stop:
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    primes = [<span style="color:#ff0;font-weight:bold">2</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">for</span> n in <span style="color:#fff;font-weight:bold">range</span>(<span style="color:#ff0;font-weight:bold">3</span>, stop + <span style="color:#ff0;font-weight:bold">1</span>, <span style="color:#ff0;font-weight:bold">2</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span> p in primes:
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">if</span> n % p == <span style="color:#ff0;font-weight:bold">0</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#fff;font-weight:bold">break</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">else</span>:
</span></span><span style="display:flex;"><span>            primes.append(n)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">while</span> primes and primes[<span style="color:#ff0;font-weight:bold">0</span>] &lt; start:
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">del</span> primes[<span style="color:#ff0;font-weight:bold">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> primes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> are_relatively_prime(a, b):
</span></span><span style="display:flex;"><span>    <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;Return ``True`` if ``a`` and ``b`` are two relatively prime numbers.
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    Two numbers are relatively prime if they share no common factors,
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    i.e. there is no integer (except 1) that divides both.
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">for</span> n in <span style="color:#fff;font-weight:bold">range</span>(<span style="color:#ff0;font-weight:bold">2</span>, <span style="color:#fff;font-weight:bold">min</span>(a, b) + <span style="color:#ff0;font-weight:bold">1</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> a % n == b % n == <span style="color:#ff0;font-weight:bold">0</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">False</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">True</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> make_key_pair(length):
</span></span><span style="display:flex;"><span>    <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;Create a public-private key pair.
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    The key pair is generated from two random prime numbers. The argument
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    ``length`` specifies the bit length of the number ``n`` shared between
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    the two keys: the higher, the better.
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> length &lt; <span style="color:#ff0;font-weight:bold">4</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">raise</span> ValueError(<span style="color:#0ff;font-weight:bold">&#39;cannot generate a key of length less &#39;</span>
</span></span><span style="display:flex;"><span>                         <span style="color:#0ff;font-weight:bold">&#39;than 4 (got </span><span style="color:#0ff;font-weight:bold">{!r}</span><span style="color:#0ff;font-weight:bold">)&#39;</span>.format(length))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># First step: find a number ``n`` which is the product of two prime</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># numbers (``p`` and ``q``). ``n`` must have the number of bits specified</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># by ``length``, therefore it must be in ``range(n_min, n_max + 1)``.</span>
</span></span><span style="display:flex;"><span>    n_min = <span style="color:#ff0;font-weight:bold">1</span> &lt;&lt; (length - <span style="color:#ff0;font-weight:bold">1</span>)
</span></span><span style="display:flex;"><span>    n_max = (<span style="color:#ff0;font-weight:bold">1</span> &lt;&lt; length) - <span style="color:#ff0;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># The key is stronger if ``p`` and ``q`` have similar bit length. We</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># choose two prime numbers in ``range(start, stop)`` so that the</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># difference of bit lengths is at most 2.</span>
</span></span><span style="display:flex;"><span>    start = <span style="color:#ff0;font-weight:bold">1</span> &lt;&lt; (length // <span style="color:#ff0;font-weight:bold">2</span> - <span style="color:#ff0;font-weight:bold">1</span>)
</span></span><span style="display:flex;"><span>    stop = <span style="color:#ff0;font-weight:bold">1</span> &lt;&lt; (length // <span style="color:#ff0;font-weight:bold">2</span> + <span style="color:#ff0;font-weight:bold">1</span>)
</span></span><span style="display:flex;"><span>    primes = get_primes(start, stop)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># Now that we have a list of prime number candidates, randomly select</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># two so that their product is in ``range(n_min, n_max + 1)``.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">while</span> primes:
</span></span><span style="display:flex;"><span>        p = random.choice(primes)
</span></span><span style="display:flex;"><span>        primes.remove(p)
</span></span><span style="display:flex;"><span>        q_candidates = [q <span style="color:#fff;font-weight:bold">for</span> q in primes
</span></span><span style="display:flex;"><span>                        <span style="color:#fff;font-weight:bold">if</span> n_min &lt;= p * q &lt;= n_max]
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> q_candidates:
</span></span><span style="display:flex;"><span>            q = random.choice(q_candidates)
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">break</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">raise</span> AssertionError(<span style="color:#0ff;font-weight:bold">&#34;cannot find &#39;p&#39; and &#39;q&#39; for a key of &#34;</span>
</span></span><span style="display:flex;"><span>                             <span style="color:#0ff;font-weight:bold">&#34;length=</span><span style="color:#0ff;font-weight:bold">{!r}</span><span style="color:#0ff;font-weight:bold">&#34;</span>.format(length))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># Second step: choose a number ``e`` lower than ``(p - 1) * (q - 1)``</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># which shares no factors with ``(p - 1) * (q - 1)``.</span>
</span></span><span style="display:flex;"><span>    stop = (p - <span style="color:#ff0;font-weight:bold">1</span>) * (q - <span style="color:#ff0;font-weight:bold">1</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">for</span> e in <span style="color:#fff;font-weight:bold">range</span>(<span style="color:#ff0;font-weight:bold">3</span>, stop, <span style="color:#ff0;font-weight:bold">2</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> are_relatively_prime(e, stop):
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">break</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">raise</span> AssertionError(<span style="color:#0ff;font-weight:bold">&#34;cannot find &#39;e&#39; with p=</span><span style="color:#0ff;font-weight:bold">{!r}</span><span style="color:#0ff;font-weight:bold"> &#34;</span>
</span></span><span style="display:flex;"><span>                             <span style="color:#0ff;font-weight:bold">&#34;and q=</span><span style="color:#0ff;font-weight:bold">{!r}</span><span style="color:#0ff;font-weight:bold">&#34;</span>.format(p, q))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># Third step: find ``d`` such that ``(d * e - 1)`` is divisible by</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># ``(p - 1) * (q - 1)``.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">for</span> d in <span style="color:#fff;font-weight:bold">range</span>(<span style="color:#ff0;font-weight:bold">3</span>, stop, <span style="color:#ff0;font-weight:bold">2</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> d * e % stop == <span style="color:#ff0;font-weight:bold">1</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">break</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">raise</span> AssertionError(<span style="color:#0ff;font-weight:bold">&#34;cannot find &#39;d&#39; with p=</span><span style="color:#0ff;font-weight:bold">{!r}</span><span style="color:#0ff;font-weight:bold">, q=</span><span style="color:#0ff;font-weight:bold">{!r}</span><span style="color:#0ff;font-weight:bold"> &#34;</span>
</span></span><span style="display:flex;"><span>                             <span style="color:#0ff;font-weight:bold">&#34;and e=</span><span style="color:#0ff;font-weight:bold">{!r}</span><span style="color:#0ff;font-weight:bold">&#34;</span>.format(p, q, e))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># That&#39;s all. We can build and return the public and private keys.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> PublicKey(p * q, e), PrivateKey(p * q, d)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">class</span> PublicKey(namedtuple(<span style="color:#0ff;font-weight:bold">&#39;PublicKey&#39;</span>, <span style="color:#0ff;font-weight:bold">&#39;n e&#39;</span>)):
</span></span><span style="display:flex;"><span>    <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;Public key which can be used to encrypt data.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    __slots__ = ()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> encrypt(self, x):
</span></span><span style="display:flex;"><span>        <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;Encrypt the number ``x``.
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        The result is a number which can be decrypted only using the
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        private key.
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">pow</span>(x, self.e, self.n)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">class</span> PrivateKey(namedtuple(<span style="color:#0ff;font-weight:bold">&#39;PrivateKey&#39;</span>, <span style="color:#0ff;font-weight:bold">&#39;n d&#39;</span>)):
</span></span><span style="display:flex;"><span>    <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;Private key which can be used both to decrypt data.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    __slots__ = ()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> decrypt(self, x):
</span></span><span style="display:flex;"><span>        <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;Decrypt the number ``x``.
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        The argument ``x`` must be the result of the ``encrypt`` method of
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        the public key.
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">pow</span>(x, self.d, self.n)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">if</span> __name__ == <span style="color:#0ff;font-weight:bold">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># Test with known results.</span>
</span></span><span style="display:flex;"><span>    public = PublicKey(n=<span style="color:#ff0;font-weight:bold">2534665157</span>, e=<span style="color:#ff0;font-weight:bold">7</span>)
</span></span><span style="display:flex;"><span>    private = PrivateKey(n=<span style="color:#ff0;font-weight:bold">2534665157</span>, d=<span style="color:#ff0;font-weight:bold">1810402843</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">assert</span> public.encrypt(<span style="color:#ff0;font-weight:bold">123</span>) == <span style="color:#ff0;font-weight:bold">2463995467</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">assert</span> public.encrypt(<span style="color:#ff0;font-weight:bold">456</span>) == <span style="color:#ff0;font-weight:bold">2022084991</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">assert</span> public.encrypt(<span style="color:#ff0;font-weight:bold">123456</span>) == <span style="color:#ff0;font-weight:bold">1299565302</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">assert</span> private.decrypt(<span style="color:#ff0;font-weight:bold">2463995467</span>) == <span style="color:#ff0;font-weight:bold">123</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">assert</span> private.decrypt(<span style="color:#ff0;font-weight:bold">2022084991</span>) == <span style="color:#ff0;font-weight:bold">456</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">assert</span> private.decrypt(<span style="color:#ff0;font-weight:bold">1299565302</span>) == <span style="color:#ff0;font-weight:bold">123456</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># Test with random values.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">for</span> length in <span style="color:#fff;font-weight:bold">range</span>(<span style="color:#ff0;font-weight:bold">4</span>, <span style="color:#ff0;font-weight:bold">17</span>):
</span></span><span style="display:flex;"><span>        public, private = make_key_pair(length)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> public.n == private.n
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> <span style="color:#fff;font-weight:bold">len</span>(<span style="color:#fff;font-weight:bold">bin</span>(public.n)) - <span style="color:#ff0;font-weight:bold">2</span> == length
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        x = random.randrange(public.n - <span style="color:#ff0;font-weight:bold">2</span>)
</span></span><span style="display:flex;"><span>        y = public.encrypt(x)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> private.decrypt(y) == x
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> public.encrypt(public.n - <span style="color:#ff0;font-weight:bold">1</span>) == public.n - <span style="color:#ff0;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> public.encrypt(public.n) == <span style="color:#ff0;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> private.decrypt(public.n - <span style="color:#ff0;font-weight:bold">1</span>) == public.n - <span style="color:#ff0;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> private.decrypt(public.n) == <span style="color:#ff0;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#39;éªŒè¯å®Œæ¯•&#39;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 44
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 45
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 46
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 47
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 48
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 49
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 50
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 51
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 52
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 53
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 54
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 55
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 56
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 57
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 58
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 59
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 60
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 61
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 62
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 63
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 64
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 65
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 66
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 67
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 68
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 69
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 70
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 71
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 72
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 73
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 74
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 75
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 76
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 77
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 78
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 79
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 80
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 81
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 82
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 83
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 84
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 85
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 86
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 87
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 88
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 89
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 90
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 91
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 92
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 93
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 94
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 95
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 96
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 97
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 98
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 99
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">100
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">101
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">102
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">103
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">104
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">105
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">106
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">107
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">108
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">109
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">110
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">111
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">112
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">113
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">114
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">115
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">116
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">117
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">118
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">119
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">120
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">121
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">122
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">123
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">124
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">125
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">126
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">127
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">128
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">129
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">130
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">131
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">132
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">133
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">134
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">135
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">136
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">137
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">138
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">139
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">140
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">141
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">142
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">143
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">144
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">145
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">146
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">147
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">148
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">149
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">150
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">151
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">152
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">153
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">154
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">155
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">156
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">157
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">158
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">159
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">160
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">161
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">162
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">163
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">164
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">165
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">166
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">167
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">168
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">169
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">170
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">171
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">172
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">173
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">174
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">175
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">176
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">177
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">178
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">179
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">180
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">181
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">182
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">183
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">184
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">185
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">186
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">187
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">188
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">189
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">190
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">191
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">192
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">193
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">194
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">195
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">196
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">197
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">198
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">199
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">200
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">201
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">202
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">203
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">204
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">205
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">206
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">207
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">208
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">209
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">210
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">211
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">212
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">213
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">214
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">215
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">216
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">217
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">218
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">219
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">220
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">221
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">222
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">223
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">224
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">225
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">226
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">227
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">228
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">229
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">230
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">231
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">232
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">233
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">234
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">235
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">236
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">237
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">238
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">239
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">240
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">241
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">242
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">243
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">244
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">245
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">246
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">247
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">248
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">249
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">250
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">251
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">252
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">253
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">254
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">255
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">256
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">257
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">258
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">259
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">260
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">261
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">262
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">263
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">264
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">265
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">266
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">267
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">268
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">269
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">270
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">271
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">272
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">273
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">274
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">275
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">276
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">277
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">278
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">279
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">280
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">281
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">282
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">283
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">284
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">285
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">286
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">287
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">288
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">289
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">290
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">291
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">292
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">293
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">294
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">295
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">296
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">297
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">298
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">299
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">300
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">301
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">302
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">303
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">304
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">305
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">306
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">307
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">308
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">309
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">310
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">311
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">312
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">313
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">314
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">315
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">316
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">317
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">318
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">319
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">320
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">321
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">322
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">323
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">324
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">325
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#007f7f"># Basics of Elliptic Curve Cryptography implementation on Python</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> collections
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> inv(n, q):
</span></span><span style="display:flex;"><span>    <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;div on PN modulo a/b mod q as a * inv(b, q) mod q
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    &gt;&gt;&gt; assert n * inv(n, q) % q == 1
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># n*inv % q = 1 =&gt; n*inv = q*m + 1 =&gt; n*inv + q*-m = 1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># =&gt; egcd(n, q) = (inv, -m, 1) =&gt; inv = egcd(n, q)[0] (mod q)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> egcd(n, q)[<span style="color:#ff0;font-weight:bold">0</span>] % q
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">#[ref] naive implementation</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">#for i in range(q):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">#    if (n * i) % q == 1:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">#        return i</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">#    pass</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">#assert False, &#34;unreached&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">#pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> egcd(a, b):
</span></span><span style="display:flex;"><span>    <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;extended GCD
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    returns: (s, t, gcd) as a*s + b*t == gcd
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    &gt;&gt;&gt; s, t, gcd = egcd(a, b)
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    &gt;&gt;&gt; assert a </span><span style="color:#0ff;font-weight:bold">% g</span><span style="color:#0ff;font-weight:bold">cd == 0 and b </span><span style="color:#0ff;font-weight:bold">% g</span><span style="color:#0ff;font-weight:bold">cd == 0
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    &gt;&gt;&gt; assert a * s + b * t == gcd
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    s0, s1, t0, t1 = <span style="color:#ff0;font-weight:bold">1</span>, <span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#ff0;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">while</span> b &gt; <span style="color:#ff0;font-weight:bold">0</span>:
</span></span><span style="display:flex;"><span>        q, r = <span style="color:#fff;font-weight:bold">divmod</span>(a, b)
</span></span><span style="display:flex;"><span>        a, b = b, r
</span></span><span style="display:flex;"><span>        s0, s1, t0, t1 = s1, s0 - q * s1, t1, t0 - q * t1
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> s0, t0, a
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> sqrt(n, q):
</span></span><span style="display:flex;"><span>    <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;sqrt on PN modulo: returns two numbers or exception if not exist
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    &gt;&gt;&gt; assert (sqrt(n, q)[0] ** 2) % q == n
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    &gt;&gt;&gt; assert (sqrt(n, q)[1] ** 2) % q == n
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">assert</span> n &lt; q
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">for</span> i in <span style="color:#fff;font-weight:bold">range</span>(<span style="color:#ff0;font-weight:bold">1</span>, q):
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> i * i % q == n:
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> (i, q - i)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">raise</span> Exception(<span style="color:#0ff;font-weight:bold">&#34;not found&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Coord = collections.namedtuple(<span style="color:#0ff;font-weight:bold">&#34;Coord&#34;</span>, [<span style="color:#0ff;font-weight:bold">&#34;x&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;y&#34;</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">class</span> EC(<span style="color:#fff;font-weight:bold">object</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;System of Elliptic Curve&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> __init__(self, a, b, q):
</span></span><span style="display:flex;"><span>        <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;elliptic curve as: (y**2 = x**3 + a * x + b) mod q
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        - a, b: params of curve formula
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        - q: prime number
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> <span style="color:#ff0;font-weight:bold">0</span> &lt; a and a &lt; q and <span style="color:#ff0;font-weight:bold">0</span> &lt; b and b &lt; q and q &gt; <span style="color:#ff0;font-weight:bold">2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> (<span style="color:#ff0;font-weight:bold">4</span> * (a ** <span style="color:#ff0;font-weight:bold">3</span>) + <span style="color:#ff0;font-weight:bold">27</span> * (b ** <span style="color:#ff0;font-weight:bold">2</span>))  % q != <span style="color:#ff0;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>        self.a = a
</span></span><span style="display:flex;"><span>        self.b = b
</span></span><span style="display:flex;"><span>        self.q = q
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f"># just as unique ZERO value representation for &#34;add&#34;: (not on curve)</span>
</span></span><span style="display:flex;"><span>        self.zero = Coord(<span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#ff0;font-weight:bold">0</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> is_valid(self, p):
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> p == self.zero: <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">True</span>
</span></span><span style="display:flex;"><span>        l = (p.y ** <span style="color:#ff0;font-weight:bold">2</span>) % self.q
</span></span><span style="display:flex;"><span>        r = ((p.x ** <span style="color:#ff0;font-weight:bold">3</span>) + self.a * p.x + self.b) % self.q
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> l == r
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> at(self, x):
</span></span><span style="display:flex;"><span>        <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;find points on curve at x
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        - x: int &lt; q
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        - returns: ((x, y), (x,-y)) or not found exception
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &gt;&gt;&gt; a, ma = ec.at(x)
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &gt;&gt;&gt; assert a.x == ma.x and a.x == x
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &gt;&gt;&gt; assert a.x == ma.x and a.x == x
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &gt;&gt;&gt; assert ec.neg(a) == ma
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &gt;&gt;&gt; assert ec.is_valid(a) and ec.is_valid(ma)
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> x &lt; self.q
</span></span><span style="display:flex;"><span>        ysq = (x ** <span style="color:#ff0;font-weight:bold">3</span> + self.a * x + self.b) % self.q
</span></span><span style="display:flex;"><span>        y, my = sqrt(ysq, self.q)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> Coord(x, y), Coord(x, my)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> neg(self, p):
</span></span><span style="display:flex;"><span>        <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;negate p
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &gt;&gt;&gt; assert ec.is_valid(ec.neg(p))
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> Coord(p.x, -p.y % self.q)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> add(self, p1, p2):
</span></span><span style="display:flex;"><span>        <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;&lt;add&gt; of elliptic curve: negate of 3rd cross point of (p1,p2) line
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &gt;&gt;&gt; d = ec.add(a, b)
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &gt;&gt;&gt; assert ec.is_valid(d)
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &gt;&gt;&gt; assert ec.add(d, ec.neg(b)) == a
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &gt;&gt;&gt; assert ec.add(a, ec.neg(a)) == ec.zero
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &gt;&gt;&gt; assert ec.add(a, b) == ec.add(b, a)
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &gt;&gt;&gt; assert ec.add(a, ec.add(b, c)) == ec.add(ec.add(a, b), c)
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> p1 == self.zero: <span style="color:#fff;font-weight:bold">return</span> p2
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> p2 == self.zero: <span style="color:#fff;font-weight:bold">return</span> p1
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> p1.x == p2.x and (p1.y != p2.y or p1.y == <span style="color:#ff0;font-weight:bold">0</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f"># p1 + -p1 == 0</span>
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> self.zero
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> p1.x == p2.x:
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f"># p1 + p1: use tangent line of p1 as (p1,p1) line</span>
</span></span><span style="display:flex;"><span>            l = (<span style="color:#ff0;font-weight:bold">3</span> * p1.x * p1.x + self.a) * inv(<span style="color:#ff0;font-weight:bold">2</span> * p1.y, self.q) % self.q
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">else</span>:
</span></span><span style="display:flex;"><span>            l = (p2.y - p1.y) * inv(p2.x - p1.x, self.q) % self.q
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>        x = (l * l - p1.x - p2.x) % self.q
</span></span><span style="display:flex;"><span>        y = (l * (p1.x - x) - p1.y) % self.q
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> Coord(x, y)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> mul(self, p, n):
</span></span><span style="display:flex;"><span>        <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;n times &lt;mul&gt; of elliptic curve
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &gt;&gt;&gt; m = ec.mul(p, n)
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &gt;&gt;&gt; assert ec.is_valid(m)
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &gt;&gt;&gt; assert ec.mul(p, 0) == ec.zero
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        r = self.zero
</span></span><span style="display:flex;"><span>        m2 = p
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f"># O(log2(n)) add</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">while</span> <span style="color:#ff0;font-weight:bold">0</span> &lt; n:
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">if</span> n &amp; <span style="color:#ff0;font-weight:bold">1</span> == <span style="color:#ff0;font-weight:bold">1</span>:
</span></span><span style="display:flex;"><span>                r = self.add(r, m2)
</span></span><span style="display:flex;"><span>                <span style="color:#fff;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>            n, m2 = n &gt;&gt; <span style="color:#ff0;font-weight:bold">1</span>, self.add(m2, m2)
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f"># [ref] O(n) add</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">#for i in range(n):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">#    r = self.add(r, p)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">#    pass</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> r
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> order(self, g):
</span></span><span style="display:flex;"><span>        <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;order of point g
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &gt;&gt;&gt; o = ec.order(g)
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &gt;&gt;&gt; assert ec.is_valid(a) and ec.mul(a, o) == ec.zero
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &gt;&gt;&gt; assert o &lt;= ec.q
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> self.is_valid(g) and g != self.zero
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span> i in <span style="color:#fff;font-weight:bold">range</span>(<span style="color:#ff0;font-weight:bold">1</span>, self.q + <span style="color:#ff0;font-weight:bold">1</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">if</span> self.mul(g, i) == self.zero:
</span></span><span style="display:flex;"><span>                <span style="color:#fff;font-weight:bold">return</span> i
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">raise</span> Exception(<span style="color:#0ff;font-weight:bold">&#34;Invalid order&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">class</span> ElGamal(<span style="color:#fff;font-weight:bold">object</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;ElGamal Encryption
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    pub key encryption as replacing (mulmod, powmod) to (ec.add, ec.mul)
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    - ec: elliptic curve
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    - g: (random) a point on ec
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> __init__(self, ec, g):
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> ec.is_valid(g)
</span></span><span style="display:flex;"><span>        self.ec = ec
</span></span><span style="display:flex;"><span>        self.g = g
</span></span><span style="display:flex;"><span>        self.n = ec.order(g)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> gen(self, priv):
</span></span><span style="display:flex;"><span>        <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;generate pub key
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        - priv: priv key as (random) int &lt; ec.q
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        - returns: pub key as points on ec
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> self.ec.mul(g, priv)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> enc(self, plain, pub, r):
</span></span><span style="display:flex;"><span>        <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;encrypt
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        - plain: data as a point on ec
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        - pub: pub key as points on ec
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        - r: randam int &lt; ec.q
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        - returns: (cipher1, ciper2) as points on ec
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> self.ec.is_valid(plain)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> self.ec.is_valid(pub)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> (self.ec.mul(g, r), self.ec.add(plain, self.ec.mul(pub, r)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> dec(self, cipher, priv):
</span></span><span style="display:flex;"><span>        <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;decrypt
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        - chiper: (chiper1, chiper2) as points on ec
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        - priv: private key as int &lt; ec.q
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        - returns: plain as a point on ec
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        c1, c2 = cipher
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> self.ec.is_valid(c1) and ec.is_valid(c2)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> self.ec.add(c2, self.ec.neg(self.ec.mul(c1, priv)))
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">class</span> DiffieHellman(<span style="color:#fff;font-weight:bold">object</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;Elliptic Curve Diffie Hellman (Key Agreement)
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    - ec: elliptic curve
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    - g: a point on ec
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> __init__(self, ec, g):
</span></span><span style="display:flex;"><span>        self.ec = ec
</span></span><span style="display:flex;"><span>        self.g = g
</span></span><span style="display:flex;"><span>        self.n = ec.order(g)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> gen(self, priv):
</span></span><span style="display:flex;"><span>        <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;generate pub key&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> <span style="color:#ff0;font-weight:bold">0</span> &lt; priv and priv &lt; self.n
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> self.ec.mul(self.g, priv)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> secret(self, priv, pub):
</span></span><span style="display:flex;"><span>        <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;calc shared secret key for the pair
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        - priv: my private key as int
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        - pub: partner pub key as a point on ec
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        - returns: shared secret as a point on ec
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> self.ec.is_valid(pub)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> self.ec.mul(pub, self.n) == self.ec.zero
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> self.ec.mul(pub, priv)
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">class</span> DSA(<span style="color:#fff;font-weight:bold">object</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;ECDSA
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    - ec: elliptic curve
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    - g: a point on ec
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> __init__(self, ec, g):
</span></span><span style="display:flex;"><span>        self.ec = ec
</span></span><span style="display:flex;"><span>        self.g = g
</span></span><span style="display:flex;"><span>        self.n = ec.order(g)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> gen(self, priv):
</span></span><span style="display:flex;"><span>        <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;generate pub key&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> <span style="color:#ff0;font-weight:bold">0</span> &lt; priv and priv &lt; self.n
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> self.ec.mul(self.g, priv)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> sign(self, hashval, priv, r):
</span></span><span style="display:flex;"><span>        <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;generate signature
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        - hashval: hash value of message as int
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        - priv: priv key as int
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        - r: random int 
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        - returns: signature as (int, int)
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> <span style="color:#ff0;font-weight:bold">0</span> &lt; r and r &lt; self.n
</span></span><span style="display:flex;"><span>        m = self.ec.mul(self.g, r)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> (m.x, inv(r, self.n) * (hashval + m.x * priv) % self.n)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> validate(self, hashval, sig, pub):
</span></span><span style="display:flex;"><span>        <span style="color:#0ff;font-weight:bold">&#34;&#34;&#34;validate signature
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        - hashval: hash value of message as int
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        - sig: signature as (int, int)
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        - pub: pub key as a point on ec
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> self.ec.is_valid(pub)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">assert</span> self.ec.mul(pub, self.n) == self.ec.zero
</span></span><span style="display:flex;"><span>        w = inv(sig[<span style="color:#ff0;font-weight:bold">1</span>], self.n)
</span></span><span style="display:flex;"><span>        u1, u2 = hashval * w % self.n, sig[<span style="color:#ff0;font-weight:bold">0</span>] * w % self.n
</span></span><span style="display:flex;"><span>        p = self.ec.add(self.ec.mul(self.g, u1), self.ec.mul(pub, u2))
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> p.x % self.n == sig[<span style="color:#ff0;font-weight:bold">0</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">if</span> __name__ == <span style="color:#0ff;font-weight:bold">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># shared elliptic curve system of examples</span>
</span></span><span style="display:flex;"><span>    ec = EC(<span style="color:#ff0;font-weight:bold">1</span>, <span style="color:#ff0;font-weight:bold">18</span>, <span style="color:#ff0;font-weight:bold">19</span>)
</span></span><span style="display:flex;"><span>    g, _ = ec.at(<span style="color:#ff0;font-weight:bold">7</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">assert</span> ec.order(g) &lt;= ec.q
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># ElGamal enc/dec usage</span>
</span></span><span style="display:flex;"><span>    eg = ElGamal(ec, g)
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># mapping value to ec point</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># &#34;masking&#34;: value k to point ec.mul(g, k)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># (&#34;imbedding&#34; on proper n:use a point of x as 0 &lt;= n*v &lt;= x &lt; n*(v+1) &lt; q)</span>
</span></span><span style="display:flex;"><span>    mapping = [ec.mul(g, i) <span style="color:#fff;font-weight:bold">for</span> i in <span style="color:#fff;font-weight:bold">range</span>(eg.n)]
</span></span><span style="display:flex;"><span>    plain = mapping[<span style="color:#ff0;font-weight:bold">7</span>] 
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    priv = <span style="color:#ff0;font-weight:bold">5</span>
</span></span><span style="display:flex;"><span>    pub = eg.gen(priv)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    cipher = eg.enc(plain, pub, <span style="color:#ff0;font-weight:bold">15</span>)
</span></span><span style="display:flex;"><span>    decoded = eg.dec(cipher, priv)
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">assert</span> decoded == plain
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">assert</span> cipher != pub
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># ECDH usage</span>
</span></span><span style="display:flex;"><span>    dh = DiffieHellman(ec, g)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    apriv = <span style="color:#ff0;font-weight:bold">11</span>
</span></span><span style="display:flex;"><span>    apub = dh.gen(apriv)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    bpriv = <span style="color:#ff0;font-weight:bold">3</span>
</span></span><span style="display:flex;"><span>    bpub = dh.gen(bpriv)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    cpriv = <span style="color:#ff0;font-weight:bold">7</span>
</span></span><span style="display:flex;"><span>    cpub = dh.gen(cpriv)
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># same secret on each pair</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">assert</span> dh.secret(apriv, bpub) == dh.secret(bpriv, apub)
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">assert</span> dh.secret(apriv, cpub) == dh.secret(cpriv, apub)
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">assert</span> dh.secret(bpriv, cpub) == dh.secret(cpriv, bpub)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># not same secret on other pair</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">assert</span> dh.secret(apriv, cpub) != dh.secret(apriv, bpub)
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">assert</span> dh.secret(bpriv, apub) != dh.secret(bpriv, cpub)
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">assert</span> dh.secret(cpriv, bpub) != dh.secret(cpriv, apub)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># ECDSA usage</span>
</span></span><span style="display:flex;"><span>    dsa = DSA(ec, g)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    priv = <span style="color:#ff0;font-weight:bold">11</span>
</span></span><span style="display:flex;"><span>    pub = eg.gen(priv)
</span></span><span style="display:flex;"><span>    hashval = <span style="color:#ff0;font-weight:bold">128</span>
</span></span><span style="display:flex;"><span>    r = <span style="color:#ff0;font-weight:bold">7</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#39;å®Œæˆæµ‹è¯•&#39;</span>)
</span></span><span style="display:flex;"><span>    sig = dsa.sign(hashval, priv, r)
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">assert</span> dsa.validate(hashval, sig, pub)
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">pass</span>
</span></span></code></pre></td></tr></table>
</div>
</div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://blog.niuhemoon.win/tags/python/">Python</a></li>
      <li><a href="https://blog.niuhemoon.win/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/">å¯†ç å­¦</a></li>
    </ul>
<nav class="paginav">
  <a class="next" href="https://blog.niuhemoon.win/posts/tech/install-minikube-on-manjaro/">
    <span class="title">Next Â»</span>
    <br>
    <span>Manjaro æ­å»º minikube ç¯å¢ƒ</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share Pythonå®ç°RSAå’ŒECC on twitter"
        href="https://twitter.com/intent/tweet/?text=Python%e5%ae%9e%e7%8e%b0RSA%e5%92%8cECC&amp;url=https%3a%2f%2fblog.niuhemoon.win%2fposts%2ftech%2fpython-asymmetric-encryption%2f&amp;hashtags=Python%2c%e5%af%86%e7%a0%81%e5%ad%a6">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Pythonå®ç°RSAå’ŒECC on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fblog.niuhemoon.win%2fposts%2ftech%2fpython-asymmetric-encryption%2f&amp;title=Python%e5%ae%9e%e7%8e%b0RSA%e5%92%8cECC&amp;summary=Python%e5%ae%9e%e7%8e%b0RSA%e5%92%8cECC&amp;source=https%3a%2f%2fblog.niuhemoon.win%2fposts%2ftech%2fpython-asymmetric-encryption%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Pythonå®ç°RSAå’ŒECC on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2fblog.niuhemoon.win%2fposts%2ftech%2fpython-asymmetric-encryption%2f&title=Python%e5%ae%9e%e7%8e%b0RSA%e5%92%8cECC">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Pythonå®ç°RSAå’ŒECC on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.niuhemoon.win%2fposts%2ftech%2fpython-asymmetric-encryption%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Pythonå®ç°RSAå’ŒECC on whatsapp"
        href="https://api.whatsapp.com/send?text=Python%e5%ae%9e%e7%8e%b0RSA%e5%92%8cECC%20-%20https%3a%2f%2fblog.niuhemoon.win%2fposts%2ftech%2fpython-asymmetric-encryption%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Pythonå®ç°RSAå’ŒECC on telegram"
        href="https://telegram.me/share/url?text=Python%e5%ae%9e%e7%8e%b0RSA%e5%92%8cECC&amp;url=https%3a%2f%2fblog.niuhemoon.win%2fposts%2ftech%2fpython-asymmetric-encryption%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://blog.niuhemoon.win">Niuhe&#39;s Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
