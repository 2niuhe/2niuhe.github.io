[{"content":"è®°å½•ä¸€ä¸‹CKAè€ƒè¯•çš„å¤‡è€ƒè¿‡ç¨‹\nCKAè€ƒè¯•å¤‡è€ƒç¬”è®°\nè®°å½•å¤‡è€ƒCKAçš„è¿‡ç¨‹\nå­¦ä¹ K8Sçš„èµ„æºä¸»è¦æœ‰ä¸‰ä¸ªï¼š\nCertified Kubernetes Administrator (CKA) Practice Exam Tests | Udemy kubectl Cheat Sheet | Kubernetes Udemy Labs - Certified Kubernetes Administrator with Practice Tests - KodeKloud å…¶ä¸­kodekloudæä¾›äº†åœ¨çº¿çš„å®éªŒç¯å¢ƒï¼Œæ— éœ€è‡ªå·±æ­å»ºk8sé›†ç¾¤æµ‹è¯•ç¯å¢ƒ æœ€ç»ˆè€ƒäº†94åˆ†ï¼Œé«˜åˆ†é£˜è¿‡\nè€ƒè¯•æŠ€å·§ è€ƒè¯•ç¯å¢ƒæ˜¯ç±»ä¼¼è¿œç¨‹æ¡Œé¢ï¼Œæ˜¯ä¸€ä¸ªè¿œç¨‹çš„ubuntuæ¡Œé¢ï¼Œåªèƒ½åœ¨è¿œç¨‹æ¡Œé¢å†…æ“ä½œï¼Œä¸èƒ½ä½¿ç”¨ä½ è‡ªå·±ç”µè„‘ä¸Šçš„æµè§ˆå™¨ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨è¿œç¨‹æ¡Œé¢é‡Œçš„firefoxæµè§ˆå™¨\næå‰30åˆ†é’Ÿå°±å¯ä»¥è¿›å…¥è€ƒåœºï¼Œå‡ºç¤ºè¯ä»¶å¹¶æ£€æŸ¥ç¯å¢ƒ\nè€ƒè¯•å‘½ä»¤è¡Œå„ç§å¿«æ·é”®å’Œå‘½ä»¤è¡¥å…¨éƒ½å·²ç»é…ç½®å¥½äº†ï¼Œä¸ç”¨æ“å¿ƒ\nå¦‚æœè¦æ±‚æ˜¯å†™shellå‘½ä»¤è¡Œåˆ°æ–‡ä»¶ä¸­ï¼Œä¸èƒ½ç”¨kç¼©å†™ï¼Œå¿…é¡»æ˜¯å®Œæ•´çš„kubeletå‘½ä»¤\nè€ƒè¯•æ—¶å¯ä»¥å¤åˆ¶ç²˜è´´k8så®˜ç½‘çš„å†…å®¹\nä¸€å®šè¦çœ‹çœ‹ç½‘ä¸Šå†å¹´çœŸé¢˜ï¼Œå¹¶å®é™…è”ç³»ï¼Œé¢˜ç›®å‡ ä¹ä¸€æ ·ï¼ˆå¾ˆå…³é”®ï¼‰\næœ€å¥½çœ‹è‹±æ–‡è¯•é¢˜ï¼Œä¸ä¼šå› ä¸ºç¿»è¯‘äº§ç”Ÿè¯¯è§£\næœ€å¥½å‚åŠ ä¸‹Killer Shell - Exam Simulatorsçš„æ¨¡æ‹Ÿè€ƒè¯•ï¼Œæ¨¡æ‹Ÿéš¾åº¦å¾ˆå¤§ï¼Œåˆ†æå­¦ä¹ å®Œä¼šæœ‰æ˜æ˜¾æé«˜\nå¿…å­¦å‘½ä»¤\nvim grepå‘½ä»¤ yamlè¯­æ³• netstatå‘½ä»¤ ipå‘½ä»¤ systemctlå‘½ä»¤ journalctlå‘½ä»¤ ipcalcå‘½ä»¤(å¯é€‰) apt-cache madison apt-get json-path ç¬”è®° æ ¸å¿ƒæ¦‚å¿µ æ ¸å¿ƒæ¦‚å¿µ ä¸€åˆ‡çš†æ˜¯èµ„æº\né€šè¿‡å¦‚ä¸‹å‘½ä»¤å¯ä»¥åˆ—å‡ºapiæ”¯æŒçš„èµ„æº\nkubectl api-resources Short name Full name csr certificatesigningrequests cs componentstatuses cm configmaps ds daemonsets deploy deployments ep endpoints ev events hpa horizontalpodautoscalers ing ingresses limits limitranges ns namespaces no nodes pvc persistentvolumeclaims pv persistentvolumes po pods pdb poddisruptionbudgets psp podsecuritypolicies rs replicasets rc replicationcontrollers quota resourcequotas sa serviceaccounts svc services é€šç”¨å‘½ä»¤ # åˆ—å‡ºapiæ¥å£æ”¯æŒçš„èµ„æº(ä¹ŸåŒ…å«äº†èµ„æºçš„apiVersionoå’Œkindä¿¡æ¯) kubectl api-resources # è§£é‡Šå…·ä½“çš„èµ„æº kubectl explain \u0026lt;resource-name\u0026gt; kubectl explain replicaset kubectl explain rs | head -n3 # åˆ—å‡ºå½“å‰namespaceæ‰€æœ‰èµ„æº kubectl get all Pod # æŸ¥çœ‹æ‰€æœ‰pods kubectl get pods kubectl get pods -o wide # åˆ›å»ºä¸€ä¸ªnginxå®¹å™¨ kubectl run nginx --image=nginx # æŸ¥çœ‹podçš„è¯¦æƒ… kubectl describe pod \u0026lt;podname\u0026gt; | less # åˆ é™¤pod kubectl delete pod \u0026lt;podname\u0026gt; # æŸ¥æ‰¾ç‰¹å®šlableçš„pods k get pods --selector env=dev,bu=finance åˆ©ç”¨å£°æ˜å¼æ¥å£åˆ›å»ºpod\ndry runæœºåˆ¶ç”Ÿæˆyaml kubectl create -f ä»yamlæ–‡ä»¶ç”Ÿæˆpod controlplane ~ âœ kubectl run redis --image=redis123 --dry-run=client -o yaml \u0026gt; redis-definition.yaml controlplane ~ âœ cat redis-definition.yaml apiVersion: v1 kind: Pod metadata: creationTimestamp: null labels: run: redis name: redis spec: containers: - image: redis123 name: redis resources: {} dnsPolicy: ClusterFirst restartPolicy: Always status: {} controlplane ~ âœ kubectl create -f redis-definition.yaml pod/redis created åˆšæ‰åˆ›å»ºçš„podä¸­imageåå­—redis123æ— æ³•pullé•œåƒï¼Œç°åœ¨è¿›è¡Œä¿®å¤\næ–¹å¼1:\nkubectl edit pod rediså°†specæ®µä¸­çš„redis123ä¿®æ”¹ä¸ºredisï¼Œä¿å­˜å³å¯ç”Ÿæ•ˆ\næ–¹å¼2:\nç›´æ¥ç¼–è¾‘redis-definition.yamlæ–‡ä»¶ï¼Œä¿®æ”¹imageåå\nkubectl apply -f redis-definition.yaml æ–¹å¼3:\nå…ˆè·å–podçš„yaml\nkubectl get pod redis -o yaml \u0026gt; redis-definition.yaml\nç¼–è¾‘ä¿®æ”¹åå†è¿›è¡Œæ›¿æ¢\nkubectl replace -f redis-definition.yaml --force\nä¸€äº›ä¾‹å­\n# åˆ›å»ºå¸¦lableçš„pod kubectl run redis --image=redis:alpine --labels tier=db # ä¸ºpodåˆ›å»ºä¸€ä¸ªservice k expose pod redis --port 6379 --name redis-service # åˆ›å»ºpodå¹¶åˆ¶å®šç«¯å£ k run custom-nginx --image=nginx --port=8080 # åˆ›å»ºpodåŒæ—¶åˆ›å»ºåŒåçš„service k run httpd --image httpd:alpine --port=80 --expose æŸ¥çœ‹/åˆ›å»ºstatic pod\nstatic podç”±kubeletç›´æ¥ç®¡ç†ï¼Œåªèƒ½ä»apiæ¥å£æŸ¥çœ‹ï¼Œæ— æ³•ä»apiç®¡ç†\n# æŸ¥çœ‹å“ªäº›æ˜¯static podï¼Œä»¥-controlplaneç»“å°¾çš„æ˜¯çš„ k get pods --all-namespaces | grep -controlplane # æŸ¥æ‰¾static podçš„yamlé…ç½®è·¯å¾„ # step1: æŸ¥çœ‹kubeletçš„é…ç½®æ–‡ä»¶ï¼ˆå¯åŠ¨æ—¶é€šè¿‡å‘½ä»¤è¡Œä¼ é€’ï¼‰ ps -aux | grep /usr/bin/kubelet # kubeletçš„é…ç½®è·¯å¾„ä¸º/var/lib/kubelet/config.yaml grep -i staticpod /var/lib/kubelet/config.yaml # åˆ›å»ºstatic pod # é¦–å…ˆåˆ›å»ºå®šä¹‰podçš„yamlæ–‡ä»¶ï¼Œç„¶åæ”¾åˆ°/etc/kubernetes/manifestsè·¯å¾„ä¸‹ kubectl run --restart=Never --image=busybox static-busybox --dry-run=client -o yaml --command -- sleep 1000 \u0026gt; /etc/kubernetes/manifests/static-busybox.yaml Replicaset # åˆ—å‡ºreplicasetsèµ„æº kubectl get replicasets kubectl get rs # æŸ¥çœ‹replicasetsæ›´å¤šä¿¡æ¯ kubectl get rs -o wide kubectl describe replicaset \u0026lt;replicaset-name\u0026gt; # ä»yamlæ–‡ä»¶åˆ›å»ºreplicasets # å‘½ä»¤å¼ï¼šèµ„æºå·²å­˜åœ¨ä¼šæŠ¥é”™ kubectl create -f replicaset-definition.yaml # å£°æ˜å¼ï¼šèµ„æºå·²å­˜åœ¨ä¸ä¼šæŠ¥é”™ï¼Œæ›´é€‚ç”¨äºç‰ˆæœ¬æ›´æ–° kubectl apply -f replicaset-definition.yaml # åˆ é™¤replicasets kubectl delete rs \u0026lt;replicaset-name\u0026gt; # ä¿®å¤é”™è¯¯çš„replicasets # step1: ä¿®å¤é…ç½® kubectl edit rs \u0026lt;replicaset-name\u0026gt; # step2: åˆ é™¤ä¹‹å‰æœªæˆåŠŸçš„pods k get po | grep \u0026lt;replicaset-name\u0026gt; | awk \u0026#39;{print $1}\u0026#39; | xargs -n 1 k delete po # scaleæ‰©å®¹æˆ–ç¼©å®¹ k scale rs \u0026lt;replicaset-name\u0026gt; --replicas=5 # æˆ–è€…ç›´æ¥k editç¼–è¾‘replicas k edit rs \u0026lt;replicaset-name\u0026gt; ä¸€äº›ä¾‹å­\nk create deployment webapp --image kodekloud/webapp-color --replicas DaemonSet # è·å–æ‰€æœ‰namespaceä¸­çš„daemonsets k get daemonsets --all-namespaces # æŸ¥çœ‹daemonsetè¯¦æƒ… kubectl describe ds \u0026lt;daemonset-name\u0026gt; --namespace=\u0026lt;namespace-name\u0026gt; # åˆ›å»ºä¸€ä¸ªdaemonsetçš„yaml # step1: å…ˆé€šè¿‡dry runæ–¹å¼åˆ›å»ºä¸€ä¸ªdeploymentçš„yaml # step2: ç¼–è¾‘yamlï¼Œç§»é™¤replicas, strategy and status æ®µ # step3: å°†kindä»Deployment æ”¹ä¸º DaemonSet åˆ›å»ºdaemonsetçš„ä¾‹å­\nk create deployment elasticsearch -n kube-system --image registry.k8s.io/fluentd-elasticsearch:1.20 --dry-run=client -o yaml \u0026gt; daemonset.yaml apiVersion: apps/v1 kind: DaemonSet metadata: creationTimestamp: null labels: app: elasticsearch name: elasticsearch namespace: kube-system spec: selector: matchLabels: app: elasticsearch template: metadata: creationTimestamp: null labels: app: elasticsearch spec: containers: - image: registry.k8s.io/fluentd-elasticsearch:1.20 name: fluentd-elasticsearch resources: {} k apply -f daemonset.yaml Deployment # åˆ—å‡ºdeploymentsèµ„æº kubectl get deployments kubectl get deploy # åˆ›å»ºdeployment # æ–¹å¼1:ç›´æ¥å‘½ä»¤åˆ›å»º kubectl create deployment --image httpd:2.4-alpine --replicas 3 httpd-frontent # æ–¹å¼2:å…ˆdry-runç”Ÿæˆyamlï¼Œç„¶åä¿®æ”¹åå†apply kubectl create deployment --image httpd:2.4-alpine --replicas 3 --dry-run=client httpd-frontent -o yaml \u0026gt; httpd-deployment.yaml kubectl apply -f httpd-deployment.yaml # åˆ é™¤deployment k delete deploy \u0026lt;deployment-name\u0026gt; ä¸€äº›ä¾‹å­\n# æŒ‡å®šnamespaceåˆ›å»ºdeployment kubectl create deployment redis-deploy -n dev-ns --image redis --replicas 2 Namespace # åˆ—å‡ºæ‰€æœ‰namespace k get namespaces k get ns # è·å–ç¯å¢ƒä¸­namespaceä¸ªæ•° k get ns --no-headers | wc -l # åˆ—å‡ºç‰¹å®šnamespaceä¸­çš„pods k get pods -n \u0026lt;namespace-name\u0026gt; # è·å–æ‰€æœ‰namespaceä¸­çš„pods k get pods --all-namespaces # åœ¨ç‰¹å®šnamespaceä¸­åˆ›å»ºpod k run redis --image=redis -n finance k run redis --image=redis --dry-run=client -n finance -o yaml # åˆ—å‡ºç‰¹å®šnamespaceä¸­çš„service k get service -n \u0026lt;namespace-name\u0026gt; # åˆ›å»ºä¸€ä¸ªæ–°çš„namespace k create namespace \u0026lt;namespace-name\u0026gt; å¤‡æ³¨ï¼š\nserviceçš„DNSè§£æç­–ç•¥ åŒnamespaceï¼Œå¯ä»¥ç›´æ¥ç”¨serviceçš„åå­— ä¸åŒnamesapceï¼Œéœ€è¦åŠ ä¸Šnamespaceçš„åç¼€ï¼Œä¾‹å¦‚ db-service.dev db-service.dev.svc.cluster.local Service # åˆ—å‡ºæ‰€æœ‰services k get services k get svc # æŸ¥çœ‹ç‰¹å®šserviceè¯¦æƒ… k describe svc \u0026lt;service-name\u0026gt; # åˆ›å»ºserviceï¼Œä½¿ç”¨ç±»ä¼¼ä¸‹æ°‘çš„yamlåˆ›å»º k apply -f service-definition.yaml --- apiVersion: v1 kind: Service metadata: name: webapp-service namespace: default spec: ports: - nodePort: 30080 port: 8080 targetPort: 8080 selector: name: simple-webapp type: NodePort Node # è·å–é›†ç¾¤ä¸­æ‰€æœ‰nodeçš„ä¿¡æ¯ kubectl get nodes # æŸ¥çœ‹èŠ‚ç‚¹è¯¦æƒ… k describe node \u0026lt;node-name\u0026gt; è°ƒåº¦éƒ¨åˆ† é€šè¿‡æŒ‡å®šnodeNameæŒ‡å®šèŠ‚ç‚¹éƒ¨ç½²\n--- apiVersion: v1 kind: Pod metadata: name: nginx spec: nodeName: node01 containers: - image: nginx name: nginx Taintå’ŒTolerance\n# ä¸ºèŠ‚ç‚¹node01æ·»åŠ taintï¼Œæ•ˆæœæ˜¯NoSchedule k taint node node01 spary=mortein:NoSchedule # ä¸ºèŠ‚ç‚¹node01ç§»é™¤keyæ˜¯sparyçš„taint k taint node node01 spary- åˆ›å»ºå¯ä»¥å®¹å¿ç‰¹å®štaintçš„pod\n--- apiVersion: v1 kind: Pod metadata: name: bee spec: containers: - image: nginx name: bee tolerations: - key: spray value: mortein effect: NoSchedule operator: Equal Label\n# ä¸ºèŠ‚ç‚¹æ·»åŠ lable color=blue kubectl label node node01 color=blue ä½¿ç”¨labelå®ç°ä¸€ä¸ªdeploymentä¸­çš„podè°ƒåº¦äº²å’Œ\n--- apiVersion: apps/v1 kind: Deployment metadata: name: blue spec: replicas: 3 selector: matchLabels: run: nginx template: metadata: labels: run: nginx spec: containers: - image: nginx imagePullPolicy: Always name: nginx affinity: nodeAffinity: requiredDuringSchedulingIgnoredDuringExecution: nodeSelectorTerms: - matchExpressions: - key: color operator: In values: - blue é‡åˆ°podå®šä¹‰çš„èµ„æºä¸è¶³ä»¥è¿è¡Œ\nkubectl get pod elephant -o yaml \u0026gt; ele.yaml # ç¼–è¾‘èµ„æºrequestå kubectl replace -f ele.yaml --force podé€šè¿‡schedulerNameæŒ‡å®šè°ƒåº¦å™¨\n--- apiVersion: v1 kind: Pod metadata: name: nginx spec: schedulerName: my-scheduler containers: - image: nginx name: nginx åº¦é‡å’Œæ—¥å¿—Metric \u0026amp; Log Metrics # Metricsåº¦é‡ git clone https://github.com/kodekloudhub/kubernetes-metrics-server.git cd kubernetes-metrics-server/ kubectl create -f . # wait a minute kubectl top node # cpuå ç”¨æœ€é«˜çš„èŠ‚ç‚¹ kubectl top node --sort-by=\u0026#39;cpu\u0026#39; --no-headers | head -1 # å†…å­˜å ç”¨æœ€é«˜çš„èŠ‚ç‚¹ kubectl top node --sort-by=\u0026#39;memory\u0026#39; --no-headers | head -1 # å†…å­˜å ç”¨æœ€å¤šçš„pod kubectl top pod --sort-by=\u0026#39;memory\u0026#39; --no-headers | head -1 # å†…å­˜å ç”¨æœ€å°‘çš„pod kubectl top pod --sort-by=\u0026#39;memory\u0026#39; --no-headers | tail -1 Log # æŸ¥çœ‹podæ—¥å¿— kubectl logs \u0026lt;pod-name\u0026gt; # æŒ‡å®špodä¸­å®¹å™¨æŸ¥çœ‹æ—¥å¿—ï¼ˆä¸€ä¸ªpodå¯ä»¥æœ‰å¤šä¸ªcontainerï¼‰ kubectl logs \u0026lt;pod-name\u0026gt; -c \u0026lt;container-name\u0026gt; # ç™»å…¥podä¸­æŒ‡å®šçš„å®¹å™¨ kubectl exec -it \u0026lt;pod-name\u0026gt; -c \u0026lt;container-name\u0026gt; -- /bin/bash åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç† æ›´æ–°deploymentç‰ˆæœ¬ # æŸ¥çœ‹deploymentçš„ç­–ç•¥ k describe deploy \u0026lt;deployment-name\u0026gt; | grep StrategyType # RollingUpdateæ„å‘³ç€ä¸€æ¬¡åªæ›´æ–°éƒ¨åˆ†pod # Recreateæ„å‘³ç€åŒæ—¶ç»ˆæ­¢podå¹¶é‡æ–°åˆ›å»º k describe deploy \u0026lt;deployment-name\u0026gt; | grep RollingUpdateStrategy # 25% max unavailable, 25% max surgeæ„å‘³ç€æœ€å¤šå¯ä»¥åŒæ—¶ç»ˆæ­¢25%çš„pod # æ›´æ–°deploymentçš„é•œåƒ k edit deploy \u0026lt;deployment-name\u0026gt; å‘½ä»¤è¡Œ æŒ‡å®šå®¹å™¨å‘½ä»¤è¡Œ\napiVersion: v1 kind: Pod metadata: name: ubuntu-sleeper-2 spec: containers: - name: ubuntu image: ubuntu command: - \u0026#34;sleep\u0026#34; - \u0026#34;5000\u0026#34; apiVersion: v1 kind: Pod metadata: name: webapp-green labels: name: webapp-green spec: containers: - name: simple-webapp image: kodekloud/webapp-color command: [\u0026#34;python\u0026#34;, \u0026#34;app.py\u0026#34;] args: [\u0026#34;--color\u0026#34;, \u0026#34;pink\u0026#34;] Secret # åˆ—å‡ºsecrets k get secrets # æŸ¥çœ‹secretè¯¦æƒ… k describe secrets \u0026lt;secret-name\u0026gt; # åˆ›å»ºsecretï¼Œåä¸ºdb-secret kubectl create secret generic db-secret --from-literal=DB_Host=sql01 --from-literal=DB_User=root podä½¿ç”¨secret\n--- apiVersion: v1 kind: Pod metadata: labels: name: webapp-pod name: webapp-pod namespace: default spec: containers: - image: kodekloud/simple-webapp-mysql imagePullPolicy: Always name: webapp envFrom: - secretRef: name: db-secret Multi Container apiVersion: v1 kind: Pod metadata: creationTimestamp: null labels: run: yellow name: yellow spec: containers: - image: busybox name: lemon resources: {} command: [\u0026#34;sleep\u0026#34;, \u0026#34;1000\u0026#34;] - image: redis name: gold resources: {} dnsPolicy: ClusterFirst restartPolicy: Always status: {} å¤šå®¹å™¨å…±äº«æ–‡ä»¶ç³»ç»Ÿ\n--- apiVersion: v1 kind: Pod metadata: name: app namespace: elastic-stack labels: name: app spec: containers: - name: app image: kodekloud/event-simulator volumeMounts: - mountPath: /log name: log-volume - name: sidecar image: kodekloud/filebeat-configured volumeMounts: - mountPath: /var/log/event-simulator/ name: log-volume volumes: - name: log-volume hostPath: # directory location on host path: /var/log/webapp # this field is optional type: DirectoryOrCreate Init Container --- apiVersion: v1 kind: Pod metadata: name: red namespace: default spec: containers: - command: - sh - -c - echo The app is running! \u0026amp;\u0026amp; sleep 3600 image: busybox:1.28 name: red-container initContainers: - image: busybox name: red-initcontainer command: - \u0026#34;sleep\u0026#34; - \u0026#34;20\u0026#34; Cluster ç»´æŠ¤ å‡çº§OS # å‡çº§node01ï¼Œé¦–å…ˆæ¸…ç©ºnode01ä¸Šçš„pod # æ•ˆæœ pod evicted, node drained # drainä¼šé»˜è®¤å°†node cordonï¼Œå³ä¸å¯è°ƒåº¦ kubectl drain node01 --ignore-daemonsets # node01ç»´æŠ¤å®Œæ¯•åï¼Œå°†node01è®¾ç½®ä¸ºå¯è°ƒåº¦ kubectl uncordon node01 # NOTE: drainåªèƒ½å¤„ç†replicasetï¼Œå•ç‹¬çš„podéœ€è¦å¼ºåˆ¶æ‰§è¡Œ k drain node01 --ignore-daemonsets --force # å¯¹ä¸å±äºreplicasetçš„podï¼Œå°†ä¼šæ°¸ä¹…ä¸¢å¤± # å°†node01è®¾ç½®ä¸å¯è°ƒåº¦ kubectl cordon node01 å‡çº§K8S # æŸ¥çœ‹æ§åˆ¶èŠ‚ç‚¹ç‰ˆæœ¬ k version --short # æŸ¥çœ‹nodeç‰ˆæœ¬ï¼Œå½“å‰1.26 k get nodes # æŸ¥çœ‹è¿œç«¯å¯å‡çº§ç‰ˆæœ¬ kubeadm upgrade plan # æœ‰ä¸¤ä¸ªnodeåˆ†åˆ«æ˜¯controlplaneå’Œnode01 # å…ˆæ¸…ç©ºcontrolplaneçš„pod kubectl drain controlplane --ignore-daemonsets # å¼€å§‹å‡çº§controlplane apt update # é¦–å…ˆå‡çº§kubeadm apt-get install kubeadm=1.27.0-00 kubeadm upgrade apply v1.27.0 # å‡çº§å‘½ä»¤è¡Œ apt-get install kubelet=1.27.0-00 # é‡å¯æœåŠ¡ systemctl daemon-reload systemctl restart kubelet # controlplaneå‡çº§å®Œæ¯•ï¼Œæ ‡è®°ä¸ºå¯è°ƒåº¦ kubectl uncordon controlplane # éœ€è¦è§£é™¤controlplaneçš„taint k drain node01 # æ¥ç€sshç™»å½•åˆ°node01ä¸Šï¼Œå‡çº§node01 apt-get update apt-get install kubeadm=1.27.0-00 kubeadm upgrade node apt-get install kubelet=1.27.0-00 systemctl daemon-reload systemctl restart kubelet # æœ€åè®©node01å¯è°ƒåº¦ kubectl uncordon node01 å¤‡ä»½æ¢å¤ # æŸ¥çœ‹etcdç‰ˆæœ¬ï¼ˆæŸ¥çœ‹æ—¥å¿—æˆ–è€…é•œåƒï¼‰ kubectl -n kube-system logs etcd-controlplane | grep -i \u0026#39;etcd-version\u0026#39; kubectl -n kube-system describe pod etcd-controlplane | grep Image: # æŸ¥çœ‹etcdçš„endpoint kubectl -n kube-system describe pod etcd-controlplane | grep \u0026#39;\\--listen-client-urls\u0026#39; # æŸ¥çœ‹etcdçš„certæ–‡ä»¶ kubectl -n kube-system describe pod etcd-controlplane | grep \u0026#39;\\--cert-file\u0026#39; # æŸ¥çœ‹etcdçš„ca certæ–‡ä»¶ kubectl -n kube-system describe pod etcd-controlplane | grep \u0026#39;\\--trusted-ca-file\u0026#39; # åœ¨ç»´æŠ¤æˆ–è€…å¯¹ç¯å¢ƒåšæ“ä½œå‰å…ˆå¤‡ä»½etcd ETCDCTL_API=3 etcdctl --endpoints=https://[127.0.0.1]:2379 \\ --cacert=/etc/kubernetes/pki/etcd/ca.crt \\ --cert=/etc/kubernetes/pki/etcd/server.crt \\ --key=/etc/kubernetes/pki/etcd/server.key \\ snapshot save /opt/snapshot-pre-boot.db # åœ¨ç»´æŠ¤çª—å£æœŸé—´ä¸¢å¤±äº†ä¸€äº›podæˆ–deploymentï¼Œéœ€è¦æ¢å¤ # é¦–å…ˆå°†etcdå¿«ç…§æ¢å¤åˆ°ä¸€ä¸ªæ–°çš„ç›®å½• ETCDCTL_API=3 etcdctl --data-dir /var/lib/etcd-from-backup \\ snapshot restore /opt/snapshot-pre-boot.db # ä¿®æ”¹etcdè¿™ä¸ªstaticpodçš„yamlï¼ŒæŒ‡å‘æ¢å¤çš„data-dir vim /etc/kubernetes/manifests/etcd.yaml # ä¿®æ”¹æˆå¦‚ä¸‹ï¼Œå°†etcd-dataè¿™ä¸ªvolumeæŒ‡å‘hostPath: /var/lib/etcd-from-backup # volumes: # - hostPath: # path: /var/lib/etcd-from-backup # type: DirectoryOrCreate # name: etcd-data # æ›´æ–°yamlåï¼Œetcdä¼šè‡ªåŠ¨é‡å»ºï¼Œè‹¥etcdä¸€ç›´PENDINGï¼Œæ‰‹åŠ¨åˆ é™¤è§¦å‘é‡å¯ kubectl delete pod -n kube-system etcd-controlplane å¤šcluster\n# æŸ¥çœ‹clusterä¿¡æ¯ kubectl config view # æˆ–è€… kubectl config get-clusters # æŸ¥çœ‹å½“å‰çš„cluster kubectl config view | grep current-context # åˆ‡æ¢cluster kubectl config use-context cluster2 # Type1: Stacked ETCD Topology # å¦‚ä¸‹å‘½ä»¤å¯ä»¥åœ¨clusterä¸­æŸ¥æ‰¾åˆ°etcdçš„pod kubectl get pods -n kube-system | grep etcd kubectl -n kube-system describe pod etcd-cluster1-controlplane # Type2: External ETCD # clusterå†…æ²¡æœ‰etcdçš„podï¼Œkube-apiserverç›´æ¥æŒ‡å‘ä¸€ä¸ªå¤–éƒ¨çš„etcd endpoint ps -aux | grep etcd # æŸ¥çœ‹ETCDé›†ç¾¤çš„members ETCDCTL_API=3 etcdctl \\ --endpoints=https://127.0.0.1:2379 \\ --cacert=/etc/etcd/pki/ca.pem \\ --cert=/etc/etcd/pki/etcd.pem \\ --key=/etc/etcd/pki/etcd-key.pem \\ member list # å¤‡ä»½Stacked ETCD kubectl config use-context cluster1 kubectl describe pods -n kube-system etcd-cluster1-controlplane | grep advertise-client-urls # --advertise-client-urls=https://10.1.218.16:2379 kubectl describe pods -n kube-system etcd-cluster1-controlplane | grep pki # --cert-file=/etc/kubernetes/pki/etcd/server.crt # --key-file=/etc/kubernetes/pki/etcd/server.key # --peer-cert-file=/etc/kubernetes/pki/etcd/peer.crt # --peer-key-file=/etc/kubernetes/pki/etcd/peer.key # --peer-trusted-ca-file=/etc/kubernetes/pki/etcd/ca.crt # --trusted-ca-file=/etc/kubernetes/pki/etcd/ca.crt # /etc/kubernetes/pki/etcd from etcd-certs (rw) # Path: /etc/kubernetes/pki/etcd # ç™»å½•åˆ°etcd podæ‰€åœ¨çš„èŠ‚ç‚¹ ETCDCTL_API=3 etcdctl --endpoints=https://10.1.220.8:2379 --cacert=/etc/kubernetes/pki/etcd/ca.crt --cert=/etc/kubernetes/pki/etcd/server.crt --key=/etc/kubernetes/pki/etcd/server.key snapshot save /opt/cluster1.db # æ¢å¤External ETCD ETCDCTL_API=3 etcdctl --endpoints=https://127.0.0.1:2379 --cacert=/etc/etcd/pki/ca.pem --cert=/etc/etcd/pki/etcd.pem --key=/etc/etcd/pki/etcd-key.pem snapshot restore /root/cluster2.db --data-dir /var/lib/etcd-data-new systemctl status etcd.service vim /etc/systemd/system/etcd.service systemctl daemon-reload # serviceçš„Useræ˜¯etcdï¼Œä¿®æ”¹æ–‡ä»¶æƒé™ chown -R etcd:etcd /var/lib/etcd-data-new systemctl restart etcd # æ¨èé‡å¯æ§åˆ¶å¹³é¢çš„pod(kube-scheduler, kube-controller-manager, kubelet) å®‰å…¨Security TLSå’Œè¯ä¹¦ä»‹ç» Certificate: Data: Version: 3 (0x2) Serial Number: 3478545236123834268 (0x304646764e49d79c) Signature Algorithm: sha256WithRSAEncryption Issuer: CN = kubernetes Validity Not Before: Dec 1 12:24:30 2023 GMT Not After : Nov 30 12:24:30 2024 GMT Subject: CN = kube-apiserver Subject Public Key Info: Public Key Algorithm: rsaEncryption RSA Public-Key: (2048 bit) Modulus: 00:ce:fc:11:8c:a0:2c:83:2d:20:b2:47:83:dc:38: ec:3f:7f:b5:9a:09:c8:a5:7a:16:7a:c7:2d:1d:62: ae:a6:02:7e:d0:be:6a:c6:fd:71:d3:1a:a8:fd:9b: 4d:11:45:f1:21:aa:20:a1:9d:4e:d7:be:f1:22:25: a9:82:52:87:f8:e5:ce:d5:30:e6:1f:99:a5:13:56: e1:38:e3:68:f5:54:de:67:e1:d1:7e:7a:30:12:6c: 48:fd:d9:89:95:07:2a:51:8e:d8:fa:0c:02:79:54: c4:8f:16:42:b1:f4:a9:0e:ac:83:20:f7:d4:eb:c6: 8f:e2:74:2a:03:c7:2a:b6:d9:c4:ea:28:3c:b8:14: 3f:dd:f0:d9:d9:b2:1f:6c:89:93:0b:37:cd:1b:57: 1c:8e:53:fe:d1:40:f5:80:ee:2d:8d:c6:ce:c2:39: 03:d6:c7:aa:61:cb:b5:8d:5c:d6:73:99:ef:c8:6b: 87:ac:0e:3b:59:bb:ec:e2:c5:04:54:4b:ad:d5:da: 48:16:f5:15:0c:bb:29:fe:13:c7:ed:29:dc:bc:01: b5:ac:dd:84:c9:01:e1:fc:40:1e:8f:c5:4a:82:c5: 69:3a:4a:54:b3:22:c6:4b:61:78:54:59:e9:21:ef: a9:5d:cf:a1:b4:c8:f2:18:4e:6a:03:d3:44:3c:be: 9e:d9 Exponent: 65537 (0x10001) X509v3 extensions: X509v3 Key Usage: critical Digital Signature, Key Encipherment X509v3 Extended Key Usage: TLS Web Server Authentication X509v3 Basic Constraints: critical CA:FALSE X509v3 Authority Key Identifier: keyid:27:89:3A:1C:08:4F:74:4E:60:20:1A:44:E0:47:AC:D6:F9:05:93:E5 X509v3 Subject Alternative Name: DNS:controlplane, DNS:kubernetes, DNS:kubernetes.default, DNS:kubernetes.default.svc, DNS:kubernetes.default.svc.cluster.local, IP Address:10.96.0.1, IP Address:192.21.43.6 Signature Algorithm: sha256WithRSAEncryption 8e:75:b2:8e:47:5c:8f:a1:6c:c8:49:da:ef:e0:09:09:6d:cf: ddğŸ’¿35:f0:e2:df:b2ğŸ‡©ğŸ‡ªb0:f0:8a:0a:4b:4b:32:7e:46:45: 6b:0b:52:7b:8d:ad:17:67:59:fb:7d:68:86:2b:d1:91:7d:99: c8:ff:d2:17:46:a0:92:ae:3c:55:9a:e4:f5:ee:59:48:a5:2a: 93:4d:8d:02:ba:02:73:f6:07:36:2a:5a:99:4a:33:52:ce:36: ea:44:29:19:cb:d1:6f:4a:db:1f:d9:47:7e:8c:e7:2b:6a:7f: 11:43:57:f1:f6:7a:19:c1:b6:ff:81:37:71:3a:f6:14:d5:63: ab:9d:31:f7:bc:4c:0a:19:fb:36:d7:84:f2:1c:fd:c5:fc:8d: 83:b0:8f:ec:1b:9c:ae:57:4f:f1:96:f5:45:f5:c5:4e:8f:a0: ac:04:97:fa:87:2c:0d:5c:83:a9:d8:94:2f:d5:64:8d:ec:13: c6:b4:93:d2:29:f9:87:23:a0:90:7b:68:8c:d6:5c:fd:a3:97: 96:68:a7:e0:2a:22:8b:a9:d4:01:fc:f5:06:39:7f:63:6b:33: 8e:3f:6b:23:18:9c:c8:7c:0f:0c:c1:4c:73:3f:a3:c2:d7:ea: cb:2a:a8:5d:86:a1:0d:4a:5e:12:51:ba:6c:1e:1c:20:75:d6: 5f:62:5f:d3 è¯ä¹¦æŸ¥çœ‹ # æŸ¥çœ‹kube-apiçš„certæ–‡ä»¶ cat /etc/kubernetes/manifests/kube-apiserver.yaml | grep tls-cert-file # æŸ¥çœ‹certfileè¯¦æƒ… openssl x509 -in ./apiserver.crt -text -noout # kube-apiæ•…éšœï¼Œæ’æŸ¥é—®é¢˜ # åˆ—å‡ºæ‰€æœ‰çš„å®¹å™¨ crictl ps -a crictl ps -a | grep kube-api crictl logs \u0026lt;container-id\u0026gt; CertificateSigningRequest # æœ‰ç­¾åæ–‡ä»¶akshay.csrï¼Œå…ˆbase64ç¼–ç  cat akshay.csr | base64 -w 0 # æŒ‰ç…§å¦‚ä¸‹yamlï¼Œæ‰§è¡Œk applyåˆ›å»ºcsr # æŸ¥çœ‹csrï¼Œåˆšåˆ›å»ºçš„çŠ¶æ€æ˜¯Pending k get certificatesigningrequests k get csr # æˆæƒï¼ŒæˆæƒåçŠ¶æ€æ˜¯Approved,Issued k certificate approve \u0026lt;csr-name\u0026gt; # æ‹’ç» csr kubectl certificate deny \u0026lt;csr-name\u0026gt; # åˆ é™¤csr k delete csr \u0026lt;csr-name\u0026gt; # æŸ¥çœ‹csrè¯¦æƒ… k get csr \u0026lt;csr-name\u0026gt; -o yaml --- apiVersion: certificates.k8s.io/v1 kind: CertificateSigningRequest metadata: name: akshay spec: groups: - system:authenticated request: \u0026lt;Paste the base64 encoded value of the CSR file\u0026gt; signerName: kubernetes.io/kube-apiserver-client usages: - client auth Kube Config Client-certificateï¼ˆå®¢æˆ·ç«¯è¯ä¹¦ï¼‰å’Œclient-keyï¼ˆå®¢æˆ·ç«¯å¯†é’¥ï¼‰æ˜¯åœ¨SSL/TLSé€šä¿¡ä¸­ç”¨äºå®¢æˆ·ç«¯èº«ä»½éªŒè¯çš„ä¸¤ä¸ªé‡è¦ç»„ä»¶ã€‚\nå®¢æˆ·ç«¯è¯ä¹¦æ˜¯ä¸€ç§æ•°å­—è¯ä¹¦ï¼Œç”¨äºéªŒè¯å®¢æˆ·ç«¯çš„èº«ä»½ã€‚å®ƒåŒ…å«äº†å®¢æˆ·ç«¯çš„å…¬é’¥ä»¥åŠä¸ä¹‹ç›¸å…³è”çš„èº«ä»½ä¿¡æ¯ï¼Œé€šå¸¸ç”±è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰ç­¾å‘ã€‚å®¢æˆ·ç«¯è¯ä¹¦å¯ä»¥è¢«æœåŠ¡å™¨ç”¨æ¥éªŒè¯å®¢æˆ·ç«¯çš„èº«ä»½ï¼Œç¡®ä¿é€šä¿¡åŒæ–¹çš„åˆæ³•æ€§å’Œå®‰å…¨æ€§ã€‚\nå®¢æˆ·ç«¯å¯†é’¥æ˜¯å®¢æˆ·ç«¯è¯ä¹¦ä¸­åŒ…å«çš„ç§é’¥éƒ¨åˆ†ã€‚ç§é’¥æ˜¯ä¸€ç§åŠ å¯†å¯†é’¥ï¼Œç”¨äºå¯¹æ•°æ®è¿›è¡Œç­¾åå’Œè§£å¯†ã€‚å®¢æˆ·ç«¯ä½¿ç”¨ç§é’¥å¯¹æ•°æ®è¿›è¡Œç­¾åï¼ŒæœåŠ¡å™¨ä½¿ç”¨å®¢æˆ·ç«¯è¯ä¹¦ä¸­çš„å…¬é’¥å¯¹ç­¾åè¿›è¡ŒéªŒè¯ï¼Œä»è€Œç¡®è®¤å®¢æˆ·ç«¯çš„èº«ä»½ã€‚\nåœ¨SSL/TLSé€šä¿¡ä¸­ï¼Œå®¢æˆ·ç«¯è¯ä¹¦å’Œå®¢æˆ·ç«¯å¯†é’¥é€šå¸¸ä¸€èµ·ä½¿ç”¨ï¼Œä»¥ç¡®ä¿é€šä¿¡çš„å®‰å…¨æ€§å’Œå®Œæ•´æ€§ã€‚å®¢æˆ·ç«¯è¯ä¹¦ç”¨äºéªŒè¯å®¢æˆ·ç«¯çš„èº«ä»½ï¼Œå®¢æˆ·ç«¯å¯†é’¥ç”¨äºç”Ÿæˆæ•°å­—ç­¾åä»¥è¿›è¡Œèº«ä»½éªŒè¯å’Œæ•°æ®åŠ å¯†ã€‚\nè¿™ä¸‰ä¸ªæ–‡ä»¶ååç¼€åˆ†åˆ«ä»£è¡¨ä»¥ä¸‹å«ä¹‰ï¼š\n.crtï¼šä»£è¡¨è¯ä¹¦æ–‡ä»¶ï¼ŒåŒ…å«äº†å…¬é’¥å’Œè¯ä¹¦ç›¸å…³ä¿¡æ¯ã€‚ .csrï¼šä»£è¡¨è¯ä¹¦ç­¾åè¯·æ±‚æ–‡ä»¶ï¼ŒåŒ…å«äº†å…¬é’¥å’Œä¸€äº›ä¸ªäººä¿¡æ¯ï¼Œç”¨äºå‘è¯ä¹¦é¢å‘æœºæ„ç”³è¯·ç­¾åã€‚ .keyï¼šä»£è¡¨å¯†é’¥æ–‡ä»¶ï¼ŒåŒ…å«äº†ä¸è¯ä¹¦ç›¸å…³çš„ç§é’¥ä¿¡æ¯ã€‚ è¿™ä¸‰ä¸ªæ–‡ä»¶ä¹‹é—´çš„å…³è”æ€§åœ¨äºï¼š\nè¯ä¹¦ç­¾åè¯·æ±‚æ–‡ä»¶ï¼ˆ.csrï¼‰æ˜¯ç”¨æ¥å‘è¯ä¹¦é¢å‘æœºæ„ç”³è¯·ç­¾åçš„ï¼Œå…¶ä¸­åŒ…å«äº†å…¬é’¥å’Œä¸€äº›ä¸ªäººä¿¡æ¯ã€‚ è¯ä¹¦æ–‡ä»¶ï¼ˆ.crtï¼‰æ˜¯ç”±è¯ä¹¦é¢å‘æœºæ„ç­¾ååçš„è¯ä¹¦ï¼ŒåŒ…å«äº†å…¬é’¥å’Œè¯ä¹¦ç›¸å…³ä¿¡æ¯ã€‚ å¯†é’¥æ–‡ä»¶ï¼ˆ.keyï¼‰åŒ…å«äº†ä¸è¯ä¹¦ç›¸å…³çš„ç§é’¥ä¿¡æ¯ï¼Œç”¨äºä¸è¯ä¹¦è¿›è¡Œé…å¯¹ï¼Œä»¥è¿›è¡ŒåŠ å¯†å’Œè§£å¯†æ“ä½œã€‚ è¿™ä¸‰ä¸ªæ–‡ä»¶é€šå¸¸ä¸€èµ·ä½¿ç”¨ï¼Œä»¥å»ºç«‹å®‰å…¨çš„é€šä¿¡è¿æ¥å’Œè¿›è¡ŒåŠ å¯†æ“ä½œã€‚\n# configé»˜è®¤æ–‡ä»¶è·¯å¾„ ls ~/.kube/config # æŸ¥çœ‹æ‰€æœ‰cluster k config view # æŒ‡å®šconfigæ–‡ä»¶ kubectl config view --kubeconfig \u0026lt;config-file-path\u0026gt; # æŸ¥çœ‹configä¸­çš„current-context kubectl config current-context --kubeconfig \u0026lt;config-file-path\u0026gt; # åˆ‡æ¢context kubectl config --kubeconfig=\u0026lt;config-file-path\u0026gt; use-context \u0026lt;new-context-name\u0026gt; # å°†è‡ªå®šä¹‰çš„configæ–‡ä»¶æ›¿æ¢~/.kube/configæ–‡ä»¶ï¼Œå³å¯è®¾ç½®ä¸ºé»˜è®¤çš„config RBAC # æŸ¥çœ‹kube-apiçš„authorization-mode kubectl describe pod kube-apiserver-controlplane -n kube-system | grep mode # åˆ—å‡ºroles k get roles # åˆ—å‡ºæ‰€æœ‰namespaceçš„roles k get roles.rbac.authorization.k8s.io --all-namespaces --no-headers # æŸ¥çœ‹rolesè¯¦æƒ… k describe roles \u0026lt;role-name\u0026gt; # åˆ—å‡ºrolebinding k get rolebindings --all-namespaces # æŸ¥çœ‹rolebindingè¯¦æƒ… k describe rolebindings \u0026lt;rolebinding-name\u0026gt; -n kube-system # æŸ¥çœ‹config k config view # æŒ‡å®šconfigä¸­çš„ç”¨æˆ·æ‰§è¡Œkubectlå‘½ä»¤ k get pods --as \u0026lt;user-name\u0026gt; # ä¸Šè¿°å‘½ä»¤æ‰§è¡ŒæŠ¥é”™ï¼Œç”¨æˆ·æ— æƒé™ï¼Œéœ€è¦åˆ›å»ºroleå’Œrolebinding # åˆ›å»ºä¸€ä¸ªroleï¼Œåä¸ºdeveloper k create role developer --namespace=default --verb=list,create,delete --resource=pod --dry-run=client -o yaml # åˆ›å»ºrolebindingï¼Œå°†deveploerç»‘å®šåˆ°ç”¨æˆ·dev-userä¸Š kubectl create rolebinding dev-user-binding --namespace=default --role=developer --user=dev-user # ç¼–è¾‘roleçš„æƒé™ï¼Œç¼–è¾‘åæ— éœ€é‡æ–°binding k edit role \u0026lt;role-name\u0026gt; Cluster Role # åˆ—å‡ºclusterrole k get clusterrole # åˆ—å‡ºclusterrolebinding k get clusterrolebindings # æŸ¥çœ‹ç¯å¢ƒä¸­clusteræ•°é‡ k get clusterrole --no-headers | wc -l # æŸ¥çœ‹clusterrolebindingæ•°é‡ k get clusterrolebindings.rbac.authorization.k8s.io --no-headers | wc -l # æŸ¥çœ‹æ‰€æœ‰ä¸namspaceæ— å…³çš„resource k api-resources --namespaced=false # æŸ¥çœ‹clusterroleè¯¦æƒ… k describe clusterrole \u0026lt;clusterrole-name\u0026gt; # æŸ¥çœ‹clusterrolebindingè¯¦æƒ… k describe clusterrolebindings.rbac.authorization.k8s.io \u0026lt;name\u0026gt; # åˆ›å»ºä¸€ä¸ªç®¡ç†nodeçš„clusterrole k create clusterrole nodeadmin --resource=nodes --verb=get,watch,list,create,delete --dry-run=client -o yaml # åˆ›å»ºclusterrolebinding k create clusterrolebinding michella-binding --clusterrole nodeadmin --user=michelle --dry-run=client -o yaml # æµ‹è¯•æ˜¯å¦æœ‰æ‰§è¡Œæƒé™ kubectl auth can-i list nodes --as michelle # éœ€è¦ç»™michelleç”¨æˆ·å¢åŠ æƒé™ï¼Œæ–°å»ºå­˜å‚¨ç›¸å…³çš„clusterroleå’Œbinding k create clusterrole storage-admin --resource=persistentvolumes,storageclasses --verb=get,watch,list,create,delete --dry-run=client -o yaml k create clusterrolebinding michelle-storage-admin --clusterrole=storage-admin --user=michelle --dry-run=client -o yaml Service Account # è·å–æ‰€æœ‰service account k get serviceaccounts k get sa # æŸ¥çœ‹service accountè¯¦æƒ… k describe sa \u0026lt;sa-name\u0026gt; # æŸ¥çœ‹podçš„serviceaccount k get po web-dashboard-97c9c59f6-vmw8g -o yaml | grep -i account # åˆ›å»ºä¸€ä¸ªserviceaccount k create serviceaccount dashboard-sa # ç”¨å¦‚ä¸‹yamlä¸ºserviceaccountåˆ›å»ºroleå’Œrolebindingèµ‹äºˆæƒé™ # ä¸ºdashboard-saè¿™ä¸ªservice accountåˆ›å»ºtoken kubectl create token dashboard-sa # ç¼–è¾‘deploymentçš„serviceaccountï¼ˆé»˜è®¤æ˜¯defaultï¼‰ k edit deployments.apps web-dashboard # æˆ–è€… k set serviceaccount deploy/web-dashboard dashboard-sa --- kind: Role apiVersion: rbac.authorization.k8s.io/v1 metadata: namespace: default name: pod-reader rules: - apiGroups: - \u0026#39;\u0026#39; resources: - pods verbs: - get - watch - list --- kind: RoleBinding apiVersion: rbac.authorization.k8s.io/v1 metadata: name: read-pods namespace: default subjects: - kind: ServiceAccount name: dashboard-sa # Name is case sensitive namespace: default roleRef: kind: Role #this must be Role or ClusterRole name: pod-reader # this must match the name of the Role or ClusterRole you wish to bind to apiGroup: rbac.authorization.k8s.io Image Secret # åº”ç”¨ä½¿ç”¨ç§æœ‰ä»“åº“çš„é•œåƒ k create secret --help # åˆ›å»ºdocker-registryç±»å‹çš„å¯†é’¥ k create secret docker-registry private-reg-cred --docker-username=dock_user --docker-password=dock_passwd --docker-server=myprivateregistry.com:5000 --docker-email=dock_user@myprivateregistry.com apiVersion: apps/v1 kind: Deployment metadata: annotations: deployment.kubernetes.io/revision: \u0026#34;3\u0026#34; creationTimestamp: \u0026#34;2023-12-02T13:18:12Z\u0026#34; generation: 3 labels: app: web name: web namespace: default resourceVersion: \u0026#34;2598\u0026#34; uid: b375109f-b184-4cb1-9a80-425f1a940e3d spec: progressDeadlineSeconds: 600 replicas: 2 revisionHistoryLimit: 10 selector: matchLabels: app: web strategy: rollingUpdate: maxSurge: 25% maxUnavailable: 25% type: RollingUpdate template: metadata: creationTimestamp: null labels: app: web spec: containers: - image: myprivateregistry.com:5000/nginx:alpine imagePullPolicy: IfNotPresent name: nginx resources: {} terminationMessagePath: /dev/termination-log terminationMessagePolicy: File dnsPolicy: ClusterFirst imagePullSecrets: - name: private-reg-cred restartPolicy: Always schedulerName: default-scheduler securityContext: {} terminationGracePeriodSeconds: 30 Security Context # æ‰§è¡ŒwhoamiæŸ¥çœ‹å®¹å™¨å†…éƒ¨çš„æ‰§è¡Œç”¨æˆ· kubectl exec \u0026lt;pod-name\u0026gt; -- whoami # å¼ºåˆ¶åˆ é™¤pod kubectl delete pod \u0026lt;pod-name\u0026gt; --force # æ›´æ–°security contextå¿…é¡»å…ˆåˆ é™¤å†æ–°å»ºpodï¼Œå¯ä»¥ç”¨k replaceå‘½ä»¤ # ç¼–è¾‘å¦‚ä¸‹yamlï¼Œå®¹å™¨å†…ç”¨user ID 1010æ‰§è¡Œsleepå‘½ä»¤ --- apiVersion: v1 kind: Pod metadata: name: ubuntu-sleeper namespace: default spec: securityContext: runAsUser: 1010 containers: - command: - sleep - \u0026#34;4800\u0026#34; image: ubuntu name: ubuntu-sleeper securityContext: capabilities: add: [\u0026#34;SYS_TIME\u0026#34;] ä¸åŒlevelçš„context\napiVersion: v1 kind: Pod metadata: name: multi-pod spec: securityContext: runAsUser: 1001 containers: - image: ubuntu name: web command: [\u0026#34;sleep\u0026#34;, \u0026#34;5000\u0026#34;] securityContext: runAsUser: 1002 - image: ubuntu name: sidecar command: [\u0026#34;sleep\u0026#34;, \u0026#34;5000\u0026#34;] ç¼–è¾‘å¦‚ä¸‹yamlï¼Œä¸ºå®¹å™¨å¢åŠ SYS_TIMEçš„èƒ½åŠ›\n--- apiVersion: v1 kind: Pod metadata: name: ubuntu-sleeper namespace: default spec: containers: - command: - sleep - \u0026#34;4800\u0026#34; image: ubuntu name: ubuntu-sleeper securityContext: capabilities: add: [\u0026#34;SYS_TIME\u0026#34;] Network Policy # åˆ—å‡ºnetworkpolicy k get networkpolicies.networking.k8s.io k get netpol # æŸ¥çœ‹netpolè¯¦æƒ… k describe netpol \u0026lt;netpol-name\u0026gt; # ä½¿ç”¨netpolä¸­å¯¹åº”çš„selectoræŸ¥è¯¢åº”ç”¨çš„pod k get pods --selector name=payroll # æˆ–è€… k get po --show-labels # åˆ›å»ºnetwork policyä½¿å¾—Internalåªèƒ½è®¿é—®mysqlå’Œpayroll # æ³¨æ„åŒæ—¶æ”¾å¼€äº†53ç«¯å£ï¼Œå› ä¸ºéœ€è¦é€šè¿‡53ç«¯å£è®¿é—®DNS # ä½¿ç”¨å¦‚ä¸‹yamlå®ç° apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: internal-policy namespace: default spec: podSelector: matchLabels: name: internal policyTypes: - Egress - Ingress ingress: - {} egress: - to: - podSelector: matchLabels: name: mysql ports: - protocol: TCP port: 3306 - to: - podSelector: matchLabels: name: payroll ports: - protocol: TCP port: 8080 - ports: - port: 53 protocol: UDP - port: 53 protocol: TCP å­˜å‚¨Storage Persistent Volume Claim # æŸ¥çœ‹podå†…çš„æ—¥å¿— kubectl exec \u0026lt;pod-name\u0026gt; -- cat /log/app.log # ä¸ºpodæ·»åŠ æŒä¹…åŒ–çš„æ—¥å¿—å· kubectl get po webapp -o yaml \u0026gt; webapp.yaml # é…ç½®hostpathç±»å‹çš„volume apiVersion: v1 kind: Pod metadata: name: webapp spec: containers: - name: event-simulator image: kodekloud/event-simulator env: - name: LOG_HANDLERS value: file volumeMounts: - mountPath: /log name: log-volume volumes: - name: log-volume hostPath: # directory location on host path: /var/log/webapp # this field is optional type: Directory ç”¨å¦‚ä¸‹yamlåˆ›å»ºPersistent Volume\napiVersion: v1 kind: PersistentVolume metadata: name: pv-log spec: persistentVolumeReclaimPolicy: Retain accessModes: - ReadWriteMany capacity: storage: 100Mi hostPath: path: /pv/log åˆ›å»ºPersistent Volume Claim\nkind: PersistentVolumeClaim apiVersion: v1 metadata: name: claim-log-1 spec: accessModes: - ReadWriteOnce resources: requests: storage: 50Mi # åˆ—å‡ºpersistent volume k get persistentvolume k get pv # åˆ—å‡ºpersistent volume claim k get pvc k get persistentvolumeclaims # åˆ—å‡ºå¤šç§èµ„æº k get pv,pvc # podä¸­ä½¿ç”¨pvc apiVersion: v1 kind: Pod metadata: name: webapp spec: containers: - name: event-simulator image: kodekloud/event-simulator env: - name: LOG_HANDLERS value: file volumeMounts: - mountPath: /log name: log-volume volumes: - name: log-volume persistentVolumeClaim: claimName: claim-log-1 è¢«podä½¿ç”¨ä¸­çš„PVCæ— æ³•ç›´æ¥åˆ é™¤ï¼Œéœ€è¦ç­‰åˆ°podåˆ é™¤åæ‰èƒ½åˆ æ‰PVC\nStorage Class # åˆ—å‡ºstorage class k get storageclasses.storage.k8s.io k get sc # æŸ¥çœ‹scè¯¦æƒ… k describe sc \u0026lt;sc-name\u0026gt; # åˆ›å»ºstorage classï¼Œä½¿ç”¨å¦‚ä¸‹yaml --- apiVersion: storage.k8s.io/v1 kind: StorageClass metadata: name: delayed-volume-sc provisioner: kubernetes.io/no-provisioner volumeBindingMode: WaitForFirstConsumer æ³¨æ„WaitForFirstConsumeæ¨¡å¼çš„storageï¼Œpvcç»‘å®špvæ—¶ï¼Œä¸ä¼šç«‹åˆ»ç”³è¯·å­˜å‚¨ï¼Œè€Œæ˜¯å¤„äºPENDINGçŠ¶æ€ï¼Œç­‰åˆ°ä½¿ç”¨pvcçš„podè¢«è°ƒåº¦æ—¶ï¼Œæ‰ä¼šå®é™…ä¸Šç”³è¯·å­˜å‚¨\nå¦‚ä¸‹ä¸ºä¸€ä¸ªä½¿ç”¨pvcçš„yaml\n--- apiVersion: v1 kind: Pod metadata: name: nginx labels: name: nginx spec: containers: - name: nginx image: nginx:alpine volumeMounts: - name: local-persistent-storage mountPath: /var/www/html volumes: - name: local-persistent-storage persistentVolumeClaim: claimName: local-pvc ç½‘ç»œNetworking ç½‘ç»œåŸºæœ¬å‘½ä»¤ # æŸ¥çœ‹nodeçš„internal ipåœ°å€ k get nodes -o wide # æŸ¥çœ‹ipåœ°å€å¯¹åº”çš„ç½‘å£ ip a | grep \u0026lt;ip\u0026gt; # æŸ¥çœ‹ç½‘å£çš„macåœ°å€/çŠ¶æ€ ip link show \u0026lt;interface-name\u0026gt; # æŸ¥çœ‹Containerdåˆ›å»ºçš„ç½‘å£(Container Network Interface) ip link | grep cni # æŸ¥çœ‹è·¯ç”±è¡¨ ip route list # æŸ¥çœ‹é»˜è®¤è·¯ç”± # é»˜è®¤è·¯ç”±ï¼šé»˜è®¤è·¯ç”±æ˜¯æŒ‡å½“ç›®æ ‡ç½‘ç»œä¸åœ¨è·¯ç”±è¡¨ä¸­æ—¶ï¼Œæ•°æ®åŒ…å°†è¢«å‘é€åˆ°çš„é»˜è®¤ç½‘å…³ ip route show default # æŸ¥çœ‹kubeæœåŠ¡ç›‘å¬çš„port netstat -ntpl | grep kube # æŸ¥çœ‹etcdçš„tcpç›‘å¬æœåŠ¡ netstat -ntpl | grep etcd # æŸ¥çœ‹etcdçš„æ‰€æœ‰é“¾æ¥ï¼ˆåŒ…å«clientï¼‰ netstat -anp | grep etcd CNI # æŸ¥çœ‹kubeletçš„container runtime endpoint ps aux | grep kubelet | grep runtime # æŸ¥çœ‹cniçš„æ’ä»¶ ls /opt/cni/bin/ # æŸ¥çœ‹å½“å‰clusteré…ç½®çš„cniæ’ä»¶ ls /etc/cni/net.d/ éƒ¨ç½²weave net # éƒ¨ç½²weave-net k apply -f weave-daemonset-k8s.yaml # serviceaccount/weave-net created # clusterrole.rbac.authorization.k8s.io/weave-net created # clusterrolebinding.rbac.authorization.k8s.io/weave-net created # role.rbac.authorization.k8s.io/weave-net created # rolebinding.rbac.authorization.k8s.io/weave-net created # daemonset.apps/weave-net created apiVersion: v1 kind: List items: - apiVersion: v1 kind: ServiceAccount metadata: name: weave-net labels: name: weave-net namespace: kube-system - apiVersion: rbac.authorization.k8s.io/v1 kind: ClusterRole metadata: name: weave-net labels: name: weave-net rules: - apiGroups: - \u0026#39;\u0026#39; resources: - pods - namespaces - nodes verbs: - get - list - watch - apiGroups: - extensions resources: - networkpolicies verbs: - get - list - watch - apiGroups: - \u0026#39;networking.k8s.io\u0026#39; resources: - networkpolicies verbs: - get - list - watch - apiGroups: - \u0026#39;\u0026#39; resources: - nodes/status verbs: - patch - update - apiVersion: rbac.authorization.k8s.io/v1 kind: ClusterRoleBinding metadata: name: weave-net labels: name: weave-net roleRef: kind: ClusterRole name: weave-net apiGroup: rbac.authorization.k8s.io subjects: - kind: ServiceAccount name: weave-net namespace: kube-system - apiVersion: rbac.authorization.k8s.io/v1 kind: Role metadata: name: weave-net namespace: kube-system labels: name: weave-net rules: - apiGroups: - \u0026#39;\u0026#39; resources: - configmaps resourceNames: - weave-net verbs: - get - update - apiGroups: - \u0026#39;\u0026#39; resources: - configmaps verbs: - create - apiVersion: rbac.authorization.k8s.io/v1 kind: RoleBinding metadata: name: weave-net namespace: kube-system labels: name: weave-net roleRef: kind: Role name: weave-net apiGroup: rbac.authorization.k8s.io subjects: - kind: ServiceAccount name: weave-net namespace: kube-system - apiVersion: apps/v1 kind: DaemonSet metadata: name: weave-net labels: name: weave-net namespace: kube-system spec: # Wait 5 seconds to let pod connect before rolling next pod selector: matchLabels: name: weave-net minReadySeconds: 5 template: metadata: labels: name: weave-net spec: initContainers: - name: weave-init image: \u0026#39;weaveworks/weave-kube:2.8.1\u0026#39; command: - /home/weave/init.sh env: securityContext: privileged: true volumeMounts: - name: cni-bin mountPath: /host/opt - name: cni-bin2 mountPath: /host/home - name: cni-conf mountPath: /host/etc - name: lib-modules mountPath: /lib/modules - name: xtables-lock mountPath: /run/xtables.lock readOnly: false containers: - name: weave command: - /home/weave/launch.sh env: - name: IPALLOC_RANGE value: 10.32.1.0/24 - name: INIT_CONTAINER value: \u0026#34;true\u0026#34; - name: HOSTNAME valueFrom: fieldRef: apiVersion: v1 fieldPath: spec.nodeName image: \u0026#39;weaveworks/weave-kube:2.8.1\u0026#39; readinessProbe: httpGet: host: 127.0.0.1 path: /status port: 6784 resources: requests: cpu: 50m securityContext: privileged: true volumeMounts: - name: weavedb mountPath: /weavedb - name: dbus mountPath: /host/var/lib/dbus readOnly: true - mountPath: /host/etc/machine-id name: cni-machine-id readOnly: true - name: xtables-lock mountPath: /run/xtables.lock readOnly: false - name: weave-npc env: - name: HOSTNAME valueFrom: fieldRef: apiVersion: v1 fieldPath: spec.nodeName image: \u0026#39;weaveworks/weave-npc:2.8.1\u0026#39; #npc-args resources: requests: cpu: 50m securityContext: privileged: true volumeMounts: - name: xtables-lock mountPath: /run/xtables.lock readOnly: false hostNetwork: true dnsPolicy: ClusterFirstWithHostNet hostPID: false restartPolicy: Always securityContext: seLinuxOptions: {} serviceAccountName: weave-net tolerations: - effect: NoSchedule operator: Exists - effect: NoExecute operator: Exists volumes: - name: weavedb hostPath: path: /var/lib/weave - name: cni-bin hostPath: path: /opt - name: cni-bin2 hostPath: path: /home - name: cni-conf hostPath: path: /etc - name: cni-machine-id hostPath: path: /etc/machine-id - name: dbus hostPath: path: /var/lib/dbus - name: lib-modules hostPath: path: /lib/modules - name: xtables-lock hostPath: path: /run/xtables.lock type: FileOrCreate priorityClassName: system-node-critical updateStrategy: type: RollingUpdate # æŸ¥çœ‹weaveçš„agent/peer k get pods --all-namespaces | grep weave # weave podåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šå­˜åœ¨ä¸€ä¸ªï¼ˆåŒ…æ‹¬masterå’Œwork nodeï¼‰ # æŸ¥çœ‹weaveåˆ›å»ºçš„ç½‘å£ ip link | grep weave # æŸ¥çœ‹weaveç½‘å£çš„ipåœ°å€æ®µ ip addr show weave ip route list # æŸ¥çœ‹work nodeä¸Šweave netçš„é»˜è®¤ç½‘å…³ï¼Œé¦–å…ˆç™»å½•åˆ°work node ip route | gre weave Service Networking # æŸ¥çœ‹æ•´ä¸ªclusterçš„ç½‘ç»œèŒƒå›´ ip addr | grep eth0 # 215: eth0@if216: \u0026lt;BROADCAST,MULTICAST,UP,LOWER_UP\u0026gt; mtu 1450 qdisc noqueue state UP group default # inet 192.4.210.9/24 brd 192.4.210.255 scope global eth0 ipcalc -b 192.4.210.9 # è®¡ç®—çš„clusterçš„åœ°å€èŒƒå›´192.4.210.0/24 # æŸ¥çœ‹clusterä¸­podçš„ç½‘ç»œåœ°å€èŒƒå›´ # è‹¥podä½¿ç”¨weaveç½‘ç»œï¼Œä½¿ç”¨å¦‚ä¸‹æŸ¥è¯¢æ–¹å¼ k logs -n kube-system weave-net-8v8hr | grep ipalloc-range # podåœ°å€èŒƒå›´æ˜¯10.244.0.0/16 # æŸ¥çœ‹serviceçš„ç½‘ç»œåœ°å€èŒƒå›´ cat /etc/kubernetes/manifests/kube-apiserver.yaml | grep cluster-ip-range # --service-cluster-ip-range=10.96.0.0/12 # æŸ¥çœ‹kube-proxyçš„ç±»å‹ k logs -n kube-system \u0026lt;kube-proxy-pod-name\u0026gt; CoreDNS # æŸ¥çœ‹clusterçš„DNSè§£å†³æ–¹æ¡ˆ k get pods -n kube-system | grep dns # æŸ¥çœ‹dns service k get service --all-namespaces | grep dns # æŸ¥çœ‹corednsçš„é…ç½®æ–‡ä»¶ k -n kube-system describe deployments.apps coredns | grep -A2 Args # æŸ¥çœ‹Corefileçš„æ³¨å…¥æ–¹å¼ k get po -n kube-system coredns-5d78c9869d-5sxxz -o yaml k describe cm -n kube-system coredns # serviceçš„DNSè§„åˆ™å¦‚ä¸‹ï¼šservice.namespace.svc.cluster.local # web-service.payroll.svc.cluster.local # æŸ¥çœ‹DNSç»“æœ kubectl exec -it hr -- nslookup mysql.payroll \u0026gt; /root/CKA/nslookup.out Ingress # æŸ¥çœ‹ingress kubectl get all -A | grep -i ingress k get ingress -A # æŸ¥çœ‹ingressè¯¦æƒ… kubectl describe ingress \u0026lt;ingress-name\u0026gt; # ç¼–è¾‘ingressä¿®æ”¹rules kubectl edit ingress # åˆ›å»ºingressï¼Œæ³¨æ„å¦‚ä¸‹å‘½ä»¤ç¼ºå°‘annotationï¼Œåˆ›å»ºçš„yamlæ·»åŠ annotationæ‰èƒ½æ­£å¸¸å·¥ä½œ # pathType: Exact k create ingress -n critical-space test-ingress --rule=/pay=pay-service:8282 --dry-run=client -o yaml # pathType: Prefix k create ingress -n critical-space test-ingress --rule=/pay*=pay-service:8282 --dry-run=client -o yaml apiVersion: networking.k8s.io/v1 kind: Ingress metadata: annotations: nginx.ingress.kubernetes.io/rewrite-target: / nginx.ingress.kubernetes.io/ssl-redirect: \u0026#34;false\u0026#34; name: ingress-wear-watch namespace: app-space spec: rules: - http: paths: - backend: service: name: wear-service port: number: 8080 path: /wear pathType: Prefix - backend: service: name: video-service port: number: 8080 path: /stream pathType: Prefix å¦‚ä¸‹ä¸ºclusteråˆ›å»ºingress controller\n# åˆ›å»ºingressç‹¬ç«‹çš„namespace(ä¾¿äºéš”ç¦») k create namespace ingress-nginx # åˆ›å»ºconfigmap kubectl create configmap ingress-nginx-controller --namespace ingress-nginx # åˆ›å»ºservice account k create sa ingress-nginx -n ingress-nginx k create sa ingress-nginx-admission -n ingress-nginx # åˆ›å»ºroleï¼Œrolebindingï¼Œclusterroleï¼Œclusterrolebinding # ç•¥ # ingress controller çš„yamlå¦‚ä¸‹ apiVersion: apps/v1 kind: Deployment metadata: labels: app.kubernetes.io/component: controller app.kubernetes.io/instance: ingress-nginx app.kubernetes.io/managed-by: Helm app.kubernetes.io/name: ingress-nginx app.kubernetes.io/part-of: ingress-nginx app.kubernetes.io/version: 1.1.2 helm.sh/chart: ingress-nginx-4.0.18 name: ingress-nginx-controller namespace: ingress-nginx spec: replicas: 1 minReadySeconds: 0 revisionHistoryLimit: 10 selector: matchLabels: app.kubernetes.io/component: controller app.kubernetes.io/instance: ingress-nginx app.kubernetes.io/name: ingress-nginx template: metadata: labels: app.kubernetes.io/component: controller app.kubernetes.io/instance: ingress-nginx app.kubernetes.io/name: ingress-nginx spec: containers: - args: - /nginx-ingress-controller - --publish-service=$(POD_NAMESPACE)/ingress-nginx-controller - --election-id=ingress-controller-leader - --watch-ingress-without-class=true - --default-backend-service=app-space/default-http-backend - --controller-class=k8s.io/ingress-nginx - --ingress-class=nginx - --configmap=$(POD_NAMESPACE)/ingress-nginx-controller - --validating-webhook=:8443 - --validating-webhook-certificate=/usr/local/certificates/cert - --validating-webhook-key=/usr/local/certificates/key env: - name: POD_NAME valueFrom: fieldRef: fieldPath: metadata.name - name: POD_NAMESPACE valueFrom: fieldRef: fieldPath: metadata.namespace - name: LD_PRELOAD value: /usr/local/lib/libmimalloc.so image: registry.k8s.io/ingress-nginx/controller:v1.1.2@sha256:28b11ce69e57843de44e3db6413e98d09de0f6688e33d4bd384002a44f78405c imagePullPolicy: IfNotPresent lifecycle: preStop: exec: command: - /wait-shutdown livenessProbe: failureThreshold: 5 httpGet: path: /healthz port: 10254 scheme: HTTP initialDelaySeconds: 10 periodSeconds: 10 successThreshold: 1 timeoutSeconds: 1 name: controller ports: - name: http containerPort: 80 protocol: TCP - containerPort: 443 name: https protocol: TCP - containerPort: 8443 name: webhook protocol: TCP readinessProbe: failureThreshold: 3 httpGet: path: /healthz port: 10254 scheme: HTTP initialDelaySeconds: 10 periodSeconds: 10 successThreshold: 1 timeoutSeconds: 1 resources: requests: cpu: 100m memory: 90Mi securityContext: allowPrivilegeEscalation: true capabilities: add: - NET_BIND_SERVICE drop: - ALL runAsUser: 101 volumeMounts: - mountPath: /usr/local/certificates/ name: webhook-cert readOnly: true dnsPolicy: ClusterFirst nodeSelector: kubernetes.io/os: linux serviceAccountName: ingress-nginx terminationGracePeriodSeconds: 300 volumes: - name: webhook-cert secret: secretName: ingress-nginx-admission --- apiVersion: v1 kind: Service metadata: creationTimestamp: null labels: app.kubernetes.io/component: controller app.kubernetes.io/instance: ingress-nginx app.kubernetes.io/managed-by: Helm app.kubernetes.io/name: ingress-nginx app.kubernetes.io/part-of: ingress-nginx app.kubernetes.io/version: 1.1.2 helm.sh/chart: ingress-nginx-4.0.18 name: ingress-nginx-controller namespace: ingress-nginx spec: ports: - port: 80 protocol: TCP targetPort: 80 nodePort: 30080 selector: app.kubernetes.io/component: controller app.kubernetes.io/instance: ingress-nginx app.kubernetes.io/name: ingress-nginx type: NodePort # æ¥ç€åˆ›å»ºingressï¼Œingressèµ„æºæ˜¯åœ¨namespaceèŒƒå›´ä¸‹çš„ï¼Œæ‰€ä»¥ingressè¦å’ŒserviceåŒä¸€ä¸ªnamespace k create ingress -n app-space --rule /wear*=wear-service:8080 --rule /watch*=video-service:8080 --annotation nginx.ingress.kubernetes.io/rewrite-target=/ --annotation nginx.ingress.kubernetes.io/ssl-redirect=false test-ingress --dry-run=client -o yaml apiVersion: networking.k8s.io/v1 kind: Ingress metadata: annotations: nginx.ingress.kubernetes.io/rewrite-target: / nginx.ingress.kubernetes.io/ssl-redirect: \u0026#34;false\u0026#34; creationTimestamp: null name: test-ingress namespace: app-space spec: rules: - http: paths: - backend: service: name: wear-service port: number: 8080 path: /wear pathType: Prefix - backend: service: name: video-service port: number: 8080 path: /watch pathType: Prefix status: loadBalancer: {} éƒ¨ç½²K8S # åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šæ‰§è¡Œå¦‚ä¸‹å®‰è£…æ“ä½œ # step1: ä¿®æ”¹ç½‘ç»œç­–ç•¥ cat \u0026lt;\u0026lt;EOF | sudo tee /etc/modules-load.d/k8s.conf br_netfilter EOF cat \u0026lt;\u0026lt;EOF | sudo tee /etc/sysctl.d/k8s.conf net.bridge.bridge-nf-call-ip6tables = 1 net.bridge.bridge-nf-call-iptables = 1 EOF sudo sysctl --system # step2: å®‰è£…åŒ… sudo apt-get update sudo apt-get install -y apt-transport-https ca-certificates curl sudo mkdir -m 755 /etc/apt/keyrings curl -fsSL https://pkgs.k8s.io/core:/stable:/v1.27/deb/Release.key | sudo gpg --dearmor -o /etc/apt/keyrings/kubernetes-apt-keyring.gpg echo \u0026#39;deb [signed-by=/etc/apt/keyrings/kubernetes-apt-keyring.gpg] https://pkgs.k8s.io/core:/stable:/v1.27/deb/ /\u0026#39; | sudo tee /etc/apt/sources.list.d/kubernetes.list sudo apt-get update # To see the new version labels sudo apt-cache madison kubeadm sudo apt-get install -y kubelet=1.27.0-2.1 kubeadm=1.27.0-2.1 kubectl=1.27.0-2.1 sudo apt-mark hold kubelet kubeadm kubectl Installing kubeadm | Kubernetes\n# step3: æŸ¥çœ‹kubeletç‰ˆæœ¬ kubelet --version # step4: ä½¿ç”¨kubeadmå¯åŠ¨kubernetesé›†ç¾¤ # step4-1: å¯åŠ¨controlplane # æŸ¥çœ‹eth0ç½‘å£ipåœ°å€ ifconfig eth0 # å‡è®¾ä¸Šä¸€æ­¥eth0åœ°å€æ˜¯192.17.132.9 kubeadm init --apiserver-cert-extra-sans=controlplane --apiserver-advertise-address 192.17.132.9 --pod-network-cidr=10.244.0.0/16 # æˆ–è€…æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ IP_ADDR=$(ip addr show eth0 | grep -oP \u0026#39;(?\u0026lt;=inet\\s)\\d+(\\.\\d+){3}\u0026#39;) kubeadm init --apiserver-cert-extra-sans=controlplane --apiserver-advertise-address $IP_ADDR --pod-network-cidr=10.244.0.0/16 # æ‰§è¡Œå®Œæ¯•åï¼Œé…ç½®kubeconfig mkdir -p $HOME/.kube sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config sudo chown $(id -u):$(id -g) $HOME/.kube/config You should now deploy a pod network to the cluster. Run \u0026#34;kubectl apply -f [podnetwork].yaml\u0026#34; with one of the options listed at: https://kubernetes.io/docs/concepts/cluster-administration/addons/ Then you can join any number of worker nodes by running the following on each as root: kubeadm join 192.17.132.9:6443 --token b2134k.u3alyaj4iwkjhm6w \\ --discovery-token-ca-cert-hash sha256:23471ecdb6d52790d13880d333fa0a667cc249297ed26faa7b75171b84157c46 # Step 4-2: å°†node01åŠ å…¥åˆ°cluster # kubeadmç”Ÿæˆjoin token kubeadm token generate # æˆ– kubeadm token create --print-join-command # ç”Ÿæˆå¦‚ä¸‹å‘½ä»¤ï¼Œsshç™»å½•åˆ°node01ä¸Šæ‰§è¡Œ kubeadm join 192.17.132.9:6443 --token 2uh5xs.qoh26441ba0l4du4 --discovery-token-ca-cert-hash sha256:23471ecdb6d52790d13880d333fa0a667cc249297ed26faa7b75171b84157c46 # Step5: å®‰è£…Flannelç½‘ç»œ # ä¸‹è½½kube-flannel.yml curl -LO https://raw.githubusercontent.com/flannel-io/flannel/v0.20.2/Documentation/kube-flannel.yml # ç¼–è¾‘kube-flannel.yml # å®šä½åˆ° args: - --ip-masq - --kube-subnet-mgr # æ·»åŠ å‚æ•° - --iface=eth0 kubectl apply -f kube-flannel.yml # ç½‘ç»œåˆ›å»ºæˆåŠŸåï¼ŒnodeçŠ¶æ€å˜æˆReady controlplane ~ âœ kubectl get nodes NAME STATUS ROLES AGE VERSION controlplane Ready control-plane 15m v1.27.0 node01 Ready \u0026lt;none\u0026gt; 15m v1.27.0 Trouble Shooting Application Failureï¼š\ndnsè§£æçš„serviceåç§°ä¸å¯¹ serviceä¸­selectoræ²¡æœ‰é€‰ä¸­å·¥ä½œçš„pod serviceçš„targetPorté…ç½®é”™è¯¯ dbçš„ç”¨æˆ·åå¯†ç é”™è¯¯ serviceæš´éœ²çš„nodeç«¯å£é”™è¯¯ Control Plane Failureï¼š\nkube-scheduleræ•…éšœï¼Œä¿®æ”¹/etc/kubernetes/manifests/ä¸‹çš„yaml scaleæ— å“åº”ï¼ŒæŸ¥çœ‹kube-controlleræ•…éšœ Work Node Failure:\nè®¡ç®—èŠ‚ç‚¹containerdæœåŠ¡æˆ–è€…kubeletæœåŠ¡åœæ‰äº†ï¼Œç”¨systemctlå‘½ä»¤æ‰‹åŠ¨å¯åŠ¨ /var/lib/kubelet/config.yamlé…ç½®æ–‡ä»¶æœ‰é—®é¢˜ /etc/kubernetes/kubelet.confä¸­kube-apiçš„ç«¯å£é…ç½® Network Failure:\nç¼ºå°‘ç½‘ç»œæ’ä»¶Creating a cluster with kubeadm | Kubernetes\ncurl -L https://github.com/weaveworks/weave/releases/download/latest_release/weave-daemonset-k8s-1.11.yaml | kubectl apply -f -\næŸ¥çœ‹æ‰€æœ‰kube-proxyæ˜¯å¦è¿è¡Œæ­£å¸¸ï¼ŒæŸ¥çœ‹å…³è”çš„configMapæ˜¯å¦æ­£ç¡®ï¼Œä¿®æ”¹daemonset\nLighting Lab # json pathå®šä¹‰è¾“å‡º kubectl get deployments.apps -n admin2406 -o custom-columns=DEPLOYMENT:.metadata.name,CONTAINER_IMAGE:.spec.template.spec.containers[*].image,READY_REPLICAS:.status.readyReplicas,NAMESPACE:.metadata.namespace --sort-by=.metadata.name å‚è€ƒ Kubectl Command Cheat Sheet - Learn Essential Kubernetes Commands\nKubectl Cheatsheet | Free Cheatsheet\nLF è®¤è¯è€ƒè¯•æ”»ç•¥ï½œè®¤è¯è€ƒè¯•æµç¨‹å…¨ä»‹ç»\u0026ndash;è´­ä¹°ã€æ³¨å†ŒåŠé¢„çº¦è€ƒè¯•ç¯‡ï¼ˆå»ºè®®æ”¶è—ï¼‰-Linux Foundationå¼€æºè½¯ä»¶å­¦å›­\nCKA (Certified Kubernetes Administrator)\nKiller Shell - Exam Simulators\nLinux Foundation Certification Exam: Candidate Handbook (using PSI BRIDGE Proctoring platform) - T\u0026amp;C DOCS (Candidate Facing Resources)\nè€ƒè¯•å…¥å£Certified Kubernetes Administrator China Exam (CKA-CN) - Exam | The Linux Foundation\nCKAè€ƒè¯•å¿ƒå¾—åˆ†äº« - æœ¨äºŒ - åšå®¢å›­\nCKAè€ƒè¯•ç»éªŒæ€»ç»“ - ç®€ä¹¦\nIntroduction to YAML - KodeKloud\näº’è”ç½‘æœ€å…¨ckaçœŸé¢˜è§£æ-2022.9.9 - çŸ¥ä¹\n2023å¹´CKAè€ƒè¯•çœŸé¢˜åŠæ³¨æ„äº‹é¡¹ - jiayou111 - åšå®¢å›­\nKubernetes CKAçœŸé¢˜è§£æ-20200402çœŸé¢˜_check to see how many nodes are ready (not includi-CSDNåšå®¢\n","permalink":"https://blog.niuhemoon.win/posts/tech/cka-study-record/","summary":"\u003cp\u003eè®°å½•ä¸€ä¸‹CKAè€ƒè¯•çš„å¤‡è€ƒè¿‡ç¨‹\u003c/p\u003e","title":"CKAå¤‡è€ƒç¬”è®°"},{"content":" å‚åŠ äº†ä¸€ä¸ªLLMçš„åº”ç”¨æ¯”èµ›ï¼Œèµ›é¢˜ç›®æ ‡æ˜¯ç¼–ç ä¼˜åŒ–promptæé«˜text2sqlæ¨ç†çš„æ­£ç¡®ç‡ ç»™å®šçš„èµ„æºå¦‚ä¸‹ï¼š\næ‰€æœ‰æ•°æ®åº“schema ä¸€ä¸ª100æ¡è®°å½•çš„è®­ç»ƒé›†ï¼ˆå…¶å®æ˜¯åŸºäºspideræ•°æ®é›†åšäº†ä¿®æ”¹ï¼‰ ä¸‰ä¸ªLLMçš„æ¥å£ï¼ˆBaichuan13B/LLama2/Code-LLamaï¼‰ text2sqlæ­£ç¡®ç‡æé«˜åˆ°äº†60%å·¦å³ï¼Œåœ¨æ­¤è®°å½•ä¸€äº›å¿ƒå¾—\npromptçš„ç»„æˆåŒ…å››ä¸ªå…ƒç´ ï¼š\nInstructionï¼ˆæŒ‡ä»¤ï¼Œå¿…é¡»ï¼‰ Contextï¼ˆä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå¯é€‰ï¼‰ Input Dataï¼ˆè¾“å…¥ï¼Œéœ€è¦å¤„ç†çš„æ•°æ®ï¼Œå¯é€‰ï¼‰ Output Indicatorï¼ˆè¾“å‡ºæŒ‡å¼•ï¼Œè§„å®šè¾“å‡ºçš„ç±»å‹æˆ–æ ¼å¼ï¼Œå¯é€‰ï¼‰ ä¸€ä¸ªé¢å‘å¤æ‚ä»»åŠ¡çš„promptçš„ä¸€èˆ¬éƒ½åŒ…å«Instructionï¼ŒContextï¼ŒInput Dataï¼ŒOutput Indicatorã€‚ æ‰€ä»¥é¢å‘å¤§è¯­è¨€æ¨¡å‹çš„å¼€å‘åº”ç”¨è¿‡ç¨‹å°±æ˜¯å¦‚ä¸‹å…¬å¼ï¼š\nLMM(Instruction + Context + Input Data + Output Indicator) = Output\né¢˜ç›®è¦æ±‚æ ¹æ®è‡ªç„¶è¯­è¨€çš„Questionï¼Œç»™å‡ºå¯¹åº”æ•°æ®åº“çš„SQL Queryè¯­å¥\nåšPromptä¼˜åŒ–çš„æ ¸å¿ƒæ­¥éª¤æœ‰ï¼š\nåˆ©ç”¨LLMçš„ç¿»è¯‘èƒ½åŠ›å°†è¾“å…¥çš„ä¸­æ–‡Questionè½¬æ¢æˆè‹±æ–‡ è§£ææ•°æ®åº“schemaï¼Œæ ¼å¼åŒ–ååŠ å…¥promptï¼Œå…¶ä¸­ä¸åŒtableé—´çš„å¤–é”®å¾ˆå…³é”®ï¼Œcolumnçš„å­—æ®µç±»å‹å¯æœ‰å¯æ—  few shotï¼Œç»™å‡ºæ•°æ®åº“å…³è”çš„ä¸‰ä¸ªæ¡ˆä¾‹ï¼ˆå’Œé—®é¢˜æ•°æ®åº“å…³è”çš„æ¡ˆä¾‹æœ‰æ˜æ˜¾æå‡æ•ˆæœï¼‰ chain of thoughtï¼ŒæŒ‡å¯¼LLMå¦‚ä½•æ€è€ƒï¼Œæ³¨æ„æ„é€ sqlè¯­å¥çš„å“ªäº›æ­¥éª¤ è¯±å¯¼æ…¢æ€è€ƒï¼ˆLet\u0026rsquo;s think step by stepï¼‰ å¤šLLMäº¤å‰éªŒè¯å’Œå•LLM self consistencyï¼Œå³å¤šé—®å‡ æ¬¡ï¼ŒæŠ•ç¥¨é€‰æ‹©å‡ºç°æ¬¡æ•°å¤šçš„sqlè¯­å¥ åå¤„ç†æ ¡éªŒsqlè¯­å¥çš„æ­£ç¡®æ€§ å½“ç„¶æ›´å¥½çš„åŠæ³•æ˜¯å¯¹LLMè¿›è¡Œé¢„è®­ç»ƒï¼ŒPromptä¼˜åŒ–æˆ–è€…LLM agentçš„æå‡æ•ˆæœæœ‰é™\n","permalink":"https://blog.niuhemoon.win/posts/tech/text2sql-prompt-engineering/","summary":"å‚åŠ äº†ä¸€ä¸ªLLMçš„åº”ç”¨æ¯”èµ›ï¼Œèµ›é¢˜ç›®æ ‡æ˜¯ç¼–ç ä¼˜åŒ–promptæé«˜text2sqlæ¨ç†çš„æ­£ç¡®ç‡ ç»™å®šçš„èµ„æºå¦‚ä¸‹ï¼š æ‰€æœ‰æ•°æ®åº“schema ä¸€ä¸ª100æ¡è®°å½•çš„è®­ç»ƒé›†ï¼ˆå…¶å®æ˜¯åŸºäºspideræ•°æ®é›†åšäº†ä¿®æ”¹ï¼‰ ä¸‰ä¸ªLLMçš„æ¥å£ï¼ˆBaichuan13B/LLama2/Code-LLamaï¼‰ text2","title":"text2sql Prompt è°ƒä¼˜ç¬”è®°"},{"content":"ä»‹ç» Xpathå…¨ç§°XML Path Languageï¼ŒåŠŸèƒ½ä¸Šä½¿ç”¨ç±»ä¼¼è·¯å¾„çš„è¯­æ³•æ¥è¯†åˆ«å’Œå¯¼èˆªXMLæ–‡æ¡£ä¸­çš„èŠ‚ç‚¹ï¼ŒåŒæ—¶æ”¯æŒHTMLè¯­è¨€ã€‚XPathæ˜¯W3Cçš„æ¨èæ ‡å‡†\nNodes Xpathä¸­æœ‰ä¸ƒç§èŠ‚ç‚¹ï¼š\nelement attribute text namespace processing-instruction comment root nodes å¥æ³• é€‰ä¸­Nodes è¡¨è¾¾å¼ æè¿° nodename é€‰ä¸­æ‰€æœ‰åŒåèŠ‚ç‚¹ / ä»root nodeå¼€å§‹é€‰æ‹© // ä»å½“å‰èŠ‚ç‚¹å¼€å§‹é€‰æ‹©ï¼Œä¸ç®¡å±‚çº§å…³ç³» . é€‰æ‹©å½“å‰èŠ‚ç‚¹ .. é€‰æ‹©å½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ @ é€‰æ‹©å±æ€§ ä¸¾ä¾‹å¦‚ä¸‹\nè¡¨è¾¾å¼ æ•ˆæœ bookstore Selects all nodes with the name \u0026ldquo;bookstore\u0026rdquo; /bookstore Selects the root element bookstore bookstore/book Selects all book elements that are children of bookstore //book Selects all book elements no matter where they are in the document bookstore//book Selects all book elements that are descendant of the bookstore element, no matter where they are under the bookstore element //@lang Selects all attributes that are named lang Predicates è°“è¯ Path Expression Result /bookstore/book[1] Selects the first book element that is the child of the bookstore element. /bookstore/book[last()] Selects the last book element that is the child of the bookstore element /bookstore/book[last()-1] Selects the last but one book element that is the child of the bookstore element /bookstore/book[position()\u0026lt;3] Selects the first two book elements that are children of the bookstore element //title[@lang] Selects all the title elements that have an attribute named lang //title[@lang=\u0026lsquo;en\u0026rsquo;] Selects all the title elements that have a \u0026ldquo;lang\u0026rdquo; attribute with a value of \u0026ldquo;en\u0026rdquo; /bookstore/book[price\u0026gt;35.00] Selects all the book elements of the bookstore element that have a price element with a value greater than 35.00 /bookstore/book[price\u0026gt;35.00]/title Selects all the title elements of the book elements of the bookstore element that have a price element with a value greater than 35.00 é€‰æ‹©æœªçŸ¥èŠ‚ç‚¹ Wildcard Description * Matches any element node @* Matches any attribute node node() Matches any node of any kind Path Expression Result /bookstore/* Selects all the child element nodes of the bookstore element //* Selects all elements in the document //title[@*] Selects all title elements which have at least one attribute of any kind é€‰æ‹©å¤šæ¡è·¯å¾„ é€šè¿‡ä½¿ç”¨|æˆ–æ“ä½œç¬¦ï¼Œå¯ä»¥é€‰æ‹©å¤šæ¡è·¯å¾„\nPath Expression Result //book/title | //book/price Selects all the title AND price elements of all book elements //title | //price Selects all the title AND price elements in the document /bookstore/book/title | //price Selects all the title elements of the book element of the bookstore element AND all the price elements in the document Axes Axes(è½´)ç”¨æ¥è¡¨ç¤ºå’Œå½“å‰èŠ‚ç‚¹ä¹‹é—´çš„å…³ç³»ï¼Œç”¨äºå®šä½æ ‘ä¸Šå½“å‰èŠ‚ç‚¹çš„å…³è”èŠ‚ç‚¹\nAxisName Result ancestor Selects all ancestors (parent, grandparent, etc.) of the current node ancestor-or-self Selects all ancestors (parent, grandparent, etc.) of the current node and the current node itself attribute Selects all attributes of the current node child Selects all children of the current node descendant Selects all descendants (children, grandchildren, etc.) of the current node descendant-or-self Selects all descendants (children, grandchildren, etc.) of the current node and the current node itself following Selects everything in the document after the closing tag of the current node following-sibling Selects all siblings after the current node namespace Selects all namespace nodes of the current node parent Selects the parent of the current node preceding Selects all nodes that appear before the current node in the document, except ancestors, attribute nodes and namespace nodes preceding-sibling Selects all siblings before the current node self Selects the current node è·¯å¾„å®šä½è¡¨è¾¾å¼ ç»å¯¹è·¯å¾„ä»¥/å¼€å¤´ å®šä½çš„è¯­æ³•å¦‚ä¸‹ï¼šaxisname::nodetest[predicate] Axisnameè½´åç§° NodetestèŠ‚ç‚¹é€‰æ‹© Predicate è°“è¯ç»†åŒ–é€‰æ‹© Example Result child::book Selects all book nodes that are children of the current node attribute::lang Selects the lang attribute of the current node child::* Selects all element children of the current node attribute::* Selects all attributes of the current node child::text() Selects all text node children of the current node child::node() Selects all children of the current node descendant::book Selects all book descendants of the current node ancestor::book Selects all book ancestors of the current node ancestor-or-self::book Selects all book ancestors of the current node - and the current as well if it is a book node child::*/child::price Selects all price grandchildren of the current node æ“ä½œç¬¦ Xpathæ“ä½œç¬¦å¯ä»¥è¿”å›å¦‚ä¸‹ç±»å‹çš„å€¼ï¼š\nnode-set string number boolean Operator Description Example | Computes two node-sets //book | //cd + Addition 6 + 4 - Subtraction 6 - 4 * Multiplication 6 * 4 div Division 8 div 4 = Equal price=9.80 != Not equal price!=9.80 \u0026lt; Less than price\u0026lt;9.80 \u0026lt;= Less than or equal to price\u0026lt;=9.80 \u0026gt; Greater than price\u0026gt;9.80 \u0026gt;= Greater than or equal to price\u0026gt;=9.80 or or price=9.80 or price=9.70 and and price\u0026gt;9.00 and price\u0026lt;9.90 mod Modulus (division remainder) 5 mod 2 Functionså‡½æ•° å‡½æ•° ä½œç”¨ name() è·å–nodeçš„åç§°//[starts-with(name(), \u0026lsquo;h\u0026rsquo;)] text() è·å–nodeçš„æ–‡æœ¬//button[text()=\u0026ldquo;Submit\u0026rdquo;] lang(str) è·å–å­—ç¬¦ä¸²çš„è¯­è¨€ count() nodeè®¡æ•°//table[count(tr)=1] position() è®¡ç®—ä½ç½®//ol/li[position()=2] number() boolean() not() å–åbutton[not(starts-with(text(),\u0026ldquo;Submit\u0026rdquo;))] contains() å­—ç¬¦ä¸²åŒ…å«font[contains(@class,\u0026ldquo;head\u0026rdquo;)] starts-with() font[starts-with(@class,\u0026ldquo;head\u0026rdquo;)] ends-with() font[ends-with(@class,\u0026ldquo;head\u0026rdquo;)] concat(x, y) substring(str, start, len) æµè§ˆå™¨ä½¿ç”¨ç¤ºä¾‹ chromeæµè§ˆå™¨æœ‰ä¸¤ç§ä½¿ç”¨æ–¹æ³•ï¼š\nDevtool-Elements, CTRL+F Devtool-Console, $x(xpath_syntax) æ¡ˆä¾‹ è§£é‡Š /bookstore/book/title é€‰æ‹©æ‰€æœ‰ä¹¦çš„title /bookstore/book[1]/title é€‰æ‹©ç¬¬ä¸€æœ¬ä¹¦çš„title /bookstore/book/price[text()] é€‰æ‹©æ‰€æœ‰ä¹¦çš„ä»·æ ¼ /bookstore/book[price\u0026gt;35]/price é€‰æ‹©ä»·æ ¼å¤§äº35çš„priceèŠ‚ç‚¹ /bookstore/book[price\u0026gt;35]/title é€‰æ‹©ä»·æ ¼å¤§äº35çš„titleèŠ‚ç‚¹ $x(\u0026#39;//bookstore/book/title\u0026#39;) (4) [title, title, title, title] $x(\u0026#39;//bookstore/book[1]/title\u0026#39;) [title] $x(\u0026#39;//bookstore/book[position() \u0026gt; 2]/title\u0026#39;) (2) [title, title] $x(\u0026#39;//bookstore/book[price \u0026gt; 30]/title\u0026#39;) (2) [title, title] $x(\u0026#39;.//bookstore/book[1]/price\u0026#39;)[0].textContent \u0026#39;30.00\u0026#39; $x(\u0026#39;.//bookstore/book[1]/price[text()]\u0026#39;)[0].textContent \u0026#39;30.00\u0026#39; $x(\u0026#39;.//bookstore/book[1]/price/text()\u0026#39;)[0].textContent \u0026#39;30.00\u0026#39; $x(\u0026#39;.//bookstore/book[@id=\u0026#34;testid\u0026#34;]/title\u0026#39;)[0].textContent \u0026#39;Everyday Italian\u0026#39; $x(\u0026#39;.//bookstore/book[@class=\u0026#34;testclass\u0026#34;]/title\u0026#39;)[0].textContent \u0026#39;Harry Potter\u0026#39; $x(\u0026#39;.//bookstore/book[contains(@class, \u0026#34;test\u0026#34;)]/title\u0026#39;)[0].textContent \u0026#39;Harry Potter\u0026#39; Xpathæµ‹è¯•htmlæ‰“å¼€å¼€å‘è€…å·¥å…·å¯ä»¥è¯•éªŒ \u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e Everyday Italian Giada De Laurentiis 2005 30.00 Harry Potter J K. Rowling 2005 29.99 XQuery Kick Start James McGovern Per Bothner Kurt Cagle James Linn Vaidyanathan Nagarajan 2003 49.99 Learning XML Erik T. Ray 2003 39.95 \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;bookstore\u0026gt; \u0026lt;book id=\u0026#34;testid\u0026#34; category=\u0026#34;cooking\u0026#34;\u0026gt; \u0026lt;title lang=\u0026#34;en\u0026#34;\u0026gt;Everyday Italian\u0026lt;/title\u0026gt; \u0026lt;author\u0026gt;Giada De Laurentiis\u0026lt;/author\u0026gt; \u0026lt;year\u0026gt;2005\u0026lt;/year\u0026gt; \u0026lt;price\u0026gt;30.00\u0026lt;/price\u0026gt; \u0026lt;/book\u0026gt; \u0026lt;book class=\u0026#34;testclass\u0026#34; category=\u0026#34;children\u0026#34;\u0026gt; \u0026lt;title lang=\u0026#34;en\u0026#34; href=\u0026#34;test.pdf\u0026#34;\u0026gt;Harry Potter\u0026lt;/title\u0026gt; \u0026lt;author\u0026gt;J K. Rowling\u0026lt;/author\u0026gt; \u0026lt;year\u0026gt;2005\u0026lt;/year\u0026gt; \u0026lt;price\u0026gt;29.99\u0026lt;/price\u0026gt; \u0026lt;/book\u0026gt; \u0026lt;book category=\u0026#34;web\u0026#34;\u0026gt; \u0026lt;title lang=\u0026#34;en\u0026#34; href=\u0026#34;/test\u0026#34;\u0026gt;XQuery Kick Start\u0026lt;/title\u0026gt; \u0026lt;author\u0026gt;James McGovern\u0026lt;/author\u0026gt; \u0026lt;author\u0026gt;Per Bothner\u0026lt;/author\u0026gt; \u0026lt;author\u0026gt;Kurt Cagle\u0026lt;/author\u0026gt; \u0026lt;author\u0026gt;James Linn\u0026lt;/author\u0026gt; \u0026lt;author\u0026gt;Vaidyanathan Nagarajan\u0026lt;/author\u0026gt; \u0026lt;year\u0026gt;2003\u0026lt;/year\u0026gt; \u0026lt;price\u0026gt;49.99\u0026lt;/price\u0026gt; \u0026lt;/book\u0026gt; \u0026lt;book category=\u0026#34;web\u0026#34;\u0026gt; \u0026lt;title lang=\u0026#34;en\u0026#34; href=\u0026#34;https://www.google.com\u0026#34;\u0026gt;Learning XML\u0026lt;/title\u0026gt; \u0026lt;author\u0026gt;Erik T. Ray\u0026lt;/author\u0026gt; \u0026lt;year\u0026gt;2003\u0026lt;/year\u0026gt; \u0026lt;price\u0026gt;39.95\u0026lt;/price\u0026gt; \u0026lt;/book\u0026gt; \u0026lt;/bookstore\u0026gt; å‚è€ƒ Xpath cheatsheet\nXPath Tutorial\n","permalink":"https://blog.niuhemoon.win/posts/tech/xpath-cheetsheet/","summary":"ä»‹ç» Xpathå…¨ç§°XML Path Languageï¼ŒåŠŸèƒ½ä¸Šä½¿ç”¨ç±»ä¼¼è·¯å¾„çš„è¯­æ³•æ¥è¯†åˆ«å’Œå¯¼èˆªXMLæ–‡æ¡£ä¸­çš„èŠ‚ç‚¹ï¼ŒåŒæ—¶æ”¯æŒHTMLè¯­è¨€ã€‚XPathæ˜¯W3Cçš„æ¨èæ ‡å‡† Nodes Xpathä¸­æœ‰ä¸ƒç§èŠ‚ç‚¹ï¼š element attribute text namespace processing-instruction comment root nodes å¥æ³• é€‰ä¸­Nodes è¡¨è¾¾å¼ æè¿° nodename é€‰ä¸­æ‰€æœ‰åŒåèŠ‚ç‚¹ / ä»root nodeå¼€å§‹é€‰æ‹© // ä»å½“å‰èŠ‚ç‚¹å¼€","title":"xpathåŸºæœ¬ä½¿ç”¨"},{"content":" 2023 å¹´ 7 æœˆ:\næ€¨ä»‡æ˜ŸåŸŸä¸‰éƒ¨æ›² 2023 å¹´ 6 æœˆ:\nå›å¿†çˆ±ç›ä¾¬ 2023 å¹´ 5 æœˆ:\nå±±æœˆè®° 2023 å¹´ 4 æœˆ:\nç¬¬ä¸‰æ¬¡æµªæ½® Where Wizards Stay Up Late A Philosophy of Software Design 2023 å¹´ 2 æœˆï¼š\næˆ‘æ¯å¤©åªå·¥ä½œä¸‰å°æ—¶ ç½®èº«äº‹å†… ç¨‹åºå‘˜ä¿®ç‚¼ä¹‹é“ 2023 å¹´ 1 æœˆï¼š\näºŒæ‰‹æ—¶é—´ è®¤çŸ¥å¤©æ€§ï¼šè®©å­¦ä¹ è½»è€Œæ˜“ä¸¾çš„å¿ƒç†å­¦è§„å¾‹ æ•°å­—æ€ç»´ ","permalink":"https://blog.niuhemoon.win/posts/read/%E9%98%85%E8%AF%BB%E8%AE%B0%E5%BD%952023/","summary":"2023 å¹´ 7 æœˆ: æ€¨ä»‡æ˜ŸåŸŸä¸‰éƒ¨æ›² 2023 å¹´ 6 æœˆ: å›å¿†çˆ±ç›ä¾¬ 2023 å¹´ 5 æœˆ: å±±æœˆè®° 2023 å¹´ 4 æœˆ: ç¬¬ä¸‰æ¬¡æµªæ½® Where Wizards Stay Up Late A Philosophy of Software Design 2023 å¹´ 2 æœˆï¼š æˆ‘æ¯å¤©åªå·¥ä½œä¸‰å°æ—¶ ç½®èº«äº‹å†… ç¨‹åºå‘˜ä¿®ç‚¼ä¹‹é“ 2023 å¹´ 1 æœˆï¼š äºŒæ‰‹æ—¶é—´ è®¤çŸ¥å¤©æ€§ï¼šè®©å­¦ä¹ è½»è€Œæ˜“ä¸¾çš„å¿ƒç†å­¦è§„å¾‹ æ•°å­—æ€ç»´","title":"é˜…è¯»è®°å½•2023"},{"content":"ã€Šå¥ˆé£æ–‡åŒ–æ‰‹å†Œã€‹ èŒƒç‚è¯‘\nâ—† æ¨èåºä¸€ æ–‡åŒ–ï¼Œå¥ˆé£æˆåŠŸçš„åŸåŠ¨åŠ›\nå¥ˆé£çš„ä¼ä¸šæ–‡åŒ–ä¸»è¦æ˜¯ç”±â€œè‡ªç”±â€ä¸â€œè´£ä»»â€è¿™ä¸¤ä¸ªå…³é”®è¯æ„æˆçš„ã€‚æˆ‘ä¹‹å‰è®¤ä¸ºï¼šâ€œç°ä»£ä¼ä¸šæ–‡åŒ–çš„æ ¸å¿ƒå°±æ˜¯è¦é åˆ¶åº¦ç®¡äººï¼Œè€Œä¸æ˜¯é äººç®¡äººã€‚â€ä½†å¥ˆé£åœ¨è¿™ä¸ªåŸºç¡€ä¸Šåˆè¿›åŒ–äº†ä¸€æ­¥ï¼Œå®ƒæå‡ºï¼Œç°ä»£ä¼ä¸šæ–‡åŒ–çš„æ ¸å¿ƒè¿˜æ˜¯äººç®¡äººï¼Œä½†è¿™ä¸ªç®¡äººçš„äººä¸æ˜¯ä¼ä¸šçš„ç®¡ç†è€…ï¼Œè€Œæ˜¯å‘˜å·¥è‡ªå·±ã€‚â€œè‡ªç”±â€ä¸â€œè´£ä»»â€çš„æ ¸å¿ƒå°±æ˜¯è¦å°†æƒåŠ›è¿˜ç»™å‘˜å·¥ï¼Œè®©ä»–ä»¬èƒ½å¤Ÿåœ¨è‡ªç”±çš„ç¯å¢ƒä¸­å……åˆ†æ–½å±•è‡ªå·±çš„èƒ½åŠ›ï¼Œå±¥è¡Œè‡ªå·±çš„è´£ä»»ã€‚\nâ—† å‰è¨€ è‡ªç”±ä¸è´£ä»»ï¼Œå¥ˆé£æ–‡åŒ–çš„æ ¸å¿ƒ\nå½“æˆ‘ä»‹ç»æˆ‘ä»¬åœ¨å¥ˆé£å¼€å‘çš„ç®¡ç†æ–¹æ³•æ—¶ï¼Œæˆ‘ä¼šå¯¹æ‰€æœ‰å…³äºç®¡ç†çš„åŸºæœ¬å‡è®¾å‘èµ·æŒ‘æˆ˜ï¼Œç®¡ç†å¹¶ä¸æ˜¯è¦åœ¨å‘˜å·¥å¿ è¯šåº¦ã€äººå‘˜ç¨³å®šå’ŒèŒä¸šå‘å±•æ–¹é¢åšå·¥ä½œï¼ŒåŒæ—¶å®æ–½ç›¸å…³é¡¹ç›®æ¥æå‡å‘˜å·¥çš„æ•¬ä¸šåº¦å’Œå¹¸ç¦æ„Ÿã€‚è¿™é‡Œé¢æ²¡æœ‰ä¸€é¡¹æ˜¯ç®¡ç†åº”è¯¥åšçš„å·¥ä½œã€‚æˆ‘çš„ä¸€ä¸ªæç«¯ä¸»å¼ æ˜¯ï¼Œç®¡ç†è€…çš„æœ¬èŒå·¥ä½œæ˜¯å»ºç«‹ä¼Ÿå¤§çš„å›¢é˜Ÿï¼ŒæŒ‰æ—¶å®Œæˆé‚£äº›è®©äººè§‰å¾—ä¸å¯æ€è®®çš„å·¥ä½œã€‚åªæœ‰è¿™ä¸€é¡¹å·¥ä½œæ˜¯ç®¡ç†åº”è¯¥åšçš„ã€‚\nâ—† æˆå¹´äººæœ€æ¸´æœ›çš„å¥–åŠ±ï¼Œå°±æ˜¯æˆåŠŸ\nä»Šå¤©çš„ç®¡ç†ç†å¿µè®¤ä¸ºï¼Œå¦‚æœæƒ³è®©å‘˜å·¥æé«˜ç”Ÿäº§åŠ›ï¼Œå°±å¿…é¡»å…ˆç”¨å¥–é‡‘æ¥æ¿€åŠ±ä»–ä»¬ï¼Œç„¶åè®©ä»–ä»¬çŸ¥é“è‡ªå·±çš„è¡Œä¸ºæ˜¯å—åˆ°ç›‘æ§çš„ï¼Œä»¥ä¾¿è®©ä»–ä»¬ä¿æŒåšäº‹çš„è´£ä»»å¿ƒã€‚å› æ­¤ï¼Œå¾ˆå¤šå…¬å¸éƒ½æœ‰éƒ¨é—¨ç›®æ ‡ã€å›¢é˜Ÿç›®æ ‡å’Œä¸ªäººç›®æ ‡ï¼Œè¿˜æœ‰ä¸€å¥—æ­£å¼çš„å¹´åº¦ç»©æ•ˆè¯„ä¼°æµç¨‹ï¼Œç”¨ä»¥æµ‹é‡ç»©æ•ˆã€‚è¿™ç§ç»“æ„çš„é€»è¾‘æ€§éå¸¸å¼ºï¼Œä¹Ÿéå¸¸åˆç†ã€‚ä½†æ˜¯ï¼Œä»…æœ‰è¿™äº›æ˜¯è¿œè¿œä¸å¤Ÿçš„ã€‚å¯¹å‘˜å·¥è¯´ï¼šâ€œå¦‚æœä½ åšXï¼Œä½ å°±ä¼šå¾—åˆ°å¥–åŠ±Yâ€ï¼ŒèƒŒåçš„å‡è®¾æ˜¯â€œç³»ç»Ÿæ˜¯é™æ€çš„â€ã€‚ä½†æ˜¯ï¼Œä»Šå¤©æ²¡æœ‰å“ªé¡¹ä¸šåŠ¡æ˜¯é™æ€çš„ã€‚æ›´ä¸ºæ ¹æœ¬çš„æ˜¯ï¼Œå°½ç®¡æœ‰å¥–åŠ±å¾ˆä¸é”™ï¼Œä½†æ˜¯ï¼Œæ²¡æœ‰å“ªç§å¥–åŠ±èƒ½æ¯”ä¸ºè¿æ¥æŒ‘æˆ˜è€Œåšå‡ºé‡å¤§è´¡çŒ®æ›´å…·æ¿€åŠ±æ•ˆæœã€‚\nä½ èƒ½å¤Ÿä¸ºå‘˜å·¥åšçš„æœ€å¥½çš„äº‹æƒ…ï¼Œå°±æ˜¯åªæ‹›è˜é‚£äº›é«˜ç»©æ•ˆçš„å‘˜å·¥æ¥å’Œä»–ä»¬ä¸€èµ·å·¥ä½œã€‚è¿™å¯è¿œæ¯”æ¡Œä¸Šè¶³çƒã€å…è´¹å¯¿å¸ã€ä¸€å¤§ç¬”ç­¾çº¦å¥–é‡‘æˆ–è€…è‚¡ç¥¨æœŸæƒæ›´æœ‰å¸å¼•åŠ›ã€‚\nâ—† åŸ¹å…»åŸºå±‚å‘˜å·¥çš„é«˜å±‚è§†è§’\nå¦‚ä½•åšåˆ°è®©æ¯ä½å‘˜å·¥éƒ½ç†è§£å…¬å¸ä¸šåŠ¡1ï¼å»ºç«‹æ–°å‘˜å·¥å¤§å­¦ï¼Œä¿æŒæ²Ÿé€šçš„å¼ºèŠ‚å¥ã€‚2ï¼åŒå‘æ²Ÿé€šï¼Œä¸ºå‘˜å·¥æä¾›å‘æ‰€æœ‰ç®¡ç†è€…æé—®çš„æœºä¼šã€‚3ï¼è®©æ¯ä¸€ä½å‘˜å·¥äº†è§£ï¼Œä»–ä¸ºå®¢æˆ·å¸¦æ¥çš„ä½“éªŒæ˜¯å¦‚ä½•ç›´æ¥å½±å“å…¬å¸åˆ©æ¶¦çš„ã€‚4ï¼å¦‚æœåªé€‰æ‹©ä¸€é—¨è¯¾ç¨‹é¢å‘å…¬å¸å…¨å‘˜å¼€æˆï¼Œè¯·é€‰æ‹©å…¬å¸ä¸šåŠ¡è¿ä½œå’Œå®¢æˆ·æœåŠ¡çš„åŸºæœ¬çŸ¥è¯†ã€‚5ï¼æœ€å¥½çš„ç¦åˆ©ï¼Œæ˜¯è®©å‘˜å·¥æœ‰æœºä¼šå»æ›´å¥½åœ°äº†è§£ä¸šåŠ¡å’Œå®¢æˆ·ã€‚\nâ—† äººå‰äººåè¨€è¡Œä¸€è‡´\näººåŠ›èµ„æºéƒ¨é—¨å‰¯æ€»è£ä¼šæŠŠæˆ‘å«åˆ°ä»–çš„åŠå…¬å®¤ï¼Œå¤§å£°è´¨é—®ï¼šâ€œä½ æ˜¯ä¸æ˜¯å¼€å·¥ç¨‹å¸ˆçš„ç©ç¬‘äº†ï¼Ÿâ€æˆ‘è¯´ï¼šâ€œæ˜¯çš„ï¼Œä¸è¿‡ï¼Œæœ‰æ²¡æœ‰æé”™ï¼ä»–ä»¬æŠ±æ€¨æµ´ç¼¸é‡Œçš„æ°´ä¸å¤Ÿçƒ­ï¼Œæ¯›å·¾ä¸å¤Ÿè½¯ï¼Œè¿˜æœ‰æ¸¸æ³³æ± é‡Œçš„æ°´å¤ªå‡‰äº†ã€‚â€å‰¯æ€»è£å°±ä¼šè´£å¤‡æˆ‘ï¼šâ€œå·¥ç¨‹å¸ˆæ˜¯æˆ‘ä»¬æœ€é‡è¦çš„èµ„æºï¼Œä½ å¿…é¡»ç»™äºˆä»–ä»¬ç‰¹æ®Šå¯¹å¾…ï¼â€æˆ‘å¹¶ä¸è®¤åŒè¿™ä¸€ç‚¹ã€‚å°±åƒå‰é¢è®²è¿‡çš„ï¼Œæˆ‘å®åœ¨æ˜¯åŒå€¦äº†æŠŠå·¥ç¨‹å¸ˆå½“ä½œä¸Šå¸ä¸€æ ·å¯¹å¾…ã€‚åˆ°äº†å“ˆæ–¯å»·æ–¯é‚£é‡Œï¼Œä¸€åˆ‡éƒ½ä¸ä¸€æ ·äº†ã€‚åœ¨é¢è¯•æˆ‘æ—¶ï¼Œä»–çš„ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ï¼šâ€œä½ çš„äººåŠ›èµ„æºç†å¿µæ˜¯ä»€ä¹ˆï¼Ÿâ€è®°ä½ï¼Œæˆ‘å¯æ˜¯åœ¨å¤ªé˜³è®¡ç®—æœºç³»ç»Ÿå’ŒæŸå…°å¾·ä¸¤å®¶å…¬å¸å·¥ä½œè¿‡çš„ï¼Œäºæ˜¯æˆ‘ç”¨äººåŠ›èµ„æºæœ¯è¯­æµåˆ©åœ°å›ç­”é“ï¼šâ€œæˆ‘è®¤ä¸ºæ¯ä¸ªäººéƒ½åº”è¯¥æœ‰é‡å¿ƒï¼Œå¦è¯šï¼Œèƒ½å¤Ÿé€šè¿‡è¢«èµ‹èƒ½ä¸ºä¼ä¸šåšå‡ºè´¡çŒ®ã€‚â€å“ˆæ–¯å»·æ–¯çœ‹ç€æˆ‘è¯´ï¼šâ€œä½ è¯´çš„æ˜¯ä»€ä¹ˆï¼Ÿä½ çŸ¥é“ä½ åˆšæ‰è¯´çš„é‚£ç•ªè¯æ¯«æ— æ„ä¹‰å—ï¼Ÿé‚£äº›è¯ä¸²èµ·æ¥ï¼Œç”šè‡³éƒ½ä¸èƒ½ç»„æˆä¸€å¥æœ‰é€»è¾‘çš„è¯ï¼â€æˆ‘é•‡å®šè‡ªè‹¥åœ°å›ç­”é“ï¼šâ€œå˜¿ï¼Œä½ æ ¹æœ¬ä¸äº†è§£æˆ‘ï¼â€å“ˆæ–¯å»·æ–¯é’ˆé”‹ç›¸å¯¹ï¼šâ€œå¦‚æœæˆ‘ä»¬åƒè¿™æ ·è°ˆè¯ï¼Œä½ è§‰å¾—æˆ‘èƒ½æ€ä¹ˆäº†è§£ä½ ï¼Ÿå‘Šè¯‰æˆ‘ï¼Œä½ ä¼šåšä»€ä¹ˆæ¥å¸®åŠ©å…¬å¸æˆé•¿ï¼Ÿâ€\nç»™äºˆåé¦ˆæœ€é‡è¦çš„æ˜¯è¦é’ˆå¯¹è¡Œä¸ºï¼Œè€Œä¸æ˜¯ç¬¼ç»Ÿåœ°ç»™ä¸€ä¸ªäººå®šæ€§ï¼Œæ¯”å¦‚â€œä½ ä¸å¤Ÿä¸“å¿ƒã€‚â€åé¦ˆçš„å†…å®¹å¿…é¡»æ˜¯å¯æ“ä½œçš„ï¼Œåé¦ˆå¯¹è±¡å¿…é¡»ç†è§£ä»–ä»¬çš„è¡Œä¸ºéœ€è¦åšå‡ºå“ªäº›ç‰¹å®šçš„æ”¹å˜ã€‚åƒâ€œä½ åšå¾—ä¸é”™ï¼Œä½†æ˜¯è¿˜ä¸å¤Ÿâ€ï¼Œè¿™æ ·çš„è¯„è®ºå®é™…ä¸Šæ˜¯æ¯«æ— æ„ä¹‰çš„ã€‚ä½ å¯ä»¥è¿™ä¹ˆè¯´ï¼šâ€œæˆ‘èƒ½çœ‹åˆ°ä½ å·¥ä½œéå¸¸åŠªåŠ›ï¼Œæˆ‘å¾ˆæ¬£èµè¿™ä¸€ç‚¹ã€‚ä½†æ˜¯ï¼Œæˆ‘ä¹Ÿæ³¨æ„åˆ°ï¼Œä½ åœ¨æŸäº›äº‹æƒ…ä¸ŠèŠ±äº†å¤ªå¤šæ—¶é—´ï¼Œè€Œè¿™äº›æ—¶é—´æœ¬å¯ä»¥èŠ±åœ¨æ›´ä¸ºé‡è¦çš„äº‹æƒ…ä¸Šã€‚â€è¿™æ ·ï¼Œä½ æ¥ä¸‹æ¥å°±å¯ä»¥å’Œå¯¹æ–¹æ›´å¥½åœ°ç¡®å®šäº‹æƒ…çš„ä¼˜å…ˆé¡ºåºäº†ã€‚\nä¿¡ä»»æ˜¯å»ºç«‹åœ¨å¦è¯šæ²Ÿé€šçš„åŸºç¡€ä¹‹ä¸Šçš„ï¼Œæˆ‘å‘ç°å½“å‘˜å·¥å¬åˆ°åŠçœŸåŠå‡çš„è¯æ—¶å°±ä¼šå¼€å§‹å†·å˜²çƒ­è®½ã€‚å†·å˜²çƒ­è®½å°±åƒæ˜¯ç™Œç»†èƒï¼Œå®ƒå®¹æ˜“æ‰©æ•£ã€è½¬ç§»æˆç‰¢éªšå’Œä¸æ»¡ï¼Œå¹¶å¯¼è‡´é˜¿è°€å¥‰æ‰¿å’ŒèƒŒåä¸­ä¼¤ç­‰ä¸è‰¯é£æ°”ã€‚\nä¼ ç»Ÿè§‚ç‚¹è®¤ä¸ºï¼Œå¦‚æœå…è®¸äººä»¬åŒ¿åï¼Œä»–ä»¬å°±ä¼šè¡¨ç°å¾—æ›´å¦è¯šã€‚ä½†æ ¹æ®æˆ‘çš„ç»éªŒï¼Œæƒ…å†µå¹¶éå¦‚æ­¤ã€‚å¦è¯šçš„äººä¼šå¦è¯šåœ°å¯¹å¾…ä»»ä½•äº‹æƒ…ã€‚è€Œä¸”ï¼Œå¦‚æœä½ ä¸çŸ¥é“æ˜¯è°ç»™ä½ çš„åé¦ˆï¼Œä½ æ€ä¹ˆæŠŠä»–çš„è¯„è¯­å’Œä»–çš„å·¥ä½œèƒŒæ™¯ã€ä»–çš„ä¸Šçº§ä»¥åŠä»–çš„æ€§æ ¼ç‰¹ç‚¹ç»“åˆèµ·æ¥å‘¢ï¼ŸåŒ¿ååé¦ˆæœ€å¤§çš„é—®é¢˜å°±åœ¨äºå®ƒä¼ é€’å‡ºè¿™æ ·ä¸€ä¸ªä¿¡æ¯ï¼šäººä»¬åªæœ‰åœ¨å¯¹æ–¹ä¸çŸ¥é“è‡ªå·±æ˜¯è°çš„æ—¶å€™æ‰æ˜¯æœ€å¦è¯šçš„ã€‚\nâ—† åšæŒä½ çš„è§‚ç‚¹ï¼Œç”¨äº‹å®ä¸ºå®ƒè¾©æŠ¤\næˆ‘ä»¬åœ¨å¥ˆé£æå‡ºäº†ä¸€ä¸ªè¦æ±‚ï¼Œå³äººä»¬å¿…é¡»é€šè¿‡æ¢æ±‚äº‹å®æ¥å®Œå–„è‡ªå·±çš„è§‚ç‚¹ï¼Œå¹¶ä¸”ä»¥å¼€æ”¾çš„å¿ƒæ€å»å€¾å¬é‚£äº›ä»–ä»¬å¹¶ä¸è®¤åŒï¼Œä½†ä»¥äº‹å®ä¸ºä¾æ®çš„è¾©è®ºã€‚è¿™ä¸ªè¦æ±‚æ‰§è¡Œå¾—å¾ˆé¡ºåˆ©ï¼Œå› ä¸ºæˆ‘ä»¬æ—©æœŸçš„å‘˜å·¥éƒ½æ˜¯æ•°å­¦å®¶å’Œå·¥ç¨‹å¸ˆï¼Œç§‘å­¦æ–¹æ³•å°±æ˜¯ä»–ä»¬çš„ç”Ÿå‘½ï¼Œä»–ä»¬ä¾é è¿™äº›æ–¹æ³•æ¥å‘ç°äº‹å®ï¼Œç„¶åè°ƒæ•´è‡ªå·±å¯¹é—®é¢˜çš„ç†è§£ä»¥åŠå¤„ç†é—®é¢˜çš„æ–¹å¼ã€‚éšç€å…¬å¸çš„å£®å¤§ï¼Œæˆ‘ä»¬æœ‰æ„åŸ¹å…»å‘˜å·¥å¯¹äº‹å®é©±åŠ¨å’Œç§‘å­¦æ–¹æ³•çš„ç—´è¿·ï¼Œä¸åªæ˜¯åœ¨å·¥ç¨‹éƒ¨ï¼Œè€Œæ˜¯åœ¨å…¨å…¬å¸ã€‚ä½ çš„å…¬å¸ä¹Ÿå¯ä»¥å¹¿æ³›æ¨è¡Œè¿™å¥—è¡Œä¸ºå‡†åˆ™ï¼Œå³ä¾¿ä¸æ˜¯å·¥ç¨‹å¸ˆçš„å…¬å¸ä¹Ÿå¯ä»¥ã€‚\næˆ‘ä»¬æ ¹æ®ç›´è§‰é‡‡å–äº†ä¸å°‘è¡ŒåŠ¨ï¼Œåœ¨ä¸ºå›¢é˜Ÿå¯»æ‰¾äººæ‰æ—¶ï¼Œæˆ‘ä¼šç•™æ„é‚£äº›ä¼šåˆ†ææ•°æ®ï¼Œè€Œä¸”å‡­ç›´è§‰å°±çŸ¥é“è¯¥å¦‚ä½•å¿½ç•¥æ•°æ®çš„äººã€‚â€æ³°å¾·è¿˜è­¦å‘Šè¯´ï¼Œæ•°æ®å¯ä»¥è¢«å½“ä½œä¸€ä¸ªæŒ¡ç®­ç‰Œï¼ŒæŠµæŒ¡æœ¬è¯¥ç”¨ä¸»è§‚åˆ¤æ–­æ¥åšå‡ºå†³å®šçš„è´£ä»»ã€‚åŸºäºçœŸå®æ•°æ®æ¥åšå†³å®šä¼šä»¤äººä»¬æ„Ÿåˆ°æ›´è‡ªåœ¨ï¼Œéƒ¨åˆ†åŸå› æ˜¯ï¼šå¦‚æœå†³å®šæ˜¯é”™è¯¯çš„è¯ï¼Œå°±å¯ä»¥æŠŠè´£ä»»æ¨åˆ°æ•°æ®ä¸Šé¢ã€‚\nâ—† ä¸è¦è®©æ‹›è˜æˆä¸ºä¸€åœºæ•°å­—æ¸¸æˆ\nå½“æ—¶çš„ç¾å›½å›½é˜²éƒ¨é•¿å”çº³å¾·Â·æ‹‰å§†æ–¯è²å°”å¾·ï¼ˆDonald Rumsfeldï¼‰æœ‰ä¸€å¥åè¨€ï¼šâ€œä½ è¦å¸¦ç€ä½ ç°æœ‰çš„å†›é˜Ÿï¼Œè€Œä¸æ˜¯ä½ æƒ³æœ‰çš„æˆ–è€…ä½ ä»¥åå¸Œæœ›æœ‰çš„å†›é˜Ÿå‚åŠ æˆ˜äº‰ã€‚â€å½“æˆ‘å’Œç®¡ç†è€…ä»¬è®¨è®ºå¦‚ä½•å»ºç«‹ä¼˜ç§€å›¢é˜Ÿæ—¶ï¼Œæˆ‘å‘Šè¯‰ä»–ä»¬è¦æŒ‰ç…§å®Œå…¨ç›¸åçš„æ–¹å¼æ¥è¡Œäº‹ã€‚ä½ å¿…é¡»ç°åœ¨å°±æ‹›è˜ä½ æœªæ¥å¸Œæœ›æ‹¥æœ‰çš„å›¢é˜Ÿæˆå‘˜ã€‚\næ™‹å‡å‘˜å·¥å¹¶æŒ‡å¯¼ä»–ä»¬æ‰®æ¼”æ–°è§’è‰²ï¼Œå¯¹å›¢é˜Ÿé¢†å¯¼è€…æ¥è¯´æ˜¯ä¸€ä»¶ç›¸å½“æœ‰æ»¡è¶³æ„Ÿçš„äº‹æƒ…ï¼Œå¯¹å›¢é˜Ÿç»©æ•ˆæ¥è¯´ä¹Ÿæ˜¯ä¸€ä»¶å¥½äº‹ã€‚ä½†æ˜¯ï¼Œæ™‹å‡å’ŒåŸ¹å…»å‘˜å·¥å¯¹äºå›¢é˜Ÿç»©æ•ˆæ¥è¯´ï¼Œé€šå¸¸å¹¶ä¸æ˜¯æœ€ç†æƒ³çš„æ–¹å¼ã€‚ç®¡ç†è€…ä¸åº”è¯¥æœŸæœ›è‡ªå·±æˆä¸ºå‘˜å·¥çš„èŒä¸šè§„åˆ’è€…ã€‚åœ¨ä»Šå¤©å¿«é€Ÿå‘å±•çš„å•†ä¸šç¯å¢ƒä¸­ï¼Œè¯•å›¾æ‰®æ¼”è¿™ç§è§’è‰²æ˜¯å¾ˆå±é™©çš„ã€‚\næˆ‘ç›¸ä¿¡ï¼Œå¯¹äºä»Šå¤©èŒåœºäººå£«çš„æœ€ä½³å»ºè®®å°±æ˜¯ï¼šä¿æŒçµæ´»ï¼Œä¸æ–­å­¦ä¹ æ–°æŠ€èƒ½ï¼Œä¸æ–­è€ƒè™‘æ–°æœºä¼šï¼Œç»å¸¸æ¥å—æ–°æŒ‘æˆ˜ï¼Œè¿™æ ·å¯ä»¥ä¿æŒå·¥ä½œçš„æ–°é²œæ„Ÿå’Œå»¶å±•æ€§ã€‚å¥ˆé£é¼“åŠ±å‘˜å·¥ä¸ºè‡ªå·±çš„æˆé•¿è´Ÿè´£ï¼Œåˆ©ç”¨å¥½å…¬å¸æä¾›çš„å¤§é‡æœºä¼šï¼Œå‘é‚£äº›ä¼˜ç§€çš„åŒäº‹å’Œç®¡ç†è€…å­¦ä¹ ï¼Œæ— è®ºè¿™æ ·åšæ˜¯æ„å‘³ç€åœ¨å…¬å¸å†…éƒ¨è·å¾—æ™‹å‡è¿˜æ˜¯åœ¨å…¬å¸å¤–éƒ¨è·å¾—ä¸€ä¸ªå¥½æœºä¼šã€‚\næœ‰æ—¶å€™ï¼Œåœ¨æŸä¸ªæ—¶é—´æ®µå¯¹ä¸€ä¸ªç»„ç»‡æ¥è¯´æ˜¯éå¸¸åˆé€‚ï¼Œä¹Ÿå–œæ¬¢ä¸ºè¿™ä¸ªç»„ç»‡å·¥ä½œçš„é‚£äº›äººï¼Œæœ€å¥½æ˜¯è·³æ§½å»é‚£äº›æœ‰ç±»ä¼¼æŒ‘æˆ˜å’Œç¯å¢ƒçš„æ–°ç»„ç»‡ã€‚æˆ‘å‘Šè¯‰è¿™ä½å·¥ç¨‹å¸ˆï¼šâ€œæ²¡å…³ç³»ï¼Œä½ ä¸å¿…éå¾—æˆä¸ºå…¶ä¸­çš„ä¸€åˆ†å­ï¼Œä¹Ÿè®¸ä½ åœ¨ä¸€å®¶50äººçš„å…¬å¸é‡Œä¼šæ›´å¿«ä¹ï¼Œä¹Ÿè®¸é‚£é‡Œæ‰æ˜¯ä½ èƒ½æ‰¾åˆ°æœ€å¤§ä¹è¶£çš„åœ°æ–¹ã€‚â€\nâ—† äººæ‰ä¿ç•™ä¸æ˜¯å›¢é˜Ÿå»ºè®¾çš„ç›®æ ‡\næ­£å¦‚å¥ˆé£æœ€å¥½çš„ç”¨äººç»ç†ä¹‹ä¸€çš„çº¦ç¿°Â·è¾›åº“ææ›¾ç»è·Ÿæˆ‘è¯´çš„ï¼šâ€œçŸ¥é“ä»€ä¹ˆæ—¶å€™è®©å‘˜å·¥ç¦»å¼€ä¸å¼•è¿›ä¸€ä¸ªæ‹¥æœ‰ä½ æ‰€éœ€æŠ€èƒ½çš„é¡¶å°–äººæ‰ï¼Œæ˜¯ç›¸è¾…ç›¸æˆçš„ã€‚ä»–ä»¬å°±åƒä¸€æšç¡¬å¸çš„ä¸¤é¢ã€‚å¦‚æœä½ ä¸æ˜¯å¾ˆæ“…é•¿æ‹›è˜ä¼˜ç§€äººæ‰ï¼Œé‚£ä¹ˆåœ¨è®©ä¼˜ç§€å‘˜å·¥ç¦»å¼€æ—¶ï¼Œä½ çš„å¿ƒé‡Œå°±ä¸ä¼šå¥½å—ã€‚äºŒè€…ç¼ºä¸€ï¼Œä½ éƒ½æ— æ³•åšå¥½å¦å¤–ä¸€é¡¹ï¼Œä¹Ÿæ°¸è¿œæ— æ³•å»ºç«‹ä¸€æ”¯é«˜ç»©æ•ˆçš„å›¢é˜Ÿã€‚â€\næœ€æœ‰ç«äº‰åŠ›çš„å…¬å¸èƒ½å¤Ÿä¿æŒçµæ´»ï¼Œä¸æ–­åˆ›æ–°å’Œå¢é•¿ï¼Œå¾ˆå¤§åŸå› åœ¨äºå®ƒä»¬æ€»åœ¨ç§¯æåœ°å¼•è¿›æ–°çš„äººæ‰ã€‚æœ€å¥½çš„å‘˜å·¥åˆ™æ€»æ˜¯åœ¨å¯»æ‰¾æœ‰æŒ‘æˆ˜çš„æ–°æœºä¼šï¼Œå°½ç®¡ä»–ä»¬å¤§å¤šæåº¦å¿ è¯šï¼Œä½†æ˜¯ä»–ä»¬ä¸­çš„å¾ˆå¤šäººæœ€ç»ˆè¿˜æ˜¯ä¼šåˆ°åˆ«å¤„å¯»æ‰¾æœºä¼šã€‚ä½ æ°¸è¿œä¹Ÿä¸ä¼šçŸ¥é“ä»–ä»¬ä½•æ—¶å†³å®šç¦»å¼€ï¼Œé€šå¸¸ä½ ä¹Ÿæ²¡æœ‰åŠæ³•é˜»æ­¢ä»–ä»¬ã€‚\nå‘˜å·¥åœ¨å·¥ä½œä¸­çš„å¹¸ç¦ä¸åº”è¯¥æ˜¯ç¾å‘³æ²™æ‹‰ã€ç¡è¢‹æˆ–æ¡Œçƒã€‚å·¥ä½œä¸­çœŸå®å’ŒæŒä¹…çš„å¹¸ç¦æºäºå’Œä½ è®¤è¯†çš„ä¼˜ç§€äººæ‰ä¸€èµ·æ·±å…¥åœ°è§£å†³ä¸€ä¸ªé—®é¢˜ï¼Œæºäºå®¢æˆ·å–œçˆ±ä½ ä»˜å‡ºè¾›å‹¤åŠªåŠ›æ‰€åˆ›é€ çš„äº§å“æˆ–æœåŠ¡ã€‚\nä½†è°·æ­Œåœ¨æ‹›è˜æ–¹é¢åšå¾—æ›´å¥½ï¼Œå› ä¸ºå®ƒçš„ç›®æ ‡æ›´å¤§ï¼Œå®ƒè¦æŠŠä¸–ç•Œä¸Šæ‰€æœ‰çš„ä¿¡æ¯ç»„ç»‡èµ·æ¥ã€‚è¿˜æœ‰æ¯”è¿™ä¸ªæ›´å¤§çš„ç›®æ ‡å—ï¼Ÿæ‰€ä»¥ï¼Œè°·æ­Œå°½å¯èƒ½å¤šåœ°æ‹›å‹Ÿé‚£äº›èªæ˜äººï¼ŒæŠŠä»–ä»¬æ”¾åˆ°ä¸€ä¸ªæ‹¥æœ‰æ‰€æœ‰èµ„æºçš„ç¯å¢ƒä¸­ï¼Œè®©ä»–ä»¬äº§å‡ºå¤§é‡åˆ›æ„ï¼Œç„¶åæŠŠé‚£äº›æœ€é¡¶çº§çš„åˆ›æ„åˆ©ç”¨èµ·æ¥ã€‚è°·æ­Œçš„é¢†å¯¼è€…å¸Œæœ›åˆ©ç”¨ä¸åŒçš„æ–¹å¼æ¨åŠ¨å…¬å¸çš„å‘å±•ï¼Œå› æ­¤äººæ‰æ•°é‡å¯¹ä»–ä»¬æ¥è¯´éå¸¸é‡è¦\næˆ‘æœ‰ä¸€ä¸ªé“å¾‹ï¼Œå¦‚æœæœ‰æ‹›è˜äººå‘˜çœ‹è§ä¸€ä¸ªé™Œç”Ÿäººååœ¨é‚£é‡Œç­‰å€™é¢è¯•ï¼Œä»–ä»¬å¿…é¡»è¿‡å»å’Œä»–è¯´ï¼šâ€œå—¨ï¼Œæˆ‘å«XXï¼Œæ‚¨æ˜¯å“ªä¸€ä½ï¼Ÿæ‚¨æ˜¯è¦é¢è¯•å—ï¼Ÿæ‚¨åœ¨ç­‰è°ï¼Ÿè®©æˆ‘çœ‹çœ‹æ‚¨ä»Šå¤©çš„é¢è¯•å®‰æ’ï¼Œæˆ‘æ¥å¸®æ‚¨å®‰æ’ä¸€ä¸‹ã€‚â€æˆ‘çŸ¥é“æ‹›è˜å›¢é˜Ÿæˆå‘˜æ¸…æ¥šåœ°å¬åˆ°äº†è¿™ä¸ªè§„åˆ™ï¼Œå› ä¸ºå¦‚æœæˆ‘åœ¨é¢è¯•æŸä¸ªåº”è˜è€…æ—¶è¿Ÿåˆ°çš„è¯ï¼Œæˆ‘ä¼šè¯´ï¼šâ€œå¯¹ä¸èµ·ï¼Œæˆ‘å¸Œæœ›æœ‰äººå·²ç»è·Ÿæ‚¨èŠè¿‡äº†ã€‚â€ä»–ä»¬ä¼šè¯´ï¼šâ€œæœ‰6ä¸ªäººè·Ÿæˆ‘èŠè¿‡äº†ã€‚â€é¢è¯•çš„é‡è¦æ€§é«˜äºç”¨äººç»ç†äº‹å…ˆé¢„è®¢çš„ä»»ä½•ä¼šè®®ï¼Œè¿™ä¹Ÿæ˜¯é«˜ç®¡ä¼šè®®çš„ä¸ä¼šè€…å¯èƒ½ç¼ºå¸­æˆ–æå‰ç¦»å¼€ä¼šè®®çš„å”¯ä¸€ç†ç”±ã€‚å€™é€‰äººåœ¨è¯„ä¼°ä½ ï¼Œå°±åƒä½ åœ¨è¯„ä¼°ä»–ä»¬ä¸€æ ·ï¼Œä½†äººä»¬å¾ˆå®¹æ˜“å¿˜è®°è¿™ä¸€ç‚¹ã€‚\nâ—† è–ªé…¬ä¸ç»©æ•ˆè¯„ä¼°æµç¨‹æ— å…³ï¼Œåªä¸ç»©æ•ˆæœ‰å…³\næ ¹æ®æˆ‘çš„ç»éªŒï¼Œå¦‚æœä½ æœ‰æ„æ‹›è˜ä½ èƒ½å‘ç°çš„æœ€ä½³äººé€‰ã€ç»™ä»–ä»¬æ”¯ä»˜æœ€é«˜çš„è–ªæ°´ï¼Œä½ ä¼šå‘ç°ï¼Œä»–ä»¬ä¸ºä¸šåŠ¡å¢é•¿å¸¦æ¥çš„ä»·å€¼æ€»æ˜¯ä¼šå¤§å¤§è¶…è¿‡ä»–ä»¬çš„è–ªæ°´ã€‚\nâ—† æ¯10åœºæ¯”èµ›å°±åšä¸€æ¬¡è¯„ä¼°\næœ‰å¾ˆå¤šæ¬¡ï¼Œåœ¨å®Œæˆæ¼”è®²ä¹‹åï¼Œäººä»¬ä¼šèµ°ä¸Šå‰æ¥å‘æˆ‘å¾æ±‚èŒä¸šå‘å±•æ„è§ã€‚æˆ‘å‘Šè¯‰ä»–ä»¬ï¼šä½ éœ€è¦æˆä¸ºä¸€ä¸ªç»ˆèº«å­¦ä¹ è€…ã€‚ä½ éœ€è¦ä¸æ–­è·å–æ–°æŠ€èƒ½å¹¶ç§¯ç´¯æ–°ç»éªŒï¼Œä½†ä¸æ˜¯éå¾—åœ¨åŒä¸€å®¶å…¬å¸å–å¾—å®ƒä»¬ã€‚äº‹å®ä¸Šï¼Œæœ‰æ—¶å€™å…¬å¸è˜ç”¨ä½ åšæŸä»¶äº‹ï¼Œä½ åšå®Œå°±å®Œäº†ã€‚å¦‚æœæˆ‘é›‡ç”¨åˆ«äººæ¥æ•´ä¿®æˆ‘çš„è½¦åº“ï¼Œå½“ä»–ä»¬å¹²å®Œæ´»å„¿ä¹‹åï¼Œæˆ‘å¹¶ä¸éœ€è¦ä»–ä»¬æ¥æ•´ä¿®æˆ‘çš„åé™¢ã€‚\n1ï¼å¦‚æœå‘˜å·¥çš„è¡¨ç°ä¸å¤Ÿå¥½ï¼ŒåŠæ—¶å‘Šè¯‰ä»–ä»¬è¦ä¹ˆçº æ­£è¿‡æ¥ï¼Œè¦ä¹ˆå»ä¸€å®¶æ–°å…¬å¸ã€‚2ï¼ä¸è¦æŠŠä¸å·¥ä½œä¸å†åŒ¹é…çš„å‘˜å·¥å½’ç»“ä¸ºå¤±è´¥è€…ã€‚3ï¼ä¸è¦ç»™å‘˜å·¥æ— æ³•å®ç°çš„æ‰¿è¯ºï¼Œè¿™åªä¼šè®©ä»–ä»¬æ„Ÿè§‰è‡ªå·±è¢«èƒŒå›äº†ã€‚4ï¼ç§¯æåœ°å¸®åŠ©ç¦»èŒå‘˜å·¥æ‰¾åˆ°æ–°çš„å¥½æœºä¼šã€‚\n","permalink":"https://blog.niuhemoon.win/posts/read/%E5%A5%88%E9%A3%9E%E6%96%87%E5%8C%96%E6%89%8B%E5%86%8C/","summary":"\u003cp\u003e\u003cstrong\u003eã€Šå¥ˆé£æ–‡åŒ–æ‰‹å†Œã€‹\u003c/strong\u003e\nèŒƒç‚è¯‘\u003c/p\u003e","title":"å¥ˆé£æ–‡åŒ–æ‰‹å†Œ"},{"content":"ã€Šä¸–ç•Œè§‚ï¼šç°ä»£äººå¿…é¡»è¦æ‡‚çš„ç§‘å­¦å“²å­¦å’Œç§‘å­¦å²ï¼ˆåŸä¹¦ç¬¬2ç‰ˆï¼‰ã€‹ ç†æŸ¥å¾·Â·å¾·å¨ç‰¹ï¼ˆRichard DeWittï¼‰\nâ—† ç¬¬1ç«  ä¸–ç•Œè§‚\nä¸€ä¸ªè§‚ç‚¹å¦‚æœå³ä½¿æœ¬èº«å‘ç”Ÿå˜åŒ–ä¹Ÿä¸å¯¹å…¶æ‰€åœ¨çš„è§‚ç‚¹ä½“ç³»äº§ç”Ÿå®è´¨æ€§æ”¹å˜ï¼Œé‚£å®ƒå°±æ˜¯ä¸€ä¸ªå…¸å‹çš„å¤–å›´è§‚ç‚¹ã€‚\næ€»ä¹‹ï¼Œæˆ‘ä»¬åªèƒ½ä¸ºæˆ‘ä»¬æ‰€ç§‰æŒçš„æå°ä¸€éƒ¨åˆ†è§‚ç‚¹æ‹¿å‡ºç›´æ¥è¯æ®ã€‚å¯¹æˆ‘ä»¬çš„å¤§å¤šæ•°è§‚ç‚¹ï¼ˆä¹Ÿè®¸æ˜¯å‡ ä¹æ‰€æœ‰è§‚ç‚¹ï¼‰æ¥è¯´ï¼Œæˆ‘ä»¬ä¹‹æ‰€ä»¥ç§‰æŒè¿™äº›è§‚ç‚¹ï¼Œä¸»è¦åœ¨äºå®ƒä»¬å¯ä»¥è·Ÿä¸€ä¸ªå¾ˆå¤§çš„ã€å…¶ä¸­å„ä¸ªè§‚ç‚¹ç›¸äº’è”ç»“çš„è§‚ç‚¹é›†åˆæ‹¼åˆåœ¨ä¸€èµ·ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬ä¹‹æ‰€ä»¥ç§‰æŒè¿™æ ·çš„è§‚ç‚¹ä¸»è¦æ˜¯å› ä¸ºå®ƒä»¬å¯ä»¥è·Ÿæˆ‘ä»¬çš„ä¸–ç•Œè§‚æ‹¼åˆåœ¨ä¸€èµ·ã€‚\nâ—† ç¬¬2ç«  çœŸç†\næ‰€ä»¥ï¼Œæ€»ç»“ä¸€ä¸‹ï¼Œæ ¹æ®çœŸç†ç¬¦åˆè®ºï¼Œå†³å®šä¸€ä¸ªè§‚ç‚¹ä¸ºçœŸçš„å› ç´ æ˜¯è¿™ä¸ªè§‚ç‚¹ä¸ç‹¬ç«‹ã€å®¢è§‚çš„ç°å®ç›¸ç¬¦åˆï¼›å†³å®šä¸€ä¸ªè§‚ç‚¹ä¸ºå‡çš„å› ç´ æ˜¯è¿™ä¸ªè§‚ç‚¹æ²¡èƒ½ä¸é‚£æ ·çš„ç°å®ç›¸ç¬¦åˆã€‚\nåœ¨è¿™é‡Œåˆ—å‡ºä¸ªäººä¸»ä¹‰èè´¯è®ºå’Œä»¥ç§‘å­¦ä¸ºåŸºç¡€çš„èè´¯è®ºä¸»è¦æ˜¯ä¸ºäº†è¯´æ˜åœ¨èè´¯è®ºè¿™ä¸ªç†è®ºç±»åˆ«ä¸­è¿˜æœ‰è®¸å¤šä¸åŒçš„å°ç±»åˆ«ã€‚ç”±äºä¸åŒç§ç±»çš„èè´¯è®ºçš„ä¸»è¦åŒºåˆ«åœ¨äºè€ƒè™‘äº†å“ªäº›äººçš„è§‚ç‚¹ï¼ŒåŒæ—¶ï¼Œå­˜åœ¨å¾ˆå¤šä¸åŒçš„æ–¹æ³•æ¥è§£é‡Šå…·ä½“è€ƒè™‘äº†å“ªäº›äººçš„è§‚ç‚¹ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»æ˜ç™½ï¼Œå¯èƒ½å­˜åœ¨å¤§é‡å·®å¼‚å·¨å¤§çš„èè´¯è®ºã€‚\nä»æœ¬è´¨ä¸Šè®²ï¼ŒçŸ¥è§‰è¡¨å¾è®ºçš„æ ¸å¿ƒæ˜¯ï¼šæ„Ÿå®˜ä¸ºæˆ‘ä»¬æä¾›äº†å¤–éƒ¨ä¸–ç•Œå„ç§ç‰©ä½“çš„è¡¨å¾ï¼ˆå¯¹è§†è§‰æ¥è¯´ï¼Œè¿™äº›è¡¨å¾å¤§è‡´ç±»ä¼¼å›¾ç”»ï¼‰ã€‚åŒæ ·åœ°ï¼Œè¿™æ˜¯ä¸€ä¸ªå‡ ä¹æ‰€æœ‰äººéƒ½è®¤ä¸ºç†æ‰€å½“ç„¶çš„è§‚ç‚¹ã€‚ä¸è¿‡ï¼Œè¿™ä¸ªè§‚ç‚¹åŒæ—¶ä¹Ÿæœ‰äº›æœ‰è¶£çš„æ¨è®ºï¼Œè€Œè¿™äº›æ¨è®ºå´ç›´æ¥å½±å“äº†çœŸç†ç¬¦åˆè®ºã€‚è¿™äº›æ¨è®ºä¸­æœ€é‡è¦çš„ä¸€ä¸ªæ˜¯ï¼Œè¿™ä¸ªè§‚ç‚¹æ„å‘³ç€æˆ‘ä»¬æ¯ä¸ªäººä»æŸç§æ„ä¹‰ä¸Šæ¥è¯´ä¸è¿™ä¸ªä¸–ç•Œéƒ½æ˜¯éš”ç»çš„ã€‚æ›´å…·ä½“åœ°è¯´ï¼Œæˆ‘ä»¬æ²¡æœ‰åŠæ³•ç¡®å®šè‡ªèº«æ„Ÿå®˜æ‰€æä¾›çš„è¡¨å¾æ˜¯å¦å‡†ç¡®ã€‚\nå¦‚æœè‡ªèº«æ„Ÿå®˜ä¸ºæˆ‘ä»¬æä¾›äº†å¤–éƒ¨ä¸–ç•Œçš„è¡¨å¾ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥ä¸€ä¸ªåˆç†çš„é—®é¢˜å°±æ˜¯è¿™äº›è¡¨å¾æ˜¯å¦å‡†ç¡®ã€‚æ­£å¦‚æˆ‘ä»¬åˆšåˆšè®¨è®ºè¿‡çš„ï¼Œè¦è¯„ä¼°æ„Ÿå®˜æä¾›çš„è¡¨å¾æ˜¯å¦å‡†ç¡®ï¼Œæˆ‘ä»¬éœ€è¦æŠŠè¿™äº›è¡¨å¾å’Œè¡¨å¾æ‰€ä»£è¡¨çš„äº‹ç‰©è¿›è¡Œå¯¹æ¯”ã€‚ç„¶è€Œï¼Œè®©æˆ‘ä»¬å†çœ‹ä¸€çœ‹å›¾2-1ä¸­è¨æ‹‰çš„æ„è¯†å›¾è§£ã€‚å‡è®¾è¨æ‹‰æƒ³è¯„ä¼°å¥¹å…³äºè‹¹æœçš„è§†è§‰è¡¨å¾æ˜¯å¦æ­£ç¡®ï¼Œè¦è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œå¥¹éœ€è¦æŠŠè‹¹æœçš„è§†è§‰è¡¨å¾ä¸çœŸæ­£çš„è‹¹æœè¿›è¡Œå¯¹æ¯”ã€‚ä½†æ˜¯ï¼Œè¨æ‹‰æ²¡æœ‰åŠæ³•è¿™ä¹ˆåšã€‚è¨æ‹‰ä¸èƒ½æŠŠè‹¹æœçš„è§†è§‰è¡¨å¾ä¸çœŸæ­£çš„è‹¹æœè¿›è¡Œå¯¹æ¯”çš„åŸå› æ˜¯å¥¹æ— æ³•ä»è‡ªå·±çš„æ„è¯†ä¸­èµ°å‡ºæ¥ã€‚ä»è¨æ‹‰çš„è§’åº¦æ¥çœ‹ï¼Œå¥¹æ‰€èƒ½è¿ç”¨çš„éƒ½åœ¨å¥¹çš„æ„è¯†é‡Œã€‚\nè¿™ä¸ªæƒ…å½¢å°±åƒæ˜¯ä¸ºäº†è¯„ä¼°æ¶é­”å¡”ç…§ç‰‡çš„å‡†ç¡®æ€§è€ŒæŠŠç…§ç‰‡å’Œæ¶é­”å¡”çš„åœ°å½¢å›¾æˆ–è€…æ¶é­”å¡”å‘¨å›´é“è·¯çš„åœ°å›¾è¿›è¡Œå¯¹æ¯”ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯¹æ¯”æ˜¯åœ¨ä¸¤ä¸ªè¡¨å¾ä¹‹é—´è¿›è¡Œçš„ï¼Œè€Œè¯„ä¼°è¡¨å¾å‡†ç¡®æ€§æ‰€éœ€è¦çš„å¯¹æ¯”ï¼Œä¹Ÿå°±æ˜¯è¡¨å¾ä¸è¿™ä¸ªè¡¨å¾æ‰€ä»£è¡¨çš„äº‹ç‰©ä¹‹é—´çš„å¯¹æ¯”ï¼Œå¹¶æ²¡æœ‰è¿›è¡Œã€‚è¿™ä¸ªæ¨è®ºè¯´æ˜ï¼Œæˆ‘ä»¬æ ¹æœ¬æ²¡æœ‰åŠæ³•è¯„ä¼°æ„Ÿå®˜ç»™æˆ‘ä»¬æä¾›çš„è¡¨å¾æ˜¯å¦å‡†ç¡®ï¼Œæˆ–è€…æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬æ²¡æœ‰åŠæ³•ç¡®å®šç°å®åˆ°åº•æ˜¯ä»€ä¹ˆæ ·å­çš„\næ€»ä¹‹ï¼Œå°½ç®¡æˆ‘ä»¬éƒ½è®¤ä¸ºè‡ªå·±çš„ä½“éªŒæ¥è‡ªäºâ€œæ­£å¸¸â€çš„ç°å®ï¼Œä½†æˆ‘ä»¬å¹¶ä¸èƒ½ç¡®å®šè¿™äº›ä½“éªŒä¸æ˜¯æ¥è‡ªäºæŸç§ã€Šå…¨é¢å›å¿†ã€‹æƒ…å¢ƒæ¤å…¥æˆ‘ä»¬å¤§è„‘ä¸­çš„ç°å®ã€‚ç®€è¨€ä¹‹ï¼Œæˆ‘ä»¬æ— æ³•ç¡®å®šç°å®çœŸæ­£çš„æ ·å­ã€‚\næ€»ç»“ä¸€ä¸‹ï¼Œä¸ªäººä¸»ä¹‰èè´¯è®ºä¼¼ä¹ä¼šé™·å…¥ä¸€ç§è®©äººæ— æ³•æ¥å—çš„ç›¸å¯¹ä¸»ä¹‰ã€‚å¦ä¸€æ–¹é¢ï¼Œå›¢ä½“èè´¯è®ºä¼¼ä¹é¿å…äº†ç›¸å¯¹ä¸»ä¹‰çš„é—®é¢˜ï¼Œä½†æ˜¯åŒæ—¶åˆå¸¦æ¥äº†å‡ ä¸ªæ–°çš„ã€ä¸å®¹å¿½è§†çš„é—®é¢˜ã€‚æ‰€ä»¥ï¼Œä¸ç®¡æ˜¯çœŸç†èè´¯è®ºè¿˜æ˜¯çœŸç†ç¬¦åˆè®ºï¼Œå¯¹å…³äºçœŸç†çš„æ ¸å¿ƒé—®é¢˜ï¼Œéƒ½æ— æ³•æä¾›è®©äººå®Œå…¨æ»¡æ„çš„ç­”æ¡ˆã€‚\nç”šè‡³â€œæˆ‘æœ‰ä¸€ä¸ªèº«ä½“â€çš„è§‚ç‚¹ä¹Ÿç»ä¸èµ·æµ‹è¯•ï¼Œå› ä¸ºå¯èƒ½é‚ªæ¶éª—å­æ­£åœ¨å¾€æˆ‘æ²¡æœ‰å®ä½“çš„å¤§è„‘ä¸­æ¤å…¥èº«ä½“çš„å›¾åƒã€‚é‚£æœ‰æ²¡æœ‰è§‚ç‚¹ç»å¾—èµ·è¿™ä¸ªæµ‹è¯•å‘¢ï¼Ÿä¹Ÿå°±æ˜¯è¯´ï¼Œæ˜¯å¦å­˜åœ¨å¯ä»¥è®©æˆ‘ä»¬æ„Ÿåˆ°å®Œå…¨ç¡®å®šçš„è§‚ç‚¹ï¼Ÿç¬›å¡å°”è®¤ä¸ºä»–æ‰¾åˆ°äº†è‡³å°‘ä¸€ä¸ªè¿™æ ·çš„è§‚ç‚¹ï¼Œå°±æ˜¯ä»–çš„åè¨€â€œCogitoï¼Œergosumâ€ï¼Œä¹Ÿå°±æ˜¯â€œæˆ‘æ€ï¼Œæ•…æˆ‘åœ¨â€ã€‚ç¬›å¡å°”è¡¨ç¤ºï¼Œè¿™æ˜¯ä¸€ä¸ªå¯ä»¥è®©ä»–æ„Ÿåˆ°å®Œå…¨ç¡®å®šçš„è§‚ç‚¹ã€‚\nâ—† ç¬¬3ç«  ç»éªŒäº‹å®å’Œå“²å­¦æ€§/æ¦‚å¿µæ€§äº‹å®\næˆ‘çŒœæµ‹ä½ ä¹‹æ‰€ä»¥è¿™æ ·è®¤ä¸ºï¼Œæ˜¯æºäºä½ çœ‹å¾…è¿™ä¸ªä¸–ç•Œçš„æ–¹å¼ã€‚æˆ‘ä»¬å¤§éƒ¨åˆ†äººæ— æ³•æƒ³è±¡ç‰©ä½“åœ¨æˆ‘ä»¬è§‚å¯Ÿä¸åˆ°çš„æ—¶å€™å°±ä¸å†å­˜åœ¨äº†ã€‚æˆ‘ä»¬å¯¹è‡ªå·±æ‰€ç”Ÿæ´»çš„è¿™ä¸ªä¸–ç•Œæœ‰ä¸€ä¸ªåˆ¤æ–­ï¼Œé‚£å°±æ˜¯â€œç»„æˆè¿™ä¸ªä¸–ç•Œçš„å¤§éƒ¨åˆ†ç‰©ä½“æ˜¯ç¨³å®šçš„ï¼Œå³ä½¿åœ¨æ²¡æœ‰è¢«è§‚å¯Ÿåˆ°çš„æ—¶å€™ï¼Œä»ç„¶ä¿æŒå­˜åœ¨â€ã€‚å¯¹æ­¤ï¼Œæˆ‘ä»¬æ·±ä¿¡ä¸ç–‘ï¼Œè€Œè¿™æ­£æ˜¯æˆ‘ä»¬è®¤ä¸ºæŠ½å±‰é‡Œæœ‰ä¸€æ”¯é“…ç¬”çš„æ ¹æºã€‚\næŠŠäº‹å®ä¸è§‚ç‚¹åŒºåˆ†å¼€æ¥å°±æ„å‘³ç€ä¸¤è€…ä¹‹é—´å­˜åœ¨ç›¸å½“æ¸…æ™°çš„åŒºåˆ«ï¼Œä¹Ÿå°±æ„å‘³ç€äº‹å®æ˜¯äº‹å®ï¼Œè€Œè§‚ç‚¹ä»…ä»…æ˜¯è§‚ç‚¹ã€‚ç„¶è€Œï¼Œä¸¤è€…ä¹‹é—´å®é™…ä¸Šæ²¡æœ‰è¿™æ ·ä¸€ä¸ªæ˜ç¡®çš„åŒºåˆ«ï¼Œè‡³å°‘åœ¨ä¸€ä¸ªäººçš„ç”Ÿå‘½è¿‡ç¨‹ä¸­æˆ–è€…ä¸€ä¸ªäººè‡ªèº«çš„ä¸–ç•Œè§‚ä¸­ä¸ä¼šæœ‰è¿™æ ·çš„åŒºåˆ«ï¼ˆåœ¨è¿™é‡Œï¼Œå¯ä»¥å†è€ƒè™‘ä¸€ä¸‹â€œä¹¦æ¡Œä¸Šçš„é“…ç¬”å’ŒæŠ½å±‰é‡Œçš„é“…ç¬”â€çš„ä¾‹å­ï¼‰ã€‚ä»ä¸€ä¸ªäººè‡ªå·±çš„ä¸–ç•Œè§‚æ¥çœ‹ï¼Œé‚£äº›ä»–æ„Ÿåˆ°æ·±ä¿¡ä¸ç–‘è€Œåˆæœ‰å¼ºæœ‰åŠ›è¯æ®æ”¯æ’‘çš„è§‚ç‚¹ä¼¼ä¹å°±æ˜¯äº‹å®ã€‚\nåœ¨æˆ‘ä»¬æ‰€å¤„çš„æ—¶ä»£ï¼Œäº‹å®åªæ˜¯å¯¹æˆ‘ä»¬æ¥è¯´çœ‹èµ·æ¥åƒäº‹å®ï¼Œå®ƒä»¬çœ‹èµ·æ¥éƒ½å·®ä¸å¤šã€‚åªæœ‰ç»è¿‡ä»”ç»†æ€è€ƒï¼Œæœ‰æ—¶åœ¨æ€è€ƒè¿‡ç¨‹ä¸­è¿˜è¦å…‹æœæå¤§çš„å›°éš¾ï¼Œç„¶åæˆ‘ä»¬æ‰ä¼šå‘ç°è‡ªå·±æ‰€ç§‰æŒçš„æŸäº›è§‚ç‚¹æ›´åå‘äºä»¥ç»éªŒä¸ºåŸºç¡€ï¼Œè€Œå¦ä¸€äº›è§‚ç‚¹åˆ™æ›´åå‘äºä»¥å“²å­¦æ€§/æ¦‚å¿µæ€§è§‚ç‚¹ä¸ºåŸºç¡€ã€‚\nâ—† ç¬¬4ç«  è¯å®ä¸ä¸è¯å®è¯æ®å’Œæ¨ç†\nè¯å®æ¨ç†æ˜¯ä¸€ç§å½’çº³æ¨ç†ï¼Œè€Œä¸è¯å®æ¨ç†åˆ™æ˜¯ä¸€ç§æ¼”ç»æ¨ç†ã€‚è¯å®æ¨ç†çš„å½’çº³æ¨ç†æ€§è´¨å’Œä¸è¯å®æ¨ç†çš„æ¼”ç»æ¨ç†æ€§è´¨éƒ½å…·æœ‰ä¸€äº›é‡è¦å½±å“ã€‚è¦ç†è§£è¿™äº›å½±å“ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æ˜ç¡®å½’çº³æ¨ç†å’Œæ¼”ç»æ¨ç†ä¹‹é—´çš„ä¸åŒä¹‹å¤„ã€‚\nè¿™å°±æ˜¯å½’çº³æ¨ç†çš„ç‰¹ç‚¹ï¼šåœ¨ä¸€ä¸ªå¥½çš„å½’çº³æ¨ç†è¿‡ç¨‹ä¸­ï¼Œå³ä½¿æ‰€æœ‰å‰ææ¡ä»¶éƒ½æ˜¯çœŸçš„ï¼Œæ‰€å¾—å‡ºçš„ç»“è®ºä¹Ÿæœ‰å¯èƒ½æ˜¯é”™çš„ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œåœ¨ä¸€ä¸ªå¥½çš„æ¼”ç»æ¨ç†è®ºè¯è¿‡ç¨‹ä¸­ï¼ŒçœŸçš„å‰ææ¡ä»¶å°±ä¿è¯äº†çœŸçš„ç»“è®ºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ä¸€ä¸ªå¥½çš„æ¼”ç»æ¨ç†è®ºè¯è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæ‰€æœ‰å‰ææ¡ä»¶éƒ½æ˜¯çœŸçš„ï¼Œé‚£ä¹ˆå…¶æ‰€å¾—å‡ºçš„ç»“è®ºå°±ä¸€å®šæ˜¯çœŸçš„ã€‚\nè¯å®æ¨ç†æ¨¡å¼å’Œä¸è¯å®æ¨ç†æ¨¡å¼æ˜¯ç§‘å­¦é¢†åŸŸå†…å¤–ä¸¤ä¸ªå¸¸è§çš„æ¨ç†æ¨¡å¼ã€‚ä¸€æ–¹é¢ï¼Œè¯å®æ¨ç†æ¨¡å¼ç”±äºæ˜¯ä¸€ç§å½’çº³æ¨ç†æ¨¡å¼ï¼Œå› è€Œæ— æ³•åœ¨è¯æ˜ä¸€ä¸ªç†è®ºæ­£ç¡®çš„åŒæ—¶ä¿è¯è¿™ä¸€æ­£ç¡®æ€§ä¸å—è´¨ç–‘ã€‚å› æ­¤ï¼Œå¯¹äºä¸€ä¸ªç§‘å­¦ç†è®ºæ¥è¯´ï¼Œä¸ç®¡æœ‰å¤šå°‘å¯ä»¥è¯æ˜å…¶æ­£ç¡®æ€§çš„è¯æ®ï¼Œè¿™ä¸ªç†è®ºæ˜¯é”™è¯¯çš„è¿™ç§å¯èƒ½æ€§å§‹ç»ˆå­˜åœ¨ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨å®é™…çš„ä¾‹å­é‡Œï¼Œå½’çº³å¾—å‡ºçš„è¯æ®å’Œå½’çº³æ¨ç†é€šå¸¸éå¸¸å¤æ‚ä¸”ç›¸äº’äº¤ç»‡ã€‚è¯å®æ¨ç†æ¨¡å¼åŠè¯æ®å¾€å¾€è¿œæ²¡æœ‰å®ƒä»¬ä¹çœ‹èµ·æ¥é‚£ä¹ˆç›´æ¥æ˜ç¡®ã€‚å¦ä¸€æ–¹é¢ï¼Œä¸è¯å®æ¨ç†æ¨¡å¼æ˜¯ä¸€ç§æ¼”ç»æ¨ç†ã€‚ç„¶è€Œå®é™…ä¸Šï¼Œç”±ä¸è¯å®æ¨ç†æ¨¡å¼å¾—å‡ºçš„è¯æ®å¾€å¾€åŒæ ·å¾ˆå¤æ‚ã€‚å…·ä½“æ¥è¯´ï¼Œé€šå¸¸ä¸è¯å®æ¨ç†æ¨¡å¼æ¶‰åŠå¤§é‡è¾…åŠ©å‡è®¾ã€‚å› æ­¤ï¼Œé€šè¿‡ä¸è¯å®æ¨ç†æ¨¡å¼å¾—å‡ºçš„è¯æ®åªèƒ½è¡¨æ˜è¦ä¹ˆæ˜¯æ‰€ä½¿ç”¨çš„ç†è®ºä¸æ­£ç¡®ï¼Œè¦ä¹ˆå°±æ˜¯ä¸€ä¸ªæˆ–å‡ ä¸ªè¾…åŠ©å‡è®¾ä¸æ­£ç¡®ï¼ˆç»å¸¸å‡ºç°çš„æ˜¯åè€…ï¼‰ã€‚å› æ­¤ï¼Œä¸è¯å®æ¨ç†æ¨¡å¼åŠè¯æ®åŒæ ·ä¹Ÿè¿œæ²¡æœ‰å®ƒä»¬ä¹çœ‹èµ·æ¥é‚£ä¹ˆç›´æ¥æ˜ç¡®ã€‚\nâ—† ç¬¬5ç«  å¥å› -è¿ªæ˜‚è®ºç‚¹å’Œå¯¹ç§‘å­¦æ–¹æ³•çš„æ„ä¹‰\nç¬›å¡å°”è¿™ä¸ªæ–¹æ³•çš„åŸºæœ¬é—®é¢˜æ˜¯ï¼Œå®ƒä¸è¶³ä»¥æˆä¸ºä¸€ä¸ªåŸºç¡€ã€‚ç®€è¨€ä¹‹ï¼Œåœ¨å¯»æ‰¾å…³äºè¿™ä¸ªä¸–ç•Œçš„å¿…å®šä¸ºçœŸçš„èµ·å§‹ç‚¹æ—¶ï¼Œç¬›å¡å°”çš„é—®é¢˜ä¸äºšé‡Œå£«å¤šå¾·çš„é—®é¢˜æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿå°±æ˜¯ï¼Œä¼¼ä¹ä¸å­˜åœ¨å¾—åˆ°ä¸€è‡´è®¤å¯çš„ã€å¿…å®šä¸ºçœŸçš„èµ·å§‹ç‚¹ã€‚å°½ç®¡ï¼Œä¸€ä¸ªäººè‡³å°‘å¯ä»¥åœ¨â€œæˆ‘å­˜åœ¨â€ï¼ˆè‡³å°‘ä½œä¸ºä¸€ä¸ªæ€è€ƒä¸»é¢˜å­˜åœ¨ï¼‰çš„ä¸»å¼ ä¸Šæ‰¾åˆ°æŸäº›ç¡®å®šæ€§ï¼Œå¯¹è¿™ä¸€è§‚ç‚¹å¯èƒ½æœ‰æ›´å¤šå…±è¯†ï¼Œä½†æ˜¯è¿™ä¸ªè§‚ç‚¹åŒæ ·å¤ªå•è–„äº†ï¼Œæ— æ³•æˆä¸ºè¿›è¡ŒçŸ¥è¯†æ„å»ºçš„åŸºç¡€ã€‚\nâ—† ç¬¬6ç«  å“²å­¦æ’æ›²ï¼šå½’çº³çš„é—®é¢˜å’Œå›°æƒ‘\næ€»ä¹‹ï¼Œæ¯ä¸€å¤©ä»–ä»¬æ‰€å¤„çš„ä¸–ç•Œéƒ½ä¸å‰ä¸€å¤©æœ‰ä¸€äº›ä¸åŒã€‚ç”±äºè‡ªå·±æ‰€å¤„çš„ä¸–ç•Œå§‹ç»ˆåœ¨å˜åŒ–ï¼Œè¿™ä¸¤äººä¸çŸ¥é“æ¯å¤©ä¼šé‡åˆ°ä»€ä¹ˆã€‚å¯¹ä»–ä»¬æ¥è¯´ï¼Œæœªæ¥ä¸ä¼šåƒè¿‡å»ä¸€æ ·ã€‚å› æ­¤ï¼Œä»–ä»¬æ— æ³•å¯¹æœªæ¥åšå‡ºé‚£ç§æˆ‘ä»¬éƒ½è®¤ä¸ºæ˜¯ç†æ‰€å½“ç„¶çš„å½’çº³æ¨ç†ã€‚ï¼ˆå¤§æ¦‚ä»–ä»¬æ‰€èƒ½åšå‡ºçš„å”¯ä¸€ä¸€ç§å…³äºæœªæ¥çš„å½’çº³æ¨ç†ï¼Œå°±æ˜¯æœªæ¥ä¸ä¼šç»§ç»­åƒè¿‡å»ä¸€æ ·ï¼Œè€Œè¿™å½“ç„¶å¹¶ä¸æ˜¯ä¸€ä¸ªç‰¹åˆ«æœ‰å¸®åŠ©çš„æ¨ç†ç»“è®ºã€‚ï¼‰æ‰€ä»¥ï¼Œè¦ç†è§£ä¼‘è°Ÿçš„å½’çº³é—®é¢˜ï¼Œåº”è®¤è¯†åˆ°çš„ç¬¬ä¸€ä¸ªå…³é”®ç‚¹æ˜¯ï¼šå‰é¢æåˆ°çš„é‚£å¥è¯ï¼Œä¹Ÿå°±æ˜¯æœªæ¥å°†ç»§ç»­åƒè¿‡å»ä¸€æ ·ï¼Œæ˜¯æ¯ä¸€ä¸ªå…³äºæœªæ¥çš„æ¨ç†æ‰€å¿…éœ€çš„éšå«å‰æï¼Œå°½ç®¡é€šå¸¸éƒ½ä¸ä¸ºäººå¯Ÿè§‰ã€‚\næ€»ç»“ä¸€ä¸‹ï¼Œä¼‘è°Ÿçš„è§‚ç‚¹æ˜¯æ¯ä¸€ä¸ªå½’çº³æ¨ç†éƒ½ä¾èµ–äºâ€œæœªæ¥å°†ç»§ç»­åƒè¿‡å»ä¸€æ ·â€çš„éšå«å‰æã€‚ä½†æ˜¯ï¼Œç”¨æ¥è§£é‡Šæ”¯æ’‘è¿™ä¸ªéšå«å‰æçš„ä¸»è¦ï¼ˆä¼¼ä¹ä¹Ÿæ˜¯å”¯ä¸€çš„ï¼‰æ–¹æ³•æ˜¯å¾ªç¯çš„ï¼Œå› æ­¤ï¼Œçœ‹èµ·æ¥è¿™ä¸ªå…³é”®çš„éšå«å‰ææ— æ³•å¾—åˆ°è¶³å¤Ÿæ”¯æ’‘ã€‚æ‰€ä»¥ï¼Œå…³äºæœªæ¥çš„æ¨ç†ä¾èµ–äºä¸€ä¸ªæ— æ³•å¾—åˆ°æ”¯æ’‘çš„å‡è®¾ï¼Œè¿™äº›æ¨ç†ä»é€»è¾‘ä¸Šä¹Ÿå°±æ— æ³•å¾—åˆ°æ”¯æ’‘ã€‚\nä¼‘è°Ÿçš„é—®é¢˜æ˜¯ï¼Œæˆ‘ä»¬æ˜¯å¦å¯ä»¥ä»é€»è¾‘ä¸Šä¸ºæˆ‘ä»¬å…³äºæœªæ¥çš„æ¨ç†æä¾›ä¾æ®ï¼Œè€Œä»–çš„ç­”æ¡ˆæ˜¯ï¼šæˆ‘ä»¬ä¸å¯ä»¥ã€‚\nâ—† ç¬¬8ç«  å·¥å…·ä¸»ä¹‰å’Œç°å®ä¸»ä¹‰\nå¯¹å·¥å…·ä¸»ä¹‰è€…æ¥è¯´ï¼Œä¸€ä¸ªé€‚å½“çš„ç†è®ºå¯ä»¥ç»™å‡ºé¢„è¨€å’Œè§£é‡Šï¼Œè‡³äºè¿™ä¸ªç†è®ºæ˜¯å¦åæ˜ æˆ–æ¨¡æ‹Ÿç°å®ä¸–ç•Œï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªé‡è¦çš„è€ƒé‡ã€‚è€Œå¯¹ç°å®ä¸»ä¹‰è€…æ¥è¯´ï¼Œäº‹æƒ…æ°æ°ç›¸åï¼Œä¸€ä¸ªåˆç†çš„ç†è®ºå¿…é¡»ä¸ä»…å¯ä»¥ç»™å‡ºé¢„è¨€å’Œè§£é‡Šï¼Œè€Œä¸”è¦åæ˜ ç°å®äº‹ç‰©çš„çœŸå®æƒ…å†µã€‚\nçœŸç†ç¬¦åˆè®ºçš„æ”¯æŒè€…è®¤ä¸ºçœŸç†æ˜¯ç¬¦åˆç°å®çš„è§‚ç‚¹ï¼Œè€ŒçœŸç†èè´¯è®ºçš„æ”¯æŒè€…åˆ™è®¤ä¸ºå½“ä¸€ä¸ªè§‚ç‚¹å¯ä»¥ä¸ä¸€ä¸ªæ•´ä½“çš„è§‚ç‚¹ä½“ç³»ç›¸èåˆï¼Œæˆ–è€…è¯´æ˜¯æ‹¼åˆåœ¨ä¸€èµ·æ—¶ï¼Œé‚£ä¹ˆè¿™ä¸ªè§‚ç‚¹å°±æ˜¯çœŸç†ã€‚å› æ­¤ï¼Œæ¥ä¸‹æ¥çš„ç–‘é—®å°±ä¼šæ˜¯çœŸç†çš„ç¬¦åˆè®ºå’Œèè´¯è®ºæ˜¯å¦ä¸å·¥å…·ä¸»ä¹‰å’Œç°å®ä¸»ä¹‰ç´§å¯†ç›¸è¿ã€‚\nâ—† ç¬¬9ç«  äºšé‡Œå£«å¤šå¾·ä¸–ç•Œè§‚ä¸­çš„å®‡å®™ç»“æ„\næ€»çš„æ¥è¯´ï¼Œç›®çš„è®ºè§£é‡Šæ˜¯ä»ç›®æ ‡ã€ç›®çš„æˆ–åŠŸèƒ½è§’åº¦æå‡ºçš„è§£é‡Šï¼Œè€Œæœºæ¢°è®ºè§£é‡Šåˆ™æ˜¯ä¸ä½¿ç”¨ç›®æ ‡ã€ç›®çš„å’ŒåŠŸèƒ½çš„è§£é‡Šã€‚\nâ—† ç¬¬14ç«  å“¥ç™½å°¼ä½“ç³»\nä»–è®¤ä¸ºæœ‰å¾ˆå¤šå„ç§å„æ ·å®¢è§‚å­˜åœ¨ï¼Œä½†åˆæ²¡æœ‰å®ä½“çš„æ°¸æ’â€œå½¢å¼â€ã€‚è¿™äº›å½¢å¼æ˜¯çŸ¥è¯†çš„å®¢è§‚å­˜åœ¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç›¸å¯¹äºä»…ä»…å¾—åˆ°ä¸€ä¸ªä¿¡å¿µæˆ–è§‚ç‚¹ï¼Œå½“æˆ‘ä»¬å¾—åˆ°äº†çŸ¥è¯†æ—¶ï¼Œæˆ‘ä»¬çš„çŸ¥è¯†å°±æ˜¯å…³äºä¸€ä¸ªæˆ–å¤šä¸ªè¿™æ ·å®¢è§‚å­˜åœ¨ï¼Œä½†åˆæ²¡æœ‰å®ä½“çš„æ°¸æ’å½¢å¼çš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå½“æˆ‘ä»¬çŸ¥é“äº†æ¯•è¾¾å“¥æ‹‰æ–¯å®šç†ï¼Œæˆ–æ•°å­¦ä¸­çš„å…¶ä»–çœŸç†ï¼Œæˆ‘ä»¬æ‰€å¾—åˆ°çš„çŸ¥è¯†å¹¶ä¸æ˜¯å…³äºåœ°çƒä¸ŠæŸç§ç‰©ä½“çš„ï¼ˆæ¯”å¦‚ï¼Œç”»åœ¨çº¸ä¸Šçš„ä¸‰è§’å½¢ï¼‰ï¼Œè€Œæ˜¯å…³äºä¸€ä¸ªå®¢è§‚å­˜åœ¨ï¼Œä½†åˆæ²¡æœ‰å®ä½“çš„æ°¸æ’å½¢å¼çš„ã€‚\nâ—† ç¬¬20ç«  æ–°ç§‘å­¦å’Œç‰›é¡¿ä¸–ç•Œè§‚æ¦‚è¿°\nå›åˆ°å‘åœ°é¢ä¸‹è½çš„é’¢ç¬”çš„ä¾‹å­ï¼Œè¯·æ³¨æ„é’¢ç¬”å’Œåœ°çƒä¹‹é—´ä¼¼ä¹ä¸å­˜åœ¨è”ç³»ï¼Œå¹¶æ²¡æœ‰æ©¡çš®ç­‹æŠŠåœ°çƒå’Œé’¢ç¬”ç»‘åœ¨ä¸€èµ·ï¼Œä¹Ÿæ²¡æœ‰ç»†ç»³ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚ç„¶è€Œï¼Œå°½ç®¡å¦‚æ­¤ï¼Œé’¢ç¬”åœ¨è¢«æ¾å¼€ä»¥åä»ç„¶å‘åœ°çƒç§»åŠ¨ã€‚ä»è¿™ä¸ªè§’åº¦æ¥çœ‹ï¼Œé‡åŠ›å¬èµ·æ¥å¹¶ä¸åƒæ˜¯ç§‘å­¦ï¼Œè€Œåƒæ˜¯é­”æ³•ã€‚\nç‰›é¡¿ä¸–ç•Œè§‚ä¹Ÿéšæ—¶é—´æ¨ç§»è€Œç»å†äº†å‘å±•ï¼Œä¸è¿‡ä¸€ä¸ªæœºæ¢°è®ºçš„ã€åƒæœºå™¨ä¸€æ ·çš„å®‡å®™ä¸€ç›´ä¿ç•™äº†ä¸‹æ¥ï¼Œå¹¶ä¸”æˆä¸ºè¿™ä¸€ä¸–ç•Œè§‚çš„æ ¸å¿ƒè§‚ç‚¹ã€‚\nâ—† ç¬¬21ç«  å“²å­¦æ’æ›²ï¼šä»€ä¹ˆæ˜¯ç§‘å­¦å®šå¾‹\nåæ˜ æ— ä¾‹å¤–çš„è§„å¾‹æ€§ä¼¼ä¹æ˜¯ç§‘å­¦å®šå¾‹çš„ä¸€ä¸ªå…³é”®ç‰¹ç‚¹ã€‚\nâ—† ç¬¬ä¸‰éƒ¨åˆ† ç§‘å­¦åŠä¸–ç•Œè§‚çš„æ–°è¿‘å‘å±•\nä¸17ä¸–çºªå‘ç”Ÿçš„æƒ…å†µä¸€æ ·ï¼Œæˆ‘ä»¬çœ‹åˆ°æŸäº›æˆ‘ä»¬ä¸€ç›´è®¤ä¸ºæ˜¾è€Œæ˜“è§çš„ç»éªŒäº‹å®ï¼Œåœ¨è¿ç”¨äº†æ–°è¿‘ç§‘å­¦å‘å±•çš„è§†è§’åï¼Œéƒ½è¢«è¯æ˜æ˜¯é”™è¯¯çš„å“²å­¦æ€§/æ¦‚å¿µæ€§äº‹å®ã€‚\nâ—† ç¬¬23ç«  ç‹­ä¹‰ç›¸å¯¹è®º\nå…‰é€Ÿæ’å®šåŸåˆ™æ˜¯ç‹­ä¹‰ç›¸å¯¹è®ºèµ–ä»¥ä¸ºåŸºç¡€çš„åŸºæœ¬åŸåˆ™ä¹‹ä¸€\nâ—† ç¬¬24ç«  å¹¿ä¹‰ç›¸å¯¹è®º\nç«æ˜Ÿå›´ç»•å¤ªé˜³æ²¿æ¤­åœ†è½¨é“è¿è½¬å¹¶ä¸æ˜¯ç«æ˜Ÿä¸å¤ªé˜³ä¹‹é—´ç›¸äº’çš„å¸å¼•åŠ›æˆ–è€…è¯´ä¸‡æœ‰å¼•åŠ›çš„ç»“æœã€‚ç›¸åï¼Œä¸å…¶ä»–è¿åŠ¨çš„ç‰©ä½“ä¸€æ ·ï¼Œç«æ˜Ÿæ²¿ç›´çº¿è¿åŠ¨ã€‚ç„¶è€Œï¼Œåœ¨ä¸€ä¸ªå¼¯æ›²çš„ç©ºé—´ä¸­ï¼Œâ€œç›´çº¿â€å…¶å®æ˜¯æµ‹åœ°çº¿ã€‚æ­£å¦‚æˆ‘ä»¬åœ¨å‰é¢çœ‹åˆ°çš„ï¼Œæ ¹æ®å¹¿ä¹‰ç›¸å¯¹è®ºï¼Œåƒå¤ªé˜³è¿™æ ·çš„ç‰©ä½“ä¼šå¯¼è‡´æ—¶ç©ºæ›²ç‡ã€‚æ ¹æ®å¹¿ä¹‰ç›¸å¯¹è®ºæ–¹ç¨‹å¼ï¼Œè¿™ä¸ªæ›²ç‡ä¹‹å¤§ï¼Œä¼šä½¿ç«æ˜Ÿè¿åŠ¨æ‰€æ²¿çš„æµ‹åœ°çº¿å˜æˆå›´ç»•å¤ªé˜³çš„ä¸€ä¸ªæ¤­åœ†å½¢ã€‚æ¢å¥è¯è¯´ï¼Œåœ¨å¹¿ä¹‰ç›¸å¯¹è®ºä¸­ï¼Œåƒç«æ˜Ÿå’Œå¤ªé˜³è¿™æ ·çš„ç‰©ä½“ä¹‹é—´ä¸å­˜åœ¨å¸å¼•â€œåŠ›â€ã€‚äº‹å®ä¸Šï¼Œç«æ˜Ÿåªæ˜¯æ²¿ç›´çº¿è¿åŠ¨ï¼Œä½†æ˜¯ç”±äºæ—¶ç©ºæ›²ç‡ï¼Œè¿™æ¡ç›´çº¿å˜æˆäº†å›´ç»•å¤ªé˜³çš„ä¸€ä¸ªæ¤­åœ†å½¢ã€‚\nâ—† ç¬¬28ç«  æ¼”åŒ–çš„å“²å­¦ä¸æ¦‚å¿µå½±å“\nç”Ÿå‘½åŠå…¶è•´å«ä¹‹åŠ›èƒ½ï¼Œæœ€åˆæ³¨å…¥åˆ°å¯¥å¯¥å‡ ä¸ªæˆ–å•ä¸ªç±»å‹ä¹‹ä¸­ï¼›å½“è¿™ä¸€è¡Œæ˜ŸæŒ‰ç…§å›ºå®šçš„å¼•åŠ›æ³•åˆ™å¾ªç¯è¿è¡Œä¹‹æ—¶ï¼Œæ— æ•°æœ€ç¾ä¸½ä¸æœ€å¥‡å¼‚çš„ç±»å‹ï¼Œå³æ˜¯ä»å¦‚æ­¤ç®€å•çš„å¼€ç«¯æ¼”åŒ–è€Œæ¥ã€å¹¶ä¾ç„¶åœ¨æ¼”åŒ–ä¹‹ä¸­ï¼›ç”Ÿå‘½å¦‚æ˜¯ä¹‹è§‚ï¼Œä½•ç­‰å£®ä¸½æ¢å¼˜ã€‚ï¼ˆDarwinï¼Œ1964\nâ—† ç¬¬29ç«  ä¸–ç•Œè§‚ï¼šæ€»ç»“æ€è€ƒ\næˆ‘è®¤ä¸ºï¼Œç›¸å¯¹è®ºçœŸæ­£æ›´é‡è¦çš„å½±å“æ˜¯ï¼Œå®ƒæ·±åˆ»è¡¨æ˜äº†åœ¨ä¸€äº›çœ‹èµ·æ¥æ˜¾è€Œæ˜“è§çš„å‘½é¢˜ä¸Šï¼Œæˆ‘ä»¬çŠ¯äº†å¤šä¹ˆä¸¥é‡çš„é”™è¯¯ã€‚æˆ–è€…æ¢å¥è¯è¯´ï¼Œå®ƒè¡¨æ˜äº†å“²å­¦æ€§/æ¦‚å¿µæ€§äº‹å®ä¼ªè£…æˆæ˜¾è€Œæ˜“è§çš„ç»éªŒäº‹å®æ˜¯å¤šä¹ˆå®¹æ˜“ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘è®¤è¯†çš„æ‰€æœ‰äººåœ¨äº†è§£ç›¸å¯¹è®ºä¹‹å‰éƒ½è®¤ä¸ºç©ºé—´å’Œæ—¶é—´å¯¹ä»»ä½•äººæ¥è¯´éƒ½æ˜¯ç›¸åŒçš„ï¼Œè€Œä¸”æŠŠè¿™å½“ä½œä¸€ä¸ªæ˜¾è€Œæ˜“è§çš„ç»éªŒäº‹å®ã€‚\nå†æ¥æ¢³ç†ä¸€ä¸‹ï¼šåœ¨äºšé‡Œå£«å¤šå¾·ä¸–ç•Œè§‚ä¸­ï¼Œå®‡å®™è¢«çœ‹ä½œåƒä¸€ä¸ªç”Ÿç‰©æœ‰æœºä½“ï¼Œå„éƒ¨åˆ†åˆ†åˆ«å‘æŒ¥å…¶ä½œç”¨ï¼Œä»è€Œå…±åŒå®ç°å¤©ç„¶çš„ç›®æ ‡å’Œç›®çš„ï¼›åœ¨ç‰›é¡¿ä¸–ç•Œè§‚ä¸­ï¼Œå®‡å®™è¢«çœ‹ä½œåƒä¸€å°æœºå™¨ï¼Œå„ä¸ªéƒ¨åˆ†é€šè¿‡æ¨æ‹‰ä¸å…¶ä»–éƒ¨åˆ†å‘ç”Ÿç›¸äº’ä½œç”¨ï¼Œä¸æœºå™¨é‡Œçš„é›¶éƒ¨ä»¶å½¼æ­¤å‘ç”Ÿç›¸äº’ä½œç”¨çš„æ–¹å¼ä¸€æ ·ã€‚è¿™ç±»éšå–»æ—¢å¾ˆæœ‰é­…åŠ›ï¼Œåˆå¾ˆæœ‰ç”¨â€”â€”è¿™ä¸€ç‚¹å¾ˆå®¹æ˜“ç†è§£ï¼Œå› ä¸ºå®ƒä»¬æä¾›äº†ä¸€ç§æ–¹ä¾¿è€Œåˆç®€å•çš„æ–¹å¼æ¥æ€»ç»“å¯¹å®‡å®™çš„æ•´ä½“è§‚ç‚¹ã€‚ä¸è¿‡ï¼Œæ–°è¿‘çš„è¿™äº›å‘ç°éƒ½æœ‰ä¸€ä¸ªæœ‰è¶£çš„ç‰¹ç‚¹ï¼Œé‚£å°±æ˜¯å®ƒä»¬æ‰€ä¸»å¼ çš„å®‡å®™ä¸æˆ‘ä»¬ç»å†è¿‡çš„ä»»ä½•äº‹ç‰©éƒ½ä¸ä¸€æ ·ã€‚\n","permalink":"https://blog.niuhemoon.win/posts/read/%E4%B8%96%E7%95%8C%E8%A7%82/","summary":"\u003cp\u003eã€Šä¸–ç•Œè§‚ï¼šç°ä»£äººå¿…é¡»è¦æ‡‚çš„ç§‘å­¦å“²å­¦å’Œç§‘å­¦å²ï¼ˆåŸä¹¦ç¬¬2ç‰ˆï¼‰ã€‹\nç†æŸ¥å¾·Â·å¾·å¨ç‰¹ï¼ˆRichard DeWittï¼‰\u003c/p\u003e","title":"ä¸–ç•Œè§‚"},{"content":" Tip\næ–‡ä¸­æ“ä½œåŸºäºManjaroç³»ç»Ÿ\næ¶‰åŠè½¯ä»¶:\ncalibreç®¡ç†ç”µå­ä¹¦ megaç½‘ç›˜ åŒæ­¥å¤‡ä»½å›¾ä¹¦åº“ å¾®ä¿¡è¯»ä¹¦ æ‰‹æœºä¾¿æ·é˜…è¯» (webç«¯åŒæ­¥ï¼Œæ”¯æŒå¯¼å‡ºæ‰¹æ³¨) okular é˜…è¯»pdf (åŠŸèƒ½å¼ºå¤§ï¼Œæ”¯æŒæ ‡æ³¨) zlib ä¸‹è½½ç”µå­ä¹¦ (ç›®å‰è¦ç”¨toræµè§ˆå™¨æ‰èƒ½è®¿é—®) ä¹‹å‰è¯»äº†å¾ˆå¤šæŠ€æœ¯å’ŒéæŠ€æœ¯çš„ä¹¦ç±ï¼ŒéæŠ€æœ¯çš„ä¹¦åŸºæœ¬éƒ½æ˜¯epub,mobiæ ¼å¼ï¼ŒæŠ€æœ¯ç±»çš„åŸºæœ¬æ˜¯pdfæ ¼å¼ã€‚ä¹¦ç±é›¶æ•£ï¼Œè¶ç€å…ƒæ—¦ç”¨calibre æ•´ç†ä¸€ä¸‹ã€‚\nå®‰è£…é…ç½®calibre # å®‰è£…calibre yay -Sy calibre ä»è±†ç“£ä¸‹è½½å…ƒæ•°æ®å’Œå°é¢æ’ä»¶\nReleases Â· fugary/calibre-douban\ncalibreé»˜è®¤æœ‰ä¸¤ä¸ªç”¨æˆ·:\næœ¬åœ°ç”µå­é˜…è¯»å™¨ç”¨æˆ· (å³ç›´æ¥åŒå‡»calibreä¹¦ç±æ¡ç›®é˜…è¯») åŒ¿åçš„å†…å®¹æœåŠ¡å™¨ç”¨æˆ· (calibreå¯åŠ¨å†…å®¹æœåŠ¡å™¨ï¼Œåœ¨ç½‘é¡µä¸Šé˜…è¯») é»˜è®¤è¿™ä¸¤ä¸ªç”¨æˆ·çš„æ‰¹æ³¨æ˜¯ä¸äº’é€šçš„ï¼Œéœ€è¦åˆå¹¶æ‰¹æ³¨çš„è¯ï¼ŒåŒå‡»ä¸€æœ¬epubä¹¦ï¼Œåœ¨é¦–é€‰é¡¹-æ‚é¡¹-ä¸å†…å®¹æœåŠ¡å™¨ç”¨æˆ·åŒæ­¥ä¹¦ç­¾/çªå‡ºæ˜¾ç¤ºé‡Œè¿›è¡Œé…ç½®\nå®‰è£…å¹¶é…ç½®calibre-web calibre-webç›®å‰é˜…è¯»åŠŸèƒ½è¾ƒå¼±ï¼Œèƒœåœ¨UIæ¯”è¾ƒå¥½çœ‹ï¼Œä¸»è¦ç”¨æ¥ä»ç½‘é¡µç®¡ç†å›¾ä¹¦\nmkdir calibre-web \u0026amp;\u0026amp; cd calibre-web python3 -m venv ./venv source venv/bin/activate # install calibreweb pip install calibreweb # start calibreweb cps # open browser http://localhost:8083 calibre-webæ·»åŠ è±†ç“£æºæ•°æ®api\ncalibre-web-douban-api\nå®‰è£…megaæ¡Œé¢åŒæ­¥calibreç›®å½• megaç½‘ç›˜å…è´¹ç”¨æˆ·æœ‰50GBçš„ç©ºé—´ï¼Œè¶³å¤ŸåŒæ­¥å›¾ä¹¦åº“åšä¸€ä¸ªå¤‡ä»½ã€‚å›½å†…å¯èƒ½ç½‘é€Ÿä¸ç¨³å®šéœ€è¦æŒ‚æ¢¯å­ã€‚ ä»megaå®˜ç½‘ä¸‹è½½æºç åŒ…ï¼Œå¹¶ä½¿ç”¨pacmanå®‰è£…ã€‚ä¸æ¨èä»yayæºå®‰è£…megasyncï¼Œå› ä¸ºç›®å‰yayæºçš„åŒ…æœ‰bugï¼Œæ— æ³•æ­£å¸¸ä½¿ç”¨ã€‚\næ¡Œé¢åº”ç”¨ç¨‹åº- MEGA\n","permalink":"https://blog.niuhemoon.win/posts/read/calibre-usage/","summary":"ä½¿ç”¨calibreç®¡ç†ç”µå­ä¹¦","title":"calibre-usage"},{"content":"TmuxåŸºæœ¬æ¦‚å¿µ â— TmuxåŸºæœ¬æ¦‚å¿µ session ä¼šè¯ï¼šå¯ä»¥ç†è§£æˆæ˜¯ä¸€ä¸ªç‰¹å®šçš„ç»ˆç«¯ç»„åˆï¼Œé€šå¸¸å°†åŒä¸€ä»»åŠ¡ä¸‹çš„å·¥ä½œæ”¾åˆ°ä¸€ä¸ªä¼šè¯ä¸­ã€‚ window çª—å£ï¼šä¸€ä¸ªä¼šè¯å¯ä»¥åŒ…å«å¤šä¸ªçª—å£ï¼Œä¸€ä¸ªçª—å£å°±ç›¸å½“äºæ™®é€šç»ˆç«¯çš„ä¸€ä¸ªæ ‡ç­¾ï¼Œé€šå¸¸åœ¨ä¸åŒçš„çª—å£ä¸­å®Œæˆä¸åŒçš„å·¥ä½œã€‚ pane çª—æ ¼ï¼šä¸€ä¸ªçª—å£å¯ä»¥è¢«åˆ†å‰²æˆå¤šä¸ªå°çš„çª—æ ¼ã€‚ Tmuxé…ç½®æ–‡ä»¶(å¯é€‰) å…¨å±€é…ç½® /etc/tmux.conf ç”¨æˆ·é…ç½® ~/.tmux.conf å¼€ç®±å³ç”¨çš„é…ç½®æ–‡ä»¶:\nğŸ‡«ğŸ‡· Oh my tmux! â¤ï¸\nç¬”è€…é…ç½®æ–‡ä»¶å†…å®¹å¦‚ä¸‹:\n# å¼€å¯é¼ æ ‡ set -g mouse on TmuxåŸºæœ¬æ“ä½œ Tip\næœ¬æ–‡ä¸­prefixæ˜¯tmuxçš„å‰ç¼€å¿«æ·é”®ï¼Œé»˜è®¤æ˜¯Ctrl+b\nä¼šè¯ç®¡ç† # prefix + ? æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯ # æ–°å»ºä¼šè¯tmux tmux new -s \u0026lt;session-name\u0026gt; tmux new-session -s \u0026lt;session-name\u0026gt; # ç¦»å¼€ä¼šè¯ # prefix + d tmux detach # æŸ¥çœ‹æ‰€æœ‰tmuxä¼šè¯ tmux list-session tmux ls # æ¥å…¥ä¼šè¯ tmux attach -t \u0026lt;session-name\u0026gt; tmux a -t \u0026lt;session-name\u0026gt; # æ€æ­»ä¼šè¯ tmux kill-session -t \u0026lt;session-name\u0026gt; # åˆ‡æ¢ä¼šè¯ tmux switch -t \u0026lt;session-name\u0026gt; # é‡å‘½åä¼šè¯ tmux rename-session -t \u0026lt;old-name\u0026gt; \u0026lt;new-name\u0026gt; # é‡å‘½åå½“å‰ä¼šè¯ tmux rename-session \u0026lt;new-name\u0026gt; çª—æ ¼ç®¡ç† # åˆ’åˆ†ä¸Šä¸‹çª—æ ¼prefix + \u0026#34; tmux split-window # åˆ’åˆ†å·¦å³çª—æ ¼prefix + % tmux split-window -h # ç§»åŠ¨å…‰æ ‡prefix + â†â†‘â†’â†“ tmux select-pane -U # å…‰æ ‡åˆ‡åˆ°ä¸Šæ–¹çª—æ ¼ tmux select-pane -D tmux select-pane -L tmux select-pane -R # äº¤æ¢çª—æ ¼ä½ç½® # çª—æ ¼ä¸Šç§» tumx swap-pane -U # çª—æ ¼ä¸‹ç§» tumx swap-pane -D # çª—æ ¼è½¬å˜ä¸ºçª—å£ prefix + ! # çª—æ ¼å…¨å±æ˜¾ç¤ºprefix + z, å†ä½¿ç”¨ä¸€æ¬¡æ¢å¤åŸå¤§å° # è°ƒæ•´çª—æ ¼å¤§å°prefix + Ctrl + â†â†‘â†’â†“ çª—å£ç®¡ç† # æ–°å»ºçª—å£ tmux new-window tmux new-window -n \u0026lt;window-name\u0026gt; # æŸ¥çœ‹çª—å£åˆ—è¡¨ tmux list-window # åˆ‡æ¢çª—å£ tmux select-window -t \u0026lt;window-name\u0026gt; # é‡å‘½åå½“å‰çª—å£ tmux rename-window \u0026lt;new-name\u0026gt; # é‡å‘½åæŒ‡å®šçª—å£ tmux rename-window -t \u0026lt;old-name\u0026gt; \u0026lt;new-name\u0026gt; # åˆ‡æ¢ä¸Šä¸€ä¸ªçª—å£ prefix + p # åˆ‡æ¢ä¸‹ä¸€ä¸ªçª—å£ prefix + n # åˆ‡æ¢æŒ‡å®šçª—å£ prefix + \u0026lt;numberçª—å£ç¼–å·\u0026gt; å…¶å®ƒå¿«æ·é”® å‘½ä»¤ è¯´æ˜ ? åˆ—å‡ºæ‰€æœ‰å¿«æ·é”®ï¼›æŒ‰ q è¿”å› d è„±ç¦»å½“å‰ä¼šè¯,å¯æš‚æ—¶è¿”å› Shell ç•Œé¢ s é€‰æ‹©å¹¶åˆ‡æ¢ä¼šè¯ï¼›åœ¨åŒæ—¶å¼€å¯äº†å¤šä¸ªä¼šè¯æ—¶ä½¿ç”¨ [ å¤åˆ¶æ¨¡å¼ï¼Œå…‰æ ‡ç§»åŠ¨åˆ°å¤åˆ¶å†…å®¹ä½ç½®ï¼Œç©ºæ ¼é”®å¼€å§‹ï¼Œæ–¹å‘é”®é€‰æ‹©å¤åˆ¶ï¼Œå›è½¦ç¡®è®¤ï¼Œq/Esc é€€å‡º ] è¿›å…¥ç²˜è´´æ¨¡å¼ï¼Œç²˜è´´ä¹‹å‰å¤åˆ¶çš„å†…å®¹ï¼ŒæŒ‰ q/Esc é€€å‡º t æ˜¾ç¤ºå½“å‰çš„æ—¶é—´ c åˆ›å»ºæ–°çª—å£ \u0026amp; å…³é—­å½“å‰çª—å£ [0-9] æ•°å­—é”®åˆ‡æ¢åˆ°æŒ‡å®šçª—å£ p åˆ‡æ¢è‡³ä¸Šä¸€çª—å£ n åˆ‡æ¢è‡³ä¸‹ä¸€çª—å£ l å‰åçª—å£é—´äº’ç›¸åˆ‡æ¢ w é€šè¿‡çª—å£åˆ—è¡¨åˆ‡æ¢çª—å£ , é‡å‘½åå½“å‰çª—å£ï¼Œä¾¿äºè¯†åˆ« . ä¿®æ”¹å½“å‰çª—å£ç¼–å·ï¼Œç›¸å½“äºé‡æ–°æ’åº f åœ¨æ‰€æœ‰çª—å£ä¸­æŸ¥æ‰¾å…³é”®è¯ï¼Œä¾¿äºçª—å£å¤šäº†åˆ‡æ¢ \u0026quot; å°†å½“å‰é¢æ¿ä¸Šä¸‹åˆ†å± % å°†å½“å‰é¢æ¿å·¦å³åˆ†å± x å…³é—­å½“å‰åˆ†å± ! å°†å½“å‰é¢æ¿ç½®äºæ–°çª—å£,å³æ–°å»ºä¸€ä¸ªçª—å£,å…¶ä¸­ä»…åŒ…å«å½“å‰é¢æ¿ q æ˜¾ç¤ºé¢æ¿ç¼–å· o é€‰æ‹©å½“å‰çª—å£ä¸­ä¸‹ä¸€ä¸ªé¢æ¿ { å‘å‰ç½®æ¢å½“å‰é¢æ¿ } å‘åç½®æ¢å½“å‰é¢æ¿ z æœ€å¤§åŒ–å½“å‰æ‰€åœ¨é¢æ¿ æ–¹å‘é”® ç§»åŠ¨å…‰æ ‡é€‰æ‹©å¯¹åº”é¢æ¿ page up å‘ä¸Šæ»šåŠ¨å±å¹•ï¼Œq é€€å‡º page down å‘ä¸‹æ»šåŠ¨å±å¹•ï¼Œq é€€å‡º alt+o é€†æ—¶é’ˆæ—‹è½¬å½“å‰çª—å£çš„é¢æ¿ ctrl+o é¡ºæ—¶é’ˆæ—‹è½¬å½“å‰çª—å£çš„é¢æ¿ ctrl+æ–¹å‘é”® ä»¥ 1 ä¸ªå•å…ƒæ ¼ä¸ºå•ä½ç§»åŠ¨è¾¹ç¼˜ä»¥è°ƒæ•´å½“å‰é¢æ¿å¤§å° alt+æ–¹å‘é”® ä»¥ 5 ä¸ªå•å…ƒæ ¼ä¸ºå•ä½ç§»åŠ¨è¾¹ç¼˜ä»¥è°ƒæ•´å½“å‰é¢æ¿å¤§å° å‚è€ƒ Tmux ç®€ä»‹ä¸ä½¿ç”¨\nTmux ä½¿ç”¨æ•™ç¨‹ - é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—\n","permalink":"https://blog.niuhemoon.win/posts/tech/tmux-usage/","summary":"tmuxæ˜¯å°†ä¼šè¯å’Œçª—å£è§£ç»‘çš„å·¥å…·","title":"tmux-usage"},{"content":"è®°å½•hugo ä¸€äº›å¸¸ç”¨çš„shortcode\nRaw å¦‚ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨svgç»˜åˆ¶çš„é’Ÿè¡¨\nPlantuml Grpahvizo DOT Language (GraphViz) Example Chart Blockquote èŠ±å¼€èŠ±è°¢ ç™½å¤©é»‘å¤œ\nä¸€åˆ‡è‡ªç„¶ åˆä¸å°½ç„¶\næ˜¥å¤ç§‹å†¬ ç»è¿‡æ‰æ‡‚\nä¸–é—´å†·æš– æ— éè‡ªç„¶\næå¥ ã€Šæ‡‚å¾—ã€‹ Imagecap å¸¦æ ‡é¢˜çš„å›¾ç‰‡ â— TmuxåŸºæœ¬æ¦‚å¿µ ä¸å¸¦æ ‡é¢˜çš„å›¾ç‰‡ æŠ˜å å†…å®¹ æµ‹è¯•æŠ˜å å†…å®¹ æµ‹è¯•æŠ˜å å†…å®¹\nprint(\u0026#39;hello\u0026#39;) RawHTML \u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e Everyday Italian Giada De Laurentiis 2005 30.00 Harry Potter J K. Rowling 2005 29.99 XQuery Kick Start James McGovern Per Bothner Kurt Cagle James Linn Vaidyanathan Nagarajan 2003 49.99 Learning XML Erik T. Ray 2003 39.95 Music åŸºäºmeeting js\nspotify iframe\nNotice Warning\nå‘Šè­¦\nInfo\nå¼•è¨€/é€šçŸ¥\nNote\nè®°å½•\nTip\næç¤º\nBilibili \u003c!DOCTYPE HTML\u003e Gist Codepen See the Pen Draft Countdown by littlebookboy (@littlebookboy) on CodePen. Youtube Ref Theme Documentation - Extended Shortcodes - LoveIt\n","permalink":"https://blog.niuhemoon.win/posts/tech/hugo-shortcode-example/","summary":"\u003cp\u003eè®°å½•hugo ä¸€äº›å¸¸ç”¨çš„shortcode\u003c/p\u003e","title":"hugo shortcode example"},{"content":"åœ¨manjaroä¸Šæ­å»ºminikubeæµ‹è¯•ç¯å¢ƒ\nå®‰è£… minikube å®‰è£…ä¾èµ– sudo pacman -Sy libvirt qemu ebtables dnsmasq sudo usermod -a -G libvirt $(whoami) newgrp libvirt sudo systemctl start libvirtd.service sudo systemctl enable libvirtd.service sudo systemctl start virtlogd.service sudo systemctl enable virtlogd.service è£…dockerå’Œkvm2 é©±åŠ¨ sudo pacman -Sy docker-machine yaourt -Sy docker-machine-driver-kvm2 è£…minikube yay -Sy minikube kubectl-bin minikube version whereis kubectl kubectl -h è£…ç¯å¢ƒ æ³¨æ„å…³æ‰ vpn\nminikube start --vm-driver kvm2 --registry-mirror=https://dockerhub.azk8s.cn --image-repository=registry.cn-hangzhou.aliyuncs.com/google_containers minikube status kubectl cluster-info kubectl get nodes å‚è€ƒ https://www.howtoforge.com/learning-kubernetes-locally-via-minikube-on-linux-manjaro-archlinux/\n","permalink":"https://blog.niuhemoon.win/posts/tech/install-minikube-on-manjaro/","summary":"\u003cp\u003eåœ¨manjaroä¸Šæ­å»ºminikubeæµ‹è¯•ç¯å¢ƒ\u003c/p\u003e","title":"Manjaro æ­å»º minikube ç¯å¢ƒ"},{"content":"å®‰è£… Tinygo åœ¨ Ubuntu ä¸Šå®‰è£…å¼€å‘ç¯å¢ƒï¼Œå…¶ä»–ç¯å¢ƒè§å‚è€ƒ\n# x86_64 wget https://github.com/tinygo-org/tinygo/releases/download/v0.17.0/tinygo_0.17.0_amd64.deb sudo dpkg -i tinygo_0.17.0_amd64.deb # arm wget https://github.com/tinygo-org/tinygo/releases/download/v0.17.0/tinygo_0.17.0_arm.deb sudo dpkg -i tinygo_0.17.0_arm.deb é…ç½®ç¯å¢ƒå˜é‡\nexport PATH=$PATH:/usr/local/tinygo/bin éªŒè¯å®‰è£…æˆåŠŸ\ntinygo version å®‰è£… esp32 ç¯å¢ƒ # install dep sudo apt-get install git wget make libncurses-dev flex bison gperf pip3 install pyserial # install esp32 toolchain wget https://dl.espressif.com/dl/xtensa-esp32-elf-linux64-1.22.0-80-g6c4433a-5.2.0.tar.gz -P ~/ mkdir -p ~/esp cd ~/esp tar -xzf ~/xtensa-esp32-elf-linux64-1.22.0-80-g6c4433a-5.2.0.tar.gz # add env path export PATH=\u0026#34;$PATH:$HOME/esp/xtensa-esp32-elf/bin\u0026#34; # install esptool pip3 install esptool çƒ§å½• esp32 ç¨‹åº å¯ä»¥ç”¨ usb è¿æ¥ esp32ï¼Œä¹Ÿå¯ä»¥ ttl è½¬ usb çº¿ï¼Œæˆ‘ç”¨çš„æ˜¯ ttl-usbï¼Œå°†è¿æ¥ esp å¯¹åº”çš„ RX å’Œ TX ä¸²å£ï¼Œè‡ªå·±ä½¿ç”¨ä¸²å£çº¿çƒ§å½•æ—¶éœ€è¦åŒæ—¶æŒ‰ä½ä¸¤ä¸ªæ¿è½½æŒ‰é”®ã€‚\nçƒ§å½•å®Œæˆåï¼ŒæŒ‰ en ä½¿èƒ½é”®ï¼Œç¨‹åºå¼€å§‹è¿è¡Œã€‚\n# chmod /dev/ttyUSB0 sudo chmod 666 /dev/ttyUSB0 # flash example program tinygo flash -target=esp32-mini32 -port=/dev/ttyUSB0 examples/blinky1 example/blinky1 ä»£ç åœ¨/usr/local/lib/tinygo/src ç›®å½•ä¸‹\nä¹Ÿå¯ä»¥ç¼–å†™è‡ªå·±çš„ç¨‹åºè¿›è¡Œçƒ§å½•ï¼Œå°†ä¸‹é¢ç¨‹åºä¿å­˜åœ¨/tmp/blink/blink.go\npackage main // This is the most minimal blinky example and should run almost everywhere. import ( \u0026#34;machine\u0026#34; \u0026#34;time\u0026#34; ) func main() { led := machine.LED led.Configure(machine.PinConfig{Mode: machine.PinOutput}) for { led.Low() time.Sleep(time.Millisecond * 300) led.High() time.Sleep(time.Millisecond * 2000) } } ç¼–è¯‘å¹¶çƒ§å½•\ntinygo flash -target=esp32-mini32 -port=/dev/ttyUSB0 /tmp/blink/blink.go Tinygo å¯¹ esp32 æ”¯æŒæƒ…å†µ\nå½“å‰ tinygo å¯¹ esp32 çš„æ”¯æŒè¿˜å¾ˆä¸å®Œå–„ï¼Œæ¯”è¾ƒé¸¡è‚‹ï¼Œä¸æ”¯æŒ goroutineï¼Œä¸æ”¯æŒç½‘ç»œå’Œè“ç‰™ç­‰ã€‚ç›¸æ¯” arduino å’Œ micropythonï¼Œå®ç”¨æ€§ä¸å¼ºã€‚\nInterface Hardware Supported TinyGo Support GPIO YES YES UART YES YES SPI YES YES I2C YES Not Yet ADC YES Not Yet PWM YES Not Yet WiFi YES Not Yet Bluetooth YES Not Yet å‚è€ƒ https://tinygo.org/getting-started/linux/\nhttps://docs.espressif.com/projects/esp-idf/en/release-v3.0/get-started/linux-setup.html#standard-setup-of-toolchain-for-linux\n","permalink":"https://blog.niuhemoon.win/posts/tech/tinygo-esp32/","summary":"\u003ch3 id=\"å®‰è£…-tinygo\"\u003eå®‰è£… Tinygo\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003eåœ¨ Ubuntu ä¸Šå®‰è£…å¼€å‘ç¯å¢ƒï¼Œå…¶ä»–ç¯å¢ƒè§å‚è€ƒ\u003c/p\u003e\n\u003c/blockquote\u003e","title":"tinygoç‚¹äº®esp32"},{"content":" ä½¿ç”¨selectè¯­å¥å’Œå¸¦ç¼“å†²åŒºçš„channelæ¥æ§åˆ¶å‡½æ•°å¹¶å‘æ‰§è¡Œæ¬¡æ•°\npackage main import ( \u0026#34;fmt\u0026#34; \u0026#34;time\u0026#34; ) // cocurrency number of the do func const cnum = 3 func main() { var jobs = make(chan bool, cnum) for { for i := 0; i \u0026lt; 10; i++ { go frqLimit(do, jobs, i) } time.Sleep(4e9) } } func frqLimit(f func(), jobChan chan bool, i int) { select { case jobChan \u0026lt;- true: f() \u0026lt;-jobChan default: fmt.Println(\u0026#34;job channel is full. pass \u0026#34;, i) } fmt.Println(\u0026#34;jobs\u0026#34;, i, \u0026#34;exit\u0026#34;) } func do() { time.Sleep(3e9) fmt.Println(\u0026#34;job done\u0026#34;) } ","permalink":"https://blog.niuhemoon.win/posts/tech/golang-frequency-limit/","summary":"ä½¿ç”¨selectè¯­å¥å’Œå¸¦ç¼“å†²åŒºçš„channelæ¥æ§åˆ¶å‡½æ•°å¹¶å‘æ‰§è¡Œæ¬¡æ•° package main import ( \u0026#34;fmt\u0026#34; \u0026#34;time\u0026#34; ) // cocurrency number of the do func const cnum = 3 func main() { var jobs = make(chan bool, cnum) for { for i := 0; i \u0026lt; 10; i++ { go frqLimit(do, jobs, i) } time.Sleep(4e9) } } func frqLimit(f func(), jobChan chan bool, i int) { select { case jobChan \u0026lt;- true: f() \u0026lt;-jobChan default: fmt.Println(\u0026#34;job channel is full. pass \u0026#34;, i) } fmt.Println(\u0026#34;jobs\u0026#34;, i, \u0026#34;exit\u0026#34;) } func do() { time.Sleep(3e9) fmt.Println(\u0026#34;job done\u0026#34;) }","title":"golangé™åˆ¶å‡½æ•°åŒæ—¶è°ƒç”¨æ¬¡æ•°"},{"content":"MakefileåŸºç¡€ è¯­æ³•\n# ç›®æ ‡ ï¼šä¾èµ– # æ ¹æ®ä¾èµ–ç”Ÿæˆç›®æ ‡çš„å‘½ä»¤ targets : prerequisites command å˜é‡\nMakefile å…è®¸ä½¿ç”¨ç­‰å·è‡ªå®šä¹‰å˜é‡ã€‚\ntxt = Hello World test: @echo $(txt) ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡ txt ç­‰äº Hello Worldã€‚è°ƒç”¨æ—¶ï¼Œå˜é‡éœ€è¦æ”¾åœ¨ $( ) ä¹‹ä¸­ã€‚\nè°ƒç”¨Shellå˜é‡ï¼Œéœ€è¦åœ¨ç¾å…ƒç¬¦å·å‰ï¼Œå†åŠ ä¸€ä¸ªç¾å…ƒç¬¦å·ï¼Œè¿™æ˜¯å› ä¸ºMakeå‘½ä»¤ä¼šå¯¹ç¾å…ƒç¬¦å·è½¬ä¹‰ã€‚\ntest: @echo $$HOME æœ‰æ—¶ï¼Œå˜é‡çš„å€¼å¯èƒ½æŒ‡å‘å¦ä¸€ä¸ªå˜é‡ã€‚\nv1 = $(v2) ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡ v1 çš„å€¼æ˜¯å¦ä¸€ä¸ªå˜é‡ v2ã€‚è¿™æ—¶ä¼šäº§ç”Ÿä¸€ä¸ªé—®é¢˜ï¼Œv1 çš„å€¼åˆ°åº•åœ¨å®šä¹‰æ—¶æ‰©å±•ï¼ˆé™æ€æ‰©å±•ï¼‰ï¼Œè¿˜æ˜¯åœ¨è¿è¡Œæ—¶æ‰©å±•ï¼ˆåŠ¨æ€æ‰©å±•ï¼‰ï¼Ÿå¦‚æœ v2 çš„å€¼æ˜¯åŠ¨æ€çš„ï¼Œè¿™ä¸¤ç§æ‰©å±•æ–¹å¼çš„ç»“æœå¯èƒ½ä¼šå·®å¼‚å¾ˆå¤§ã€‚\nä¸ºäº†è§£å†³ç±»ä¼¼é—®é¢˜ï¼ŒMakefileä¸€å…±æä¾›äº†å››ä¸ªèµ‹å€¼è¿ç®—ç¬¦ ï¼ˆ=ã€:=ã€ï¼Ÿ=ã€+=ï¼‰ï¼Œå®ƒä»¬çš„åŒºåˆ«è¯·çœ‹StackOverflowã€‚\nVARIABLE = value # åœ¨æ‰§è¡Œæ—¶æ‰©å±•ï¼Œå…è®¸é€’å½’æ‰©å±•ã€‚ VARIABLE := value # åœ¨å®šä¹‰æ—¶æ‰©å±•ã€‚ VARIABLE ?= value # åªæœ‰åœ¨è¯¥å˜é‡ä¸ºç©ºæ—¶æ‰è®¾ç½®å€¼ã€‚ VARIABLE += value # å°†å€¼è¿½åŠ åˆ°å˜é‡çš„å°¾ç«¯ã€‚ ç‰¹æ®Šå˜é‡\n$@ ï¼š targetæ–‡ä»¶å $\u0026lt; ï¼š ç¬¬ä¸€ä¸ªdependenciesæ–‡ä»¶ $? ï¼š æ‰€æœ‰æ¯”targetæ–‡ä»¶æ›´æ–°çš„dependenciesæ–‡ä»¶ $^ ï¼š æ‰€æœ‰çš„dependenciesæ–‡ä»¶ï¼Œä¸ç®¡æ–‡ä»¶ä¿®æ”¹æ—¶é—´å¦‚ä½•ã€‚ è·¨å¹³å°\nè®©makefileæ”¯æŒè·¨å¹³å°ï¼Œåœ¨ä¸åŒå¹³å°ä½œå‡ºä¸åŒçš„ååº”\n# Detect system OS. ifeq ($(OS),Windows_NT) detected_OS := Windows else detected_OS := $(shell sh -c \u0026#39;uname -s 2\u0026gt;/dev/null || echo not\u0026#39;) endif Goè¯­è¨€Makefileæ¨¡æ¿ -include .env PROJECTNAME=$(shell basename \u0026#34;$(PWD)\u0026#34;) # Binary package name for release BINARY=go_trans VERSION=0.0.3 # Go related variables. GOBASE=$(shell pwd) GOPATH :=$(shell echo ${GOPATH}) # Go binary store place. GOBIN=$(GOBASE)/bin GORELEASE=$(GOBASE)/release GOFILES=$(wildcard *.go) GOBUILD_RACE=go build -race -o GOBUILD=go build -o # Redirect error output to a file, so we can show it in development mode. STDERR=/tmp/.$(PROJECTNAME)-stderr.txt # PID file will keep the process id of the server PID=/tmp/.$(PROJECTNAME).pid # Make is verbose in Linux. Make it silent. MAKEFLAGS += --silent .PHONY: help all: help help: Makefile @echo @echo \u0026#34; Choose a command run in \u0026#34;$(PROJECTNAME)\u0026#34;:\u0026#34; @echo @sed -n \u0026#39;s/^##//p\u0026#39; $\u0026lt; | column -t -s \u0026#39;:\u0026#39; | sed -e \u0026#39;s/^/ /\u0026#39; @echo go-compile: clean-bin go-get go-build go-build: @echo \u0026#34; \u0026gt; Building binary...\u0026#34; @GOOS=linux GOARCH=amd64 $(GOBUILD) $(GOBIN)/$(PROJECTNAME) @echo \u0026#34; \u0026gt; Building done.\u0026#34; go-race-check: go-get @echo \u0026#34; \u0026gt; Race check start...\u0026#34; @GOOS=linux GOARCH=amd64 $(GOBUILD_RACE) $(GOBIN)/$(PROJECTNAME)_tmp @echo \u0026#34; \u0026gt; Race check done.\u0026#34; @-rm $(GOBIN)/$(PROJECTNAME)_tmp go-generate: @echo \u0026#34; \u0026gt; Generating dependency files...\u0026#34; @GOPATH=$(GOPATH) GOBIN=$(GOBIN) go generate $(generate) go-get: @echo \u0026#34; \u0026gt; Checking if there is any missing dependencies...\u0026#34; #@GOPATH=$(GOPATH) GOBIN=$(GOBIN) go get $(get) go-install: @GOPATH=$(GOPATH) GOBIN=$(GOBIN) go install $(GOFILES) clean-bin: @echo \u0026#34; \u0026gt; Cleaning build cache...\u0026#34; @-rm $(GOBIN)/* 2\u0026gt; /dev/null clean-release: @echo \u0026#34; \u0026gt; Cleaning release file...\u0026#34; @-rm $(GORELEASE)/* 2\u0026gt; /dev/null ## test: Run all test. test: echo \u0026#34;Test Not Implement.\u0026#34; ## install: Install missing dependencies. Runs `go get` internally. e.g; make install get=github.com/foo/bar install: go-get stop: stop-server start-server: stop-server @echo \u0026#34; \u0026gt; $(PROJECTNAME) is available at $(ADDR)\u0026#34; @-$(GOBIN)/$(PROJECTNAME) 2\u0026gt;\u0026amp;1 \u0026amp; echo $$! \u0026gt; $(PID) @cat $(PID) | sed \u0026#34;/^/s/^/ \\\u0026gt; PID: /\u0026#34; stop-server: @-touch $(PID) @-kill `cat $(PID)` 2\u0026gt; /dev/null || true @-rm $(PID) restart-server: stop-server start-server ## compile: Compile the x86_64 Linux binary without race check. compile: @-touch $(STDERR) @-rm $(STDERR) @-$(MAKE) go-compile 2\u0026gt; $(STDERR) @cat $(STDERR) | sed -e \u0026#39;1s/.*/\\nError:\\n/\u0026#39; | sed \u0026#39;s/make\\[.*/ /\u0026#39; | sed \u0026#34;/^/s/^/ /\u0026#34; 1\u0026gt;\u0026amp;2 ## clean: Clean build files and release file. clean: clean-bin clean-release ## race: Race check. race: @-touch $(STDERR) @-rm $(STDERR) @-$(MAKE) go-race-check 2\u0026gt; $(STDERR) @cat $(STDERR) | sed -e \u0026#39;1s/.*/\\nError:\\n/\u0026#39; | sed \u0026#39;s/make\\[.*/ /\u0026#39; | sed \u0026#34;/^/s/^/ /\u0026#34; 1\u0026gt;\u0026amp;2 ## release: Release arm64 and x86_64 linux binary package. release: clean-release @echo \u0026#34; \u0026gt; Creating release file...\u0026#34; # Build for arm linux @CGO_ENABLED=0 GOOS=linux GOARCH=arm64 $(GOBUILD) $(GORELEASE)/$(BINARY)-arm64-liunx-$(VERSION) # Build for x86_64 linux @CGO_ENABLED=0 GOOS=linux GOARCH=amd64 $(GOBUILD) $(GORELEASE)/$(BINARY)-x86-64-linux-$(VERSION) å‚è€ƒ è·Ÿæˆ‘ä¸€èµ·å†™Makefile\nhttps://github.com/crossoverJie/btb/blob/master/Makefile Makefiles for Go Developers\ngo-makefile-example\nMake å‘½ä»¤æ•™ç¨‹\nä¸€ä¸ªä¸ºgoå‡†å¤‡çš„ä¼˜ç§€makefile\nGNU make\nmakefileè·¨å¹³å°\n","permalink":"https://blog.niuhemoon.win/posts/tech/golang-makefile/","summary":"MakefileåŸºç¡€ è¯­æ³• # ç›®æ ‡ ï¼šä¾èµ– # æ ¹æ®ä¾èµ–ç”Ÿæˆç›®æ ‡çš„å‘½ä»¤ targets : prerequisites command å˜é‡ Makefile å…è®¸ä½¿ç”¨ç­‰å·è‡ªå®šä¹‰å˜é‡ã€‚ txt = Hello World test: @echo $(txt) ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡ txt ç­‰äº Hello Worldã€‚è°ƒç”¨æ—¶ï¼Œå˜é‡éœ€è¦æ”¾åœ¨ $( ) ä¹‹ä¸­ã€‚ è°ƒç”¨Shellå˜é‡ï¼Œéœ€è¦åœ¨ç¾å…ƒç¬¦å·å‰ï¼Œå†åŠ ä¸€ä¸ªç¾å…ƒç¬¦å·ï¼Œè¿™æ˜¯å› ä¸ºMakeå‘½ä»¤ä¼šå¯¹ç¾å…ƒç¬¦å·è½¬ä¹‰ã€‚ test: @echo $$HOME æœ‰","title":"Goè¯­è¨€å’ŒMakefile"},{"content":"ç®€ä»‹ Typescript å¯ä»¥åœ¨ä»£ç ç¼–å†™å†™åšç±»å‹æ£€æŸ¥ï¼Œå¯ä»¥ç¼–å†™æ›´å¥å£®çš„ä»£ç ã€‚\nå®‰è£… npm config set registry https://registry.npm.taobao.org sudo npm install -g typescript # å®‰è£…REPL sudo npm install -g tsun åŸºæœ¬æ¦‚å¿µ è”åˆç±»å‹\nè¡¨ç¤ºå–å€¼æ˜¯å¤šç§ç±»å‹ä¸­çš„ä¸€ç§ï¼Œå½“ TypeScript ä¸ç¡®å®šä¸€ä¸ªè”åˆç±»å‹çš„å˜é‡åˆ°åº•æ˜¯å“ªä¸ªç±»å‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªèƒ½è®¿é—®æ­¤è”åˆç±»å‹çš„æ‰€æœ‰ç±»å‹é‡Œå…±æœ‰çš„å±æ€§æˆ–æ–¹æ³•\nlet myFavoriteNumber: string | number; myFavoriteNumber = \u0026#34;seven\u0026#34;; myFavoriteNumber = 7; æ¥å£\nTypeScript ä¸­çš„æ¥å£æ˜¯ä¸€ä¸ªéå¸¸çµæ´»çš„æ¦‚å¿µï¼Œé™¤äº†å¯ç”¨äºå¯¹ç±»çš„ä¸€éƒ¨åˆ†è¡Œä¸ºè¿›è¡ŒæŠ½è±¡ä»¥å¤–ï¼Œä¹Ÿå¸¸ç”¨äºå¯¹ã€Œå¯¹è±¡çš„å½¢çŠ¶ï¼ˆShapeï¼‰ã€è¿›è¡Œæè¿°ã€‚ æ¥å£æ˜¯ä¸€ä¸ªç±»å‹ï¼Œä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„å€¼ï¼Œå®ƒåœ¨ç¼–è¯‘ç»“æœä¸­ä¼šè¢«åˆ é™¤\n//ï¼Ÿå¯é€‰å±æ€§ interface Person { name: string; age?: number; } let tom: Person = { name: \u0026#34;Tom\u0026#34;, }; let tom: Person1 = { name: \u0026#34;Tom\u0026#34;, age: 25, }; //æ¥å£å¯ä»¥ç»§æ‰¿ interface ApiError extends Error { code: number; } æ¥å£å¯ä»¥å®šä¹‰ä»»æ„ç±»å‹ï¼Œä½†æ˜¯å½“åŒæ—¶å­˜åœ¨å¯é€‰ç±»å‹å’Œä»»æ„ç±»å‹ï¼Œå¯é€‰ç±»å‹éœ€è¦æ˜¯ä»»æ„ç±»å‹çš„å­é›†\ninterface Person { name: string; age?: number; //ä»»æ„ç±»å‹ä¸ºè”åˆç±»å‹ [propName: string]: string | number; } let tom: Person = { name: \u0026#34;Tom\u0026#34;, age: 25, gender: \u0026#34;male\u0026#34;, }; æ¥å£å±æ€§åªè¯»ï¼Œæ„å‘³ç€ï¼Œåªæœ‰åœ¨åˆ›å»ºå¯¹è±¡æ—¶å¯è¢«èµ‹å€¼ï¼Œå…¶åæ— æ³•ä¿®æ”¹ï¼Œè€Œä¸”åªè¯»å±æ€§å¿…é¡»åœ¨å¯¹è±¡åˆå§‹åŒ–æ—¶è¿›è¡Œèµ‹å€¼ã€‚\ninterface Person { readonly id: number; name: string; age?: number; [propName: string]: any; } let tom: Person = { id: 89757, name: \u0026#34;Tom\u0026#34;, gender: \u0026#34;male\u0026#34;, }; æ•°ç»„\nä¹ æƒ¯æ€§çš„å°†æ•°ç»„ä¸­çš„å…ƒç´ ç±»å‹ä¿æŒç›¸åŒ\nlet fibonacci: number[] = [1, 1, 2, 3, 5]; //æ³›å‹ let fibonacci: Array\u0026lt;number\u0026gt; = [1, 1, 2, 3, 5]; //æ¥å£è¡¨ç¤ºæ•°ç»„ //ç”¨æ¥å£è¡¨ç¤ºæ•°ç»„é€šå¸¸ç”¨æ¥æ ‡è¯†ç±»å‹ interface NumberArray { //ç´¢å¼•æ˜¯æ•°å­—ï¼Œç±»å‹æ˜¯æ•°å­— [index: number]: number; } let fibonacci: NumberArray = [1, 1, 2, 3, 5]; interface IArguments { [index: number]: any; length: number; callee: Function; } å‡½æ•°\nåœ¨ JavaScript ä¸­ï¼Œæœ‰ä¸¤ç§å¸¸è§çš„å®šä¹‰å‡½æ•°çš„æ–¹å¼â€”â€”å‡½æ•°å£°æ˜ï¼ˆFunction Declarationï¼‰å’Œå‡½æ•°è¡¨è¾¾å¼ï¼ˆFunction Expressionï¼‰; å‡½æ•°å£°æ˜å’Œå‡½æ•°è¡¨è¾¾å¼çš„è¯æ³•ç¯å¢ƒå’Œæ‰§è¡Œä¸Šä¸‹æ–‡æ˜¯ä¸ä¸€æ ·çš„ï¼Œå‡½æ•°å£°æ˜ä¼šåšç±»å‹æå‡ã€‚\n// å‡½æ•°å£°æ˜ï¼ˆFunction Declarationï¼‰ function sum(x, y) { return x + y; } // å‡½æ•°è¡¨è¾¾å¼ï¼ˆFunction Expressionï¼‰ let mySum = function (x, y) { return x + y; }; å¯ä»¥æ‰‹åŠ¨ç»™å‡½æ•°è¡¨è¾¾å¼æ·»åŠ ç±»å‹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç±»å‹æ¨æ–­ åœ¨ TypeScript çš„ç±»å‹å®šä¹‰ä¸­ï¼Œ=\u0026gt; ç”¨æ¥è¡¨ç¤ºå‡½æ•°çš„å®šä¹‰ï¼Œå·¦è¾¹æ˜¯è¾“å…¥ç±»å‹ï¼Œéœ€è¦ç”¨æ‹¬å·æ‹¬èµ·æ¥ï¼Œå³è¾¹æ˜¯è¾“å‡ºç±»å‹ã€‚ åœ¨ ES6 ä¸­ï¼Œ=\u0026gt; å«åšç®­å¤´å‡½æ•°ï¼Œåº”ç”¨ååˆ†å¹¿æ³›\nlet mySum: (x: number, y: number) =\u0026gt; number = function ( x: number, y: number ): number { return x + y; }; å¯é€‰å‚æ•°ç”¨ï¼Ÿæ ‡è¯†ï¼Œå¿…é¡»æ¥åœ¨å¿…éœ€å‚æ•°çš„åé¢\nfunction buildName(firstName: string, lastName?: string) { if (lastName) { return firstName + \u0026#34; \u0026#34; + lastName; } else { return firstName; } } let tomcat = buildName(\u0026#34;Tom\u0026#34;, \u0026#34;Cat\u0026#34;); let tom = buildName(\u0026#34;Tom\u0026#34;); ES6 ä¸­å…è®¸ç»™å‚æ•°æ·»åŠ é»˜è®¤å€¼ï¼ŒTypescript å°†æ·»åŠ é»˜è®¤å€¼çš„å‚æ•°è¯†åˆ«ä¸ºå¯é€‰å‚æ•°ï¼Œå¹¶ä¸”æ·»åŠ é»˜è®¤å€¼åï¼Œå°±ä¸å—ã€Œå¯é€‰å‚æ•°å¿…é¡»æ¥åœ¨å¿…éœ€å‚æ•°åé¢ã€çš„é™åˆ¶äº† é»˜è®¤å€¼å‚æ•°åœ¨å¿…éœ€å‚æ•°å‰çš„è¯ï¼Œéœ€è¦ä¼ ä¸€ä¸ª undefined è¿›å»å ä½ï¼Œå› æ­¤æ¨èå°†é»˜è®¤å€¼å‚æ•°æ”¾åœ¨åé¢\nfunction buildName(firstName: string = \u0026#34;Tom\u0026#34;, lastName: string) { return firstName + \u0026#34; \u0026#34; + lastName; } let tomcat = buildName(\u0026#34;Tom\u0026#34;, \u0026#34;Cat\u0026#34;); //å¦‚æœé»˜è®¤å€¼å‚æ•°åœ¨å¿…éœ€å‚æ•°å‰è¾¹ï¼Œå¿…é¡»ä¼ å…¥undefined console.log(buildName(undefined, \u0026#34;cat\u0026#34;)); function buildName1(firstName: string, lastName: string = \u0026#34;Man\u0026#34;) { return firstName + \u0026#34; \u0026#34; + lastName; } console.log(buildName(\u0026#34;good\u0026#34;)); å‰©ä½™ rest å‚æ•°ï¼ˆä¸å®šé•¿å‚æ•°ï¼‰ rest å‚æ•°åªèƒ½æ˜¯æœ€åä¸€ä¸ªå‚æ•°\n//itemsæ˜¯ä¸€ä¸ªæ•°ç»„ function push(array, ...items) { items.forEach(function (item) { array.push(item); }); } let a: any[] = []; push(a, 1, 2, 3); å‡½æ•°é‡è½½å…è®¸ä¸€ä¸ªå‡½æ•°æ¥å—ä¸åŒæ•°é‡æˆ–ç±»å‹çš„å‚æ•°æ—¶ï¼Œä½œå‡ºä¸åŒçš„å¤„ç†ã€‚ Typescript ä¼šä»æœ€å‰é¢çš„å‡½æ•°å®šä¹‰å¼€å§‹åŒ¹é…\n//å‰å£°æ˜ï¼ˆå®šä¹‰ï¼‰åå®ç°ï¼Œå°†ç²¾ç¡®çš„å£°æ˜å†™åœ¨å‰é¢ function reverse(x: number): number; function reverse(x: string): string; function reverse(x: number | string): number | string { if (typeof x === \u0026#34;number\u0026#34;) { return Number(x.toString().split(\u0026#34;\u0026#34;).reverse().join(\u0026#34;\u0026#34;)); } else if (typeof x === \u0026#34;string\u0026#34;) { return x.split(\u0026#34;\u0026#34;).reverse().join(\u0026#34;\u0026#34;); } } ç±»å‹æ–­è¨€\nå€¼ as ç±»å‹ ç±»å‹æ–­è¨€åªä¼šå½±å“ TypeScript ç¼–è¯‘æ—¶çš„ç±»å‹ï¼Œç±»å‹æ–­è¨€è¯­å¥åœ¨ç¼–è¯‘ç»“æœä¸­ä¼šè¢«åˆ é™¤ å®ƒä¸ä¼šçœŸçš„å½±å“åˆ°å˜é‡çš„ç±»å‹ã€‚ åº”ç”¨åœºæ™¯:\nå°†ä¸€ä¸ªè”åˆç±»å‹æ–­è¨€ä¸ºå…¶ä¸­ä¸€ä¸ªç±»å‹ï¼Œæ¬ºéª— tsc ç¼–è¯‘å™¨ï¼Œå¯èƒ½å¯¼è‡´è¿è¡Œæ—¶å‡ºé”™ å°†ä¸€ä¸ªçˆ¶ç±»æ–­è¨€ä¸ºæ›´åŠ å…·ä½“çš„å­ç±» å°†ä»»ä½•ä¸€ä¸ªç±»å‹æ–­è¨€ä¸º any å°† any æ–­è¨€ä¸ºä¸€ä¸ªå…·ä½“çš„ç±»å‹ é™åˆ¶ï¼š typescript æ˜¯ç»“æ„ç±»å‹ç³»ç»Ÿï¼Œä¸å…³å¿ƒå®šä¹‰æ—¶çš„ç±»å‹å…³ç³»ï¼Œåªæ¯”è¾ƒæœ€ç»ˆç»“æ„æœ‰ä»€ä¹ˆå…³ç³»\nè”åˆç±»å‹å¯ä»¥è¢«æ–­è¨€ä¸ºå…¶ä¸­ä¸€ä¸ªç±»å‹ çˆ¶ç±»å¯ä»¥è¢«æ–­è¨€ä¸ºå­ç±» ä»»ä½•ç±»å‹éƒ½å¯ä»¥è¢«æ–­è¨€ä¸º any any å¯ä»¥è¢«æ–­è¨€ä¸ºä»»ä½•ç±»å‹ è¦ä½¿å¾— A èƒ½å¤Ÿè¢«æ–­è¨€ä¸º Bï¼Œåªéœ€è¦ A å…¼å®¹ B æˆ– B å…¼å®¹ A å³å¯ //ç±»å‹æ¯”è¾ƒ //ä¸‹é¢ä¸¤ç§Catçš„å®šä¹‰æ˜¯ç­‰ä»·çš„ interface Animal { name: string; } interface Cat { name: string; run(): void; } interface Cat extends Animal { run(): void; } //è”åˆç±»å‹æ–­è¨€ interface Cat { name: string; run(): void; } interface Fish { name: string; swim(): void; } function isFish(animal: Cat | Fish) { if (typeof (animal as Fish).swim === \u0026#34;function\u0026#34;) { return true; } return false; } //å­ç±»æ–­è¨€ interface ApiError extends Error { code: number; } interface HttpError extends Error { statusCode: number; } function isApiError(error: Error) { if (typeof (error as ApiError).code === \u0026#34;number\u0026#34;) { return true; } return false; } //ç¡®ä¿ä»£ç æ— è¯¯åï¼Œç»•è¿‡ç±»å‹æ£€æŸ¥ //åœ¨ç±»å‹çš„ä¸¥æ ¼æ€§å’Œå¼€å‘çš„ä¾¿åˆ©æ€§ä¹‹é—´æŒæ¡å¹³è¡¡ (window as any).foo = 1; //æ˜ç¡®ç±»å‹ï¼Œåç»­æœ‰äº†ä»£ç è¡¥å…¨ï¼Œæé«˜å¯ç»´æŠ¤æ€§ function getCacheData(key: string): any { return (window as any).cache[key]; } interface Cat { name: string; run(): void; } const tom = getCacheData(\u0026#34;tom\u0026#34;) as Cat; tom.run(); ç±»å‹å£°æ˜æ¯”ç±»å‹æ–­è¨€çº¦æŸæ›´ä¸¥æ ¼ï¼Œå¦‚ animal æ–­è¨€ä¸º Catï¼Œåªéœ€è¦æ»¡è¶³ Animal å…¼å®¹ Cat æˆ– Cat å…¼å®¹ Animal å³å¯ animal èµ‹å€¼ç»™ tomï¼Œéœ€è¦æ»¡è¶³ Cat å…¼å®¹ Animal æ‰è¡Œ å¯ä»¥ç”¨æ³›å‹æ›¿ä»£ç±»å‹æ–­è¨€\nfunction getCacheData\u0026lt;T\u0026gt;(key: string): T { return (window as any).cache[key]; } interface Cat { name: string; run(): void; } const tom = getCacheData\u0026lt;Cat\u0026gt;(\u0026#34;tom\u0026#34;); tom.run(); å£°æ˜æ–‡ä»¶\nå¸¸ç”¨çš„å£°æ˜è¯­æ³•\ndeclare var å£°æ˜å…¨å±€å˜é‡ declare const å£°æ˜å…¨å±€å¸¸é‡ declare function å£°æ˜å…¨å±€æ–¹æ³• declare class å£°æ˜å…¨å±€ç±» declare enum å£°æ˜å…¨å±€æšä¸¾ç±»å‹ declare namespace å£°æ˜ï¼ˆå«æœ‰å­å±æ€§çš„ï¼‰å…¨å±€å¯¹è±¡ interface å’Œ type å£°æ˜å…¨å±€ç±»å‹ export å¯¼å‡ºå˜é‡ export namespace å¯¼å‡ºï¼ˆå«æœ‰å­å±æ€§çš„ï¼‰å¯¹è±¡ export default ES6 é»˜è®¤å¯¼å‡º export = commonjs å¯¼å‡ºæ¨¡å— export as namespace UMD åº“å£°æ˜å…¨å±€å˜é‡ declare global æ‰©å±•å…¨å±€å˜é‡ declare module æ‰©å±•æ¨¡å— /// \u0026lt;reference /\u0026gt; ä¸‰æ–œçº¿æŒ‡ä»¤ ç±»å‹åˆ«å\nç±»å‹ c è¯­è¨€ typedefï¼Œåœ¨ typescript ä¸­ç”¨ type åˆ›å»ºç±»å‹åˆ«å\ntype Name = string; type NameResolver = () =\u0026gt; string; type NameOrResolver = Name | NameResolver; function getName(n: NameOrResolver): Name { if (typeof n === \u0026#34;string\u0026#34;) { return n; } else { return n(); } } å­—é¢é‡ç±»å‹\nçº¦æŸå–å€¼åªèƒ½æ˜¯æŸå‡ ä¸ªå€¼ä¸­çš„ä¸€ä¸ª\ntype EventNames = \u0026#34;click\u0026#34; | \u0026#34;scroll\u0026#34; | \u0026#34;mousemove\u0026#34;; function handleEvent(ele: Element, event: EventNames) { // do something } handleEvent(document.getElementById(\u0026#34;hello\u0026#34;), \u0026#34;scroll\u0026#34;); // æ²¡é—®é¢˜ handleEvent(document.getElementById(\u0026#34;world\u0026#34;), \u0026#34;dblclick\u0026#34;); // æŠ¥é”™ï¼Œevent ä¸èƒ½ä¸º \u0026#39;dblclick\u0026#39; å…ƒç»„\næ•°ç»„åˆå¹¶äº†ç›¸åŒç±»å‹çš„å¯¹è±¡ï¼Œè€Œå…ƒç»„ï¼ˆTupleï¼‰åˆå¹¶äº†ä¸åŒç±»å‹çš„å¯¹è±¡; å¯ä»¥å¯¹å…ƒç»„ä¸­çš„å•ä¸ªå…ƒç´ èµ‹å€¼ï¼› å½“ç›´æ¥å¯¹å…ƒç»„ç±»å‹çš„å˜é‡è¿›è¡Œåˆå§‹åŒ–æˆ–è€…èµ‹å€¼çš„æ—¶å€™ï¼Œéœ€è¦æä¾›æ‰€æœ‰å…ƒç»„ç±»å‹ä¸­æŒ‡å®šçš„é¡¹; å½“æ·»åŠ è¶Šç•Œçš„å…ƒç´ æ—¶ï¼Œå®ƒçš„ç±»å‹ä¼šè¢«é™åˆ¶ä¸ºå…ƒç»„ä¸­æ¯ä¸ªç±»å‹çš„è”åˆç±»å‹\nlet tom: [string, number] = [\u0026#34;Tom\u0026#34;, 25]; let tom: [string, number]; tom[0] = \u0026#34;Tom\u0026#34;; tom[1] = 25; tom[0].slice(1); tom[1].toFixed(2); tom = [\u0026#34;Tom\u0026#34;, 25]; tom.push(\u0026#34;male\u0026#34;); æšä¸¾\næšä¸¾ï¼ˆEnumï¼‰ç±»å‹ç”¨äºå–å€¼è¢«é™å®šåœ¨ä¸€å®šèŒƒå›´å†…çš„åœºæ™¯\nenum Days { Sun, Mon, Tue, Wed, Thu, Fri, Sat, } console.log(Days[\u0026#34;Sun\u0026#34;] === 0); // true console.log(Days[\u0026#34;Mon\u0026#34;] === 1); // true console.log(Days[\u0026#34;Tue\u0026#34;] === 2); // true console.log(Days[\u0026#34;Sat\u0026#34;] === 6); // true console.log(Days[0] === \u0026#34;Sun\u0026#34;); // true console.log(Days[1] === \u0026#34;Mon\u0026#34;); // true console.log(Days[2] === \u0026#34;Tue\u0026#34;); // true console.log(Days[6] === \u0026#34;Sat\u0026#34;); // true ç±»\nä¼ ç»Ÿæ–¹æ³•ä¸­ï¼ŒJavaScript é€šè¿‡æ„é€ å‡½æ•°å®ç°ç±»çš„æ¦‚å¿µï¼Œé€šè¿‡åŸå‹é“¾å®ç°ç»§æ‰¿ã€‚è€Œåœ¨ ES6 ä¸­ï¼Œæˆ‘ä»¬ç»ˆäºè¿æ¥äº† class ä½¿ç”¨ class å®šä¹‰ç±»ï¼Œä½¿ç”¨ constructor å®šä¹‰æ„é€ å‡½æ•°ã€‚ é€šè¿‡ new ç”Ÿæˆæ–°å®ä¾‹çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨æ„é€ å‡½æ•°ã€‚ ä½¿ç”¨ extends å…³é”®å­—å®ç°ç»§æ‰¿ï¼Œå­ç±»ä¸­ä½¿ç”¨ super å…³é”®å­—æ¥è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°å’Œæ–¹æ³•ã€‚ ä½¿ç”¨ getter å’Œ setter å¯ä»¥æ”¹å˜å±æ€§çš„èµ‹å€¼å’Œè¯»å–è¡Œä¸ºï¼š ä½¿ç”¨ static ä¿®é¥°ç¬¦ä¿®é¥°çš„æ–¹æ³•ç§°ä¸ºé™æ€æ–¹æ³•ï¼Œå®ƒä»¬ä¸éœ€è¦å®ä¾‹åŒ–ï¼Œè€Œæ˜¯ç›´æ¥é€šè¿‡ç±»æ¥è°ƒç”¨ï¼Œä¸å¯ä»¥é€šè¿‡å®ä¾‹æ¥è°ƒç”¨ï¼š\nES6 ä¸­å®ä¾‹çš„å±æ€§åªèƒ½é€šè¿‡æ„é€ å‡½æ•°ä¸­çš„ this.xxx æ¥å®šä¹‰ï¼ŒES7 ææ¡ˆä¸­å¯ä»¥ç›´æ¥åœ¨ç±»é‡Œé¢å®šä¹‰ ES7 ææ¡ˆä¸­ï¼Œå¯ä»¥ä½¿ç”¨ static å®šä¹‰ä¸€ä¸ªé™æ€å±æ€§ï¼Œé™æ€å±æ€§å±äºç±»ï¼› å½“æ„é€ å‡½æ•°ä¿®é¥°ä¸º private æ—¶ï¼Œè¯¥ç±»ä¸å…è®¸è¢«ç»§æ‰¿æˆ–è€…å®ä¾‹åŒ–; å½“æ„é€ å‡½æ•°ä¿®é¥°ä¸º protected æ—¶ï¼Œè¯¥ç±»åªå…è®¸è¢«ç»§æ‰¿ï¼Œä¸å…è®¸è¢«å®ä¾‹åŒ–ï¼› ç±»å±æ€§/æ–¹æ³•çš„è®¿é—®é™å®šç¬¦å¦‚ä¸‹:\npublic ä¿®é¥°çš„å±æ€§æˆ–æ–¹æ³•æ˜¯å…¬æœ‰çš„ï¼Œå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è¢«è®¿é—®åˆ°ï¼Œé»˜è®¤æ‰€æœ‰çš„å±æ€§å’Œæ–¹æ³•éƒ½æ˜¯ public çš„ private ä¿®é¥°çš„å±æ€§æˆ–æ–¹æ³•æ˜¯ç§æœ‰çš„ï¼Œä¸èƒ½åœ¨å£°æ˜å®ƒçš„ç±»çš„å¤–éƒ¨è®¿é—® protected ä¿®é¥°çš„å±æ€§æˆ–æ–¹æ³•æ˜¯å—ä¿æŠ¤çš„ï¼Œå®ƒå’Œ private ç±»ä¼¼ï¼ŒåŒºåˆ«æ˜¯å®ƒåœ¨å­ç±»ä¸­ä¹Ÿæ˜¯å…è®¸è¢«è®¿é—®çš„ class Animal { private _name: string; age = 23; static num = 42; constructor(name) { this._name = name; } get name() { return \u0026#34;get \u0026#34; + this._name; } //nameæ˜¯publicçš„ï¼Œä½†æ˜¯_nameæ˜¯ç§æœ‰çš„ //ä¸èƒ½åœ¨set nameä¸­å†å¯¹nameèµ‹å€¼ï¼Œä¼šé€ æˆæ­»å¾ªç¯ set name(value) { if (value === \u0026#34;Dog\u0026#34;) { console.log(\u0026#34;Animal cannot be dog\u0026#34;); return; } this._name = value; console.log(\u0026#34;setter: \u0026#34; + value); } sayHi() { console.log(`My name is ${this._name}`); } static isAnimal(a) { return a instanceof Animal; } } class Cat extends Animal { constructor(name) { super(name); // è°ƒç”¨çˆ¶ç±»çš„ constructor(name) console.log(this.name); } //å‡½æ•°é‡å†™ sayHi() { return \u0026#34;Meow, \u0026#34; + super.sayHi(); // è°ƒç”¨çˆ¶ç±»çš„ sayHi() } } let a = new Animal(\u0026#34;Jack\u0026#34;); Animal.isAnimal(a); // true let c = new Cat(\u0026#34;Tom\u0026#34;); // Tom console.log(c.sayHi()); // Meow, My name is Tom å‚æ•°å±æ€§ ä¿®é¥°ç¬¦å’Œ readonly è¿˜å¯ä»¥ä½¿ç”¨åœ¨æ„é€ å‡½æ•°å‚æ•°ä¸­ï¼Œç­‰åŒäºç±»ä¸­å®šä¹‰è¯¥å±æ€§åŒæ—¶ç»™è¯¥å±æ€§èµ‹å€¼ åªè¯»å±æ€§å…³é”®å­—ï¼Œåªå…è®¸å‡ºç°åœ¨å±æ€§å£°æ˜æˆ–ç´¢å¼•ç­¾åæˆ–æ„é€ å‡½æ•°ä¸­ æ³¨æ„å¦‚æœ readonly å’Œå…¶ä»–è®¿é—®ä¿®é¥°ç¬¦åŒæ—¶å­˜åœ¨çš„è¯ï¼Œéœ€è¦å†™åœ¨å…¶åé¢ã€‚ abstract ç”¨äºå®šä¹‰æŠ½è±¡ç±»å’Œå…¶ä¸­çš„æŠ½è±¡æ–¹æ³•ã€‚ æŠ½è±¡ç±»ä¸å…è®¸è¢«å®ä¾‹åŒ–ï¼ŒæŠ½è±¡ç±»ä¸­çš„æŠ½è±¡æ–¹æ³•å¿…é¡»è¢«å­ç±»å®ç°\nabstract class Animal { //public readonly name; public constructor(public readonly name: string) { this.name = name; } //abstract method public abstract eat(); } class Cat extends Animal { public eat() { console.log(`${this.name} is eating.`); } } let a = new Cat(\u0026#34;Tom\u0026#34;); console.log(a.name); // Tom ç±»å’Œæ¥å£\nå®ç°ï¼ˆimplementsï¼‰æ˜¯é¢å‘å¯¹è±¡ä¸­çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µã€‚ä¸€èˆ¬æ¥è®²ï¼Œä¸€ä¸ªç±»åªèƒ½ç»§æ‰¿è‡ªå¦ä¸€ä¸ªç±»ï¼Œæœ‰æ—¶å€™ä¸åŒç±»ä¹‹é—´å¯ä»¥æœ‰ä¸€äº›å…±æœ‰çš„ç‰¹æ€§ï¼Œè¿™æ—¶å€™å°±å¯ä»¥æŠŠç‰¹ æ€§æå–æˆæ¥å£ï¼ˆinterfacesï¼‰ï¼Œç”¨ implements å…³é”®å­—æ¥å®ç°ã€‚è¿™ä¸ªç‰¹æ€§å¤§å¤§æé«˜äº†é¢å‘å¯¹è±¡çš„çµæ´»æ€§ã€‚\næ¥å£ä¸­æ‰€æœ‰å±æ€§å’Œæ–¹æ³•éƒ½è¦æ±‚æ˜¯ public ä¸€ä¸ªç±»å¯ä»¥å®ç°ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ¥å£ æ¥å£ä¹‹é—´å¯ä»¥æ˜¯ç»§æ‰¿å…³ç³» æ¥å£å¯ä»¥ç»§æ‰¿ç±»ï¼ˆä¸æ¨èï¼‰ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯æ¥å£ç»§æ‰¿æ¥å£ï¼Œå› ä¸ºåœ¨åˆ›å»ºç±»çš„æ—¶å€™ï¼Œä¼šåˆ›å»ºä¸€ä¸ªåŒåçš„æ¥å£ç±»å‹ åˆ›å»ºç±»æ—¶è‡ªåŠ¨ç”Ÿæˆçš„ç±»å‹ä¸­åŒ…å«äº†é™¤äº†æ„é€ å‡½æ•°çš„å®ä¾‹å±æ€§å’Œå®ä¾‹æ–¹æ³•ï¼Œä¼šä¿ç•™è®¿é—®é™å®šç¬¦ï¼Œ å¦‚æœç±»å±æ€§æ˜¯ privateï¼Œå°†å¯¼è‡´è¯¥ç±»å‹çš„å¯¹è±¡æ— æ³•è¢«åˆå§‹åŒ–ï¼Œç”Ÿæˆçš„æ¥å£ç±»å‹ä¸­ä¸åŒ…æ‹¬ï¼š\né™æ€ç±»å‹å’Œé™æ€æ–¹æ³• æ„é€ å‡½æ•° interface Alarm { alert(): void; } interface Light { lightOn(): void; lightOff(): void; } class Car implements Alarm, Light { alert() { console.log(\u0026#34;Car alert\u0026#34;); } lightOn() { console.log(\u0026#34;Car light on\u0026#34;); } lightOff() { console.log(\u0026#34;Car light off\u0026#34;); } } æ¥å£ç»§æ‰¿ç±»ï¼ˆæ™¦æ¶©ï¼‰\nclass Point { x: number; y: number; constructor(x: number, y: number) { this.x = x; this.y = y; } } interface PointInstanceType { x: number; y: number; } // ç­‰ä»·äº interface Point3d extends PointInstanceType interface Point3d extends Point { z: number; } let point3d: Point3d = { x: 1, y: 2, z: 3 }; æ³›å‹\næ³›å‹ï¼ˆGenericsï¼‰æ˜¯æŒ‡åœ¨å®šä¹‰å‡½æ•°ã€æ¥å£æˆ–ç±»çš„æ—¶å€™ï¼Œä¸é¢„å…ˆæŒ‡å®šå…·ä½“çš„ç±»å‹ï¼Œè€Œåœ¨ä½¿ç”¨çš„æ—¶å€™å†æŒ‡å®šç±»å‹çš„ä¸€ç§ç‰¹æ€§\nfunction createArray\u0026lt;T\u0026gt;(length: number, value: T): Array\u0026lt;T\u0026gt; { let result: T[] = []; for (let i = 0; i \u0026lt; length; i++) { result[i] = value; } return result; } createArray\u0026lt;string\u0026gt;(3, \u0026#34;x\u0026#34;); // [\u0026#39;x\u0026#39;, \u0026#39;x\u0026#39;, \u0026#39;x\u0026#39;] //å¤šä¸ªç±»å‹å‚æ•° function swap\u0026lt;T, U\u0026gt;(tuple: [T, U]): [U, T] { return [tuple[1], tuple[0]]; } swap([7, \u0026#34;seven\u0026#34;]); // [\u0026#39;seven\u0026#39;, 7] æ³›å‹çº¦æŸï¼Œå¯ä»¥ä½¿ç”¨å…¶ä»–ç±»å‹çº¦æŸï¼Œä¹Ÿå¯ä»¥åœ¨ç±»å‹å‚æ•°ä¹‹é—´è¿›è¡Œçº¦æŸ\nfunction copyFields\u0026lt;T extends U, U\u0026gt;(target: T, source: U): T { for (let id in source) { target[id] = (\u0026lt;T\u0026gt;source)[id]; } return target; } let x = { a: 1, b: 2, c: 3, d: 4 }; copyFields(x, { b: 10, d: 20 }); å‚è€ƒ Typescript å…¥é—¨æ•™ç¨‹\næ·±å…¥ç†è§£Typescript\n","permalink":"https://blog.niuhemoon.win/posts/tech/typescript-doc/","summary":"ç®€ä»‹ Typescript å¯ä»¥åœ¨ä»£ç ç¼–å†™å†™åšç±»å‹æ£€æŸ¥ï¼Œå¯ä»¥ç¼–å†™æ›´å¥å£®çš„ä»£ç ã€‚ å®‰è£… npm config set registry https://registry.npm.taobao.org sudo npm install -g typescript # å®‰è£…REPL sudo npm install -g tsun åŸºæœ¬æ¦‚å¿µ è”åˆç±»å‹ è¡¨ç¤ºå–å€¼æ˜¯å¤šç§ç±»å‹ä¸­çš„ä¸€ç§ï¼Œå½“ TypeScript ä¸ç¡®å®šä¸€ä¸ªè”åˆç±»å‹çš„å˜é‡åˆ°åº•æ˜¯å“ªä¸ªç±»å‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªèƒ½è®¿é—®æ­¤è”åˆç±»å‹çš„æ‰€æœ‰ç±»å‹é‡Œå…±æœ‰çš„å±æ€§æˆ–æ–¹æ³• let myFavoriteNumber: string | number; myFavoriteNumber = \u0026#34;seven\u0026#34;; myFavoriteNumber = 7; æ¥å£ TypeScript ä¸­çš„","title":"TypescriptåŸºç¡€"},{"content":"CheatSheet Docker æ ¸å¿ƒæ¶æ„ï¼š\nå®¢æˆ·ç«¯ Client æœåŠ¡å™¨ Docker daemon é•œåƒ Image Registry å®¹å™¨ Container å®¹å™¨åŸºæœ¬æŠ€æœ¯ï¼š\ncgroup èµ„æºé™é¢ namespace èµ„æºéš”ç¦» Mount UTS IPC PID Network User Docker é‡‡ç”¨ C/S æ¶æ„ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼ŒæœåŠ¡å™¨è´Ÿè´£æ„å»ºã€è¿è¡Œå’Œåˆ†å‘å®¹å™¨ã€‚å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å¯ä»¥è¿è¡Œåœ¨åŒä¸€ä¸ª host ä¸Šï¼Œå®¢æˆ·ç«¯ä¹Ÿå¯ä»¥é€šè¿‡ socket æˆ–è€… REST API å’Œè¿œç¨‹æœåŠ¡å™¨é€šä¿¡ã€‚docker å®¢æˆ·ç«¯æ˜¯å’ŒæœåŠ¡å™¨é€šä¿¡çš„å‘½ä»¤è¡Œå·¥å…·ã€‚æœåŠ¡å™¨è´Ÿè´£åˆ›å»ºã€è¿è¡Œã€ç›‘æ§å®¹å™¨ï¼Œæ„å»ºã€å­˜å‚¨é•œåƒã€‚é•œåƒæ˜¯ä¸€ä¸ªåªè¯»æ¨¡æ¿ï¼Œé€šè¿‡é•œåƒå¯ä»¥åˆ›å»ºå®¹å™¨ã€‚å®¹å™¨å°±æ˜¯é•œåƒè¿è¡Œçš„å®ä¾‹ã€‚Registry æ˜¯å­˜æ”¾é•œåƒçš„ä»“åº“ã€‚\næ„å»ºé•œåƒå¹¶å¯åŠ¨å®¹å™¨ é•œåƒç®¡ç†\n# pull an image from a registry docker pull myimage:1.0 # retag a local image with new name and tag docker tag myimage:1.0 myrepo/myimage:2.0 # push an image to a registry docker push myrepo/myimage:2.0 # æŸ¥çœ‹æœ¬åœ°é•œåƒ docker images # list all images locally stored docker image ls # delete an image from local image store docker image rm alpine:3.4 ä»é•œåƒå¯åŠ¨å®¹å™¨\n# åå°ä»é•œåƒå¯åŠ¨å®¹å™¨ï¼Œå¹¶æŒ‡å®šHostå’Œå®¹å™¨çš„ç«¯å£æ˜ å°„ docker run -d -p 8000:80 \u0026lt;image\u0026gt; # è¿›å…¥å®¹å™¨ï¼Œé™„åŠ åˆ°å‰å°è¿›ç¨‹ docker attach \u0026lt;å®¹å™¨\u0026gt; # ç¦»å¼€å®¹å™¨ Ctrl+p Ctrl+q # è¿›å…¥å®¹å™¨ï¼Œæ–°å¼€ä¸€ä¸ªç»ˆç«¯ docker exec -it \u0026lt;å®¹å™¨\u0026gt; bash # é€€å‡ºå®¹å™¨ exit # å¯åŠ¨exitçš„å®¹å™¨ docker start \u0026lt;å®¹å™¨\u0026gt; # åœæ­¢å®¹å™¨ docker stop \u0026lt;å®¹å™¨\u0026gt; # rum a container from alpine:3.9 image # name the running container \u0026#34;web\u0026#34; # expose port 5000 externally mapped to port 80 inside the container docker container run --name web -p 5000:80 alpine:3.9 # stop a running container through SIGTERM docker container stop web # stop a running container through SIGKILL docker container kill web # delete all running and stopped containers docker container rm -f $(docker ps -aq) # print the last 100 lines of a container\u0026#39;s logs docker container logs --tail 100 web æ„å»ºé•œåƒ\n# æŸ¥çœ‹å®¹å™¨ docker ps -a docker container ls -a # æ„å»ºé•œåƒ # 1.è¿è¡Œå®¹å™¨ # 2.ä¿®æ”¹å®¹å™¨ # 3.å°†å®¹å™¨ä¿å­˜ä¸ºæ–°é•œåƒ docker commit \u0026lt;é•œåƒ\u0026gt; # ä»dockerfileæ„å»ºé•œåƒ docker build -t \u0026lt;image_name\u0026gt; -f \u0026lt;Dockerfileè·¯å¾„\u0026gt; # build an image from Dockerfile in the current directory and tag the image docker build -t myimage:1.0 . # æŸ¥çœ‹é•œåƒåˆ†å±‚ docker history \u0026lt;image\u0026gt; docker ç½‘ç»œ Docker å®¹å™¨å’Œä¸»æœºä¹‹é—´ç½‘ç»œï¼š\nbridge host none è‡ªå®šä¹‰ ç½‘ç»œç›¸å…³çš„å‘½ä»¤ï¼š\nbrctl show # æ˜¾ç¤ºç½‘æ¡¥ ip r # æŸ¥çœ‹è·¯ç”±è¡¨ iptables-save # æŸ¥çœ‹è·¯ç”± # æŸ¥çœ‹dockerç½‘æ¡¥ docker network inspect bridge # æŸ¥çœ‹dockerç½‘ç»œ docker network ls # ä»¥æŸç§ç½‘ç»œé…ç½®ä»é•œåƒå¯åŠ¨å®¹å™¨ docker run --network=host -it \u0026lt;é•œåƒ\u0026gt; bash é•œåƒçš„å¤‡ä»½ä¸æ¢å¤ docker save å¯¼å‡ºé•œåƒåˆ°æœ¬åœ°æ–‡ä»¶ # Usage $ docker save [OPTIONS] IMAGE [IMAGE...] # å¯¼å‡ºgolangé•œåƒ $ sudo docker save --output golang.tar golang:1.2 docker load ä»æœ¬åœ°æ–‡ä»¶å¯¼å…¥æ–‡ä»¶åˆ°é•œåƒåº“ # Usage $ docker load [OPTIONS] # å¯¼å…¥golangé•œåƒ $ sudo docker load --input golang.tar docker export å¯¼å‡ºå®¹å™¨å¿«ç…§åˆ°æœ¬åœ°æ–‡ä»¶ # Usage $ docker export [OPTIONS] CONTAINER # å¯¼å‡ºhelloå®¹å™¨å¿«ç…§ $ sudo docker export --output hello.tar docker import ä»å®¹å™¨å¿«ç…§æ–‡ä»¶ä¸­å†å¯¼å…¥ä¸ºé•œåƒ # Usage $ docker import [OPTIONS] URL|- [REPOSITORY[:TAG]] # å¯¼å…¥helloå¿«ç…§ï¼Œå¹¶åˆ¶å®šé•œåƒæ ‡ç­¾ä¸ºhello:1.0 $ cat hello.tar | sudo docker import - hello:1.0 å®¹å™¨ç›‘æ§ # æŸ¥çœ‹æ‰€æœ‰å®¹å™¨ docker container ls # æŸ¥çœ‹å®¹å™¨å†…è¿›ç¨‹ docker container top \u0026lt;å®¹å™¨\u0026gt; # æŸ¥çœ‹å®¹å™¨èµ„æºçŠ¶æ€ # 1. æ‰€æœ‰å®¹å™¨ docker container stats # 2. ç‰¹å®šå®¹å™¨ docker container stats \u0026lt;å®¹å™¨...\u0026gt; å·¥å…·\nSysdig Weave Scope cAdvisor Prometheus å®¹å™¨æ—¥å¿— docker é»˜è®¤å°†å®¹å™¨æ—¥å¿—å‘é€åˆ° STDOUT å’Œ STDERRï¼Œ æ­¤å¤–ï¼Œdocker è¿˜æä¾›äº†å¤šç§ logging driverï¼Œå¸®åŠ©ä»å®¹å™¨ä¸­æå–è¿è¡Œæ—¥å¿—ï¼Œ é»˜è®¤çš„ logging driver æ˜¯ json-fileï¼Œå°†å®¹å™¨æ—¥å¿—ä¿å­˜åœ¨ json file ä¸­ï¼Œ å¯ä»¥åœ¨ host ç›®å½•çš„/var/lib/docker/containers/ç›®å½•ä¸‹æ‰¾åˆ°æ—¥å¿—çš„ json æ–‡ä»¶\nä¸€äº›ç³»ç»Ÿçš„æ—¥å¿—æ–¹æ¡ˆ\nELK Graylog # æ‰“å°å®¹å™¨æ‰€æœ‰æ—¥å¿— docker logs \u0026lt;å®¹å™¨\u0026gt; # æŒç»­æ‰“å°æ—¥å¿— docker logs -f \u0026lt;å®¹å™¨\u0026gt; å‚è€ƒ Docker ä»å…¥é—¨åˆ°å®è·µ\nDocker å¿«é€Ÿå…¥é—¨\nDocker å…¥é—¨æ•™ç¨‹\næ¯å¤© 5 åˆ†é’Ÿç©è½¬ Docker\n","permalink":"https://blog.niuhemoon.win/posts/tech/docker-tutorial/","summary":"CheatSheet Docker æ ¸å¿ƒæ¶æ„ï¼š å®¢æˆ·ç«¯ Client æœåŠ¡å™¨ Docker daemon é•œåƒ Image Registry å®¹å™¨ Container å®¹å™¨åŸºæœ¬æŠ€æœ¯ï¼š cgroup èµ„æºé™é¢ namespace èµ„æºéš”ç¦» Mount UTS IPC PID Network User Docker é‡‡ç”¨ C/S æ¶æ„ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼ŒæœåŠ¡å™¨è´Ÿè´£æ„å»ºã€è¿è¡Œå’Œåˆ†å‘å®¹å™¨ã€‚å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å¯ä»¥è¿è¡Œåœ¨åŒä¸€ä¸ª host ä¸Šï¼Œå®¢æˆ·ç«¯ä¹Ÿå¯ä»¥é€šè¿‡ socket æˆ–è€… REST API å’Œè¿œç¨‹æœåŠ¡å™¨é€šä¿¡ã€‚docker å®¢æˆ·ç«¯æ˜¯å’ŒæœåŠ¡å™¨é€šä¿¡çš„å‘½ä»¤","title":"dockeråŸºæœ¬ä½¿ç”¨"},{"content":"å‘½ä»¤è¡Œ # ä»æ–‡ä»¶ä¸­æ‰§è¡Œsqlè¯­å¥ sqlite\u0026gt; .read cars.sql # æ‰“å¼€test.dbæ•°æ®åº“æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»º sqlite3 test.db # å…ƒå‘½ä»¤ # æ˜¾ç¤ºå¯ç”¨è¡¨ .tables sqlite\u0026gt; .mode column sqlite\u0026gt; .headers on sqlite\u0026gt; SELECT * FROM Friends; Id Name Sex ---------- ---------- ---------- 1 Jane F 2 Thomas M 3 Franklin M 4 Elisabeth F 5 Mary F 6 Lucy F 7 Jack M æœ¬ç¤ºä¾‹è¯´æ˜å¦‚ä½•åœ¨ sqlite çš„åˆ—æ¨¡å¼ä¸‹æ ¼å¼åŒ–æ•°æ®ã€‚ .headerså‘½ä»¤ä¹Ÿå·²ç”¨äºæ˜¾ç¤ºåˆ—æ ‡é¢˜ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œæ ‡é¢˜æ˜¯éšè—çš„ã€‚ .widthå‘½ä»¤è°ƒæ•´åˆ—çš„å¤§å°ã€‚ ï¼ˆæ­¤ meta å‘½ä»¤ä»…ä¸åˆ—æ¨¡å¼ä¸‹çš„è¡¨æœ‰å…³ã€‚ï¼‰ sqlite\u0026gt; SELECT Name, Title FROM Authors NATURAL JOIN Books; Name Title ----------- ---------- Jane Austen Emma Leo Tolstoy War and Pe Joseph Hell Catch XII Charles Dic David Copp Joseph Hell Good as Go Leo Tolstoy Anna Karen åˆ—å®½ä¸è¶³ä»¥æ­£ç¡®æ˜¾ç¤ºæ‰€æœ‰æ•°æ®ã€‚ sqlite\u0026gt; .width 15 18 sqlite\u0026gt; SELECT Name, Title FROM Authors NATURAL JOIN Books; Name Title --------------- ------------------ Jane Austen Emma Leo Tolstoy War and Peace Joseph Heller Catch XII Charles Dickens David Copperfield Joseph Heller Good as Gold Leo Tolstoy Anna Karenia SQL åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æ›´æ”¹åˆ—å®½ã€‚ ç¬¬ä¸€åˆ—ä¸º 15 ä¸ªå­—ç¬¦ï¼Œç¬¬äºŒåˆ—ä¸º 18 ä¸ªå­—ç¬¦ã€‚ .showå‘½ä»¤åˆ—å‡ºäº†å„ç§è®¾ç½®ã€‚ å…¶ä¸­åŒ…æ‹¬è¾“å‡ºæ¨¡å¼ï¼Œåˆ—è¡¨æ¨¡å¼ä¸­ä½¿ç”¨çš„åˆ†éš”ç¬¦ä»¥åŠæ ‡é¢˜æ˜¯å¦æ‰“å¼€ã€‚ .schemaå‘½ä»¤æ˜¾ç¤ºè¡¨çš„ç»“æ„ã€‚ å®ƒæä¾›äº† DDL SQL æ¥åˆ›å»ºè¡¨ã€‚ sqlite\u0026gt; .schema Cars CREATE TABLE Cars(Id INTEGER PRIMARY KEY, Name TEXT, Price INTEGER); SQL .schemaå‘½ä»¤æ˜¾ç¤ºè¡¨çš„ç»“æ„ã€‚ å®ƒæä¾›äº† DDL SQL æ¥åˆ›å»ºè¡¨ã€‚ å¯ä»¥ä½¿ç”¨.promptå‘½ä»¤æ›´æ”¹sqlite3çš„æç¤ºã€‚ sqlite\u0026gt; .prompt \u0026#34;\u0026gt; \u0026#34; \u0026#34;. \u0026#34; \u0026gt; SELECT * FROM Cars . LIMIT 2; Id Name Price ---------- ---------- ---------- 1 Audi 52642 2 Mercedes 57127 \u0026gt; SQL æœ‰ä¸¤ä¸ªæç¤ºã€‚ ä¸€ä¸ªæ˜¯ä¸»æç¤ºï¼Œå¦ä¸€ä¸ªæ˜¯ç»§ç»­æç¤ºã€‚ é»˜è®¤çš„ä¸»æç¤ºæ˜¯sqlite\u0026amp;gt;ï¼Œé»˜è®¤çš„ç»§ç»­æç¤ºæ˜¯...\u0026amp;gt;ã€‚ æˆ‘ä»¬å¯ä»¥ä» Shell æ‰§è¡Œ SQL å‘½ä»¤ã€‚ $ sqlite3 test.db \u0026#34;SELECT * FROM Cars;\u0026#34; æˆ‘ä»¬å°†ä½¿ç”¨.dumpå‘½ä»¤è½¬å‚¨è¯¥è¡¨ã€‚ sqlite\u0026gt; .output cars2.sql sqlite\u0026gt; .dump Cars SQL æˆ‘ä»¬è¿˜å¯ä»¥å°†è¾“å‡ºé‡å®šå‘åˆ°æ–‡ä»¶ã€‚ .outputå‘½ä»¤ä¼šå°†è¾“å‡ºé‡å®šå‘åˆ°cars2.sqlæ–‡ä»¶ã€‚ sqlite\u0026gt; .tables Authors Cars Friends Reservations Books Customers Orders sqlite\u0026gt; DROP TABLE Cars; sqlite\u0026gt; .tables Authors Customers Orders Books Friends Reservations sqlite\u0026gt; .read cars.sql sqlite\u0026gt; .tables Authors Cars Friends Reservations Books Customers Orders sqlite\u0026gt; SELECT * FROM Cars WHERE Id=1; Id Name Price ---------- ---------- ---------- 1 Audi 52642 åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¾—åˆ° SELECT è¯­å¥çš„è¾“å‡ºã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œè¾“å‡ºæ¨¡å¼ä¸º lineï¼Œåˆ†éš”ç¬¦ä¸º|ã€‚\nä½¿ç”¨æ¡ˆä¾‹ 1ã€è¾“å…¥\u0026quot; sqlite3 + æ•°æ®åº“å.db \u0026quot; (å¦‚ï¼š \u0026quot; sqlite3 collect.db \u0026ldquo;) æ‰“å¼€æ•°æ®åº“\n2ã€å¯è¾“å…¥ \u0026quot; .table \u0026quot; æŸ¥çœ‹æ•°æ®åº“ä¸­å­˜åœ¨å“ªäº›è¡¨\n3ã€å¯è¾“å…¥\u0026rdquo; .schema \u0026rsquo; æŸ¥çœ‹å»ºè¡¨è¯­å¥\n4ã€é€šè¿‡ SQL æŸ¥è¯¢è¯­å¥ \u0026quot; select _ from è¡¨å \u0026quot; ï¼ˆå¦‚ï¼š\u0026quot; select _ from Book \u0026ldquo;ï¼‰\nå‚è€ƒ sqlite æ•™ç¨‹\n","permalink":"https://blog.niuhemoon.win/posts/tech/sqlite3-tutorial/","summary":"å‘½ä»¤è¡Œ # ä»æ–‡ä»¶ä¸­æ‰§è¡Œsqlè¯­å¥ sqlite\u0026gt; .read cars.sql # æ‰“å¼€test.dbæ•°æ®åº“æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»º sqlite3 test.db # å…ƒå‘½ä»¤ # æ˜¾ç¤ºå¯ç”¨è¡¨ .tables sqlite\u0026gt; .mode column sqlite\u0026gt; .headers on sqlite\u0026gt; SELECT * FROM Friends; Id Name Sex ---------- ---------- ---------- 1 Jane F 2 Thomas M 3 Franklin M 4 Elisabeth F 5 Mary F 6 Lucy F 7 Jack M æœ¬ç¤ºä¾‹è¯´æ˜å¦‚ä½•åœ¨ sqlite çš„åˆ—æ¨¡å¼ä¸‹æ ¼å¼åŒ–æ•°æ®ã€‚ .headerså‘½ä»¤ä¹Ÿå·²ç”¨äºæ˜¾ç¤ºåˆ—æ ‡é¢˜ã€‚ é»˜è®¤æƒ…å†µä¸‹","title":"sqlite3å…¥é—¨"},{"content":"å¿«æ·é”® awk æ˜¯ linux ä¸Šç”¨äºæ–‡æœ¬å¤„ç†çš„è„šæœ¬è¯­è¨€ï¼Œä½ å¯ä»¥å®ç°ï¼š\nå®šä¹‰å˜é‡ ä½¿ç”¨å­—ç¬¦ä¸²å’Œç®—æœ¯è¿ç®—ç¬¦ ä½¿ç”¨æ§åˆ¶æµç¨‹å’Œå¾ªç¯ ç”Ÿæˆæ ¼å¼åŒ–çš„è¾“å‡º ç”¨æ³•ï¼šawk [POSIX æˆ– GNU é£æ ¼é€‰é¡¹] [--] \u0026#39;ç¨‹åº\u0026#39; æ–‡ä»¶ ... POSIX é€‰é¡¹ï¼š\tGNU é•¿é€‰é¡¹ï¼š(æ ‡å‡†) -f è„šæœ¬æ–‡ä»¶\t--file=è„šæœ¬æ–‡ä»¶ -F fs\t--field-separator=fs -v var=val\t--assign=var=val ä½¿ç”¨å˜é‡ $0 æ•´è¡Œ $1 ç¬¬ä¸€åˆ—å­—æ®µ $2 ç¬¬äºŒåˆ—å­—æ®µ $n ç¬¬ n åˆ—å­—æ®µ ç©ºæ ¼æˆ–è€…åˆ¶è¡¨ç¬¦æ˜¯é»˜è®¤çš„åˆ—åˆ†éš”ç¬¦ å¯ä»¥é€šè¿‡-F æŒ‡å®šåˆ†éš”ç¬¦\nawk -F: \u0026#39;{print $1}\u0026#39; /etc/passwd cat /etc/passwd | awk -F: \u0026#39;{print $1}\u0026#39; ä½¿ç”¨è„šæœ¬æ–‡ä»¶ å°† awk è„šæœ¬ä¿å­˜åœ¨ testfile æ–‡ä»¶ä¸­\n{print $1 \u0026#34; home at \u0026#34; $6} ç„¶åæ‰§è¡Œæ–‡ä»¶\nawk -F: -f testfile /etc/passwd é¢„å¤„ç†å’Œåå¤„ç† ä¿å­˜ testfile å¦‚ä¸‹\nBEGIN { print \u0026#34;Users and thier corresponding home\u0026#34; print \u0026#34; UserName \\t HomePath\u0026#34; print \u0026#34;___________ \\t __________\u0026#34; FS=\u0026#34;:\u0026#34; } { print $1 \u0026#34; \\t \u0026#34; $6 } END { print \u0026#34;The end\u0026#34; } æ‰§è¡Œè„šæœ¬\nawk -f testfile /etc/passwd å†…ç½®å˜é‡ ä¸€äº›å†…ç½®å˜é‡å¦‚ä¸‹\nFS æŒ‡å®š field æ®µåˆ†éš”ç¬¦ OFS [Output Filed Separator]è¾“å‡ºåˆ†éš”ç¬¦ ORS [Output Record Separator] è¾“å‡ºè¡Œåˆ†éš”ç¬¦ FIELDWIDTHS æŒ‰æ®µé•¿åº¦åˆ†å‰² RS [Record Separator]è®°å½•åˆ†éš”ç¬¦ï¼Œé»˜è®¤æ˜¯æ¢è¡Œç¬¦ æŒ‡å®šè¾“å‡ºåˆ†éš”ç¬¦\nawk \u0026#39;BEGIN{FS=\u0026#34;:\u0026#34;; OFS=\u0026#34;-\u0026#34;} {print $1,$6,$7}\u0026#39; /etc/passwd ä½¿ç”¨é•¿åº¦åˆ†å‰²\nç´ æå¦‚ä¸‹ï¼Œä¿å­˜ä¸º testrecordï¼š\n1235.96521 927-8.3652 36257.8157 awk \u0026#39;BEGIN{FIELDWIDTHS=\u0026#34;3 4 3\u0026#34;}{print $1,$2,$3}\u0026#39; testrecord è¾“å‡ºå¦‚ä¸‹ï¼š\n123 5.96 521 927 -8.3 652 362 57.8 157 ä½¿ç”¨ Record Separator ç´ æå¦‚ä¸‹ï¼Œä¿å­˜ä¸º testrecordï¼š\nPerson Name 123 High Street (222) 466-1234 Another person 487 High Street (523) 643-8754 awk \u0026#39;BEGIN{FS=\u0026#34;\\n\u0026#34;; RS=\u0026#34;\u0026#34;} {print $1,$3}\u0026#39; testrecord è¾“å‡ºå¦‚ä¸‹ï¼š\nPerson Name (222) 466-1234 Another person (523) 643-8754 å‚è€ƒ 30 Examples For Awk Command In Text Processing\n","permalink":"https://blog.niuhemoon.win/posts/tech/awk-usage/","summary":"å¿«æ·é”® awk æ˜¯ linux ä¸Šç”¨äºæ–‡æœ¬å¤„ç†çš„è„šæœ¬è¯­è¨€ï¼Œä½ å¯ä»¥å®ç°ï¼š å®šä¹‰å˜é‡ ä½¿ç”¨å­—ç¬¦ä¸²å’Œç®—æœ¯è¿ç®—ç¬¦ ä½¿ç”¨æ§åˆ¶æµç¨‹å’Œå¾ªç¯ ç”Ÿæˆæ ¼å¼åŒ–çš„è¾“å‡º ç”¨æ³•ï¼šawk [POSIX æˆ– GNU é£æ ¼é€‰é¡¹] [--] \u0026#39;ç¨‹åº\u0026#39; æ–‡ä»¶ ... POSIX é€‰é¡¹ï¼š GNU é•¿é€‰é¡¹ï¼š(æ ‡å‡†) -f è„šæœ¬æ–‡ä»¶ --file=è„šæœ¬æ–‡ä»¶ -F fs --field-separator=fs -v var=val --assign=var=val ä½¿ç”¨å˜é‡ $0 æ•´è¡Œ $1 ç¬¬ä¸€åˆ—å­—æ®µ $2 ç¬¬äºŒåˆ—å­—","title":"awkåŸºæœ¬ä½¿ç”¨"},{"content":"# åˆ›å»ºç›®å½•å¹¶è¿›å…¥ function mkdircd () { mkdir -p \u0026#34;$@\u0026#34; \u0026amp;\u0026amp; eval cd \u0026#34;\\\u0026#34;\\$$#\\\u0026#34;\u0026#34;; } æŸ¥æ‰¾æ–‡ä»¶ # æ‰¾åˆ°å¤§äº100Mçš„æ–‡ä»¶ find / -type f -size +100M # æ‰¾åˆ°æ–‡ä»¶åä¸­å«æœ‰mailçš„æ–‡ä»¶/æ–‡ä»¶å¤¹ find /etc -name \u0026#34;*mail*\u0026#34; # æ‰¾åˆ°ä¿®æ”¹æ—¶é—´åœ¨60å¤©ä¹‹å‰çš„æ–‡ä»¶ find . -mtime +60 # æ‰¾åˆ°ä¿®æ”¹æ—¶é—´åœ¨2å¤©å†…çš„æ–‡ä»¶ find . -mtime -2 # æ‰¹é‡æ˜¾ç¤ºTSåç¼€ä¸”å¤§äº100Mæ–‡ä»¶çš„è¯¦æƒ… find . -type f -name \u0026#39;*.TS\u0026#39; -size +100M -exec ls -l {} \\; # æ‰¹é‡åˆ é™¤TSåç¼€ä¸”å¤§äº100Mçš„æ–‡ä»¶ find . -type f -name \u0026#39;*.TS\u0026#39; -size +100M -exec rm -f {} \\; # æŸ¥æ‰¾ä¿®æ”¹æ—¶é—´60å¤©å‰çš„æ–‡ä»¶å¹¶æ‰“åŒ… find /home/jsmith -type f -mtime +60 | xargs tar -cvf /tmp/`date \u0026#39;+%d%m%Y\u0026#39;_archive.tar` è¾“å‡ºé‡å®šå‘ # æ ‡å‡†è¾“å‡ºé‡å®šå‘ï¼Œåªæ˜¾ç¤ºerrorä¿¡æ¯ ./shell-script.sh \u0026gt; /dev/null # æ ‡å‡†é”™è¯¯ä¿¡æ¯é‡å®šå‘ ./shell-script.sh 2\u0026gt; /dev/null # æ ‡å‡†é”™è¯¯å’Œè¾“å‡ºéƒ½é‡å®šå‘ ./shell-script.sh \u0026gt; /dev/null 2\u0026gt;\u0026amp;1 # å°†æ‰€æœ‰å¤§å†™è½¬åŒ–ä¸ºå°å†™ tr A-Z a-z \u0026lt; department.txt # å°†æ‰€æœ‰å°å†™è½¬åŒ–ä¸ºå¤§å†™ tr a-z A-Z \u0026lt; employee.txt xargs åŸºæœ¬ä½¿ç”¨ # åˆ é™¤logæ–‡ä»¶ find ~ -name \u0026#39;*.log\u0026#39; -print0 | xargs -0 rm -f find /etc -name \u0026#34;*.conf\u0026#34; | xargs ls -l cat url-list.txt | xargs wget -c find / -name *.jpg -type f -print | xargs tar -cvzf images.tar.gz ls *.jpg | xargs -n1 -i cp {} /external-harddrive/directory æ–‡ä»¶ä¸­æˆªå–åˆ— # ä»¥:åˆ†å‰²ï¼Œç¬¬ä¸€åˆ— cut -d: -f 1 /etc/passwd # ä»¥:åˆ†å‰²ï¼Œç¬¬1å’Œç¬¬3åˆ— cut -d: -f 1,3 /etc/passwd # æˆªå–æ¯è¡Œå‰è¾¹1-8ä¸ªå­—ç¬¦ cut -c 1-8 /etc/passwd åå°è¿è¡Œ nohup ./backup.sh \u0026amp; screen -S backup # ä»¥ç‰¹å®šé—´éš”æ—¶é—´æ‰§è¡Œå‘½ä»¤ watch df -h sed åŸºç¡€ # thegeekstuff.txt # Instruction Guides 1. Linux Sysadmin, Linux Scripting etc. 2. Databases - Oracle, mySQL etc. 3. Security (Firewall, Network, Online Security etc) 4. Storage in Linux 5. Productivity (Too many technologies to explore, not much time available) # Additional FAQS 6. Windows- Sysadmin, reboot etc. # å°†ç¬¬ä¸€ä¸ªLinuxæ›¿æ¢ä¸ºLinux-Unix sed \u0026#39;s/Linux/Linux-Unix/\u0026#39; thegeekstuff.txt # å°†æ‰€æœ‰Linuxæ›¿æ¢ä¸ºLinux-Unix sed \u0026#39;s/Linux/Linux-Unix/g\u0026#39; thegeekstuff.txt # å°†ç¬¬2ä¸ªå‡ºç°çš„Linuxæ›¿æ¢ä¸ºLinux-Unix sed \u0026#39;s/Linux/Linux-Unix/2\u0026#39; thegeekstuff.txt # è¾“å‡ºä¿®æ”¹è¡Œå¹¶å†™å…¥æŒ‡å®šçš„outputæ–‡ä»¶ sed -n \u0026#39;s/Linux/Linux-Unix/gpw output\u0026#39; thegeekstuff.txt # è¡Œæ­£åˆ™åŒ¹é…åˆ°-ï¼Œåˆ™ä»-åˆ°è¡Œå°¾çš„å­—ç¬¦è¢«æ›¿æ¢ä¸ºç©º sed \u0026#39;/\\-/s/\\-.*//g\u0026#39; thegeekstuff.txt # åˆ é™¤æ¯è¡Œçš„å3ä¸ªå­—ç¬¦ sed \u0026#39;s/...$//\u0026#39; thegeekstuff.txt # ç›´æ¥ä¿®æ”¹æºæ–‡ä»¶ï¼Œå»é™¤#å¼€å¤´çš„æ³¨é‡Š sed -e \u0026#39;s/#.*//\u0026#39; thegeekstuff.txt # ç›´æ¥ä¿®æ”¹æºæ–‡ä»¶ï¼Œå»é™¤#å¼€å¤´çš„æ³¨é‡Šå¹¶å»é™¤ç©ºè¡Œ sed -e \u0026#39;s/#.*//;/^$/d\u0026#39; thegeekstuff.txt # å»é™¤htmlçš„ç®­å¤´æ ‡ç­¾ sed -e \u0026#39;s/\u0026lt;[^\u0026gt;]*\u0026gt;//g\u0026#39; # åŒæ—¶æ˜¾ç¤ºå¤šä¸ªæ–‡ä»¶çš„æ—¥å¿— tail -f /var/log/syslog -f /var/log/auth.log # ä¿®æ”¹å‘½ä»¤è¡Œæç¤ºç¬¦å· export PS1=\u0026#34;\\u@\\h \\w\u0026gt; \u0026#34; # ä¿®æ”¹ç³»ç»Ÿæ—¶é—´ date {mmddhhmiyyyy.ss} # Jan 31st 2009, 10:19 p.m, 53 seconds date 013122192009.53 date +%Y%m%d -s \u0026#34;20090131\u0026#34; date +%T -s \u0026#34;22:19:53\u0026#34; date -s \u0026#34;01/31/2009 22:19:53\u0026#34; # æ˜¾ç¤ºæ—¶é—´ date +\u0026#34;%d-%m-%Y\u0026#34; 01-01-2009 date +\u0026#34;%d/%m/%Y\u0026#34; # 01/01/2009 date +\u0026#34;%A,%B %d %Y\u0026#34; # Thursday,January 01 2009 å‹ç¼©å’Œè§£å‹ zip var-log-files.zip /var/log/* zip -r var-log-dir.zip /var/log/ unzip var-log.zip unzip -v var-log.zip unzip -l var-log.zip unzip -t var-log.zip zip -P mysecurepwd var-log-protected.zip /var/log/* unzip var-log-protected.zip tar [options] [tar-archive-name] [other-file-names] # å‹ç¼©æ–‡ä»¶ tar cvf /tmp/my_home_directory.tar /home/jsmith # æ˜¾ç¤ºå‹ç¼©æ–‡ä»¶ç›®å½• tar tvf /tmp/my_home_directory.tar # æå–å‹ç¼©æ–‡ä»¶ tar xvf /tmp/my_home_directory.tar # æŒ‡å®šæå–ç›®å½• tar xvfz /tmp/my_home_directory.tar.gz -C /home/ramesh # gzipå‹ç¼©æ–‡ä»¶(*.tar.gz) tar cvfz /tmp/my_home_directory.tar.gz /home/jsmith tar xvfz /tmp/my_home_directory.tar.gz tar tvfz /tmp/my_home_directory.tar.gz # bzipå‹ç¼©æ–‡ä»¶(*.tar.bz2) tar cvfj /tmp/my_home_directory.tar.bz2 /home/jsmith tar xvfj /tmp/my_home_directory.tar.bz2 tar tvfj /tmp/my_home_directory.tar.bz2 å‘½ä»¤è¡Œå†å² # CTRL+r æŸ¥æ‰¾åŒ¹é…å†å² # CTRL+p ä¸Šä¸€æ¡å‘½ä»¤ history -c # æ¸…é™¤å†å² # å¿½ç•¥é‡å¤å‘½ä»¤ export HISTCONTROL=ignoredups # å¿½ç•¥ä»¥ç©ºæ ¼å¼€å¤´çš„å‘½ä»¤ export HISTCONTROL=ignorespace # ä¸è®°å½•å†å² export HISTSIZE=0 ç³»ç»Ÿç®¡ç† # åˆ›å»ºswapåˆ†åŒº dd if=/dev/zero of=/home/swap-fs bs=1M count=512 ls -l /home/swap-fs mkswap /home/swap-fs swapon /home/swap-fs # edit in /etc/fstab /home/swap-fs swap swap defaults 0 0 # ç”Ÿæˆsshå…¬é’¥ ssh-keygen ssh-copy-id -i ~/.ssh/id_rsa.pub remote-host # å®šæ—¶ä»»åŠ¡ç®¡ç† crontab -e {minute} {hour} {day-of-month} {month} {day-of-week} {full-path-to-shell-script} # run at 00:01am 1 0 * * * /root/bin/backup.sh # run at weekday 11:59pm 59 11 * * 1,2,3,4,5 /root/bin/backup.sh 59 11 * * 1-5 /root/bin/backup.sh # run every 5 minute */5 * * * * /root/bin/check-status.sh # run at 13:10pm on lst of every month 10 13 1 * * /root/bin/full-backup.sh # run at 11:00pm every weekday 0 23 * * 1-5 /root/bin/incremental-backup.sh # åŒæ­¥æ–‡ä»¶ rsync options source destination # sync two directory in a local computer # -z enable compression # -v verbose # -r recursive # -a archive mode:will preserve symbolic link/permission/timestamp/owner/group rsync -zvr /var/opt/installation/inventory/ /root/temp # sync one file rsync -v /var/lib/rpm/Pubkeys /root/temp/ # sync to remote machine rsync -avz /root/temp/ thegeekstuff@192.168.200.10:/home/thegeekstuff/temp/ # sync from remote to local rsync -avz thegeekstuff@192.168.200.10:/var/lib/rpm /root/temp # netcatå‘½ä»¤nc # ä»server1æ‹·è´æ–‡ä»¶åˆ°server2 # 1. åœ¨server2(102.168.200.27)ä¸Šç›‘å¬ nc -l 2222 \u0026gt; 1234.txt # 2. åœ¨server1ä¸Šå¼€å¯ä¼ è¾“ nc -w 1 102.168.200.27 2222 \u0026lt; abc.txt # ç½‘ç»œæ‹·è´ç¡¬ç›˜ # 1. server2(102.168.200.27)ç›‘å¬ nc -l -p 2222 | dd of=/dev/sda # 2. server1æ‰§è¡Œä¼ è¾“ dd if=/dev/sda | nc 102.168.200.27 2222 # ncç«¯å£æ‰«æ # æ‰«æ20-30ç«¯å£ nc -v -w 1 192.168.200.29 -z 20-30 ç³»ç»Ÿæ€§èƒ½ç›‘æ§ ps axl ps aux ps axuf ps U niuhe netstat -tap netstat --route # è·¯ç”±è¡¨ sar lsof ","permalink":"https://blog.niuhemoon.win/posts/tech/linux-101-hackers/","summary":"# åˆ›å»ºç›®å½•å¹¶è¿›å…¥ function mkdircd () { mkdir -p \u0026#34;$@\u0026#34; \u0026amp;\u0026amp; eval cd \u0026#34;\\\u0026#34;\\$$#\\\u0026#34;\u0026#34;; } æŸ¥æ‰¾æ–‡ä»¶ # æ‰¾åˆ°å¤§äº100Mçš„æ–‡ä»¶ find / -type f -size +100M # æ‰¾åˆ°æ–‡ä»¶åä¸­å«æœ‰mailçš„æ–‡ä»¶/æ–‡ä»¶å¤¹ find /etc -name \u0026#34;*mail*\u0026#34; # æ‰¾åˆ°ä¿®æ”¹æ—¶é—´åœ¨60å¤©ä¹‹å‰çš„æ–‡ä»¶ find . -mtime +60 # æ‰¾åˆ°ä¿®æ”¹æ—¶é—´åœ¨2å¤©å†…çš„æ–‡ä»¶ find . -mtime -2 # æ‰¹é‡æ˜¾ç¤ºTSåç¼€ä¸”å¤§äº100Mæ–‡ä»¶çš„è¯¦æƒ… find . -type f -name \u0026#39;*.TS\u0026#39; -size +100M -exec ls -l {} \\; # æ‰¹","title":"linux 101 Hackers ç¬”è®°"},{"content":"å¿«æ·é”® CTRL+B æ‰“å¼€/æ”¶èµ·ä¾§è¾¹æ ç›®\nCTRL+` æ‰“å¼€å†…ç½®ç»ˆç«¯\nCTRL+, æ‰“å¼€è®¾ç½®\nCTRL+p å¿«é€Ÿæœç´¢å¹¶æ‰“å¼€æ–‡ä»¶\nCTRL+TAB åœ¨å·²ç»æ‰“å¼€çš„æ ‡ç­¾é¡µä¸­è·³è½¬\nCTRL+\\ å°†æ ‡ç­¾é¡µç§»åŠ¨åˆ°å³ä¾§åˆ†å‰²æ \nCTRL+w å…³é—­æ ‡ç­¾é¡µ\nCTRL+f æŸ¥æ‰¾å†…å®¹\nCTRL+h æŸ¥æ‰¾å¹¶æ›¿æ¢\nCTRL+SHIFT+f å…¨å±€æœç´¢\nCTRL+SHIFT+p å‘½ä»¤é¢æ¿\nCTRL+/ æ³¨é‡Š/è§£é™¤æ³¨é‡Š\nCTRL+HOME/END è·³è½¬åˆ°æ–‡ä»¶é¦–/å°¾\nCTRL+c/v å¤åˆ¶æˆ–å‰ªåˆ‡å½“å‰å…‰æ ‡è¡Œ/åœ¨å½“å‰å…‰æ ‡è¡Œæˆ–ä¸‹ä¸€è¡Œç²˜è´´\nCTRL+SHIFT+ç®­å¤´ä¸Šä¸‹ç®­å¤´ å¤šä¸ªå…‰æ ‡ç”¨äºåˆ—ç¼–è¾‘\nALT+CLICK è·å–å¤šä¸ªç¼–è¾‘çš„å…‰æ ‡\nCTRL+d é€‰ä¸­å•è¯\nCTRL+SHIFT+l é€‰ä¸­æ‰€æœ‰è¯¥é€‰ä¸­çš„å†…å®¹\nF2 é‡å‘½åå˜é‡\nCTRL+CLICK ä»£ç è·³è½¬\nCTRL+k z è¿›å…¥/æ¨å‡º zen æ¨¡å¼\nå®˜æ–¹å¸¸ç”¨å¿«æ·é”® General Ctrl+Shift+P, F1 Show Command Palette Ctrl+P Quick Open, Go to File\u0026hellip; Ctrl+Shift+N New window/instance Ctrl+W Close window/instance Ctrl+, User Settings Ctrl+K Ctrl+S Keyboard Shortcuts Basic editing Ctrl+X Cut line (empty selection) Ctrl+C Copy line (empty selection) Alt+ â†“ / â†‘ Move line down/up Ctrl+Shift+K Delete line Ctrl+Enter / Insert line below/ above Ctrl+Shift+Enter Ctrl+Shift+\\ Jump to matching bracket Ctrl+] / Ctrl+[ Indent/Outdent line Home / End Go to beginning/end of line Ctrl+ Home / End Go to beginning/end of file Ctrl+ â†‘ / â†“ Scroll line up/down Alt+ PgUp / PgDn Scroll page up/down Ctrl+Shift+ [ / ] Fold/unfold region Ctrl+K Ctrl+ [ / ] Fold/unfold all subregions Ctrl+K Ctrl+0 / Fold/Unfold all regions Ctrl+K Ctrl+J Ctrl+K Ctrl+C Add line comment Ctrl+K Ctrl+U Remove line comment Ctrl+/ Toggle line comment Ctrl+Shift+A Toggle block comment Alt+Z Toggle word wrap Rich languages editing Ctrl+Space Trigger suggestion Ctrl+Shift+Space Trigger parameter hints Ctrl+Shift+I Format document Ctrl+K Ctrl+F Format selection F12 Go to Definition Ctrl+Shift+F10 Peek Definition Ctrl+K F12 Open Definition to the side Ctrl+. Quick Fix Shift+F12 Show References F2 Rename Symbol Ctrl+K Ctrl+X Trim trailing whitespace Ctrl+K M Change file language Multi-cursor and selection Alt+Click Insert cursor* Shift+Alt+ â†‘ / â†“ Insert cursor above/below Ctrl+U Undo last cursor operation Shift+Alt+I Insert cursor at end of each line selected Ctrl+L Select current line Ctrl+Shift+L Select all occurrences of current selection Ctrl+F2 Select all occurrences of current word Shift+Alt + â†’ Expand selection Shift+Alt + â† Shrink selection Shift+Alt + drag mouse Column (box) selection Display F11 Toggle full screen Shift+Alt+0 Toggle editor layout (horizontal/vertical) Ctrl+ = / - Zoom in/out Ctrl+B Toggle Sidebar visibility Ctrl+Shift+E Show Explorer / Toggle focus Ctrl+Shift+F Show Search Ctrl+Shift+G Show Source Control Ctrl+Shift+D Show Debug Ctrl+Shift+X Show Extensions Ctrl+Shift+H Replace in files Ctrl+Shift+J Toggle Search details Ctrl+Shift+C Open new command prompt/terminal Ctrl+K Ctrl+H Show Output panel Ctrl+Shift+V Open Markdown preview Ctrl+K V Open Markdown preview to the side Ctrl+K Z Zen Mode (Esc Esc to exit) Search and replace Ctrl+F Find Ctrl+H Replace F3 / Shift+F3 Find next/previous Alt+Enter Select all occurrences of Find match Ctrl+D Add selection to next Find match Ctrl+K Ctrl+D Move last selection to next Find match Navigation Ctrl+T Show all Symbols Ctrl+G Go to Line\u0026hellip; Ctrl+P Go to File\u0026hellip; Ctrl+Shift+O Go to Symbol\u0026hellip; Ctrl+Shift+M Show Problems panel F8 Go to next error or warning Shift+F8 Go to previous error or warning Ctrl+Shift+Tab Navigate editor group history Ctrl+Alt+- Go back Ctrl+Shift+- Go forward Ctrl+M Toggle Tab moves focus Editor management Ctrl+W Close editor Ctrl+K F Close folder Ctrl+\\ Split editor Ctrl+ 1 / 2 / 3 Focus into 1st, 2nd, 3rd editor group Ctrl+K Ctrl + â† Focus into previous editor group Ctrl+K Ctrl + â†’ Focus into next editor group Ctrl+Shift+PgUp Move editor left Ctrl+Shift+PgDn Move editor right Ctrl+K â† Move active editor group left/up Ctrl+K â†’ Move active editor group right/down File management Ctrl+N New File Ctrl+O Open File\u0026hellip; Ctrl+S Save Ctrl+Shift+S Save As\u0026hellip; Ctrl+W Close Ctrl+K Ctrl+W Close All Ctrl+Shift+T Reopen closed editor Ctrl+K Enter Keep preview mode editor open Ctrl+Tab Open next Ctrl+Shift+Tab Open previous Ctrl+K P Copy path of active file Ctrl+K R Reveal active file in Explorer Ctrl+K O Show active file in new window/instance Debug F9 Toggle breakpoint F5 Start / Continue F11 / Shift+F11 Step into/out F10 Step over Shift+F5 Stop Ctrl+K Ctrl+I Show hover Integrated terminal Ctrl+` Show integrated terminal Ctrl+Shift+` Create new terminal Ctrl+Shift+C Copy selection Ctrl+Shift+V Paste into active terminal Ctrl+Shift+ â†‘ / â†“ Scroll up/down Shift+ PgUp / PgDn Scroll page up/down Shift+ Home / End Scroll to top/bottom Keyboard shortcuts for Linux The Alt+Click gesture may not work on some Linux distributions. You can change the modifier key for the Insert cursor command to Ctrl+Click with the \u0026rsquo;editor.multiCursorModifier\u0026rsquo; setting\nå¯¼å…¥/å¯¼å‡ºæ‰©å±• //å¯¼å‡ºæ‰©å±•å code --list-extensions \u0026gt;\u0026gt; vs_code_extensions_list.txt cat vs_code_extensions_list.txt | xargs -n 1 code --install-extension //åˆ é™¤æ‰€æœ‰æ‰©å±• code --list-extensions | xargs -n 1 code --uninstall-extension 2gua.rainbow-brackets Angular.ng-template cyrilletuzi.angular-schematics davidbabel.vscode-simpler-icons dbaeumer.vscode-eslint doggy8088.angular-extension-pack donjayamanne.githistory eamodio.gitlens EditorConfig.EditorConfig EFanZh.graphviz-preview esbenp.prettier-vscode formulahendry.auto-rename-tag golang.go Gruntfuggly.todo-tree humao.rest-client infinity1207.angular2-switcher jebbs.plantuml johnpapa.Angular2 krizzdewizz.refactorix MariusAlchimavicius.json-to-ts Mikael.Angular-BeastCode mikeburgh.xml-format ms-azuretools.vscode-docker ms-mssql.mssql ms-python.python ms-toolsai.jupyter ms-vscode-remote.remote-containers ms-vscode-remote.remote-ssh ms-vscode-remote.remote-ssh-edit ms-vscode.cpptools ms-vscode.typescript-javascript-grammar ms-vscode.vscode-typescript-tslint-plugin msjsdiag.debugger-for-chrome nhoizey.gremlins obenjiro.arrr oderwat.indent-rainbow PKief.material-icon-theme quicktype.quicktype shd101wyy.markdown-preview-enhanced steoates.autoimport stringham.move-ts tht13.html-preview-vscode twxs.cmake wayou.vscode-todo-highlight xabikos.JavaScriptSnippets ","permalink":"https://blog.niuhemoon.win/posts/tech/vscode-shortcut/","summary":"å¿«æ·é”® CTRL+B æ‰“å¼€/æ”¶èµ·ä¾§è¾¹æ ç›® CTRL+` æ‰“å¼€å†…ç½®ç»ˆç«¯ CTRL+, æ‰“å¼€è®¾ç½® CTRL+p å¿«é€Ÿæœç´¢å¹¶æ‰“å¼€æ–‡ä»¶ CTRL+TAB åœ¨å·²ç»æ‰“å¼€çš„æ ‡ç­¾é¡µä¸­è·³è½¬ CTRL+\\ å°†æ ‡ç­¾é¡µç§»åŠ¨åˆ°å³ä¾§åˆ†å‰²æ  CTRL+w å…³é—­æ ‡ç­¾é¡µ CTRL+f æŸ¥æ‰¾å†…å®¹ CTRL+h æŸ¥æ‰¾å¹¶æ›¿æ¢ CTRL+SHIFT+f å…¨å±€æœç´¢ CTRL+SHIFT+p å‘½ä»¤é¢æ¿ CTRL+/ æ³¨é‡Š/è§£é™¤æ³¨é‡Š CTRL+HOME/END è·³è½¬åˆ°æ–‡ä»¶é¦–/å°¾ CTRL+c/v å¤åˆ¶æˆ–å‰ªåˆ‡å½“å‰å…‰æ ‡è¡Œ/åœ¨å½“å‰å…‰æ ‡è¡Œæˆ–ä¸‹ä¸€è¡Œç²˜è´´ CTRL+SHIFT+","title":"vscode å¿«æ·é”®å’Œæ’ä»¶è®°å½•"},{"content":"åˆ›å»ºè™šæ‹Ÿæœº 1ã€ç•Œé¢æˆ–å‘½ä»¤è¡Œé€šè¿‡RESTful APIå‘keystoneè·å–è®¤è¯ä¿¡æ¯ã€‚\n2ã€keystoneé€šè¿‡ç”¨æˆ·è¯·æ±‚è®¤è¯ä¿¡æ¯ï¼Œå¹¶ç”Ÿæˆauth-tokenè¿”å›ç»™å¯¹åº”çš„è®¤è¯è¯·æ±‚ã€‚\n3ã€ç•Œé¢æˆ–å‘½ä»¤è¡Œé€šè¿‡RESTful APIå‘nova-apiå‘é€ä¸€ä¸ªboot instanceçš„è¯·æ±‚ï¼ˆæºå¸¦auth-tokenï¼‰ã€‚\n4ã€nova-apiæ¥å—è¯·æ±‚åå‘keystoneå‘é€è®¤è¯è¯·æ±‚ï¼ŒæŸ¥çœ‹tokenæ˜¯å¦ä¸ºæœ‰æ•ˆç”¨æˆ·å’Œtokenã€‚\n5ã€keystoneéªŒè¯tokenæ˜¯å¦æœ‰æ•ˆï¼Œå¦‚æœ‰æ•ˆåˆ™è¿”å›æœ‰æ•ˆçš„è®¤è¯å’Œå¯¹åº”çš„è§’è‰²ï¼ˆæ³¨ï¼šæœ‰äº›æ“ä½œéœ€è¦æœ‰è§’è‰²æƒé™æ‰èƒ½æ“ä½œï¼‰ã€‚\n6ã€é€šè¿‡è®¤è¯ånova-apiå’Œæ•°æ®åº“é€šè®¯ã€‚\n7ã€åˆå§‹åŒ–æ–°å»ºè™šæ‹Ÿæœºçš„æ•°æ®åº“è®°å½•ã€‚\n8ã€nova-apié€šè¿‡rpc.callå‘nova-schedulerè¯·æ±‚æ˜¯å¦æœ‰åˆ›å»ºè™šæ‹Ÿæœºçš„èµ„æº(Host ID)ã€‚\n9ã€nova-schedulerè¿›ç¨‹ä¾¦å¬æ¶ˆæ¯é˜Ÿåˆ—ï¼Œè·å–nova-apiçš„è¯·æ±‚ã€‚\n10ã€nova-scheduleré€šè¿‡æŸ¥è¯¢novaæ•°æ®åº“ä¸­è®¡ç®—èµ„æºçš„æƒ…å†µï¼Œå¹¶é€šè¿‡è°ƒåº¦ç®—æ³•è®¡ç®—ç¬¦åˆè™šæ‹Ÿæœºåˆ›å»ºéœ€è¦çš„ä¸»æœºã€‚\n11ã€å¯¹äºæœ‰ç¬¦åˆè™šæ‹Ÿæœºåˆ›å»ºçš„ä¸»æœºï¼Œnova-scheduleræ›´æ–°æ•°æ®åº“ä¸­è™šæ‹Ÿæœºå¯¹åº”çš„ç‰©ç†ä¸»æœºä¿¡æ¯ã€‚\n12ã€nova-scheduleré€šè¿‡rpc.castå‘nova-computeå‘é€å¯¹åº”çš„åˆ›å»ºè™šæ‹Ÿæœºè¯·æ±‚çš„æ¶ˆæ¯ã€‚\n13ã€nova-computeä¼šä»å¯¹åº”çš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­è·å–åˆ›å»ºè™šæ‹Ÿæœºè¯·æ±‚çš„æ¶ˆæ¯ã€‚\n14ã€nova-computeé€šè¿‡rpc.callå‘nova-conductorè¯·æ±‚è·å–è™šæ‹Ÿæœºæ¶ˆæ¯ã€‚ï¼ˆFlavorï¼‰\n15ã€nova-conductorä»æ¶ˆæ¯é˜Ÿé˜Ÿåˆ—ä¸­æ‹¿åˆ°nova-computeè¯·æ±‚æ¶ˆæ¯ã€‚\n16ã€nova-conductoræ ¹æ®æ¶ˆæ¯æŸ¥è¯¢è™šæ‹Ÿæœºå¯¹åº”çš„ä¿¡æ¯ã€‚\n17ã€nova-conductorä»æ•°æ®åº“ä¸­è·å¾—è™šæ‹Ÿæœºå¯¹åº”ä¿¡æ¯ã€‚\n18ã€nova-conductoræŠŠè™šæ‹Ÿæœºä¿¡æ¯é€šè¿‡æ¶ˆæ¯çš„æ–¹å¼å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­ã€‚\n19ã€nova-computeä»å¯¹åº”çš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­è·å–è™šæ‹Ÿæœºä¿¡æ¯æ¶ˆæ¯ã€‚\n20ã€nova-computeé€šè¿‡keystoneçš„RESTfull APIæ‹¿åˆ°è®¤è¯çš„tokenï¼Œå¹¶é€šè¿‡HTTPè¯·æ±‚glance-apiè·å–åˆ›å»ºè™šæ‹Ÿæœºæ‰€éœ€è¦é•œåƒã€‚\n21ã€glance-apiå‘keystoneè®¤è¯tokenæ˜¯å¦æœ‰æ•ˆï¼Œå¹¶è¿”å›éªŒè¯ç»“æœã€‚\n22ã€tokenéªŒè¯é€šè¿‡ï¼Œnova-computeè·å¾—è™šæ‹Ÿæœºé•œåƒä¿¡æ¯(URL)ã€‚\n23ã€nova-computeé€šè¿‡keystoneçš„RESTfull APIæ‹¿åˆ°è®¤è¯kçš„tokenï¼Œå¹¶é€šè¿‡HTTPè¯·æ±‚neutron-serverè·å–åˆ›å»ºè™šæ‹Ÿæœºæ‰€éœ€è¦çš„ç½‘ç»œä¿¡æ¯ã€‚\n24ã€neutron-serverå‘keystoneè®¤è¯tokenæ˜¯å¦æœ‰æ•ˆï¼Œå¹¶è¿”å›éªŒè¯ç»“æœã€‚\n25ã€tokenéªŒè¯é€šè¿‡ï¼Œnova-computeè·å¾—è™šæ‹Ÿæœºç½‘ç»œä¿¡æ¯ã€‚\n26ã€nova-computeé€šè¿‡keystoneçš„RESTfull APIæ‹¿åˆ°è®¤è¯çš„tokenï¼Œå¹¶é€šè¿‡HTTPè¯·æ±‚cinder-apiè·å–åˆ›å»ºè™šæ‹Ÿæœºæ‰€éœ€è¦çš„æŒä¹…åŒ–å­˜å‚¨ä¿¡æ¯ã€‚\n27ã€cinder-apiå‘keystoneè®¤è¯tokenæ˜¯å¦æœ‰æ•ˆï¼Œå¹¶è¿”å›éªŒè¯ç»“æœã€‚\n28ã€tokenéªŒè¯é€šè¿‡ï¼Œnova-computeè·å¾—è™šæ‹ŸæœºæŒä¹…åŒ–å­˜å‚¨ä¿¡æ¯ã€‚\n29ã€nova-computeæ ¹æ®instanceçš„ä¿¡æ¯è°ƒç”¨é…ç½®çš„è™šæ‹ŸåŒ–é©±åŠ¨æ¥åˆ›å»ºè™šæ‹Ÿæœºã€‚\nä»¥Novaä¸ºä¾‹ï¼Œnova/computeç›®å½•å¹¶ä¸æ˜¯ä¸€å®šåœ¨nova-computeèŠ‚ç‚¹ä¸Šè¿è¡Œï¼Œè€Œä¸»è¦æ˜¯å’Œcomputeç›¸å…³(è™šæ‹Ÿæœºæ“ä½œç›¸å…³ï¼‰çš„åŠŸèƒ½å®ç°ï¼ŒåŒæ ·çš„ï¼Œschedulerç›®å½•ä»£ç å¹¶ä¸å…¨åœ¨scheduleræœåŠ¡èŠ‚ç‚¹è¿è¡Œï¼Œä½†ä¸»è¦æ˜¯å’Œè°ƒåº¦ç›¸å…³çš„ä»£ç ã€‚ä¸è¿‡ç›®å½•ç»“æ„éµå¾ªä¸€å®šçš„è§„å¾‹ã€‚\né€šå¸¸ä¸€ä¸ªOpenStacké¡¹ç›®çš„ä»£ç ç›®å½•éƒ½ä¼šåŒ…å«api.pyã€rpcapi.pyã€manager.pyï¼Œè¿™ä¸‰ä¸ªæ˜¯æœ€é‡è¦çš„æ¨¡å—ã€‚\napi.pyï¼š é€šå¸¸æ˜¯ä¾›å…¶å®ƒç»„ä»¶è°ƒç”¨çš„å°è£…åº“ã€‚æ¢å¥è¯è¯´ï¼Œè¯¥æ¨¡å—é€šå¸¸å¹¶ä¸ä¼šç”±æœ¬æ¨¡å—è°ƒç”¨ã€‚æ¯”å¦‚computeç›®å½•çš„api.pyï¼Œé€šå¸¸ç”±nova-apiæœåŠ¡çš„controllerè°ƒç”¨ã€‚å¯ä»¥ç®€å•è®¤ä¸ºæ˜¯ä¾›å…¶ä»–æœåŠ¡è°ƒç”¨çš„sdkã€‚ rpcapi.pyï¼šè¿™ä¸ªæ˜¯RPCè¯·æ±‚çš„å°è£…ï¼Œæˆ–è€…è¯´æ˜¯RPCå°è£…çš„clientç«¯ï¼Œè¯¥æ¨¡å—å°è£…äº†RPCè¯·æ±‚è°ƒç”¨ã€‚ manager.pyï¼š è¿™ä¸ªæ‰æ˜¯çœŸæ­£æœåŠ¡çš„åŠŸèƒ½å®ç°ï¼Œä¹Ÿæ˜¯RPCçš„serverç«¯ï¼Œå³å¤„ç†RPCè¯·æ±‚çš„å…¥å£ï¼Œå®ç°çš„æ–¹æ³•é€šå¸¸å’Œrpcapiå®ç°çš„æ–¹æ³•ä¸€ä¸€å¯¹åº”ã€‚ å…³æœºæµç¨‹\nAPIèŠ‚ç‚¹ nova-apiæ¥æ”¶ç”¨æˆ·è¯·æ±‚ -\u0026gt; nova-apiè°ƒç”¨compute/api.py -\u0026gt; compute/apiè°ƒç”¨compute/rpcapi.py -\u0026gt; rpcapi.pyå‘ç›®æ ‡è®¡ç®—èŠ‚ç‚¹å‘èµ·stop_instance()RPCè¯·æ±‚ è®¡ç®—èŠ‚ç‚¹ æ”¶åˆ°stop_instance()è¯·æ±‚ -\u0026gt; è°ƒç”¨compute/manager.pyçš„callbackæ–¹æ³•stop_instance() -\u0026gt; è°ƒç”¨libvirtå…³æœºè™šæ‹Ÿæœº\nå‰é¢æåˆ°OpenStacké¡¹ç›®çš„ç›®å½•ç»“æ„æ˜¯æŒ‰ç…§åŠŸèƒ½åˆ’åˆ†çš„ï¼Œè€Œä¸æ˜¯æœåŠ¡ç»„ä»¶ï¼Œå› æ­¤å¹¶ä¸æ˜¯æ‰€æœ‰çš„ç›®å½•éƒ½èƒ½æœ‰å¯¹åº”çš„ç»„ä»¶ã€‚ä»ä»¥Novaä¸ºä¾‹:\nnova/cmdï¼šè¿™æ˜¯æœåŠ¡çš„å¯åŠ¨è„šæœ¬ï¼Œå³æ‰€æœ‰æœåŠ¡çš„mainå‡½æ•°ã€‚çœ‹æœåŠ¡æ€ä¹ˆåˆå§‹åŒ–ï¼Œå°±ä»è¿™é‡Œå¼€å§‹ã€‚ nova/db: å°è£…æ•°æ®åº“è®¿é—®ï¼Œç›®å‰æ”¯æŒçš„driverä¸ºsqlalchemyã€‚ nova/confï¼šNovaæ‰€æœ‰é…ç½®é¡¹å£°æ˜éƒ½æ”¾åœ¨è¿™ä¸ªç›®å½•ã€‚ nova/locale: æœ¬åœ°åŒ–å¤„ç†ã€‚ nova/image: å°è£…Glanceæ¥å£ã€‚ nova/network: å°è£…Neutronæ¥å£ã€‚ nova/volume: å°è£…Cinderæ¥å£ã€‚ nova/virt: è¿™æ˜¯æ”¯æŒçš„æ‰€æœ‰è™šæ‹ŸåŒ–é©±åŠ¨å®ç°ï¼Œå³compute driverå®ç°ï¼Œä¸»æµçš„å¦‚libvirtã€hypervã€ironicã€vmwareapiç­‰ã€‚ nova/objects: å¯¹è±¡æ¨¡å‹ï¼Œå°è£…äº†æ‰€æœ‰Novaå¯¹è±¡çš„CURDæ“ä½œï¼Œç›¸å¯¹ä»¥å‰ç›´æ¥è°ƒç”¨dbçš„modelæ›´å®‰å…¨ï¼Œå¹¶ä¸”æ”¯æŒç‰ˆæœ¬æ§åˆ¶ã€‚ nova/policiesï¼š API policyé›†åˆã€‚ nova/tests: æµ‹è¯•ä»£ç ï¼Œå¦‚å•å…ƒæµ‹è¯•ã€åŠŸèƒ½æµ‹è¯•ã€‚ nova/hacking: Novaä»£ç è§„èŒƒå®šä¹‰çš„ä¸€äº›è§„åˆ™ã€‚ nova \u0026ndash;debug boot \u0026ndash;image 81e58b1a-4732-4255-b4f8-c844430485d2 \u0026ndash;flavor 1 yikun\ncontrollerçš„indexæ–¹æ³•å¯¹åº”listæ“ä½œã€showæ–¹æ³•å¯¹åº”getæ“ä½œã€createå¯¹åº”åˆ›å»ºæ“ä½œã€deleteå¯¹åº”åˆ é™¤æ“ä½œã€updateå¯¹åº”æ›´æ–°æ“ä½œç­‰ã€‚\nopenstack-nova-compute.service ä¸¤ä¸ªèŒè´£ï¼Œå…¶ä¸€ï¼Œæ˜¯å®ˆæŠ¤è¿›ç¨‹ï¼Œè´Ÿè´£åŸºäºå„ç§è™šæ‹ŸåŒ–æŠ€æœ¯Hypervisiorå®ç°åˆ›å»ºå’Œç»ˆæ­¢è™šæ‹Ÿæœºï¼›å…¶äºŒï¼Œæ•´åˆäº†è®¡ç®—èµ„æºCPUï¼Œå­˜å‚¨ï¼Œç½‘ç»œä¸‰ç±»èµ„æºéƒ¨ç½²ç®¡ç†è™šæ‹Ÿæœºï¼Œå®ç°è®¡ç®—èƒ½åŠ›çš„äº¤ä»˜ã€‚\nCell V2çš„è®¾è®¡æ€æƒ³æ˜¯ï¼Œç”±APIã€Super Conductorå»è®¿é—®ä¸Šå±‚çš„å…¨å±€æ•°æ®åº“ï¼ˆnova_apiæ•°æ®åº“ï¼‰ï¼Œè€Œåº•ä¸‹çš„cellä¸­çš„ç»„ä»¶ï¼Œåªéœ€è¦å…³å¿ƒcellä¸­çš„é€»è¾‘å³å¯\né¦–å…ˆï¼Œapiä¸­è¿›è¡Œç¬¬ä¸€æ¬¡Quotaæ£€æµ‹ï¼Œä¸»è¦æ–¹æ³•å°±æ˜¯æ”¶é›†åœ°ä¸‹å„ä¸ªcellæ•°æ®åº“ä¸­çš„èµ„æºä¿¡æ¯ï¼Œç„¶åå’Œapiæ•°æ®åº“ä¸­çš„quotaä¸Šé™è¿›è¡Œå¯¹æ¯”ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç”¨æˆ·å¯ä»¥åˆ›å»º10ä¸ªè™šæ‹Ÿæœºï¼Œåœ¨cell1ä¸­æœ‰2ä¸ªï¼Œcell2ä¸­æœ‰7ä¸ªï¼Œå†åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿæœºæ—¶ï¼Œä¼šæœé›†cell1å’Œcell2ä¸­çš„è™šæ‹Ÿæœºä¸ªæ•°ä¹‹å’Œï¼ˆ9ä¸ªï¼‰ï¼Œç„¶ååŠ ä¸Šå˜åŒ–ï¼ˆæ–°å¢ä¸€ä¸ªï¼‰ï¼Œä¸æ€»é…é¢è¿›è¡Œæ¯”è¾ƒã€‚ äºŒæ¬¡æ£€æµ‹ï¼ˆcell v2åœ¨super conductoré‡Œåšï¼‰ã€‚ç”±äºåœ¨å¹¶å‘åœºæ™¯ä¸‹ï¼Œå¯èƒ½å‡ºç°åŒæ—¶æ£€æµ‹å‘ç°æ»¡è¶³ï¼Œä¹‹åè¿›è¡Œåˆ›å»ºï¼Œå°±ä¼šé€ æˆé…é¢çš„è¶…åˆ†ï¼Œé’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œç¤¾åŒºç›®å‰ç»™å‡ºçš„æ–¹æ¡ˆæ˜¯ï¼Œåœ¨åˆ›å»ºè™šæ‹Ÿæœºè®°å½•ä¹‹åï¼Œå†è¿›è¡Œrecheckï¼Œå¦‚æœå‘ç°è¶…é¢äº†ï¼Œä¼šå°†è¶…é¢åˆ†é…çš„è™šæ‹Ÿæœºæ ‡è®°ä¸ºERRORï¼Œä¸å†ç»§ç»­å¾€ä¸‹èµ°äº†ã€‚ åœ¨Cell v2åœºæ™¯ï¼Œè™šæ‹Ÿæœºçš„åˆ›å»ºè®°å½•å·²ç»éœ€è¦å†™å…¥çš„å­cellä¸­ï¼Œå› æ­¤ï¼Œconductoréœ€è¦åšçš„äº‹ï¼ŒåŒ…æ‹¬ä¸€ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š\nè¿›è¡Œè°ƒåº¦ï¼Œé€‰å‡ºhostã€‚ æ ¹æ®hostï¼Œé€šè¿‡host_mappingsæ‰¾åˆ°å¯¹åº”çš„cell åœ¨å¯¹åº”çš„cell dbä¸­åˆ›å»ºè™šæ‹Ÿæœºè®°å½•ï¼Œå¹¶ä¸”è®°å½•instances_mappingsä¿¡æ¯ é€šè¿‡cell_mappingsæ¥æŸ¥æ‰¾å¯¹åº”çš„cellçš„mqï¼Œç„¶åæŠ•é€’åˆ°å¯¹åº”çš„cellä¸­çš„compute å®Œæˆè¿™äº›æ“ä½œæ—¶ï¼Œéœ€è¦ç‰µæ‰¯åˆ°3ä¸ªå…³é”®çš„æ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬æ¥ç®€å•çš„çœ‹ä¸€ä¸‹ï¼š\nhost_mappingsï¼šè®°å½•äº†hostå’Œcellçš„æ˜ å°„ä¿¡æ¯ instances_mappingsï¼šè®°å½•äº†è™šæ‹Ÿæœºå’Œcellçš„æ˜ å°„ä¿¡æ¯ cell_mappingsï¼šè®°å½•äº†cellå’Œcellå¯¹åº”çš„mqçš„æ˜ å°„ä¿¡æ¯ ä¸Cell v1ä¸å¤ªç›¸åŒï¼Œåœ¨ç›®å‰çš„è®¾è®¡ä¸­ï¼Œè®¤ä¸ºschedulerèƒ½çœ‹åˆ°çš„åº”è¯¥æ˜¯åº•ä¸‹èƒ½å¤Ÿæä¾›èµ„æºçš„å…·ä½“çš„æ‰€æœ‰çš„Resource Providerï¼ˆå¯¹äºè®¡ç®—èµ„æºæ¥è¯´ï¼Œå°±æ˜¯æ‰€æœ‰çš„è®¡ç®—èŠ‚ç‚¹ï¼‰ï¼Œè€Œä¸æ˜¯æ•´ä¸ªcellï¼Œä¹Ÿå°±æ˜¯è¯´æ‰€æœ‰cellä¸­çš„èµ„æºscheduleréƒ½å¯ä»¥çœ‹åˆ°ï¼Œè€Œå­cellå°±è´Ÿè´£åˆ›å»ºå°±å¥½äº†ã€‚å› æ­¤ï¼Œåœ¨super conductorä¸­ï¼Œéœ€è¦åšä¸€äº›transferçš„äº‹æƒ…ï¼Œè¿™æ ·ä¹Ÿå°±ä¸å¿…åœ¨åƒcell v1é‚£æ ·ï¼Œåœ¨å­cellé‡Œè¿˜å¾—æä¸ªschedulerå»åšè°ƒåº¦ã€‚\né€šè¿‡Placementè·å–å¯ç”¨çš„å¤‡é€‰èµ„æºï¼Œå‚è€ƒPlacement Allocation Requestsçš„å®ç°ã€‚ åœ¨Ocataç‰ˆæœ¬æ—¶ï¼ŒResource Providers - Scheduler Filters in DBè¿™ä¸ªBPå°±å·²ç»åœ¨è°ƒåº¦å‰åŠ äº†ä¸€æ­¥ï¼Œè·å–å¤‡é€‰èŠ‚ç‚¹ã€‚ä»BPçš„æ ‡é¢˜å°±å¯ä»¥çœ‹å‡ºï¼Œè®¾è®¡è€…æƒ³é€šè¿‡PlacementæœåŠ¡æä¾›çš„æ–°çš„ä¸€å¥—æœºåˆ¶ï¼Œæ¥åšè¿‡æ»¤ã€‚åŸå› æ˜¯ä¹‹å‰çš„è°ƒåº¦éœ€è¦åœ¨schedulerç»´æŠ¤æ¯ä¸€ä¸ªcomputeèŠ‚ç‚¹çš„hoststateä¿¡æ¯ï¼Œç„¶åè°ƒåº¦çš„æ—¶å€™ï¼Œå†ä¸€ä¸ªä¸ªå»æŸ¥ï¼Œè¿™å¤ªä½æ•ˆäº†ï¼Œå°¤å…¶æ˜¯åœ¨è®¡ç®—èŠ‚ç‚¹æ•°ç›®æ¯”è¾ƒå¤šçš„æ—¶å€™ã€‚å› æ­¤ï¼Œå¢åŠ äº†ä¸€ä¸ªâ€œé¢„è¿‡æ»¤â€çš„æµç¨‹ï¼Œé€šè¿‡å‘PlacementæŸ¥è¯¢ï¼ŒPlacementæœåŠ¡ç›´æ¥é€šè¿‡SQLå»æŸ¥ä¸€æŠŠï¼ŒæŠŠæ»¡è¶³æ¡ä»¶ï¼ˆæ¯”å¦‚CPUå……è¶³ã€RAMå……è¶³ç­‰ï¼‰å…ˆè·å–åˆ°ã€‚ è€ŒåŸæ¥è·å–å¤‡é€‰èŠ‚ç‚¹çš„æ—¶å€™ï¼Œåªæ”¯æŒè·å–å•ä¸€çš„Resource Providerï¼Œè¿™ä¸ªBPå¢å¼ºäº†è·å–å¤‡é€‰èµ„æºçš„èƒ½åŠ›ï¼Œç”¨äºåç»­æ”¯æŒæ›´å¤æ‚çš„è¯·æ±‚ï¼Œæ¯”å¦‚å…±äº«èµ„æºã€åµŒå¥—èµ„æºçš„ProvideræŸ¥è¯¢ã€‚åé¢ï¼ŒPlacementè¿˜ä¼šé™†ç»­æ”¯æŒæ›´å¤šçš„è¯·æ±‚ï¼Œæ¯”å¦‚å¯¹ä¸€äº›éå­˜é‡ä¸å¯è®¡æ•°çš„èµ„æºçš„æ”¯æŒã€‚è¿™æ ·ç•™ç»™åé¢Filter\u0026amp;Weightçš„å‹åŠ›å°±å°ä¸€äº›äº†ï¼Œå†å¾€åï¼Œä¼šä¸ä¼šå®Œå…¨å–ä»£Filterå‘¢ï¼Ÿæˆ‘æƒ³ï¼Œç°æœ‰çš„å„ç§è¿‡æ»¤éƒ½å¯ä»¥é€šè¿‡Placementæ”¯æŒåï¼Œå®Œå…¨æœ‰å¯èƒ½çš„ã€‚ Scheduleré€šè¿‡Placementæ¥claimèµ„æºã€‚å‚è€ƒScheduler claiming resources to the Placement APIçš„å®ç°ã€‚ åœ¨æœ€æ—©çš„æ—¶å€™ï¼Œclaimèµ„æºæ˜¯ç”±computeæ¥åšçš„ï¼Œç°åœ¨ç›¸å½“äºæå‰åˆ°schedulerå»æäº†ã€‚æœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿæˆ‘ä»¬å…ˆçœ‹çœ‹åŸæ¥çš„é—®é¢˜ï¼š è°ƒåº¦æ—¶åˆ»å’ŒçœŸæ­£çš„å»computeèŠ‚ç‚¹å»claimèµ„æºçš„æ—¶åˆ»ä¹‹é—´æ˜¯ç”±ä¸€æ®µæ—¶é—´çš„ï¼Œåœ¨èµ„æºä¸æ˜¯é‚£ä¹ˆå……è¶³çš„ç¯å¢ƒï¼Œå°±ä¼šé€ æˆåœ¨schedulerè°ƒåº¦çš„æ—¶å€™ï¼Œèµ„æºè¿˜æ²¡åˆ·æ–°ï¼Œæ‰€ä»¥è°ƒåº¦æ—¶å€™æˆåŠŸäº†ï¼Œä½†æ˜¯çœŸæ­£ä¸‹æ¥çš„æ—¶å€™ï¼Œæ‰å‘ç°computeå®é™…å·²ç»æ²¡æœ‰èµ„æºäº†ï¼Œç„¶ååˆâ€œè·¨è¶ŠåŠä¸ªåœ°çƒâ€å»åšé‡è°ƒåº¦ï¼Œæ— å½¢åœ°å¢åŠ äº†ç³»ç»Ÿçš„è´Ÿè½½ã€‚ è€Œä¸”å¢åŠ äº†åˆ›å»ºçš„æ—¶é•¿ï¼ˆå“¦ï¼Œå“ªæ€•åˆ›å»ºå¤±è´¥å‘¢ï¼Ÿï¼‰ï¼Œä½ æƒ³æƒ³ï¼Œç”¨æˆ·åˆ›äº†é‚£ä¹ˆä¹…çš„è™šæ‹Ÿæœºï¼Œæœ€åä½ å‘Šè¯‰æˆ‘è°ƒåº¦å¤±è´¥äº†ï¼Œç”¨æˆ·ä¸å¤ªèƒ½å¿ã€‚ æ‰€ä»¥è¿™ä¸ªBPå°±æŠŠClaimèµ„æºæ”¾åœ¨è°ƒåº¦å¤„äº†ï¼Œæˆ‘ä¸Šä¸€ä¸ªè°ƒåº¦è¯·æ±‚å¤„ç†å®Œï¼Œé©¬ä¸Šå°±å‘Šè¯‰placementï¼Œè¿™èµ„æºè€å­ç”¨äº†ï¼Œå…¶ä»–äººä¸è¦åŠ¨äº†ã€‚OKï¼Œä¸–ç•Œç»ˆäºæ¸…å‡€äº†ï¼Œèƒ½æ‹¿åˆ°èµ„æºçš„æ‹¿åˆ°äº†ï¼Œæ‹¿ä¸åˆ°èµ„æºçš„é©¬ä¸Šä¹ŸçŸ¥é“è‡ªå·±æ‹¿ä¸åˆ°äº†ï¼Œå¤§å¤§å¢å¼ºäº†è°ƒåº¦çš„ç”¨æˆ·ä½“éªŒã€‚ 2.4 Placement æ©ï¼Œåœ¨è°ƒåº¦çš„æ—¶å€™ï¼Œå·²ç»ä»‹ç»è¿‡è¿™ä¸ªæœåŠ¡äº†ï¼Œåœ¨è™šæ‹Ÿæœºåˆ›å»ºçš„æµç¨‹ä¸­ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„æ¥å£å°±æ˜¯è·å–å¤‡é€‰èµ„æºå’Œclaimèµ„æºã€‚ Placementç›®æ ‡å¾ˆå®ä¼Ÿï¼Œå¤§è‡´çš„ä½œç”¨å°±æ˜¯ï¼šèµ„æºæˆ‘æ¥ç®¡ï¼Œè¦èµ„æºé—®æˆ‘è¦ï¼Œç”¨äº†èµ„æºå‘Šè¯‰æˆ‘ã€‚åé¢å‡†å¤‡ç”¨ä¸€ç¯‡æ–‡ç« æ•´ä½“ä»‹ç»ä¸€ä¸‹Placementã€‚ï¼ˆyepï¼Œè¿™ä¸ªFlagæˆ‘ç«‹ä¸‹äº†ï¼Œä¼šå†™çš„ï¼‰\nserviceçš„è¯¦ç»†ä¿¡æ¯ä¸»è¦åŒ…æ‹¬å¦‚ä¸‹å‡ é¡¹ï¼š binary, host, zone, status, state å…¶ä¸­ï¼š binaryï¼Œå¯ä»¥ç†è§£ä¸ºserviceçš„åç§°ï¼Œç±»ä¼¼äºnova-computeï¼› hostæ˜¯serviceæ‰€åœ¨çš„ä¸»æœºåç§°ï¼› zoneæ˜¯serviceæ‰€å±çš„AZï¼Œå…¶å®å°±æ˜¯serviceæ‰€åœ¨çš„ä¸»æœºæ‰€å±çš„aggregateï¼Œåªæ˜¯aggregateçš„æ¦‚å¿µä¸å¯¹å¤–å‘ˆç°ï¼Œæ‰€ä»¥ç”¨æˆ·çœ‹åˆ°çš„æ˜¯AZã€‚å…¶å®ï¼Œåœ¨Novaå†…éƒ¨ï¼ŒAZæ˜¯AGçš„metadataè€Œå·²ã€‚\nzoneçš„ç¡®å®šï¼Œæ¶‰åŠåˆ°ä¸¤ä¸ªé…ç½®é¡¹ï¼Œå¯¹äºéè®¡ç®—èŠ‚ç‚¹ï¼Œzoneçš„åç§°ä¾èµ–äºé…ç½®é¡¹internal_service_availability_zoneï¼ˆé»˜è®¤æ˜¯internalï¼‰ï¼› å¯¹äºè®¡ç®—èŠ‚ç‚¹ï¼Œå¦‚æœä¸å±äºä»»ä½•AGï¼Œæˆ–è€…æ‰€å±çš„AGæ²¡æœ‰AZçš„metadataä¿¡æ¯ï¼Œé»˜è®¤çš„zoneä¾èµ–äºé…ç½®é¡¹default_availability_zoneï¼ˆé»˜è®¤æ˜¯novaï¼‰ã€‚ statusæ˜¯æœåŠ¡disableå±æ€§çš„ä½“ç°ï¼Œè¯¥å±æ€§å¯ä»¥ç›´æ¥é€šè¿‡APIä¿®æ”¹; stateæ˜¯æœåŠ¡çœŸå®çš„çŠ¶æ€ï¼Œæ˜¯é€šè¿‡servicegroup apiè·å–ã€‚æ¯ä¸ªæœåŠ¡åœ¨å¯åŠ¨æ—¶ä¼šåŠ å…¥servicegroupï¼Œä»¥dbåç«¯ä¸ºä¾‹ï¼Œä¼šåœ¨æœåŠ¡ä¸­å¯åŠ¨å®šæ—¶å™¨ï¼Œæ›´æ–°serviceè¡¨ä¸­çš„report_countçš„å€¼ï¼ŒåŒæ—¶ä¹Ÿä¼šåˆ·æ–°æ›´æ–°æ—¶é—´ï¼Œåç»­ä¼šæ ¹æ®è¿™ä¸ªæ›´æ–°æ—¶é—´ç¡®å®šæœåŠ¡çš„æ­»æ´»ï¼›\nå½“ç„¶ï¼ŒæŸ¥è¯¢serviceä¿¡æ¯ä¹Ÿæ”¯æŒè¿‡æ»¤æ¡ä»¶ï¼Œæ¯”å¦‚ï¼š 1ã€æŸ¥è¯¢æŸä¸ªhostç›¸å…³çš„serviceï¼› 2ã€æŒ‰binaryåç§°æŸ¥è¯¢serviceï¼›\nå…¶å®Novaä¸­æ²¡æœ‰hostè¿™ä¸ªç‹¬ç«‹çš„èµ„æºï¼ˆæ•°æ®åº“å¯¹è±¡ï¼‰ï¼Œä½†æ˜¯Novaå´æœ‰é’ˆå¯¹hostçš„APIæ“ä½œï¼Œå…¶å®ï¼Œåœ¨å†…éƒ¨å®ç°ä¸­ï¼Œå°±æ˜¯é€šè¿‡å‰é¢çš„serviceä¿¡æ¯ï¼Œé—´æ¥ç»„è£…è¿”å›hostä¿¡æ¯ã€‚\nç§Ÿæˆ·ï¼šé…é¢\nä¸æ­¤åŒæ—¶ï¼Œè™šæ‹Ÿæœºstateæˆ–task_stateå‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¹Ÿä¼šå‘å¤–éƒ¨å‘é€é€šçŸ¥ã€‚ å‰ææ˜¯é…ç½®é¡¹notify_on_state_changeè¦é…ç½®ä¸ºvm_stateæˆ–vm_and_task_stateã€‚ Novaä¸­çš„è™šæ‹Ÿæœºæ¯ä¸ªæ“ä½œï¼ˆå¯åŠ¨ã€åœæ­¢ã€æš‚åœã€æ¢å¤ç­‰ç­‰ï¼‰ï¼Œéƒ½ä¼šåœ¨dbä¸­ä¿å­˜ç›¸å…³çš„æ“ä½œè®°å½•ï¼Œç»™ç”¨æˆ·æä¾›æŸ¥è¯¢ã€‚åˆ©ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œç”¨æˆ·å¯¹è‡ªå·±çš„è™šæ‹Ÿæœºæ•´ä¸ªç”Ÿå‘½å‘¨æœŸçš„è¿‡ç¨‹å’ŒçŠ¶æ€éƒ½ä¼šäº†å¦‚æŒ‡æŒï¼Œä¾¿äºç”¨æˆ·çš„ç®¡ç†ã€‚å‚è§è¿™é‡Œã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š\nåœ¨å†…éƒ¨å®ç°ä¸­ï¼Œnova-apiå±‚ä¼šè®°å½•actionå¼€å§‹çš„è®°å½•ï¼Œåœ¨nova-computeå±‚ï¼Œåˆ™ä¼šæ·»åŠ eventå¼€å§‹å’Œç»“æŸçš„ä¿¡æ¯ï¼Œactionå’Œeventæ ¹æ®request idï¼ˆä¸€æ¬¡æ¶ˆæ¯è¯·æ±‚çš„æ ‡è¯†ï¼‰å…³è”ã€‚\nå…ˆè¯´é€šçŸ¥ï¼Œè™šæ‹Ÿæœºæ“ä½œå¼‚å¸¸æ—¶ï¼Œä¸€èˆ¬éƒ½ä¼šå‘é€erroré€šçŸ¥ï¼Œé€šçŸ¥ä¸­åŒ…å«å¼‚å¸¸çš„å‡½æ•°åç§°ã€å¼‚å¸¸æ—¶å‡½æ•°çš„å‚æ•°ä»¥åŠå¼‚å¸¸ä¿¡æ¯ã€‚ å†è¯´dbï¼Œè™šæ‹Ÿæœºæ“ä½œå¼‚å¸¸æ—¶ï¼Œæ— è®ºæ˜¯åœ¨conductor, schedulerè¿˜æ˜¯computeå±‚ï¼Œé™¤äº†ä¼šå‘é€é€šçŸ¥å¤–ï¼Œè¿˜ä¼šè®°å½•å¼‚å¸¸ä¿¡æ¯åˆ°æ•°æ®åº“ï¼ˆinstance_faultsè¡¨ï¼‰ï¼Œå½“æŸ¥è¯¢è™šæ‹Ÿæœºä¿¡æ¯æ—¶ï¼Œä¼šè¿”å›è™šæ‹Ÿæœºçš„å¼‚å¸¸ä¿¡æ¯ã€‚ ä¸€ä¸ªhypervisorï¼Œæ˜¯åˆ›å»ºè™šæ‹Ÿæœºèƒ½å¤Ÿè°ƒåº¦åˆ°çš„æœ€å°å•å…ƒã€‚\napi.pyæä¾›å¯¹å¤–è®¿é—®çš„æ¥å£ï¼Œå¯ä»¥ä»è¿™å¼€å§‹å…¥æ‰‹è·Ÿè¸ªå„ä¸ªåŠŸèƒ½å®ç°ã€‚ rpcapi.pyå°è£…RPCè¯·æ±‚è°ƒç”¨ï¼Œå¤§å¤šæ•°æ˜¯å¼‚æ­¥è°ƒç”¨ã€‚ manager.pyå„ç§RPCè°ƒç”¨çš„å®ç°ï¼ŒåŸºæœ¬å’Œrpcapi.pyä¸­è°ƒç”¨çš„åç§°ä¸€ä¸€å¯¹åº”ã€‚ æ­¤å¤–è¿˜æœ‰ä¸€ç‚¹ï¼ŒOpenstackçš„ç›®å½•ç»“æ„æ˜¯æ ¹æ®åŠŸèƒ½åˆ’åˆ†çš„ï¼Œæ¯”å¦‚Novaä¸­computeç›®å½•ä¸ä¸€å®šéƒ½æ˜¯åœ¨nova-computeèŠ‚ç‚¹ä¸Šè¿è¡Œï¼Œè€Œæ˜¯æ‰€æœ‰å’Œè™šæ‹Ÿæœºåˆ›å»ºç›¸å…³çš„åŠŸèƒ½éƒ½åœ¨è¿™é‡Œã€‚\nä»é…ç½®æ–‡ä»¶å¯ä»¥æ˜æ˜¾çš„çœ‹å‡ºï¼Œnova-apiå¯¹åº”çš„æ–‡ä»¶æ˜¯nova/cmd/api.pyçš„main()å‡½æ•°ï¼š\nvm_state\npower_state\ntask_state\n_record_action_start notify_about_instance_action elevated\n@startuml title: åˆ›å»ºè™šæ‹Ÿæœº participant \u0026#34;API\u0026#34; as api note left of api nova/api/openstack/compute/servers.py end note participant \u0026#34;Scheduler\u0026#34; as sch database \u0026#34;Database\u0026#34; as db #Green participant \u0026#34;Condutor(super)\u0026#34; as pconductor participant \u0026#34;Placement\u0026#34; as placement box \u0026#34;internal service\u0026#34; participant \u0026#34;Compute\u0026#34; as compute participant \u0026#34;Libvirt\u0026#34; as virt end box participant \u0026#34;Conductor(cell)\u0026#34; as ccondutor participant \u0026#34;Neutron\u0026#34; as neutron participant \u0026#34;Cinder\u0026#34; as cinder participant \u0026#34;Glance\u0026#34; as glance autonumber \u0026#34;\u0026lt;b\u0026gt; [00]\u0026#34; [-\u0026gt; api++ : åˆ›å»ºè™šæ‹Ÿæœº api -\u0026gt; api : validate schema api -\u0026gt; api : get context api -\u0026gt; api : get server_dict api -\u0026gt; api : gen create_kwargs api -\u0026gt; api : policy check api -\u0026gt; api : provision instance api -\u0026gt; glance : è·å–é•œåƒä¿¡æ¯ api -\u0026gt; api : policyæ ¡éªŒ api -\u0026gt; api : é…é¢æ ¡éªŒ api -\u0026gt; api : æ·»åŠ Group hnote left #FFAAAA vm_state: Building task_state: Scheduling end note api -\u0026gt; db : åˆ›å»ºinstance db -\u0026gt; api : create success [\u0026lt;- api : return 202 deactivate api api -\u0026gt; pconductor ++: schedule \u0026amp; build pconductor -\u0026gt; sch : select_destination sch -\u0026gt; placement : get allocation candidates placement -\u0026gt; sch : alloc_reqs.provider_summarys sch -\u0026gt; sch : Filter \u0026amp; weighter sch -\u0026gt; placement : claim Resources placement -\u0026gt; sch : hello sch -\u0026gt; pconductor : return host pconductor -\u0026gt; pconductor : in target cell DBä¸­åˆ›å»ºinstance pconductor -\u0026gt; pconductor : é…é¢æ ¡éªŒ recheck pconductor -\u0026gt; pconductor : åˆ·æ–°instance cell ä¿¡æ¯ pconductor -\u0026gt; pconductor : åˆ é™¤build request() pconductor -\u0026gt; compute : åœ¨æŒ‡å®šcellä¸­åˆ›å»ºè™šæ‹Ÿæœº hnote left #FFAAAA vm_state: Building task_state: None end note compute -\u0026gt; neutron : åˆ›å»ºç½‘ç»œ hnote left #FFAAAA vm_state: Building task_state: Networking end note compute -\u0026gt; cinder : æ„å»ºå—è®¾å¤‡ hnote left #FFAAAA vm_state: Building task_state: Block Device Mapping end note compute -\u0026gt; compute : spawn() hnote left #FFAAAA vm_state: Building task_state: Spawning end note compute -\u0026gt; glance : ä¸‹è½½é•œåƒ compute -\u0026gt; compute : ç”Ÿæˆxml compute -\u0026gt; compute : åˆ·æ–°è™šæ‹ŸæœºçŠ¶æ€ hnote left #FFAAAA vm_state: Building task_state: None end note @enduml @startuml title: Lockè™šæ‹Ÿæœº participant \u0026#34;API\u0026#34; as api database \u0026#34;Database\u0026#34; as db #Green autonumber \u0026#34;\u0026lt;b\u0026gt; [00]\u0026#34; [-\u0026gt; api : lock api -\u0026gt; api : get_context api -\u0026gt; api : authorize action [lock] policy api -\u0026gt; db : get instance by id db -\u0026gt; api : done api -\u0026gt; api : check policy api -\u0026gt; db : instance.locked = True\\n locked_by=owner or admin\\n record locked reason db -\u0026gt; api : done [\u0026lt;- api : response @enduml @startuml title: Pauseè™šæ‹Ÿæœº participant \u0026#34;API\u0026#34; as api database \u0026#34;Database\u0026#34; as db #Green box \u0026#34;internal service\u0026#34; participant \u0026#34;Compute\u0026#34; as compute participant \u0026#34;Libvirt\u0026#34; as virt end box autonumber \u0026#34;\u0026lt;b\u0026gt; [00]\u0026#34; [-\u0026gt; api++ : pause instance api -\u0026gt; api : authorize context api -\u0026gt; db++ : get instance by uuid return done api -\u0026gt; api : check policy api -\u0026gt; api : check instance lock api -\u0026gt; api : check instance cell api -\u0026gt; api : ensure instance state is ACTIVE api -\u0026gt; db++ : task_state = PAUSING return done api -\u0026gt; api : record pause action api -\u0026gt; compute++ : pause_instance compute -\u0026gt; compute : notify : pause.start compute -\u0026gt; virt++ : pause virt -\u0026gt; virt : get domain virt -\u0026gt; virt : domain.suspend() return done compute -\u0026gt; db++ : vm_state = PAUSE\\n task_state = None return done compute -\u0026gt; compute : notify: pause.end [\u0026lt;- api : response @enduml @startuml title: Renameè™šæ‹Ÿæœº participant \u0026#34;API\u0026#34; as api database \u0026#34;Database\u0026#34; as db #Green autonumber \u0026#34;\u0026lt;b\u0026gt; [00]\u0026#34; [-\u0026gt; api : update name activate api api -\u0026gt; api : validate schema api -\u0026gt; api : get context api -\u0026gt; api : authorize [update] policy api -\u0026gt; api : get update_dict[\u0026#34;display_name\u0026#34;] api -\u0026gt; db++ : get server by id return done api -\u0026gt; db : update(update_dict) db -\u0026gt; db : save [\u0026lt;- api : responee @enduml @startuml title: Suspendè™šæ‹Ÿæœº participant \u0026#34;API\u0026#34; as api database \u0026#34;Database\u0026#34; as db #Green box \u0026#34;internal service\u0026#34; participant \u0026#34;Compute\u0026#34; as compute participant \u0026#34;Libvirt\u0026#34; as virt end box autonumber \u0026#34;\u0026lt;b\u0026gt; [00]\u0026#34; [-\u0026gt; api++ : suspend instance api -\u0026gt; api : authorize context api -\u0026gt; db++ : get instance by uuid return done api -\u0026gt; api : check policy api -\u0026gt; api : check instance lock api -\u0026gt; api : check instance cell api -\u0026gt; api : ensure instance state is ACTIVE api -\u0026gt; db++ : task_state = SUSPANDING return done api -\u0026gt; api : record action : suspand api -\u0026gt; compute++ : suspand_instance compute -\u0026gt; compute : notify : suspand.start compute -\u0026gt; virt++ : suspand virt -\u0026gt; virt : get instance guest virt -\u0026gt; virt : detach pci device virt -\u0026gt; virt : detach sriow ports virt -\u0026gt; virt : guest.save_memory_state() return done compute -\u0026gt; db++ : vm_state = SUSPENDED\\n task_state = None return done compute -\u0026gt; compute : notify: suspend.end [\u0026lt;- api : response @enduml @startuml hide empty description [*] --\u0026gt; State1 State1 --\u0026gt; [*] vm_state:powering\\n task_state:good\\n nihao State1 : this is another string State1 -\u0026gt; State2 State2 --\u0026gt; [*] @enduml @startuml title: Unlockè™šæ‹Ÿæœº participant \u0026#34;API\u0026#34; as api database \u0026#34;Database\u0026#34; as db #Green autonumber \u0026#34;\u0026lt;b\u0026gt; [00]\u0026#34; [-\u0026gt; api : lock api -\u0026gt; api : get_context api -\u0026gt; api : authorize action [unlock] policy api -\u0026gt; db : get instance by id db -\u0026gt; api : done api -\u0026gt; api : check policy api -\u0026gt; db : query instance.locked db -\u0026gt; api : done api -\u0026gt; db : instance.locked = False\\n locked_by=None\\n clear locked reason db -\u0026gt; api : done [\u0026lt;- api : response @enduml @startuml title: Unpauseè™šæ‹Ÿæœº participant \u0026#34;API\u0026#34; as api database \u0026#34;Database\u0026#34; as db #Green box \u0026#34;internal service\u0026#34; participant \u0026#34;Compute\u0026#34; as compute participant \u0026#34;Libvirt\u0026#34; as virt end box autonumber \u0026#34;\u0026lt;b\u0026gt; [00]\u0026#34; [-\u0026gt; api++ : unpause instance api -\u0026gt; api : authorize context api -\u0026gt; db++ : get instance by uuid return done api -\u0026gt; api : check policy api -\u0026gt; api : check instance lock api -\u0026gt; api : check instance cell api -\u0026gt; api : ensure instance state is PAUSED api -\u0026gt; db++ : task_state = UNPAUSING return done api -\u0026gt; api : record action : unpause api -\u0026gt; compute++ : unpause_instance compute -\u0026gt; compute : notify : unpause.start compute -\u0026gt; virt++ : unpause virt -\u0026gt; virt : get domain virt -\u0026gt; virt : domain.resume() return done compute -\u0026gt; db++ : vm_state = ACTIVE\\n task_state = None return done compute -\u0026gt; compute : notify: unpause.end [\u0026lt;- api : response @enduml å‚è€ƒ Openstackè™šæ‹Ÿæœºå¯åŠ¨æ–¹å¼\nOpenstackæºç å­¦ä¹ ç¬”è®°\nOpenstackè¯æ±‡è¡¨\nOpenstackä»ç¡¬ç›˜å¯åŠ¨å®ä¾‹\nNovaè™šæ‹Ÿæœºåˆ›å»ºæµç¨‹åˆ†æ\nNovaåˆ›å»ºè™šæ‹Ÿæœºæµç¨‹åˆ†æ\nå¦‚ä½•é˜…è¯»openstackæºç \nè™šæ‹Ÿæœºåˆ›å»ºçš„50ä¸ªæ­¥éª¤å’Œ100ä¸ªçŸ¥è¯†ç‚¹\nOpenstackæºç å­¦ä¹ ä¹‹çƒ­è¿ç§»\n","permalink":"https://blog.niuhemoon.win/posts/tech/create-instance/","summary":"åˆ›å»ºè™šæ‹Ÿæœº 1ã€ç•Œé¢æˆ–å‘½ä»¤è¡Œé€šè¿‡RESTful APIå‘keystoneè·å–è®¤è¯ä¿¡æ¯ã€‚ 2ã€keystoneé€šè¿‡ç”¨æˆ·è¯·æ±‚è®¤è¯ä¿¡æ¯ï¼Œå¹¶ç”Ÿæˆauth-tokenè¿”å›ç»™å¯¹åº”çš„è®¤è¯è¯·æ±‚ã€‚ 3ã€ç•Œé¢æˆ–å‘½ä»¤è¡Œé€šè¿‡RESTful APIå‘nova-apiå‘é€ä¸€ä¸ªboot instanceçš„è¯·æ±‚ï¼ˆæºå¸¦aut","title":"openstackåˆ›å»ºè™šæ‹Ÿæœº"},{"content":" ä¸åŒå‘½ä»¤çš„åŠŸèƒ½æœ‰é‡å¤å’Œäº¤é›†\nOpenstackç¯‡ Openstackæ¯ä¸ªç»„ä»¶éƒ½æœ‰å…¶å‘½ä»¤ï¼Œopenstackç¤¾åŒºä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œå°†æ‰€æœ‰ç»„ä»¶çš„å‘½ä»¤è¿›è¡Œäº†ç»Ÿä¸€ï¼Œä»¥openstackå¼€å¤´\n# æŸ¥çœ‹æ‰€æœ‰openstackæœåŠ¡ openstack service list # æŸ¥çœ‹openstackæœåŠ¡çŠ¶æ€ openstack-service status # é‡å¯æœ¬èŠ‚ç‚¹æ‰€æœ‰openstackæœåŠ¡ openstack-service restart # openstackæœåŠ¡URLåˆ—è¡¨æŸ¥è¯¢ # endpointè¡¨ç¤ºä¸€ä¸ªæœåŠ¡åœ¨å“ªå¯è¢«è®¿é—®çš„URLå’Œç«¯å£å·åˆ—è¡¨ openstack endpoint list # æŸ¥è¯¢domainï¼Œdomainæ˜¯ä¸€ä¸ªkeystoneéªŒè¯å®ä½“ openstack domain list # æŸ¥çœ‹novaæœåŠ¡åˆ—è¡¨ openstack compute service list # æŸ¥çœ‹ç½‘ç»œæœåŠ¡åˆ—è¡¨ openstack network agent list # ======================================================= # é¡¹ç›®ï¼ˆç§Ÿæˆ·ï¼‰åˆ—è¡¨æŸ¥è¯¢ openstack project list # æŸ¥çœ‹ç§Ÿæˆ·è¯¦æƒ… openstack project show \u0026lt;project_id/name\u0026gt; # åˆ›å»ºç§Ÿæˆ· openstack project create --description \u0026#39;Admin Project\u0026#39; \u0026lt;ç§Ÿæˆ·å\u0026gt; # åˆ é™¤ç§Ÿæˆ· openstack project delete \u0026lt;ç§Ÿæˆ·id/name\u0026gt; # ç¦ç”¨å¯ç”¨ç§Ÿæˆ· openstack project set \u0026lt;ç§Ÿæˆ·id/name\u0026gt; --disable/enable # æ›´æ–°ç§Ÿæˆ·åç§° openstack project set \u0026lt;ç§Ÿæˆ·id/name\u0026gt; --name \u0026lt;new name\u0026gt; # ======================================================== # æŸ¥çœ‹æŸä¸€ä¸ªé¡¹ç›®ä¸‹æ‰€æœ‰ç”¨æˆ·user openstack user list --project=\u0026lt;project_id/name\u0026gt; # æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ· openstack user list # æŸ¥çœ‹ç”¨æˆ·è¯¦æƒ… openstack user show \u0026lt;user_name/id\u0026gt; # åˆ›å»ºç”¨æˆ· openstack user create --domain \u0026lt;åŸŸå\u0026gt; --project \u0026lt;é¡¹ç›®/ç§Ÿæˆ·å\u0026gt; --password \u0026lt;å¯†ç \u0026gt; \u0026lt;ç”¨æˆ·å\u0026gt; # åˆ é™¤ç”¨æˆ· openstack user delete \u0026lt;ç”¨æˆ·å\u0026gt; # ç¦ç”¨å¯ç”¨æŸä¸€ä¸ªç”¨æˆ· openstack user set \u0026lt;user_name/id\u0026gt; --disable/enable # æ›´æ–°ç”¨æˆ·åç§° openstack user set \u0026lt;user_name/id\u0026gt; --name \u0026lt;new name\u0026gt; # æŸ¥è¯¢æŸä¸€ç”¨æˆ·ä¸é¡¹ç›®ã€è§’è‰²çš„å…³ç³» openstack role assignment list --user=ç”¨æˆ·å # ======================================================= # è§’è‰²æŸ¥è¯¢ # ä¸€ä¸ªè§’è‰²åŒ…æ‹¬ä¸€ç»„æƒåˆ©å’Œç‰¹æƒï¼Œè§’è‰²è®¿é—®æ§åˆ¶æä¾›é¢„å®šä¹‰çš„ç”¨æˆ·å¯æ“ä½œåˆ—è¡¨ï¼Œå¦‚å¼€å¯æˆ–åœæ­¢è™šæœºï¼Œé‡ç½®å¯†ç ç­‰ã€‚åœ¨èº«ä»½éªŒè¯æœåŠ¡å’Œè®¡ç®—æœåŠ¡ä¸­å‡è¢«æ”¯æŒã€‚ openstack role list # è§’è‰²è¯¦æƒ…æŸ¥è¯¢ opensatck role show \u0026lt;role_name/id\u0026gt; # åˆ›å»ºè§’è‰² openstack role create \u0026lt;role_name\u0026gt; # åˆ†é…è§’è‰²ï¼Œå°†é¡¹ç›®å’Œç”¨æˆ·åŠ å…¥åˆ°è§’è‰²ä¸­ openstack role add --user \u0026lt;ç”¨æˆ·å\u0026gt; --project \u0026lt;é¡¹ç›®å\u0026gt; \u0026lt;è§’è‰²å\u0026gt; # åˆ é™¤è§’è‰² openstack role remove --user \u0026lt;ç”¨æˆ·å\u0026gt; --project \u0026lt;é¡¹ç›®å\u0026gt; \u0026lt;è§’è‰²å\u0026gt; # ====================================================== # åˆ—å‡ºæ‰€æœ‰çš„é•œåƒ openstack image list # æŸ¥çœ‹æŸä¸€ä¸ªé•œåƒä¿¡æ¯ openstack image show \u0026lt;image_id\u0026gt; # è®¾ç½®é•œåƒæ ‡ç­¾ openstack image set --tag \u0026lt;æ ‡ç­¾å\u0026gt; \u0026lt;image_name/id\u0026gt; # åˆ›å»ºé•œåƒ # æ ¼å¼åŒ–ç±»å‹åŒ…æ‹¬rawã€qcow2ã€vmdkç­‰ openstack image create \u0026lt;é•œåƒå\u0026gt; --file \u0026lt;é•œåƒæ–‡ä»¶å\u0026gt; --disk-format \u0026lt;æ ¼å¼åŒ–ç±»å‹\u0026gt; --container-format bare --public # openstack image create â€œtest1â€ --file cirros-0.5.1-x86_64-disk.img --disk-format qcow2 --container-format bare --public # æŸ¥çœ‹å®‰å…¨ç»„ä¿¡æ¯ openstack group list # æŸ¥çœ‹flavorç±»å‹ openstack flavor list # æŸ¥è¯¢ç½‘ç»œä¿¡æ¯ openstack network list # æŸ¥çœ‹ç«¯å£ä¿¡æ¯ï¼ˆè™šæ‹Ÿç½‘ç»œï¼‰ openstack port list # åˆ›å»ºè™šæ‹Ÿæœº openstack server create --image \u0026lt;image_id/name\u0026gt; --flavor \u0026lt;flavor_id/name\u0026gt; --nic net-id=\u0026lt;net_id\u0026gt; \u0026lt;instance_name\u0026gt; # åˆ›å»ºè™šæ‹Ÿæœºå¸®åŠ© openstack server create --help # ================================================== # æŸ¥çœ‹openstackç¯å¢ƒä¸»æœºåˆ—è¡¨ openstack host list # æŸ¥çœ‹æŸä¸ªhostä¸»æœºèµ„æºæƒ…å†µ openstack host show \u0026lt;host_name\u0026gt; # æŸ¥çœ‹è™šæ‹Ÿæœºåˆ—è¡¨ openstack server list # æŸ¥çœ‹è™šæ‹Ÿæœºè¯¦æƒ… openstack server show \u0026lt;instance_id\u0026gt; # è™šæ‹Ÿæœºæš‚åœ openstack server pause \u0026lt;instance_id\u0026gt; # è™šæ‹Ÿæœºä»æš‚åœä¸­æ¢å¤ openstack server unpause \u0026lt;instance_id\u0026gt; # è™šæ‹Ÿæœºé‡å¯ openstack server reboot \u0026lt;instance_id\u0026gt; # è™šæ‹Ÿæœºåˆ é™¤ openstack server delete \u0026lt;instance_id\u0026gt; Novaç¯‡ # æŸ¥çœ‹openstackç‰ˆæœ¬ nova-manage version # æŸ¥çœ‹å‘½ä»¤å¸®åŠ©ä¿¡æ¯ nova help \u0026lt;command\u0026gt; # è¿”å›novaæœåŠ¡æ‰€åœ¨çš„hostä¿¡æ¯ # åœ¨ç”µå­é€šä¿¡é¢†åŸŸï¼Œhostå’Œnodeçš„åŒºåˆ«åœ¨äºï¼Œhostæ˜¯å‘å¤–æä¾›æŸç§æœåŠ¡ï¼Œè€Œnodeåªéœ€è¦æ˜¯è¿æ¥åˆ°ç½‘ç»œçš„è®¾å¤‡ # è¿è¡Œæœ‰novaæœåŠ¡çš„ä¸»æœºè¢«è®¤ä¸ºæ˜¯host nova host-list # æŸ¥çœ‹hostå…·ä½“èµ„æºä¿¡æ¯ nova host-describe \u0026lt;host_name\u0026gt; # æŸ¥çœ‹novaæœåŠ¡å’ŒçŠ¶æ€ nova service-list # ======================================= # æŸ¥çœ‹è®¡ç®—èŠ‚ç‚¹ nova hypervisor-list # æŸ¥çœ‹è®¡ç®—èŠ‚ç‚¹è¯¦æƒ… nova hypervisor-show \u0026lt;hypervisor ID\u0026gt; # æŸ¥çœ‹è®¡ç®—èŠ‚ç‚¹ä¸Šçš„è™šæ‹Ÿæœº nova hypervisor-servers \u0026lt;hypervisor ID\u0026gt; # ====================================== # åˆ—å‡ºæ‰€æœ‰flavor(æ¨¡æ¿) nova flavor-list # åˆ›å»ºflavorï¼Œæ¨¡æ¿IDå»ºè®®ä¸ºauto nova flavor-create --is-public true \u0026lt;æ¨¡æ¿åç§°\u0026gt; \u0026lt;æ¨¡æ¿ID\u0026gt; \u0026lt;å†…å­˜(MB)\u0026gt; \u0026lt;ç£ç›˜(GB)\u0026gt; \u0026lt;VCPUS\u0026gt; # æ˜¾ç¤ºflavroè¯¦æƒ… nova flavor-show \u0026lt;æ¨¡æ¿ID\u0026gt; # åˆ é™¤flavor nova flavor-delet \u0026lt;æ¨¡æ¿ID\u0026gt; # ======================================= # æŸ¥çœ‹è™šæ‹Ÿæœºåˆ—è¡¨ nova list nova list --all-te # æŸ¥çœ‹è™šæ‹Ÿæœºè¯¦æƒ… nova show \u0026lt;instance_id\u0026gt; # æŸ¥çœ‹è™šæ‹Ÿæœºæ§åˆ¶å°æ—¥å¿— nova console-log \u0026lt;instance_id\u0026gt; # æŸ¥çœ‹å¯†é’¥å¯¹åˆ—è¡¨ nova keypair-list # æŸ¥çœ‹é•œåƒåˆ—è¡¨ nova image-list # æŸ¥çœ‹æµ®åŠ¨ipåˆ—è¡¨ nova floating-ip-list # æŸ¥çœ‹å®‰å…¨ç»„åˆ—è¡¨ nova secgroup-list # ===================================== # æŸ¥çœ‹æµ®åŠ¨ipåˆ—è¡¨ nova-manage floating list # æ•°æ®åº“åŒæ­¥ nova-manage db sync nova-manage api_db sync nova-manage placement sync # æŸ¥çœ‹æ•°æ®åº“ç‰ˆæœ¬ nova-manage db version # novaç»„ä»¶æ›´æ–°æ£€æŸ¥ nova-status upgrade check # ==================================== nova suspend \u0026lt;instance_id\u0026gt; nova resume \u0026lt;instance_id\u0026gt; nova start \u0026lt;instance_id\u0026gt; nova stop \u0026lt;instance_id\u0026gt; nova delete \u0026lt;instance_id\u0026gt; nova reboot \u0026lt;instance_id\u0026gt; # ç¡¬é‡å¯ nova reboot --hard \u0026lt;instance_id\u0026gt; # è¿›å…¥æ•‘æ´æ¨¡å¼ nova rescue \u0026lt;instance_id\u0026gt; # ä½¿ç”¨æŒ‡å®šé•œåƒè¿›å…¥æ•‘æ´æ¨¡å¼ nova rescue --image \u0026lt;image_id\u0026gt; \u0026lt;instance_id\u0026gt; # é‡å¯è™šæ‹Ÿæœºï¼Œç”±æ•‘æ´æ¨¡å¼è¿›å…¥æ­£å¸¸æ¨¡å¼ nova unrescue \u0026lt;instance_id\u0026gt; # é‡ç½®è™šæ‹ŸæœºçŠ¶æ€ nova reset-state \u0026lt;instance_id\u0026gt; # æŒ‡å®šèŠ‚ç‚¹çƒ­è¿ç§» nova live-migration \u0026lt;instance_id\u0026gt; \u0026lt;compute_node_id\u0026gt; # è°ƒæ•´è™šæ‹Ÿæœºèµ„æº nova resize \u0026lt;instance_id\u0026gt; \u0026lt;flavor_id\u0026gt; --poll # ç¡®è®¤è°ƒæ•´è™šæ‹Ÿæœºèµ„æº nova resize-confirm \u0026lt;instance_id\u0026gt; # èµ„æºè°ƒæ•´å¤±è´¥å›æ»š nova resize-revert \u0026lt;instance_id\u0026gt; # é€šè¿‡å¿«ç…§åˆ›å»ºä¸€ä¸ªé•œåƒ nova image-create \u0026lt;instance_id\u0026gt; \u0026lt;image_name\u0026gt; # =================================== # ä»é•œåƒåˆ›å»ºè™šæ‹Ÿæœº nova boot --image cirros --flavor 1 --nic net-name=net1 vm1 # ä»å·(å—è®¾å¤‡)åˆ›å»ºè™šæ‹Ÿæœº # 1. ä»é•œåƒç”Ÿæˆvolumn cinder create --image-id \u0026lt;image_id\u0026gt; --name \u0026lt;volume_name\u0026gt; \u0026lt;size_in_gb\u0026gt; # 2. ä»volumnåˆ›å»ºè™šæ‹Ÿæœº nova boot --flavor \u0026lt;flavor_id\u0026gt; source=volumn,,id=å·ID,dest=volume,shutdown=preserve,bootindex=0 è™šæ‹Ÿæœºåç§° # ================================== # æŒ‚è½½äº‘ç¡¬ç›˜ nova volume-attach \u0026lt;instance_id\u0026gt; \u0026lt;volume_name\u0026gt; /dev/sdb # å¸è½½äº‘ç¡¬ç›˜ nova volume-detach \u0026lt;instance_id\u0026gt; \u0026lt;volume_name\u0026gt; Neutronç¯‡ # åˆ—å‡ºå½“å‰ç§Ÿæˆ·ç½‘ç»œ neutron net-list # åˆ—å‡ºæ‰€æœ‰ç§Ÿæˆ·ç½‘ç»œ neutron net-list --all-te # æŸ¥çœ‹ç½‘ç»œè¯¦æƒ… neutron net-show \u0026lt;net_id\u0026gt; # åˆ é™¤ä¸€ä¸ªç½‘ç»œ neutron net-delete \u0026lt;net_id\u0026gt; # æŸ¥çœ‹æ‰€æœ‰agent neutron agent-list # æŸ¥çœ‹æ‰€æœ‰ç§Ÿæˆ·æ‹¥æœ‰çš„port # portæ˜¯è™šæ‹Ÿç½‘å£ï¼Œæ˜¯è·¯ç”±å™¨å’Œè™šæ‹ŸæœºæŒ‚æ¥ç½‘ç»œçš„ç€é™„ç‚¹ neutron port-list # æŸ¥çœ‹portè¯¦æƒ… neutron port-show \u0026lt;port_id\u0026gt; # æŸ¥çœ‹å®‰å…¨ç»„ neutron security-group-rule-list Glanceç¯‡ # åˆ—å‡ºå…¨éƒ¨é•œåƒ glance image-list # æŸ¥çœ‹imageå…·ä½“ä¿¡æ¯ glance show \u0026lt;image ID\u0026gt; # ä¸Šä¼ é•œåƒ glance image-create --visibility public --container-format docker/bare --disk-format raw/qcow2 --name xxx --file /root/xxx --progress glance image-create --name \u0026#34;CentOS7.0\u0026#34; --disk-format qcow2 --container-format bare --progress \u0026lt;/opt/images/centos_7-x86_64_xiandian.qcow2 Cinderç¯‡ # æ˜¾ç¤ºå­˜å‚¨åˆ—è¡¨ cinder list # æ˜¾ç¤ºå­˜å‚¨å·ç±»å‹åˆ—è¡¨ cinder type-list # åˆ›å»ºå­˜å‚¨å· cinder create --display-name VOLNAME SIZEï¼ˆSIZEçš„å•ä½ä¸ºGBï¼‰ Ceilmeterç¯‡ # æŸ¥çœ‹ç›‘æ§èµ„æº ceilometer meter-list #æŸ¥çœ‹å‘Šè­¦åˆ—è¡¨ ceilometer alarm-list # åˆ é™¤ä¸€ä¸ªå‘Šè­¦ ceilometer alarm-delete -a ALARM_ID # è·å–æŸä¸€ä¸ªå‘Šè­¦ä¿¡æ¯ ceilometer alarm-state-get ALARM_ID æœåŠ¡çŠ¶æ€ systemctl list-units | grep openstack systemctl status httpd.service # æŸ¥çœ‹Apacheçš„httpæœåŠ¡æ—¥å¿— cd /etc/httpd/logs tail -f \u0026lt;æ—¥å¿—æ–‡ä»¶\u0026gt; å‚è€ƒ Openstackå¸¸ç”¨å‘½ä»¤\nOpenstackå®˜æ–¹å¸¸ç”¨å‘½ä»¤æ‰‹å†Œ\nOpenstackå‘½ä»¤è¡Œæ“ä½œè™šæ‹Ÿæœº\nNovaå‘½ä»¤è¡Œå®˜æ–¹å‚è€ƒ\nOpenstackç”¨æˆ·æŒ‡å—\n","permalink":"https://blog.niuhemoon.win/posts/tech/openstack-command-tutorial/","summary":"ä¸åŒå‘½ä»¤çš„åŠŸèƒ½æœ‰é‡å¤å’Œäº¤é›† Openstackç¯‡ Openstackæ¯ä¸ªç»„ä»¶éƒ½æœ‰å…¶å‘½ä»¤ï¼Œopenstackç¤¾åŒºä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œå°†æ‰€æœ‰ç»„ä»¶çš„å‘½ä»¤è¿›è¡Œäº†ç»Ÿä¸€ï¼Œä»¥openstackå¼€å¤´ # æŸ¥çœ‹æ‰€æœ‰openstackæœåŠ¡ openstack service list # æŸ¥çœ‹openstackæœåŠ¡çŠ¶æ€ openstack-service status # é‡å¯æœ¬èŠ‚ç‚¹æ‰€æœ‰openstack","title":"Openstackå‘½ä»¤è¡ŒåŸºç¡€"},{"content":"ç¯å¢ƒæ­å»ºå’Œå‡†å¤‡ # æŸ¥çœ‹cpuæ˜¯å¦æ”¯æŒç¡¬ä»¶è™šæ‹ŸåŒ– grep -E -c \u0026#34;vmx|svm\u0026#34; /proc/cpuinfo sudo apt install -y qemu qemu-kvm libvirt-daemon bridge-utils virt-manager virtinst # if centos # yum install -y kvm virt-manager libvirt libvirt-python python-virtinst virt-install qemu-kvm lsmod | grep -i kvm sudo systemctl status libvirtd.service # å¦‚æœæœåŠ¡æœªå¯åŠ¨ sudo systemctl enable libvirtd --now # é…ç½®ç½‘æ¡¥ä½¿å¾—libvirtå¯ä»¥ä»å¤–éƒ¨è®¿é—® cat /etc/netplan/00-installer-config.yaml # å¯é€‰ï¼ŒGUIç®¡ç†å·¥å…· sudo apt-get install virt-manager python-spice-client-gtk ä¸‹è½½è°ƒè¯•é•œåƒï¼š ä»å®˜æ–¹åœ°å€ä¸‹è½½cirrosé•œåƒï¼Œç”¨æ¥è°ƒè¯•è™šæ‹Ÿæœºï¼Œç”¨æˆ·åå’Œå¯†ç å¦‚ä¸‹\nuser:cirros pass:cubswin:) # ä¸åŒç‰ˆæœ¬å¯†ç ä¸åŒ é€šå¸¸å°†cirrosé•œåƒæ”¾ç½®åˆ°/var/lib/libvirt/bootè·¯å¾„ä¸‹\nå¯ä»¥æŸ¥çœ‹é•œåƒä¿¡æ¯\nqemu-img info cirros-0.5.0-x86_64-disk.img è‡³æ­¤ï¼Œvrishå­¦ä¹ çš„åŸºæœ¬ç¯å¢ƒå°±æ­å»ºå®Œæˆ\nLibvirtåŸºæœ¬æ¦‚å¿µ virshå‘½ä»¤å¤§æ¦‚åˆ†ç»„\nDomain Managementï¼ˆåŸŸç®¡ç†ï¼‰ Domain Monitoringï¼ˆåŸŸç›‘æ§ï¼‰ Host and Hypervisorï¼ˆä¸»æœºåŠè™šæ‹ŸåŒ–ï¼‰ Interfaceï¼ˆç½‘å¡æ¥å£ï¼‰ Network Filterï¼ˆç½‘ç»œé˜²ç«å¢™ï¼‰ Networkingï¼ˆç½‘ç»œï¼‰ Node Deviceï¼ˆèŠ‚ç‚¹è®¾å¤‡é©±åŠ¨ï¼‰å­˜åœ¨ Secret Snapshotï¼ˆå¿«ç…§ï¼‰ Storage Poolï¼ˆå­˜å‚¨æ± æˆ–å­˜å‚¨ç­–ç•¥ï¼‰ Storage Volumeï¼ˆå­˜å‚¨å·ï¼‰ Virsh itselfï¼ˆvirsh shellè‡ªèº«ç›¸å…³ï¼‰ å®šä¹‰è¿‡çš„æˆ–è€…èƒ½å¤Ÿè¢«libvirtæ„ŸçŸ¥åˆ°çš„è™šæœºçš„é…ç½®æ–‡ä»¶éƒ½åœ¨/etc/libvirtç›®å½•ä¸‹\nè™šæ‹Ÿæœºæ–‡ä»¶å’Œå…¶å®ƒçš„ç›¸å…³æ–‡ä»¶éƒ½ä¿å­˜åœ¨ /var/lib/libvirt/ ä¸‹\né•œåƒçš„é»˜è®¤è·¯å¾„æ˜¯ /var/lib/libvirt/boot/ã€‚\nä¸Šå›¾æ—¶ä¸€ä¸ªlibvirtè™šæ‹Ÿæœºçš„ç”Ÿå‘½å‘¨æœŸå›¾ï¼Œè™šæ‹Ÿæœºåˆ†ä¸ºä¸¤ç§ï¼š\næŒä¹…æ€§çš„ çŸ­æš‚æ€§çš„ æŒä¹…æ€§è™šæ‹Ÿæœºä¼šä¸€ç›´å­˜åœ¨ï¼Œç›´åˆ°è¢«åˆ é™¤ï¼›\nçŸ­æš‚æ€§çš„è™šæ‹Ÿæœºåªæœ‰åœ¨è™šæ‹Ÿæœºè¢«å…³æœºæˆ–é‡å¯å‰å­˜åœ¨\nè™šæ‹Ÿæœºå¸¸ç”¨å‘½ä»¤ virshå’Œqemuçš„å‘½ä»¤éå¸¸å¤šï¼Œä¸‹é¢ç½—åˆ—ä¸€äº›å¸¸ç”¨çš„å‘½ä»¤\nvirsh help\t# æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯ virsh version\t# æŸ¥çœ‹qemuç‰ˆæœ¬ virsh help \u0026lt;ç‰¹å®šå‘½ä»¤\u0026gt;\t# æŸ¥çœ‹ç‰¹å®šå‘½ä»¤å¸®åŠ©ä¿¡æ¯ virsh \u0026lt;ç‰¹å®šå‘½ä»¤\u0026gt; --help\t# æŸ¥çœ‹ç‰¹å®šå‘½ä»¤å¸®åŠ©ä¿¡æ¯ virsh nodeinfo\t# æŸ¥çœ‹å®¿ä¸»æœºä¿¡æ¯ virsh uri # æŸ¥çœ‹å½“å‰ä¸»æœºhypervisoçš„è¿æ¥è·¯å¾„ï¼› virsh connect \u0026lt;hypervisor uri\u0026gt;\t# è¿æ¥åˆ°ç‰¹å®šhypervisor,é»˜è®¤qemu:///system virsh sysinfo\t# æŸ¥çœ‹hypervisroä¿¡æ¯ virsh start \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt; # å¯åŠ¨ä¸€ä¸ªä¹‹å‰å·²ç»å®šä¹‰defineè¿‡çš„è™šæ‹Ÿæœºï¼ˆdomain) virsh shutdown \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt;\t# å…³é—­è™šæ‹Ÿæœº,ç±»ä¼¼è™šæ‹Ÿæœºå†…æ‰§è¡Œå…³æœº virsh reboot \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt;\t# é‡å¯è™šæ‹Ÿæœº virsh destroy \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt;\t# å¼ºåˆ¶å…³é—­è™šæ‹Ÿæœºï¼Œç±»ä¼¼äºæ–­ç”µ virsh suspend \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt; # æŒ‚èµ·è™šæ‹Ÿæœºï¼Œå°†å½“å‰çŠ¶æ€ä¿å­˜åœ¨å†…å­˜ä¸­ virsh resume \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt;\t# æ¢å¤è™šæ‹ŸæœºæŒ‚èµ·çŠ¶æ€ï¼Œä»å†…å­˜ä¸­æ¢å¤è™šæ‹ŸæœºçŠ¶æ€ virsh save \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt; \u0026lt;imgé•œåƒæ–‡ä»¶å\u0026gt;\t# æš‚åœè™šæ‹Ÿæœºï¼Œå°†è™šæ‹ŸæœºçŠ¶æ€ä¿å­˜åœ¨ç£ç›˜é•œåƒæ–‡ä»¶ä¸­ virsh restore \u0026lt;imgé•œåƒæ–‡ä»¶å\u0026gt;\t#é‡æ–°è½½å…¥æš‚åœçš„è™šæ‹Ÿæœº virsh autostart \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt;\t# è™šæ‹Ÿæœºéšç€ç‰©ç†æœºå¯åŠ¨è‡ªåŠ¨å¯åŠ¨ virsh autostart \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt; --disable\t# ç¦æ­¢å¼€æœºå¯åŠ¨ virsh dominfo \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt;\t# æŸ¥çœ‹è™šæ‹Ÿæœºdomainä¿¡æ¯ virsh domblklist \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt;\t# åˆ—å‡ºè™šæ‹Ÿæœºæ‰€æœ‰å—å­˜å‚¨è®¾å¤‡ virsh console \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt;\t# æ§åˆ¶å°è¿æ¥è™šæ‹Ÿæœº virsh dumpxml \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt;\t# æŸ¥çœ‹è™šæ‹Ÿæœºxmlæ–‡ä»¶ virsh edit \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt;\t# ç¼–è¾‘è™šæ‹Ÿæœºxmlæ–‡ä»¶ virsh managedsave \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt;\t# ä¿å­˜çŠ¶æ€saveå¹¶å…³é—­è™šæ‹Ÿæœºï¼Œä¸‹æ¬¡å¯åŠ¨ä¼šæ¢å¤åˆ°ä¹‹å‰ä¿å­˜çš„çŠ¶æ€ virsh start \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt;\t# å¯åŠ¨å¹¶æ¢å¤managedsaveä¿å­˜çš„çŠ¶æ€ virsh reset \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt;\t# å¯¹è™šæ‹Ÿæœºæ‰§è¡Œå¼ºåˆ¶é‡å¯ï¼Œç±»ä¼¼é‡ç½®ç”µæºæŒ‰é’® virsh create \u0026lt;è™šæ‹Ÿæœºxmlæ–‡ä»¶\u0026gt; # ä»xmlæ–‡ä»¶ä¸­åˆ›å»ºdomainï¼Œåˆ›å»ºå®Œæˆåä¼šè‡ªåŠ¨å¯åŠ¨ï¼› # ä¸€ä¸ªxmlå¯¹åº”ä¸€ä¸ªdomainè™šæ‹Ÿæœº virsh define \u0026lt;è™šæ‹Ÿæœºxmlæ–‡ä»¶\u0026gt;\t# ä»xmlæ–‡ä»¶å®šä¹‰defineæ–°çš„domainï¼Œä¸ä¼šè‡ªåŠ¨å¯åŠ¨ virsh undefine \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt;\t# å¯¹äºè¿è¡Œä¸­çš„æŒä¹…æ€§è™šæ‹Ÿæœºï¼Œå°†çŠ¶æ€è½¬æ¢ä¸ºæš‚æ—¶çš„ï¼Œå…³æœºåvirshæ— æ³•æ„ŸçŸ¥å…¶å­˜åœ¨ # å¯¹äºéæ´»åŠ¨çš„è™šæ‹Ÿæœºï¼Œundefineåvirshå°†æ— æ³•æ„ŸçŸ¥å…¶å­˜åœ¨ # undefineåç£ç›˜ä¾ç„¶å­˜åœ¨ï¼Œåªæ˜¯åˆ é™¤è™šæ‹Ÿæœºçš„é…ç½®æ–‡ä»¶/etc/libvirt/qemu virsh undefine \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt; --remove-all-storage\t# åˆ é™¤è™šæ‹Ÿæœºå¹¶åˆ é™¤æ‰€æœ‰ç£ç›˜æ–‡ä»¶ virsh snapshot-create-as \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt; --name \u0026lt;å¿«ç…§åç§°\u0026gt; # ä»å‘½ä»¤è¡Œåˆ›å»ºå¿«ç…§ virsh snapshot-create \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt;\t# ä»xmlæ–‡ä»¶åˆ›å»ºå¿«ç…§ virsh snapshot-list \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt;\t# æŸ¥çœ‹è™šæ‹Ÿæœºå¿«ç…§åˆ—è¡¨ virsh snapshot-parent \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt; --current\t# æŸ¥çœ‹å½“å‰å¿«ç…§çš„ä¸Šä¸€çº§å¿«ç…§ virsh snapshot-edit \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt; --snapshotname \u0026lt;å¿«ç…§å\u0026gt;\t# ç¼–è¾‘å¿«ç…§ virsh snapshot-revert \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt; --snapshotname \u0026lt;å¿«ç…§å\u0026gt;\t# æ¢å¤å¿«ç…§ virsh snapshot-delete \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt; --snapshotname \u0026lt;å¿«ç…§å\u0026gt;\t# åˆ é™¤å¿«ç…§ virsh list\t# æŸ¥çœ‹æ´»åŠ¨è™šæ‹ŸæœºçŠ¶æ€ virsh list --all\t# æŸ¥çœ‹æ‰€æœ‰è™šæ‹ŸæœºçŠ¶æ€ virsh setvcpus \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt; 4 --maximum --config # è®¾ç½®æœ€å¤§vcpuæ•°ï¼ˆåªèƒ½ç”¨--configï¼Œä¸‹æ¬¡è¿è¡Œç”Ÿæ•ˆï¼‰ virsh setvcpus \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt; 4 --config # ä¸‹æ¬¡å¯åŠ¨ä½¿ç”¨vcpuæ•° virsh vcpuinfo \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt; # æŸ¥çœ‹vcpuä¿¡æ¯ virsh vcpupin \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt;\t# æŸ¥è¯¢åŸŸ vcpuäº²å’Œæ€§,å³vcpuå’Œç‰©ç†cpuä¹‹é—´å…³ç³» virsh maxvcpus\t# æ˜¾ç¤ºæœ¬æœºvcpuæœ€å¤§å€¼ virsh setmaxmem \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt; [--size] 2G --current # è®¾ç½®æœ€å¤§å†…å­˜é™åˆ¶å€¼ virsh setmem \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt; [--size] 2G --current # è®¾ç½®å†…å­˜åˆ†é… virsh domblklist cirros\t# æŸ¥çœ‹è™šæ‹Ÿæœºçš„å­˜å‚¨å—è®¾å¤‡ åˆ›å»ºç£ç›˜æ–‡ä»¶ #qcow2æ˜¯æ–‡ä»¶ç±»å‹ï¼Œtest1-add1.qcow2æ˜¯ç£ç›˜æ–‡ä»¶ï¼Œ5Gæ˜¯å¤§å° qemu-img create -f qcow2 /var/lib/libvirt/images/test1-add1.qcow2 5G qemu-img info \u0026lt;è™šæ‹Ÿæœºé•œåƒ\u0026gt;\t# æŸ¥çœ‹é•œåƒä¿¡æ¯ virt-install \u0026lt;å‘½ä»¤è¡Œ\u0026gt; # é€šè¿‡å‘½ä»¤è¡ŒæŒ‡å®šæ¥åˆ›å»ºè™šæ‹Ÿæœº virsh attach-disk \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt; virsh attach-device \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt; /etc/libvirt/qemu/test2-add.xml --persistent\t# ä»XMLæ–‡ä»¶é™„åŠ è®¾å¤‡ virsh detach-device \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt; /etc/libvirt/qemu/test2-add.xml --persistent\t# å¸è½½è®¾å¤‡ è™šæ‹Ÿæœºæ“ä½œå®è·µ å®éªŒ1ï¼šä¿®æ”¹è™šæ‹Ÿæœºvcpu ä¿®æ”¹è™šæ‹Ÿæœºçš„æœ€å¤§vcpuæ•°é‡ï¼Œå¯ä»¥ä¿®æ”¹maximum config å’Œcurrent configçš„å€¼\n# æŸ¥çœ‹vcpué…ç½® âœ ~ virsh vcpucount cirros maximum config 2\t# æŒ‡å®šä¸‹æ¬¡é‡å¯è™šæ‹Ÿæœºåå¯ç”¨çš„æœ€å¤§vcpuæ•°é‡ maximum live 2\t# æŒ‡å®šè¿è¡Œ/æš‚åœçŠ¶æ€ä¸‹è™šæ‹Ÿæœºå¯ç”¨çš„æœ€å¤§vcpuæ•°é‡,é‡å¯åå’Œmaximum configä¸€è‡´ current config 2\t# ä¸‹æ¬¡é‡å¯æ—¶è™šæ‹Ÿæœºä½¿ç”¨çš„vcpuæ•°é‡ current live 2\t# æ­£åœ¨è¿è¡Œçš„è™šæ‹Ÿæœºvcpuå®é™…æ•°é‡ é€šè¿‡ä¿®æ”¹xmlæ–‡ä»¶ä¿®æ”¹vcpuæ•°é‡\nvirsh edit cirros # \u0026lt;vcpu placement=\u0026#39;static\u0026#39;\u0026gt;2\u0026lt;/vcpu\u0026gt; # ä¿®æ”¹ä¸º \u0026lt;vcpu placement=\u0026#39;static\u0026#39;\u0026gt;3\u0026lt;/vcpu\u0026gt; å…³é—­å¹¶é‡æ–°å¯åŠ¨è™šæ‹Ÿæœº\nvirsh shutdown cirros virsh list --all # ç¡®è®¤å·²ç»æ˜¯shut offçŠ¶æ€ virsh start cirros å†æ¬¡æŸ¥çœ‹vcpuæ•°é‡ï¼Œå‘ç°å·²ç»æ”¹å˜\nâœ ~ virsh vcpucount cirros maximum config 3 maximum live 3 current config 3 current live 3 åŒæ ·æ–¹å¼ï¼Œä¿®æ”¹xmlæ–‡ä»¶ï¼Œæ¢å¤ä¸º2ä¸ªvcpuï¼Œæ‰§è¡Œvirsh reboot åå¹¶æ²¡é‡Šæ”¾vcpu\nâœ ~ virsh vcpucount cirros maximum config 2 maximum live 3 current config 2 current live 3 å¿…é¡»æ‰§è¡Œshutdownæˆ–è€…destoryï¼Œç„¶åé‡æ–°startæ‰èƒ½æ”¹å˜è¿è¡Œæ—¶çš„vcpu\nâœ ~ virsh vcpucount cirros maximum config 2 maximum live 2 current config 2 current live 2 è¿˜å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œä¿®æ”¹vcpuçš„å„ä¸ªé…ç½®å€¼\nâœ ~ virsh setvcpus cirros 3 --maximum --config âœ ~ virsh vcpucount cirros maximum config 3 maximum live 2 current config 2 current live 2 âœ ~ virsh setvcpus cirros 3 --config # ä¿®æ”¹current config âœ ~ virsh vcpucount cirros maximum config 3 maximum live 2 current config 3 current live 2 # é‡å¯è™šæ‹Ÿæœºä½¿å…¶ç”Ÿæ•ˆ âœ ~ virsh shutdown cirros âœ ~ virsh start cirros âœ ~ virsh vcpucount cirros maximum config 3 maximum live 3 current config 3 current live 3 åœ¨å®¿ä¸»æœºä¸Šæ— æ³•è®¾ç½®vcpuçš„current liveå°äºcurrent configï¼Œåªèƒ½åœ¨è™šæ‹Ÿæœºå†…éƒ¨æ‰§è¡ŒchcpuæŒ‡ä»¤æ¥ä¿®æ”¹ï¼Œä½¿å¾—vcpuç¦»çº¿\nä¹Ÿå¯ä»¥å°†æœ€å¤§å¯ç”¨vcpuè®¾ç½®è¾ƒå¤§ï¼Œæ–¹ä¾¿åç»­åœ¨è™šæ‹Ÿæœºè¿è¡Œæ—¶å¯ä»¥åŠ¨æ€è°ƒæ•´vcpuçš„æ•°é‡\nâœ ~ virsh setvcpus cirros 5 --maximum --config âœ ~ virsh setvcpus cirros 2 --config âœ ~ virsh shutdown cirros âœ ~ virsh start cirros âœ ~ virsh vcpucount cirros maximum config 5 maximum live 5 current config 2 current live 2 âœ ~ virsh setvcpus cirros 3\t# åŠ¨æ€è°ƒæ•´vcpuæ•°é‡ï¼Œè°ƒæ•´èŒƒå›´[current configï¼Œæ¯”maximum config] âœ ~ virsh vcpucount cirros maximum config 5 maximum live 5 current config 2 current live 3 âœ ~ virsh setvcpus cirros 2\tâœ ~ virsh vcpucount cirros maximum config 5 maximum live 5 current config 2 current live 2 âœ ~ virsh vcpuinfo cirros\t# æŸ¥çœ‹vcpuè¿è¡ŒçŠ¶æ€ å®éªŒ2ï¼šä¿®æ”¹è™šæ‹Ÿæœºçš„å†…å­˜ é€šè¿‡ä¿®æ”¹xmlé…ç½®æ–‡ä»¶å¹¶é‡æ–°å¯åŠ¨è™šæ‹Ÿæœº\n# ä¿®æ”¹é¡¹ï¼Œä¿®æ”¹å®Œæˆå \u0026lt;memory unit=\u0026#39;KiB\u0026#39;\u0026gt;462144\u0026lt;/memory\u0026gt;\t# å¯åŠ¨åæœ€å¤§å…è®¸å¯ç”¨å†…å­˜ \u0026lt;currentMemory unit=\u0026#39;KiB\u0026#39;\u0026gt;262144\u0026lt;/currentMemory\u0026gt;# å¯åŠ¨æ—¶ä½¿ç”¨çš„å†…å­˜å¤§å° åœ¨æœ€å¤§å¯ç”¨å†…å­˜èŒƒå›´å†…ï¼Œå¯ä»¥åœ¨è™šæ‹Ÿæœºè¿è¡Œæ—¶è°ƒæ•´å†…å­˜ä½¿ç”¨\nè™šæ‹Ÿæœºæœ€å¤§å†…å­˜åªèƒ½åœ¨è™šæ‹Ÿæœºå…³é—­çŠ¶æ€æ›´æ”¹ï¼Œé‡å¯åç”Ÿæ•ˆ\nä½¿ç”¨virsh setmaxmemå‘½ä»¤ï¼Œå’Œç›´æ¥ä¿®æ”¹xmlæ–‡ä»¶ç­‰æ•ˆ\nâœ ~ virsh dominfo cirros | grep memory # è™šæ‹Ÿæœºå¯åŠ¨æ—¶æ˜¾ç¤ºçš„used memoryä¸å‡†ç¡® Max memory: 462144 KiB Used memory: 262144 KiB âœ ~ virsh setmem cirros 300000 âœ ~ virsh dominfo cirros | grep memory Max memory: 462144 KiB Used memory: 300000 KiB âœ ~ virsh shutdown cirros âœ ~ virsh setmaxmem cirros 700000 å®éªŒ3ï¼šè°ƒæ•´è™šæ‹Ÿæœºçš„ç£ç›˜ è™šæ‹Ÿæœºæ”¯æŒåœ¨è™šæ‹Ÿæœºå¼€æœºæ—¶åŠ¨æ€æŒ‚è½½æ–°çš„ç£ç›˜\nâœ ~ qemu-img create -f qcow2 -o size=20M,preallocation=metadata /var/lib/libvirt/boot/second.qcow2 Formatting \u0026#39;/var/lib/libvirt/boot/second.qcow2\u0026#39;, fmt=qcow2 size=20971520 cluster_size=65536 preallocation=metadata lazy_refcounts=off refcount_bits=16 âœ ~ qemu-img info /var/lib/libvirt/boot/second.qcow2 image: /var/lib/libvirt/boot/second.qcow2 file format: qcow2 virtual size: 20 MiB (20971520 bytes) disk size: 260 KiB cluster_size: 65536 Format specific information: compat: 1.1 lazy refcounts: false refcount bits: 16 corrupt: false virsh attach-disk cirros /images/cirros/second.qcow2 vda --targetbus virtio # å¸è½½ç£ç›˜ï¼ˆå‰ææ—¶æ²¡æœ‰åˆ†åŒºæˆ–è€…æŒ‚è½½ virsh detach-disk 26 vda ä¹Ÿå¯ä»¥æ‰‹åŠ¨ä¿®æ”¹xmlæ–‡ä»¶ï¼Œç„¶åé‡å¯è™šæ‹Ÿæœº\n# é¦–å…ˆåˆ›å»ºä¸€ä¸ªqcow2ç£ç›˜æˆ–è€…rawç£ç›˜ # ddå‘½ä»¤åˆ›å»ºä¸€ä¸ªéç¨€ç–çš„ç£ç›˜ dd if=/dev/zero of=/vm-images/vm1-add.img bs=1M count=1024 # åœ¨xmlæ–‡ä»¶ä¸­åŠ å…¥ä¸€ä¸ªæ–°çš„xmlæ®µ \u0026lt;disk type=\u0026#39;file\u0026#39; device=\u0026#39;disk\u0026#39;\u0026gt; \u0026lt;driver name=\u0026#39;qemu\u0026#39; type=\u0026#39;raw\u0026#39; cache=\u0026#39;none\u0026#39; io=\u0026#39;threads\u0026#39;/\u0026gt; \u0026lt;source file=\u0026#39;/vm-images/vm1-add.img\u0026#39;/\u0026gt; \u0026lt;target dev=\u0026#39;vdb\u0026#39; bus=\u0026#39;virtio\u0026#39;/\u0026gt; \u0026lt;address type=\u0026#39;pci\u0026#39; domain=\u0026#39;0x0000\u0026#39; bus=\u0026#39;0x00\u0026#39; slot=\u0026#39;0x06\u0026#39; function=\u0026#39;0x0\u0026#39;/\u0026gt; \u0026lt;/disk\u0026gt; å®éªŒ4ï¼šåˆ›å»ºè™šæ‹Ÿæœº virt-install --name=cirros --ram=256 --vcpus=1 --disk path=/var/lib/libvirt/boot/cirros-0.5.0-x86_64-disk.img,format=qcow2 --import --network network:default --vnc --vncport=5920 # ä¹Ÿå¯ä»¥é€šè¿‡xmlæ–‡ä»¶æ¥åˆ›å»º å®éªŒ5ï¼šå¤åˆ¶è™šæ‹Ÿæœº å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œå¤åˆ¶ä¸€ä¸ªè™šæ‹Ÿæœºï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ‹·è´å¹¶ä¿®æ”¹é…ç½®æ–‡ä»¶å’Œå­˜å‚¨å·æ–‡ä»¶è¿›è¡Œå¤åˆ¶\n# é€šè¿‡virt-cloneå‘½ä»¤å¤åˆ¶ # virt-clone -o \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt; -n \u0026lt;æ–°è™šæ‹Ÿæœºåç§°\u0026gt; -f /var/lib/libvirt/images/test4.qcow2 # qcow2ç£ç›˜ä¸éœ€è¦é¢„å…ˆåˆ›å»ºï¼Œåˆ›å»ºå®Œæˆåéœ€è¦è¿›è™šæ‹Ÿæœºæ‰‹åŠ¨æ”¹å˜ipåœ°å€å’Œç”¨æˆ·å âœ ~ virt-clone -o cirros -n cirros1 -f /var/lib/libvirt/boot/cirros1.qcow2 # è‡ªåŠ¨ç”Ÿäº§ä¸ä¸€æ ·çš„macåœ°å€å’Œuuid âœ ~ diff cirros.xml cirros1.xml \u0026lt; \u0026lt;name\u0026gt;cirros\u0026lt;/name\u0026gt; \u0026lt; \u0026lt;uuid\u0026gt;874fe199-47ea-45d1-a25d-98d0535dddb3\u0026lt;/uuid\u0026gt; --- \u0026gt; \u0026lt;name\u0026gt;cirros1\u0026lt;/name\u0026gt; \u0026gt; \u0026lt;uuid\u0026gt;fba2f776-432d-4870-a7ec-bbf73fa1b086\u0026lt;/uuid\u0026gt; 39c39 \u0026lt; \u0026lt;source file=\u0026#39;/var/lib/libvirt/boot/cirros-0.5.0-x86_64-disk.img\u0026#39;/\u0026gt; --- \u0026gt; \u0026lt;source file=\u0026#39;/var/lib/libvirt/boot/cirros1.qcow2\u0026#39;/\u0026gt; 63c63 \u0026lt; \u0026lt;mac address=\u0026#39;52:54:00:fa:5c:d3\u0026#39;/\u0026gt; --- \u0026gt; \u0026lt;mac address=\u0026#39;52:54:00:29:8d:06\u0026#39;/\u0026gt; 81c81 \u0026lt; \u0026lt;graphics type=\u0026#39;vnc\u0026#39; port=\u0026#39;5921\u0026#39; autoport=\u0026#39;no\u0026#39;\u0026gt; --- \u0026gt; \u0026lt;graphics type=\u0026#39;vnc\u0026#39; port=\u0026#39;-1\u0026#39; autoport=\u0026#39;yes\u0026#39;\u0026gt; #virt-clone -fæŒ‡å®šçš„æ–‡ä»¶ä¸è¦äº‹å…ˆåˆ›å»ºï¼Œå¦‚æœæœ‰å¤šä¸ªç£ç›˜æ–‡ä»¶å°±ç”¨å¤šä¸ª-fé€‰é¡¹ å¦‚ virt-clone -o \u0026lt;è™šæ‹Ÿæœºåç§°\u0026gt; -n \u0026lt;æ–°è™šæ‹Ÿæœºåç§°\u0026gt; -f /home/lib/libvirt/images/test4.qcow2 -f /mnt/images/test4-add1.qcow2 å¯ä»¥æ‰‹åŠ¨å¤åˆ¶xmlæ–‡ä»¶å’Œç£ç›˜é•œåƒæ¥å¤åˆ¶\nâœ qemu cp cirros.xml cirros3.xml # ä¿®æ”¹xmlæ–‡ä»¶ä¸­çš„domain nameå’Œmacåœ°å€ç­‰ä¿¡æ¯ âœ qemu vim cirros3.xml âœ qemu cd /var/lib/libvirt/boot # åœ¨defineæ–°çš„å…‹éš†è™šæ‹Ÿæœºä¹‹å‰å‡†å¤‡å¥½æ‰€éœ€çš„ç£ç›˜ âœ boot cp cirros-0.5.0-x86_64-disk.img cirros3.img âœ boot qemu-img info cirros3.img image: cirros3.img file format: qcow2 virtual size: 112 MiB (117440512 bytes) disk size: 198 MiB cluster_size: 65536 Snapshot list: ID TAG VM SIZE DATE VM CLOCK 1 1603292226 101 MiB 2020-10-21 22:57:06 94:39:31.435 Format specific information: compat: 1.1 lazy refcounts: false refcount bits: 16 corrupt: false âœ ~ virsh define /etc/libvirt/qemu/cirros3.xml Domain cirros3 defined from /etc/libvirt/qemu/cirros3.xml âœ ~ virsh list --all Id Name State -------------------------- 2 cirros running - cirros3 shut off âœ ~ virsh start cirros3 Domain cirros3 started # æ­¤æ—¶ï¼Œä¸€ä¸ªæ–°çš„å…‹éš†è™šæ‹Ÿæœºå°±åˆ›å»ºå®Œæˆ # éœ€è¦æ‰‹åŠ¨ä¿®æ”¹IPå’Œhostname å®éªŒ6ï¼šè¯¯åˆ è™šæ‹Ÿæœºæ¢å¤ # è¯¯åˆ é™¤è™šæ‹Ÿæœº âœ ~ virsh undefine cirros1 Domain cirros1 has been undefined âœ ~ virsh dominfo cirros1 Id: 1 Name: cirros1 UUID: fba2f776-432d-4870-a7ec-bbf73fa1b086 OS Type: hvm State: running CPU(s): 2 CPU time: 41.7s Max memory: 700416 KiB Used memory: 262144 KiB Persistent: no\t# å·²ç»å˜ä¸ºéæŒä¹…åŒ–çš„ï¼Œæ— æ³•é‡æ–°å¯åŠ¨ Autostart: disable Managed save: no Security model: apparmor Security DOI: 0 Security label: libvirt-fba2f776-432d-4870-a7ec-bbf73fa1b086 (enforcing) âœ ~ virsh shutdown cirros1 # å…³æœºåå†ä¹Ÿå¯åŠ¨ä¸äº†äº† âœ ~ ls /etc/libvirt/qemu # cirros1çš„xmlæ–‡ä»¶å·²ç»ä¸å­˜åœ¨ âœ ~ ls /var/lib/libvirt/boot # cirros1çš„qcow2é•œåƒä»ç„¶å­˜åœ¨ # éœ€è¦åœ¨å…³é—­è™šæ‹Ÿæœºä¹‹å‰ï¼Œé‡æ–°å®šä¹‰defineä¸€ä¸ªé…ç½®æ–‡ä»¶å³å¯æ¢å¤ virsh dumpxml centos-C \u0026gt; /etc/libvirt/qemu/centos-C.xml virsh define /etc/libvirt/qemu/centos-C.xml # å¦‚æœæ˜¯åœ¨å…³é—­ç€çš„æœåŠ¡å™¨ä¸Šæ‰§è¡Œçš„virsh undefine centos-C åˆ é™¤å‘½ä»¤ï¼Œåˆ™ä¼šæŠŠå¯¹åº”çš„é…ç½®æ–‡ä»¶æ¸…ç©ºï¼Œè™šæ‹Ÿæœºå†ä¹Ÿå¯åŠ¨ä¸äº†ï¼Œé‡æ–°å®šä¹‰ä¹Ÿä¸è¡Œ å¯¹äº å‚è€ƒ åœ¨ Ubuntu çš„ KVM ä¸­å®‰è£… Windows ç³»ç»Ÿ\nvirshä½¿ç”¨æ€»ç»“\nkvmç®¡ç†å’ŒåŸºç¡€å‘½ä»¤\nkvmå‘½ä»¤æ€»ç»“å’Œè™šæœºå™¨å¤‡ä»½è¿ç§»\nHow to Install KVM on Ubuntu 20.04 LTS Server (Focal Fossa)\nLibvirtè™šæ‹Ÿæœºç”Ÿå‘½å‘¨æœŸ\nModify cpu number ","permalink":"https://blog.niuhemoon.win/posts/tech/virsh-tutorial/","summary":"ç¯å¢ƒæ­å»ºå’Œå‡†å¤‡ # æŸ¥çœ‹cpuæ˜¯å¦æ”¯æŒç¡¬ä»¶è™šæ‹ŸåŒ– grep -E -c \u0026#34;vmx|svm\u0026#34; /proc/cpuinfo sudo apt install -y qemu qemu-kvm libvirt-daemon bridge-utils virt-manager virtinst # if centos # yum install -y kvm virt-manager libvirt libvirt-python python-virtinst virt-install qemu-kvm lsmod | grep -i kvm sudo systemctl status libvirtd.service # å¦‚æœæœåŠ¡æœªå¯åŠ¨ sudo systemctl enable libvirtd --now # é…ç½®ç½‘æ¡¥ä½¿å¾—libvirtå¯ä»¥ä»å¤–éƒ¨è®¿é—® cat /etc/netplan/00-installer-config.yaml # å¯é€‰ï¼ŒGUIç®¡ç†å·¥å…· sudo apt-get install virt-manager python-spice-client-gtk ä¸‹è½½è°ƒè¯•é•œåƒï¼š ä»å®˜æ–¹åœ°å€ä¸‹è½½cirrosé•œåƒï¼Œç”¨æ¥è°ƒè¯•è™š","title":"Virshå‘½ä»¤å’Œè™šæ‹Ÿæœº"},{"content":" Tcpdumpæ˜¯ä¸€ä¸ªlinuxå‘½ä»¤è¡Œçš„æŠ“åŒ…å·¥å…·ï¼Œå¯ä»¥æŠ“å–TCP/IPå’Œå…¶ä»–æ•°æ®åŒ…ï¼Œå¦‚UDP,ARP,ICMPï¼Œå¯ä»¥ä½¿ç”¨è¿‡æ»¤å™¨è¿‡æ»¤å‡ºæƒ³è¦çš„åŒ…ã€‚\næŠ“å–ç‰¹å®šæ¥å£ä¸Šçš„åŒ… å½“ä½¿ç”¨tcpdumpä¸åŠ ä»»ä½•å‚æ•°ï¼Œå°†åˆ†ææ‰€æœ‰æ¥å£ä¸Šçš„æ•°æ®åŒ…ã€‚\nsudo tcpdump å¯ä»¥ä½¿ç”¨-ié€‰é¡¹æŒ‡å®šç‰¹å®šæ¥å£\nå¯ä»¥ä½¿ç”¨-cé€‰é¡¹é™åˆ¶æ•°æ®åŒ…çš„ä¸ªæ•°\nsudo tcpdump -i wlp2s0 -c 10 æŠ“å–ç‰¹å®šä¸»æœºçš„æ•°æ®åŒ… å¯ä»¥ä½¿ç”¨-hosté€‰é¡¹æŒ‡å®šå’Œç‰¹å®šä¸»æœºç›¸å…³çš„æ•°æ®åŒ…\nsudo tcpdump -i ens160 -c 5 -ttttnnvvS host 14.249.62.219 é€šè¿‡æŒ‡å®šç«¯å£æŠ“åŒ… å¯ä»¥æŒ‡å®šæ¥å£çš„ç«¯å£è¿›è¡ŒæŠ“åŒ…ï¼Œä¹Ÿå¯ä»¥æŠ“å–ç‰¹å®šæ¥å£ä»¥å¤–çš„æ•°æ®åŒ…\n# æŠ“å–22ç«¯å£æ•°æ®åŒ… sudo tcpdump -i ens160 -c 5 -nn port 22 # æŠ“å–22ç«¯å£ä»¥å¤–æ•°æ®åŒ… sudo tcpdump -i ens160 -nn not port 22 # æŒ‡å®šç«¯å£å·çš„èŒƒå›´ sudo tcpdump -i ens160 -c 3 -nns 0 portrange 20-23 æŠ“å–ç‰¹å®šä»£ç†çš„æ•°æ®åŒ… sudo tcpdump -i ens160 -c 5 -nn tcp ä¿å­˜æŠ“åŒ…æ—¥å¿— ä½¿ç”¨-sé€‰é¡¹æ¥æŒ‡å®šæ¯ä¸ªæ•°æ®åŒ…ä¿å­˜çš„é•¿åº¦ï¼Œé»˜è®¤ä¿å­˜68ä¸ªå­—èŠ‚ï¼Œå‰©ä½™å­—èŠ‚è¢«å¿½ç•¥ï¼ŒæŒ‡å®š0è¡¨ç¤ºå®Œæ•´ä¿å­˜ã€‚\nsudo tcpdump -i ens160 -c 5 -nn tcp -w packets-record.pcap -s 0 è¯»å–tcpdumpè®°å½•æ–‡ä»¶ æ›´å¸¸ç”¨çš„æ˜¯ä½¿ç”¨wiresharkè½¯ä»¶åˆ†æ\nsudo tcpdump -r packets-record.pcap è¿‡æ»¤ç‰¹å®šæºå¤´çš„æ•°æ®åŒ… ä½¿ç”¨srcé€‰é¡¹æŒ‡å®šæ¥è‡ªç‰¹å®šæºIPçš„æ•°æ®åŒ…\nä½¿ç”¨dsté€‰é¡¹æŒ‡å®šç‰¹å®šç›®çš„IPçš„æ•°æ®åŒ…\nsudo tcpdump src 100.9.8.40 sudo tcpdump dst 14.249.62.219 æŠ“å–ç‰¹å®šç½‘æ®µçš„æ•°æ®åŒ… ä½¿ç”¨-neté€‰é¡¹æŒ‡å®šincoming/outgoingç‰¹å®šç½‘æ®µçš„æ•°æ®åŒ…\nsudu tcpdump net 192.169.0.0/24 æŒ‡å®šæ•°æ®åŒ…æ ¼å¼ # 16è¿›åˆ¶æ ¼å¼ sudo tcpdump -X -i eth0 # Asciiç æ ¼å¼ sudo tcpdump -A -i eth0 æŠ“å–IPV6åŒ… sudo tcpdump -nn ip6 proto 6 è¿‡æ»¤Httpçš„User Agent ä»httpè¯·æ±‚å¤´ä¸­è¿‡æ»¤å‡ºuser agentå’Œhostä¿¡æ¯\nsudo tcpdump -nn -A -s1500 -l | egrep -i \u0026#39;User-Agent:|Host:\u0026#39; è¿‡æ»¤cookieä¿¡æ¯\nsudo tcpdump -nn -A -s0 -l | egrep -i \u0026#39;Set-Cookie|Host:|Cookie:\u0026#39; åˆ—å‡ºå¯é€‰çš„æ¥å£ sudo tcpdump -D å¾ªç¯å†™å…¥æŠ“åŒ…æ–‡ä»¶ å¯¹äºé•¿æ—¶é—´çš„æŠ“åŒ…ï¼Œä¸ºäº†é˜²æ­¢å•ä¸ªæ–‡ä»¶è¿‡å¤§ï¼Œæ¯30åˆ†é’Ÿï¼ˆ1800ç§’ï¼‰å†™å…¥ä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œæ–‡ä»¶å¤§å°é™åˆ¶ä¸º100Mï¼Œæ–‡ä»¶ä¸ªæ•°çš„24ä¸ª\nsudo tcpdump -i ens160 -w /tmp/network-%H-%M.pcap -W 24 -G 1800 -C 100 Tcpdumpé€‰é¡¹ -i \u0026lt;interface\u0026gt;: ç›‘å¬ç‰¹å®šæ¥å£ -n: Donâ€™t resolve hostnames. You can use -nn to donâ€™t resolve hostnames or port names. -t: Print human-readable timestamp on each dump line, -tttt: Give maximally human-readable timestamp output. -X: ä»¥asciiå’Œåå…­è¿›åˆ¶ä¸¤ç§æ ¼å¼æ˜¾ç¤ºæ•°æ®åŒ…å†…å®¹ -v, -vv, -vvv: å¢åŠ è·å–æ•°æ®åŒ…çš„æ•°é‡ -c N: åªè·å–Nä¸ªæ•°æ®åŒ…ç„¶ååœæ­¢ -s: Define the snaplength (size) of the capture in bytes. Use -s0 to get everything, unless you are intentionally capturing less. -S: æ‰“å°ç»å¯¹åºåˆ—å· -q: æ˜¾ç¤ºè¾ƒå°‘çš„åè®®ä¿¡æ¯ -w \u0026lt;file name\u0026gt;: å°†åŸå§‹æ•°æ®åŒ…å†™å…¥æ–‡ä»¶ é€»è¾‘è¿ç®—ç¬¦å· Tcpdumpæ”¯æŒæ›´ç²¾ç¡®çš„è¿‡æ»¤ï¼Œä½¿ç”¨and/or/notè¿™ç§é€»è¾‘è¿ç®—ã€‚\næŠ“å–æ¥è‡ª 10.20.0.0/16 ç½‘æ®µï¼Œå¹¶ä¸”ç›®çš„åœ°å€æ˜¯10.30.0.0/16 ç½‘æ®µçš„æ•°æ®åŒ…ï¼Œä½¿ç”¨ä¾¿äºé˜…è¯»çš„æ—¶é—´æˆ³ï¼Œ ä¸æ±‚è§£ä¸»æœºåå’Œç«¯å£å·ï¼Œåå‘è¾“å‡ºå¹¶ä½¿ç”¨ç»å¯¹åºå·ã€‚\nCapture traffic coming from 10.20.0.0/16 and going to the network 10.30.0.0/16 with showing human-readable timestamps (tt), with no resolution of hostnames or port numbers (nn), verbose output (vv) and using absolute sequence numbers (S):\n$ sudo -ttnnvvS tcpdump src net 10.20.0.0/16 and dst net 10.30.0.0/16 Display traffic from source 192.168.0.10 which is not UDP protocol:\n$ sudo tcpdump src 192.168.0.10 and src net and not udp To capture arp or ping traffic for a specific host and save the output to a file named packetfile.txt:\n$ sudo tcpdump -nnti eth0 arp or icmp and host 192.168.0.1 -w packetfile.txt Tcpdump è¾“å‡ºæ ¼å¼ æˆªå–ä¸€è¡Œè¾“å‡ºï¼Œåˆ†æå…¶è¾“å‡ºçš„æ ¼å¼\n10:31:13.440803 IP Ubuntu.ssh \u0026gt; 117.6.129.86.50736: Flags [P.], seq 188:400, ack 1, win 501, options [nop,nop,TS val 468736347 ecr 335665367], length 212 å…¶ä¸­:\n10:31:13.401128 - æœ¬åœ°æ•°æ®åŒ…è¢«æŠ“å–çš„æ—¶é—´\nIP - è¡¨ç¤ºæ•°æ®åŒ…æ˜¯IPV4åè®®çš„\nUbuntu.ssh - æ ‡è¯†æºIPåœ°å€æˆ–è€…ä¸»æœºå ï¼Œ.ssh è¡¨ç¤ºç«¯å£ï¼Œè¿™é‡Œæ—¶22ç«¯å£\n117.6.129.86.50376 - è¡¨ç¤ºæ•°æ®åŒ…çš„ç›®çš„IPåœ°å€ ï¼Œä½¿ç”¨.åˆ†å‰²ç«¯å£å·\næ ‡å¿—ä½ï¼š\n[P.] - This is TCP flags field.\n[.] - ACK (Acknowledgment).\n[S] - SYN (Start Connection).\n[P] - PSH (Push Data).\n[F] - FIN (Finish Connection).\n[R] - RST (Reset Connection).\n[S.] - SYN-ACK (SynAcK Packet).\nseq 188:400 - åºåˆ—å·è¡¨ç¤ºè¯¥æ•°æ®åŒ…åŒ…å«åºåˆ—æ˜¯188-400å­—èŠ‚çš„æ•°æ®\nwin 501 - çª—å£å¤§å°ï¼Œè¡¨ç¤ºæ¥å—ç¼“å†²åŒºä¸­å¯ç”¨çš„å­—èŠ‚\noptions [nop,nop,TS val 468736347 ecr 335665367] - These are TCP options such as the MSS (Maximum Segment Size) or Window Scale. You can refer more about TCP protocol options.\nlength 212 - è¡¨ç¤ºæ•°æ®åŒ…ä¸­payloadæ•°æ®çš„å­—èŠ‚\nå‚è€ƒ TcpdumpåŸºæœ¬ä½¿ç”¨\n","permalink":"https://blog.niuhemoon.win/posts/tech/tcpdump-usage/","summary":"Tcpdumpæ˜¯ä¸€ä¸ªlinuxå‘½ä»¤è¡Œçš„æŠ“åŒ…å·¥å…·ï¼Œå¯ä»¥æŠ“å–TCP/IPå’Œå…¶ä»–æ•°æ®åŒ…ï¼Œå¦‚UDP,ARP,ICMPï¼Œå¯ä»¥ä½¿ç”¨è¿‡æ»¤å™¨è¿‡æ»¤å‡ºæƒ³è¦çš„åŒ…ã€‚ æŠ“å–ç‰¹å®šæ¥å£ä¸Šçš„åŒ… å½“ä½¿ç”¨tcpdumpä¸åŠ ä»»ä½•å‚æ•°ï¼Œå°†åˆ†ææ‰€æœ‰æ¥å£ä¸Šçš„æ•°æ®åŒ…ã€‚ sudo tcpdump å¯ä»¥ä½¿ç”¨-ié€‰é¡¹æŒ‡å®šç‰¹å®šæ¥å£ å¯ä»¥ä½¿ç”¨-cé€‰é¡¹é™åˆ¶æ•°æ®åŒ…çš„ä¸ª","title":"tcpdumpçš„åŸºæœ¬ä½¿ç”¨ã€è¯‘ã€‘"},{"content":"ç®€ä»‹ Linuxä¸Šå¯¹ç³»ç»Ÿè¿›è¡Œæ€§èƒ½æ£€æµ‹çš„å·¥å…·éå¸¸å¤šï¼Œæœ¬æ–‡ä»‹ç»ä¸€äº›å¸¸ç”¨å·¥å…·çš„ä½¿ç”¨\næ€§èƒ½è§‚æµ‹å·¥å…·\nâ–ª é¦–å…ˆå­¦ä¹ çš„Basic Toolæœ‰å¦‚ä¸‹ï¼š uptimeã€top(htop)ã€mpstatã€isstatã€vmstatã€freeã€pingã€nicstatã€dstatã€‚\nâ–ª é«˜çº§çš„å‘½ä»¤å¦‚ä¸‹ï¼š sarã€netstatã€pidstatã€straceã€tcpdumpã€blktraceã€iotopã€slabtopã€sysctlã€/procã€‚\næ€§èƒ½è§‚æµ‹å·¥å…·sar\nsar\n# install sudo apt install sysstat # usage sar -u 2 3 sar -u -f /var/log/sa/sa05 sar -P ALL 1 1 sar -r 1 3 sar -W 1 3 top\näº¤äº’æ¨¡å¼çš„ä¸€äº›å¿«æ·æ“ä½œ: å…¨å±€å‘½ä»¤: \u0026lt;å›è½¦/ç©ºæ ¼\u0026gt; ?, =, A, B, d, G, h, I, k, q, r, s, W, Z ç»Ÿè®¡åŒºçš„å‘½ä»¤: l, m, t, 1 ä»»åŠ¡åŒºçš„å‘½ä»¤ï¼š å¤–è§‚: b, x, y, z å†…å®¹: c, f, H, o, S, u å¤§å°: #, i, n æ’åº: \u0026lt;, \u0026gt;, F, O, R è‰²å½©æ–¹æ¡ˆ: \u0026lt;Ret\u0026gt;, a, B, b, H, M, q, S, T, w, z, 0 - 7 çª—å£å‘½ä»¤: -, _, =, +, A, a, G, g, w Press \u0026#39;h\u0026#39; or \u0026#39;?\u0026#39; for help with Windows, Type \u0026#39;q\u0026#39; or \u0026lt;Esc\u0026gt; to continue å¦‚æœè¿™ä¸ªæ•°é™¤ä»¥é€»è¾‘CPUçš„æ•°é‡ï¼Œç»“æœé«˜äº5çš„æ—¶å€™å°±è¡¨æ˜ç³»ç»Ÿåœ¨è¶…è´Ÿè·è¿è½¬äº†ï¼ï¼ï¼ï¼ï¼\n9. netstat - æ˜¾ç¤ºå¼€æ”¾çš„ç«¯å£å’Œè¿æ¥ å®ƒæ˜¯Linuxç®¡ç†å‘˜ä½¿ç”¨æ¥æ˜¾ç¤ºå„ç§ç½‘ç»œä¿¡æ¯çš„å·¥å…·ï¼Œå¦‚æŸ¥çœ‹ä»€ä¹ˆç«¯å£å¼€æ”¾å’Œä»€ä¹ˆç½‘ç»œè¿æ¥å·²ç»å»ºç«‹ä»¥åŠä½•ç§è¿›ç¨‹è¿è¡Œåœ¨è¯¥è¿æ¥ä¹‹ä¸Šã€‚åŒæ—¶å®ƒä¹Ÿæ˜¾ç¤ºäº†ä¸åŒç¨‹åºé—´æ‰“å¼€çš„Unixå¥—æ¥å­—çš„ä¿¡æ¯ã€‚ä½œä¸ºå¤§å¤šæ•°Linuxå‘è¡Œç‰ˆæœ¬çš„ä¸€éƒ¨åˆ†ï¼Œnetstatçš„è®¸å¤šå‘½ä»¤åœ¨netstatå’Œå®ƒçš„ä¸åŒè¾“å‡ºä¸­æœ‰è¯¦ç»†çš„æè¿°ã€‚æœ€ä¸ºå¸¸ç”¨çš„å¦‚ä¸‹ï¼š\nnetstat | head -20 netstat -r netstat -rC netstat -i netstat -ie netstat -s netstat -g netstat -tapn vmstatæ˜¯è™šæ‹Ÿå†…å­˜(virtual memory statistics)çš„ç¼©å†™ï¼Œä½œä¸ºä¸€ä¸ªå†…å­˜ç›‘æ§å·¥å…·ï¼Œå®ƒæ”¶é›†å’Œæ˜¾ç¤ºå…³äºå†…å­˜ï¼Œè¿›ç¨‹ï¼Œç»ˆç«¯å’Œåˆ†é¡µå’ŒI/Oé˜»å¡çš„æ¦‚æ‹¬ä¿¡æ¯ã€‚ä½œä¸ºä¸€ä¸ªå¼€æºç¨‹åºï¼Œå®ƒå¯ä»¥åœ¨å¤§éƒ¨åˆ†Linuxå‘è¡Œç‰ˆæœ¬ä¸­æ‰¾åˆ°ï¼ŒåŒ…æ‹¬Solariså’ŒFreeBSDã€‚å®ƒç”¨æ¥è¯Šæ–­å¤§éƒ¨åˆ†çš„å†…å­˜æ€§èƒ½é—®é¢˜å’Œå…¶ä»–ç›¸å…³é—®é¢˜ã€‚\nè®©æˆ‘ä»¬çœ‹ä¸‹å¦‚ä½•äº†è§£vmstatæä¾›çš„ä¿¡æ¯ï¼š\n----------------------------- procséƒ¨åˆ†çš„è§£é‡Š r åˆ—è¡¨ç¤ºè¿è¡Œå’Œç­‰å¾…cpuæ—¶é—´ç‰‡çš„è¿›ç¨‹æ•°ï¼Œå¦‚æœé•¿æœŸå¤§äº1ï¼Œè¯´æ˜cpuä¸è¶³ï¼Œéœ€è¦å¢åŠ cpuã€‚ b åˆ—è¡¨ç¤ºåœ¨ç­‰å¾…èµ„æºçš„è¿›ç¨‹æ•°ï¼Œæ¯”å¦‚æ­£åœ¨ç­‰å¾…I``/O``ã€æˆ–è€…å†…å­˜äº¤æ¢ç­‰ã€‚ ----------------------------- cpuéƒ¨åˆ†çš„è§£é‡Š us åˆ—æ˜¾ç¤ºäº†ç”¨æˆ·æ–¹å¼ä¸‹æ‰€èŠ±è´¹ CPU æ—¶é—´çš„ç™¾åˆ†æ¯”ã€‚usçš„å€¼æ¯”è¾ƒé«˜æ—¶ï¼Œè¯´æ˜ç”¨æˆ·è¿›ç¨‹æ¶ˆè€—çš„cpuæ—¶é—´å¤šï¼Œä½†æ˜¯å¦‚æœé•¿æœŸå¤§äº50%ï¼Œéœ€è¦è€ƒè™‘ä¼˜åŒ–ç”¨æˆ·çš„ç¨‹åºã€‚ sy åˆ—æ˜¾ç¤ºäº†å†…æ ¸è¿›ç¨‹æ‰€èŠ±è´¹çš„cpuæ—¶é—´çš„ç™¾åˆ†æ¯”ã€‚è¿™é‡Œus + syçš„å‚è€ƒå€¼ä¸º80%ï¼Œå¦‚æœus+sy å¤§äº 80%è¯´æ˜å¯èƒ½å­˜åœ¨CPUä¸è¶³ã€‚ wa åˆ—æ˜¾ç¤ºäº†IOç­‰å¾…æ‰€å ç”¨çš„CPUæ—¶é—´çš„ç™¾åˆ†æ¯”ã€‚è¿™é‡Œwaçš„å‚è€ƒå€¼ä¸º30%ï¼Œå¦‚æœwaè¶…è¿‡30%ï¼Œè¯´æ˜IOç­‰å¾…ä¸¥é‡ï¼Œè¿™å¯èƒ½æ˜¯ç£ç›˜å¤§é‡éšæœºè®¿é—®é€ æˆçš„ï¼Œä¹Ÿå¯èƒ½ç£ç›˜æˆ–è€… ``ç£ç›˜è®¿é—®æ§åˆ¶å™¨çš„å¸¦å®½ç“¶é¢ˆé€ æˆçš„(ä¸»è¦æ˜¯å—æ“ä½œ)ã€‚ id` `åˆ—æ˜¾ç¤ºäº†cpuå¤„åœ¨ç©ºé—²çŠ¶æ€çš„æ—¶é—´ç™¾åˆ†æ¯” ----------------------------- systeméƒ¨åˆ†çš„è§£é‡Š in åˆ—è¡¨ç¤ºåœ¨æŸä¸€æ—¶é—´é—´éš”ä¸­è§‚æµ‹åˆ°çš„æ¯ç§’è®¾å¤‡ä¸­æ–­æ•°ã€‚ csåˆ—è¡¨ç¤ºæ¯ç§’äº§ç”Ÿçš„ä¸Šä¸‹æ–‡åˆ‡æ¢æ¬¡æ•°ï¼Œå¦‚å½“ cs æ¯”ç£ç›˜ I/O å’Œç½‘ç»œä¿¡æ¯åŒ…é€Ÿç‡é«˜å¾—å¤šï¼Œéƒ½åº”è¿›è¡Œè¿›ä¸€æ­¥è°ƒæŸ¥ã€‚ ----------------------------- memoryéƒ¨åˆ†çš„è§£é‡Š swpd åˆ‡æ¢åˆ°å†…å­˜äº¤æ¢åŒºçš„å†…å­˜æ•°é‡(kè¡¨ç¤º)ã€‚å¦‚æœswpdçš„å€¼ä¸ä¸º0ï¼Œæˆ–è€…æ¯”è¾ƒå¤§ï¼Œæ¯”å¦‚è¶…è¿‡äº†100mï¼Œåªè¦siã€soçš„å€¼é•¿æœŸä¸º0ï¼Œç³»ç»Ÿæ€§èƒ½è¿˜æ˜¯æ­£å¸¸ free å½“å‰çš„ç©ºé—²é¡µé¢åˆ—è¡¨ä¸­å†…å­˜æ•°é‡(kè¡¨ç¤º) buff ä½œä¸ºbuffer cacheçš„å†…å­˜æ•°é‡ï¼Œä¸€èˆ¬å¯¹å—è®¾å¤‡çš„è¯»å†™æ‰éœ€è¦ç¼“å†²ã€‚ cache: ä½œä¸ºpage cacheçš„å†…å­˜æ•°é‡ï¼Œä¸€èˆ¬ä½œä¸ºæ–‡ä»¶ç³»ç»Ÿçš„cacheï¼Œå¦‚æœcacheè¾ƒå¤§ï¼Œè¯´æ˜ç”¨åˆ°cacheçš„æ–‡ä»¶è¾ƒå¤šï¼Œå¦‚æœæ­¤æ—¶IOä¸­biæ¯”è¾ƒå°ï¼Œè¯´æ˜æ–‡ä»¶ç³»ç»Ÿæ•ˆç‡æ¯”è¾ƒå¥½ã€‚ ----------------------------- swapéƒ¨åˆ†çš„è§£é‡Š si ç”±å†…å­˜è¿›å…¥å†…å­˜äº¤æ¢åŒºæ•°é‡ã€‚ soç”±å†…å­˜äº¤æ¢åŒºè¿›å…¥å†…å­˜æ•°é‡ã€‚ ----------------------------- IOéƒ¨åˆ†çš„è§£é‡Š bi ä»å—è®¾å¤‡è¯»å…¥æ•°æ®çš„æ€»é‡ï¼ˆè¯»ç£ç›˜ï¼‰ï¼ˆæ¯ç§’kbï¼‰ã€‚ bo å—è®¾å¤‡å†™å…¥æ•°æ®çš„æ€»é‡ï¼ˆå†™ç£ç›˜ï¼‰ï¼ˆæ¯ç§’kbï¼‰ Procs procsæœ‰ råˆ—å’Œbåˆ—ã€‚råˆ—ä»£è¡¨ç­‰å¾…è®¿é—®CPUçš„è¿›ç¨‹æ•°é‡ã€‚è€Œbåˆ—æ„å‘³ç€ç¡çœ è¿›ç¨‹çš„æ•°é‡ã€‚åœ¨è¿™äº›åˆ—çš„ä¸‹é¢ï¼Œæ˜¯å®ƒä»¬çš„å€¼ã€‚ä»ä¸Šé¢çš„æˆªå›¾ä¸­ï¼Œæˆ‘é—¨æœ‰2ä¸ªè¿›ç¨‹æ­£åœ¨ç­‰å¾…è®¿é—®CPUï¼Œ0ä¸ªç¡çœ è¿›ç¨‹ã€‚\nMemory memoryæœ‰swpdã€ freeã€ buff å’Œ cache è¿™äº›åˆ—ã€‚è¿™äº›ä¿¡æ¯å’Œå‘½ä»¤free -mç›¸åŒã€‚swpdåˆ—æ˜¾ç¤ºäº†æœ‰å¤šå°‘å†…å­˜å·²ç»è¢«äº¤æ¢åˆ°äº†äº¤æ¢æ–‡ä»¶æˆ–è€…ç£ç›˜ã€‚freeåˆ—æ˜¾ç¤ºäº†æœªåˆ†é…çš„å¯ç”¨å†…å­˜ã€‚buffåˆ—æ˜¾ç¤ºäº†ä½¿ç”¨ä¸­çš„å†…å­˜ã€‚cacheåˆ—æ˜¾ç¤ºäº†æœ‰å¤šå°‘å†…å­˜å¯ä»¥è¢«äº¤æ¢åˆ°äº¤æ¢æ–‡ä»¶æˆ–è€…ç£ç›˜ä¸Šå¦‚æœä¸€äº›åº”ç”¨éœ€è¦ä»–ä»¬ã€‚\nSwap swapæ˜¾ç¤ºäº†ä»äº¤æ¢ç³»ç»Ÿä¸Šå‘é€æˆ–å–å›äº†å¤šå°‘å†…å­˜ã€‚siåˆ—å‘Šè¯‰æˆ‘ä»¬æ¯ç§’æœ‰å¤šå°‘å†…å­˜è¢«ä»swapç§»åˆ°çœŸå®å†…å­˜ä¸­ï¼ˆInï¼‰ã€‚soåˆ—å‘Šè¯‰æˆ‘ä»¬æ¯ç§’æœ‰å¤šå°‘å†…å­˜è¢«ä»çœŸå®å†…å­˜ç§»åˆ°swapä¸­ï¼ˆOutï¼‰ã€‚\nI/O ioä¾æ®å—çš„è¯»å†™æ˜¾ç¤ºäº†æ¯ç§’è¾“å…¥è¾“å‡ºçš„æ´»åŠ¨ã€‚biåˆ—å‘Šè¯‰æˆ‘ä»¬æ”¶åˆ°çš„å—æ•°é‡ï¼Œboåˆ—å‘Šè¯‰æˆ‘ä»¬å‘é€çš„å—æ•°é‡ã€‚\nSystem systemæ˜¾ç¤ºäº†æ¯ç§’çš„ç³»ç»Ÿæ“ä½œæ•°é‡ã€‚inåˆ—æ˜¾ç¤ºäº†ç³»ç»Ÿæ¯ç§’è¢«ä¸­æ–­çš„æ•°é‡ã€‚csåˆ—æ˜¾ç¤ºäº†ç³»ç»Ÿä¸ºäº†å¤„ç†æ‰€ä»¥ä»»åŠ¡è€Œä¸Šä¸‹æ–‡åˆ‡æ¢çš„æ•°é‡ã€‚\nCPU CPUå‘Šè¯‰äº†æˆ‘ä»¬CPUèµ„æºçš„ä½¿ç”¨æƒ…å†µã€‚usåˆ—æ˜¾ç¤ºäº†å¤„ç†å™¨åœ¨éå†…æ ¸ç¨‹åºæ¶ˆè€—çš„æ—¶é—´ã€‚syåˆ—æ˜¾ç¤ºäº†å¤„ç†å™¨åœ¨å†…æ ¸ç›¸å…³ä»»åŠ¡ä¸Šæ¶ˆè€—çš„æ—¶é—´ã€‚idåˆ—æ˜¾ç¤ºäº†å¤„ç†å™¨çš„ç©ºé—²æ—¶é—´ã€‚waåˆ—æ˜¾ç¤ºäº†å¤„ç†å™¨åœ¨ç­‰å¾…IOæ“ä½œå®Œæˆä»¥ç»§ç»­å¤„ç†ä»»åŠ¡ä¸Šçš„æ—¶é—´ã€‚\nssæ˜¯iproute2åŒ…çš„ä¸€éƒ¨åˆ†ã€‚iproute2æ˜¯ç”¨æ¥æ›¿ä»£ä¸€æ•´å¥—æ ‡å‡†çš„Unixç½‘ç»œå·¥å…·ç»„ä»¶ï¼Œå®ƒæ›¾ç»ç”¨æ¥å®Œæˆç½‘ç»œæ¥å£é…ç½®ï¼Œè·¯ç”±è¡¨å’Œç®¡ç†ARPè¡¨ä»»åŠ¡ã€‚sså·¥å…·ç”¨æ¥è®°å½•å¥—æ¥å­—ç»Ÿè®¡ä¿¡æ¯ï¼Œå®ƒå¯ä»¥æ˜¾ç¤ºç±»ä¼¼netstatä¸€æ ·çš„ä¿¡æ¯ï¼ŒåŒæ—¶ä¹Ÿèƒ½æ˜¾ç¤ºæ›´å¤šTCPå’ŒçŠ¶æ€ä¿¡æ¯ã€‚ä¸€äº›ä¾‹å­å¦‚ä¸‹ï¼š\nss -tnap ss -tnap6 ss -tnap ss -s ss -tn -o state established -p lsofå‘½ä»¤ï¼Œæ„ä¸ºâ€œlist open filesâ€, ç”¨äºåœ¨è®¸å¤šç±»Unixç³»ç»Ÿä¸­æ˜¾ç¤ºæ‰€æœ‰æ‰“å¼€çš„æ–‡ä»¶åŠæ‰“å¼€å®ƒä»¬çš„è¿›ç¨‹ã€‚åœ¨å¤§éƒ¨åˆ†Linuxå‘è¡Œç‰ˆå’Œå…¶ä»–ç±»Linuxæ“ä½œç³»ç»Ÿä¸­ç³»ç»Ÿç®¡ç†å‘˜ç”¨å®ƒæ¥æ£€æŸ¥ä¸åŒçš„è¿›ç¨‹æ‰“å¼€äº†å“ªäº›æ–‡ä»¶ã€‚\n# lsof +p process_id # lsof | less # lsof â€“u username # lsof /etc/passwd # lsof â€“i TCP:ftp # lsof â€“i TCP:80 ç¼“å†²åŒºä¸ç‰¹å®šçš„å—è®¾å¤‡å…³è”ï¼Œå¹¶è¦†ç›–æ–‡ä»¶ç³»ç»Ÿå…ƒæ•°æ®çš„ç¼“å­˜ä»¥åŠè·Ÿè¸ªè¿è¡Œä¸­çš„é¡µé¢ã€‚ç¼“å­˜ä»…åŒ…å«é©»ç•™çš„æ–‡ä»¶æ•°æ®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç¼“å†²åŒºè®°ä½ç›®å½•ä¸­çš„å†…å®¹ï¼Œæ–‡ä»¶æƒé™æ˜¯ä»€ä¹ˆï¼Œå¹¶è·Ÿè¸ªä»ç‰¹å®šå—è®¾å¤‡å†™å…¥æˆ–è¯»å–çš„å†…å­˜ã€‚ç¼“å­˜ä»…åŒ…å«æ–‡ä»¶æœ¬èº«çš„å†…å®¹ã€‚\nâ€œç¼“å†²åŒºâ€è¡¨ç¤ºæœ‰å¤šå°‘RAMä¸“ç”¨äºç¼“å­˜ç£ç›˜å—ã€‚â€œç¼“å­˜â€ç±»ä¼¼äºâ€œç¼“å†²åŒºâ€ï¼Œåªæ˜¯è¿™æ¬¡å®ƒç¼“å­˜æ–‡ä»¶è¯»å–ä¸­çš„é¡µé¢ã€‚\nå¼•ç”¨ç­”æ¡ˆï¼ˆä¾›å‚è€ƒï¼‰ï¼š\nç®€çŸ­ç­”æ¡ˆï¼šé«˜é€Ÿç¼“å­˜æ˜¯é¡µé¢é«˜é€Ÿç¼“å­˜çš„å¤§å°ã€‚ç¼“å†²åŒºæ˜¯å†…å­˜ä¸­å—I / Oç¼“å†²åŒºçš„å¤§å°ã€‚ç¼“å­˜çš„äº‹é¡¹ï¼›ç¼“å†²åŒºåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæ— å…³ç´§è¦ã€‚\né•¿ç­”æ¡ˆï¼šç¼“å­˜æ˜¯Linuxé¡µé¢ç¼“å­˜çš„å¤§å°å‡å»äº¤æ¢ç¼“å­˜ä¸­çš„å†…å­˜ï¼Œå®ƒç”±SwapCachedè¡¨ç¤ºï¼ˆå› æ­¤æ€»é¡µé¢ç¼“å­˜å¤§å°ä¸ºCached + SwapCachedï¼‰ã€‚Linuxé€šè¿‡é¡µé¢ç¼“å­˜æ‰§è¡Œæ‰€æœ‰æ–‡ä»¶I / Oã€‚å†™æ“ä½œçš„å®ç°æ˜¯ç®€å•åœ°å°†é¡µé¢ç¼“å­˜ä¸­çš„ç›¸åº”é¡µé¢æ ‡è®°ä¸ºè„ã€‚ç„¶åï¼Œåˆ·æ–°ç¨‹åºçº¿ç¨‹ä¼šå®šæœŸå°†æ‰€æœ‰è„é¡µå†™å›åˆ°ç£ç›˜ã€‚é€šè¿‡ä»é¡µé¢ç¼“å­˜è¿”å›æ•°æ®æ¥å®ç°è¯»å–ã€‚å¦‚æœæ•°æ®å°šæœªåœ¨é«˜é€Ÿç¼“å­˜ä¸­ï¼Œåˆ™é¦–å…ˆå¡«å……å®ƒã€‚åœ¨ç°ä»£Linuxç³»ç»Ÿä¸Šï¼Œâ€œç¼“å­˜â€å¯ä»¥è½»æ¾è¾¾åˆ°æ•°GBã€‚å®ƒåªä¼šå“åº”å†…å­˜å‹åŠ›è€Œç¼©å°ã€‚ç³»ç»Ÿå°†æ¸…é™¤é¡µé¢ç¼“å­˜ä»¥åŠå°†æ•°æ®äº¤æ¢åˆ°ç£ç›˜ä¸Šï¼Œä»¥æ ¹æ®éœ€è¦æä¾›æ›´å¤šçš„å†…å­˜ã€‚\nç¼“å†²åŒºæ˜¯å†…å­˜ä¸­çš„å—I / Oç¼“å†²åŒºã€‚ä»–ä»¬æ˜¯ç›¸å¯¹çŸ­æš‚çš„ã€‚åœ¨Linuxå†…æ ¸ç‰ˆæœ¬2.4ä¹‹å‰ï¼ŒLinuxå…·æœ‰å•ç‹¬çš„é¡µé¢å’Œç¼“å†²åŒºé«˜é€Ÿç¼“å­˜ã€‚ä»2.4å¼€å§‹ï¼Œé¡µé¢å’Œç¼“å†²åŒºé«˜é€Ÿç¼“å­˜æ˜¯ç»Ÿä¸€çš„ï¼Œç¼“å†²åŒºæ˜¯æœªåœ¨é¡µé¢é«˜é€Ÿç¼“å­˜ä¸­è¡¨ç¤ºçš„åŸå§‹ç£ç›˜å—ï¼Œå³ä¸æ˜¯æ–‡ä»¶æ•°æ®ã€‚å› æ­¤ï¼Œâ€œç¼“å†²åŒºâ€åº¦é‡æ ‡å‡†çš„é‡è¦æ€§æœ€ä½ã€‚åœ¨å¤§å¤šæ•°ç³»ç»Ÿä¸Šï¼Œç¼“å†²åŒºé€šå¸¸åªæœ‰å‡ åå…†å­—èŠ‚ã€‚\nå®ƒå¹¶ä¸åƒè¿™æ ·ç®€å•ï¼Œä½†æ˜¯å¯èƒ½æœ‰åŠ©äºç†è§£ï¼š\nç¼“å†²åŒºç”¨äºå­˜å‚¨æ–‡ä»¶å…ƒæ•°æ®ï¼ˆæƒé™ï¼Œä½ç½®ç­‰ï¼‰ã€‚æ¯ä¸ªå†…å­˜é¡µé¢éƒ½åœ¨æ­¤å¤„è·Ÿè¸ªã€‚\nç¼“å­˜ç”¨äºå­˜å‚¨å®é™…æ–‡ä»¶å†…å®¹ã€‚\niostat\nè§£é‡Šè¯´æ˜ï¼š avg-cpu: æ€»ä½“cpuä½¿ç”¨æƒ…å†µç»Ÿè®¡ä¿¡æ¯ï¼Œå¯¹äºå¤šæ ¸cpuï¼Œè¿™é‡Œä¸ºæ‰€æœ‰cpuçš„å¹³å‡å€¼ %user: åœ¨ç”¨æˆ·çº§åˆ«è¿è¡Œæ‰€ä½¿ç”¨çš„CPUçš„ç™¾åˆ†æ¯”. %``nice``: ``nice``æ“ä½œæ‰€ä½¿ç”¨çš„CPUçš„ç™¾åˆ†æ¯”. %sys: åœ¨ç³»ç»Ÿçº§åˆ«(kernel)è¿è¡Œæ‰€ä½¿ç”¨CPUçš„ç™¾åˆ†æ¯”. %iowait: CPUç­‰å¾…ç¡¬ä»¶I``/O``æ—¶,æ‰€å ç”¨CPUç™¾åˆ†æ¯”. %idle: CPUç©ºé—²æ—¶é—´çš„ç™¾åˆ†æ¯”. Deviceæ®µ:å„ç£ç›˜è®¾å¤‡çš„IOç»Ÿè®¡ä¿¡æ¯ tps: æ¯ç§’é’Ÿå‘é€åˆ°çš„I``/O``è¯·æ±‚æ•°. Blk_read ``/s``: æ¯ç§’è¯»å–çš„blockæ•°. Blk_wrtn``/s``: æ¯ç§’å†™å…¥çš„blockæ•°. Blk_read: è¯»å…¥çš„blockæ€»æ•°. Blk_wrtn: å†™å…¥çš„blockæ€»æ•°. iostat -x -k -d 1\nè§£é‡Šè¯´æ˜ï¼š rrqm``/s``: æ¯ç§’å¯¹è¯¥è®¾å¤‡çš„è¯»è¯·æ±‚è¢«åˆå¹¶æ¬¡æ•°ï¼Œæ–‡ä»¶ç³»ç»Ÿä¼šå¯¹è¯»å–åŒå—(block)çš„è¯·æ±‚è¿›è¡Œåˆå¹¶ wrqm``/s``: æ¯ç§’å¯¹è¯¥è®¾å¤‡çš„å†™è¯·æ±‚è¢«åˆå¹¶æ¬¡æ•° r``/s``: æ¯ç§’å®Œæˆçš„è¯»æ¬¡æ•° w``/s``: æ¯ç§’å®Œæˆçš„å†™æ¬¡æ•° rkB``/s``: æ¯ç§’è¯»æ•°æ®é‡(kBä¸ºå•ä½) wkB``/s``: æ¯ç§’å†™æ•°æ®é‡(kBä¸ºå•ä½) avgrq-sz:å¹³å‡æ¯æ¬¡IOæ“ä½œçš„æ•°æ®é‡(æ‰‡åŒºæ•°ä¸ºå•ä½) avgqu-sz: å¹³å‡ç­‰å¾…å¤„ç†çš„IOè¯·æ±‚é˜Ÿåˆ—é•¿åº¦ await: å¹³å‡æ¯æ¬¡IOè¯·æ±‚ç­‰å¾…æ—¶é—´(åŒ…æ‹¬ç­‰å¾…æ—¶é—´å’Œå¤„ç†æ—¶é—´ï¼Œæ¯«ç§’ä¸ºå•ä½) svctm: å¹³å‡æ¯æ¬¡IOè¯·æ±‚çš„å¤„ç†æ—¶é—´(æ¯«ç§’ä¸ºå•ä½) %util: é‡‡ç”¨å‘¨æœŸå†…ç”¨äºIOæ“ä½œçš„æ—¶é—´æ¯”ç‡ï¼Œå³IOé˜Ÿåˆ—éç©ºçš„æ—¶é—´æ¯”ç‡ å¦‚æœ %util æ¥è¿‘ 100%ï¼Œè¯´æ˜äº§ç”Ÿçš„I``/O``è¯·æ±‚å¤ªå¤šï¼ŒI``/O``ç³»ç»Ÿå·²ç»æ»¡è´Ÿè·ï¼Œè¯¥ç£ç›˜å¯èƒ½å­˜åœ¨ç“¶é¢ˆã€‚ idleå°äº70% IOå‹åŠ›å°±è¾ƒå¤§äº†,ä¸€èˆ¬è¯»å–é€Ÿåº¦æœ‰è¾ƒå¤šçš„waitã€‚ åŒæ—¶å¯ä»¥ç»“åˆvmstat æŸ¥çœ‹æŸ¥çœ‹bå‚æ•°(ç­‰å¾…èµ„æºçš„è¿›ç¨‹æ•°)å’Œwaå‚æ•°(IOç­‰å¾…æ‰€å ç”¨çš„CPUæ—¶é—´çš„ç™¾åˆ†æ¯”,é«˜è¿‡30%æ—¶IOå‹åŠ›é«˜) åœ¨Linuxç³»ç»Ÿä¸­ï¼Œä¸ºäº†æé«˜æ–‡ä»¶ç³»ç»Ÿæ€§èƒ½ï¼Œå†…æ ¸åˆ©ç”¨ä¸€éƒ¨åˆ†ç‰©ç†å†…å­˜åˆ†é…å‡ºç¼“å†²åŒºï¼Œç”¨äºç¼“å­˜ç³»ç»Ÿæ“ä½œå’Œæ•°æ®æ–‡ä»¶ï¼Œå½“å†…æ ¸æ”¶åˆ°è¯»å†™çš„è¯·æ±‚æ—¶ï¼Œå†…æ ¸å…ˆå»ç¼“å­˜åŒºæ‰¾æ˜¯å¦æœ‰è¯·æ±‚çš„æ•°æ®ï¼Œæœ‰å°±ç›´æ¥è¿”å›ï¼Œå¦‚æœæ²¡æœ‰åˆ™é€šè¿‡é©±åŠ¨ç¨‹åºç›´æ¥æ“ä½œç£ç›˜ã€‚ ç¼“å­˜æœºåˆ¶ä¼˜ç‚¹ï¼šå‡å°‘ç³»ç»Ÿè°ƒç”¨æ¬¡æ•°ï¼Œé™ä½CPUä¸Šä¸‹æ–‡åˆ‡æ¢å’Œç£ç›˜è®¿é—®é¢‘ç‡ã€‚ CPUä¸Šä¸‹æ–‡åˆ‡æ¢ï¼šCPUç»™æ¯ä¸ªè¿›ç¨‹ä¸€å®šçš„æœåŠ¡æ—¶é—´ï¼Œå½“æ—¶é—´ç‰‡ç”¨å®Œåï¼Œå†…æ ¸ä»æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ä¸­æ”¶å›å¤„ç†å™¨ï¼ŒåŒæ—¶æŠŠè¿›ç¨‹å½“å‰è¿è¡ŒçŠ¶æ€ä¿å­˜ä¸‹æ¥ï¼Œç„¶ååŠ è½½ä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œè¿™ä¸ªè¿‡ç¨‹å«åšä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚å®è´¨ä¸Šå°±æ˜¯è¢«ç»ˆæ­¢è¿è¡Œè¿›ç¨‹ä¸å¾…è¿è¡Œè¿›ç¨‹çš„è¿›ç¨‹åˆ‡æ¢ã€‚\nSwapç”¨é€”ï¼šSwapæ„æ€æ˜¯äº¤æ¢åˆ†åŒºï¼Œé€šå¸¸æˆ‘ä»¬è¯´çš„è™šæ‹Ÿå†…å­˜ï¼Œæ˜¯ä»ç¡¬ç›˜ä¸­åˆ’åˆ†å‡ºçš„ä¸€ä¸ªåˆ†åŒºã€‚å½“ç‰©ç†å†…å­˜ä¸å¤Ÿç”¨çš„æ—¶å€™ï¼Œå†…æ ¸å°±ä¼šé‡Šæ”¾ç¼“å­˜åŒºï¼ˆbuffers/cacheï¼‰é‡Œä¸€äº›é•¿æ—¶é—´ä¸ç”¨çš„ç¨‹åºï¼Œç„¶åå°†è¿™äº›ç¨‹åºä¸´æ—¶æ”¾åˆ°Swapä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœç‰©ç†å†…å­˜å’Œç¼“å­˜åŒºå†…å­˜ä¸å¤Ÿç”¨çš„æ—¶å€™ï¼Œæ‰ä¼šç”¨åˆ°Swapã€‚ swapæ¸…ç†ï¼šswapoff -a \u0026amp;\u0026amp; swapon -a æ³¨æ„ï¼šè¿™æ ·æ¸…ç†æœ‰ä¸ªå‰ææ¡ä»¶ï¼Œç©ºé—²çš„å†…å­˜å¿…é¡»æ¯”å·²ç»ä½¿ç”¨çš„swapç©ºé—´å¤§\n1. æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œå‘ç°swapè™šæ‹Ÿå†…å­˜ç©ºé—´ç«Ÿç„¶ä¸º0 # free -m 2. å»ºè™šæ‹Ÿå†…å­˜ç£ç›˜å·ã€‚åšæ³•å¦‚ä¸‹ï¼š # dd if=/dev/zero of=/opt/swap bs=1024 count=2048000 # mkswap /opt/swap # swapon /opt/swap å†æ¬¡æŸ¥çœ‹å†…å®¹ï¼Œå‘ç°swapè™šæ‹Ÿå†…å­˜å°±æœ‰äº† # free -m 3. å¦‚æœæƒ³å–æ¶ˆæ–‡ä»¶è™šæ‹Ÿå†…å­˜ï¼Œå³åˆ é™¤swapï¼Œåšæ³•å¦‚ä¸‹ï¼šï¼ˆå½“ç„¶æ ¹æ®ç³»ç»Ÿé…ç½®ï¼Œä¹Ÿå¯ä»¥ä¿ç•™swapï¼Œä»¥åç»§ç»­ç”¨ï¼‰ã€‚ # swapoff /opt/swap # rm /opt/swap 4. swapå¼€æœºæŒ‚è½½ # vim /etc/fstab /opt/swap swap swap defaults 0 0 ä¸Šé¢æŒ‚è½½å‚æ•°åˆ†åˆ«ä¸ºï¼š è®¾å¤‡æ–‡ä»¶æˆ–ä¼ªæ–‡ä»¶ç³»ç»Ÿ æŒ‚è½½ç‚¹ æ–‡ä»¶ç³»ç»Ÿç±»å‹ æŒ‚è½½é€‰é¡¹ å¤‡ä»½é¢‘ç‡ å¼€æœºè‡ªæ£€æ¬¡åº 6. ç§»åŠ¨è™šæ‹Ÿå†…å­˜ç©ºé—´ å¦‚æœå½“å‰çš„è™šå­˜æ‰€åœ¨çš„ç£ç›˜ç©ºé—´ä¸å¤Ÿï¼Œå¯ä»¥é¦–å…ˆå…³é—­è™šå­˜æœåŠ¡ï¼Œå°†å…¶ç§»åŠ¨åˆ°åˆ«çš„ç£ç›˜ï¼Œå†å¯ç”¨å³å¯ã€‚ # swapoff -v /swap/swapadd # mv /swap/swapadd /mnt/swap # swapon /swap/swapadd é‡Šæ”¾ç¼“å­˜åŒºå†…å­˜çš„æ–¹æ³• 1ï¼‰æ¸…ç†pagecacheï¼ˆé¡µé¢ç¼“å­˜ï¼‰ [root@backup ~]# echo 1 \u0026gt; /proc/sys/vm/drop_caches æˆ–è€… # sysctl -w vm.drop_caches=1 2ï¼‰æ¸…ç†dentriesï¼ˆç›®å½•ç¼“å­˜ï¼‰å’Œinodes [root@backup ~]# echo 2 \u0026gt; /proc/sys/vm/drop_caches æˆ–è€… # sysctl -w vm.drop_caches=2 3ï¼‰æ¸…ç†pagecacheã€dentrieså’Œinodes [root@backup ~]# echo 3 \u0026gt; /proc/sys/vm/drop_caches æˆ–è€… # sysctl -w vm.drop_caches=3 ä¸Šé¢ä¸‰ç§æ–¹å¼éƒ½æ˜¯ä¸´æ—¶é‡Šæ”¾ç¼“å­˜çš„æ–¹æ³•ï¼Œè¦æƒ³æ°¸ä¹…é‡Šæ”¾ç¼“å­˜ï¼Œéœ€è¦åœ¨/etc/sysctl.confæ–‡ä»¶ä¸­é…ç½®ï¼švm.drop_caches=1/2/3ï¼Œç„¶åsysctl -pç”Ÿæ•ˆå³å¯ï¼ å¦å¤–ï¼Œå¯ä»¥ä½¿ç”¨syncå‘½ä»¤æ¥æ¸…ç†æ–‡ä»¶ç³»ç»Ÿç¼“å­˜ï¼Œè¿˜ä¼šæ¸…ç†åƒµå°¸(zombie)å¯¹è±¡å’Œå®ƒä»¬å ç”¨çš„å†…å­˜ [root@backup ~]# sync æ¸©é¦¨æç¤ºï¼š ä¸Šé¢æ“ä½œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½ä¸ä¼šå¯¹ç³»ç»Ÿé€ æˆä¼¤å®³ï¼Œåªä¼šæœ‰åŠ©äºé‡Šæ”¾ä¸ç”¨çš„å†…å­˜ã€‚ ä½†æ˜¯å¦‚æœåœ¨æ‰§è¡Œè¿™äº›æ“ä½œæ—¶æ­£åœ¨å†™æ•°æ®ï¼Œé‚£ä¹ˆå®é™…ä¸Šåœ¨æ•°æ®åˆ°è¾¾ç£ç›˜ä¹‹å‰å°±å°†å®ƒä»æ–‡ä»¶ç¼“å­˜ä¸­æ¸…é™¤æ‰äº†ï¼Œè¿™å¯èƒ½ä¼šé€ æˆå¾ˆä¸å¥½çš„å½±å“ã€‚ é‚£ä¹ˆå¦‚æœé¿å…è¿™ç§äº‹æƒ…å‘ç”Ÿå‘¢ï¼Ÿ å› æ­¤ï¼Œè¿™é‡Œä¸å¾—ä¸æä¸€ä¸‹/proc/sys/vm/vfs_cache_pressureè¿™ä¸ªæ–‡ä»¶ï¼Œå‘Šè¯‰å†…æ ¸ï¼Œå½“æ¸…ç†inoe/dentryç¼“å­˜æ—¶åº”è¯¥ç”¨ä»€ä¹ˆæ ·çš„ä¼˜å…ˆçº§ã€‚ [root@backup ~]# cat /proc/sys/vm/vfs_cache_pressure 100 vfs_cache_pressure=100 è¿™ä¸ªæ˜¯é»˜è®¤å€¼ï¼Œå†…æ ¸ä¼šå°è¯•é‡æ–°å£°æ˜dentrieså’Œinodesï¼Œå¹¶é‡‡ç”¨ä¸€ç§ç›¸å¯¹äºé¡µé¢ç¼“å­˜å’Œäº¤æ¢ç¼“å­˜æ¯”è¾ƒ\u0026#34;åˆç†\u0026#34;çš„æ¯”ä¾‹ã€‚ å‡å°‘vfs_cache_pressureçš„å€¼ï¼Œä¼šå¯¼è‡´å†…æ ¸å€¾å‘äºä¿ç•™dentryå’Œinodeç¼“å­˜ã€‚ å¢åŠ vfs_cache_pressureçš„å€¼ï¼Œï¼ˆå³è¶…è¿‡100æ—¶ï¼‰ï¼Œåˆ™ä¼šå¯¼è‡´å†…æ ¸å€¾å‘äºé‡æ–°å£°æ˜dentrieså’Œinodes æ€»ä¹‹ï¼Œvfs_cache_pressureçš„å€¼ï¼š å°äº100çš„å€¼ä¸ä¼šå¯¼è‡´ç¼“å­˜çš„å¤§é‡å‡å°‘ è¶…è¿‡100çš„å€¼åˆ™ä¼šå‘Šè¯‰å†…æ ¸ä½ å¸Œæœ›ä»¥é«˜ä¼˜å…ˆçº§æ¥æ¸…ç†ç¼“å­˜ã€‚ å…¶å®æ— è®ºvfs_cache_pressureçš„å€¼é‡‡ç”¨ä»€ä¹ˆå€¼ï¼Œå†…æ ¸æ¸…ç†ç¼“å­˜çš„é€Ÿåº¦éƒ½æ˜¯æ¯”è¾ƒä½çš„ã€‚ å¦‚æœå°†æ­¤å€¼è®¾ç½®ä¸º10000ï¼Œç³»ç»Ÿå°†ä¼šå°†ç¼“å­˜å‡å°‘åˆ°ä¸€ä¸ªåˆç†çš„æ°´å¹³ã€‚ æµ‹è¯•ç¡¬ç›˜å†™å…¥é€Ÿåº¦\n[root@redhat73 ~]# dd if=/dev/zero of=/home/linshi.a bs=1024000000 count=2 2+0 records in 2+0 records out 2048000000 bytes (2.0 GB) copied, 4.67577 s, 438 MB/s å†™å…¥ä¸€ä¸ª2GBçš„æ–‡ä»¶ï¼Œç”¨æ—¶4.67577ç§’ï¼Œå¹³å‡438 MB/s [root@localhost home]# free -h total used free shared buff/cache available Mem: 974M 56M 818M 580K 99M 787M Swap: 2.0G 37M 2.0G # å‚æ•°è§£é‡Š -m ä»¥MBä¸ºå•ä½è¾“å‡º -g ä»¥GBä¸ºå•ä½è¾“å‡º -h ä»¥äººç±»å¯è¯»çš„å•ä½è¾“å‡ºï¼Œè‡ªåŠ¨è½¬æ¢KBã€MBæˆ–è€…GBä¸ºå•ä½ -s N æ¯Nç§’æ‰“å°ä¸€æ¬¡ -c N æ‰“å°Næ¬¡åé€€å‡º # è¾“å‡ºè¯´æ˜ï¼ˆMemä»£è¡¨ç‰©ç†å†…å­˜ã€Swapä»£è¡¨è™šæ‹Ÿå†…å­˜ï¼‰ total è¡¨ç¤ºç³»ç»Ÿçš„æ€»å†…å­˜ used è¡¨ç¤ºåº”ç”¨ç¨‹åºå·²ç»ä½¿ç”¨çš„å†…å­˜ free è¡¨ç¤ºå½“å‰è¿˜æ²¡æœ‰è¢«ä½¿ç”¨çš„å†…å­˜ shared è¡¨ç¤ºå…±äº«é“¾æ¥åº“ä½¿ç”¨çš„å†…å­˜ buff/cache è¡¨ç¤ºç³»ç»Ÿçš„page cacheå’Œbufferä½¿ç”¨åˆ°çš„å†…å­˜ available è¡¨ç¤ºåº”ç”¨ç¨‹åºè¿˜å¯ä»¥ç”³è¯·åˆ°çš„å†…å­˜ æ€ä¹ˆåˆ¤æ–­æ˜¯å¦éœ€è¦åŠ å†…å­˜ï¼š 1.swapä½¿ç”¨æœ‰å¤šå°‘ 2.availableå‰©ä½™æ˜¯å¤šå°‘ï¼Œè€Œä¸æ˜¯çœ‹free cacheæ˜¯Linuxç³»ç»Ÿä¸ºäº†æé«˜ç³»ç»Ÿè¿è¡Œæ•ˆç‡è€Œå°†ä¸€äº›ç¨‹åºæˆ–æ–‡ä»¶å†™å…¥åˆ°cacheï¼Œå¯æé«˜ç¨‹åºè¿è¡Œå’ŒåŠ è½½é€Ÿåº¦ï¼Œå¦‚æœç¨‹åºéœ€è¦ä¼šé©¬ä¸Šé‡Šæ”¾ã€‚æ‰€ä»¥åˆ¤æ–­ç³»ç»Ÿå†…å­˜æ˜¯å¦è¶³å¤Ÿå’Œæ˜¯å¦éœ€è¦å¢åŠ çš„æ—¶å€™ä¸èƒ½ç®€å•çš„çœ‹free Cache Pages: A cache is the part of the memory which transparently stores data so that future requests for that data can be served faster. This memory is utilized by the kernel to cache disk data and improve i/o performance. ç³»ç»Ÿå½“å‰ä½¿ç”¨åˆ°çš„å†…å­˜æ˜¯ï¼šused + buff/cacheï¼Œusedä¸­åŒ…å«äº†sharedã€‚ æ‰€ä»¥total = used + buff/cache + free = 56 + 99 + 818 = 973 availableï¼ˆ787ï¼‰ \u0026lt;= free + buff/cacheï¼ˆ818 + 99 = 917ï¼‰ï¼Œä¸ºä»€ä¹ˆæ˜¯å°äºå‘¢ï¼Ÿå› ä¸ºç³»ç»Ÿçš„ä¸€äº›pageæˆ–cacheæ˜¯ä¸èƒ½å›æ”¶çš„ã€‚ # æŸ¥çœ‹CPUä¿¡æ¯ # æ€»æ ¸æ•° = ç‰©ç†CPUä¸ªæ•° X æ¯é¢—ç‰©ç†CPUçš„æ ¸æ•° # æ€»é€»è¾‘CPUæ•° = ç‰©ç†CPUä¸ªæ•° X æ¯é¢—ç‰©ç†CPUçš„æ ¸æ•° X è¶…çº¿ç¨‹æ•° # æŸ¥çœ‹ç‰©ç†CPUä¸ªæ•° cat /proc/cpuinfo| grep \u0026#34;physical id\u0026#34;| sort| uniq| wc -l # æŸ¥çœ‹æ¯ä¸ªç‰©ç†CPUä¸­coreçš„ä¸ªæ•°(å³æ ¸æ•°) cat /proc/cpuinfo| grep \u0026#34;cpu cores\u0026#34;| uniq # æŸ¥çœ‹é€»è¾‘CPUçš„ä¸ªæ•° cat /proc/cpuinfo| grep \u0026#34;processor\u0026#34;| wc -l # æŸ¥çœ‹CPUä¿¡æ¯ï¼ˆå‹å·ï¼‰ cat /proc/cpuinfo | grep name | cut -f2 -d: | uniq -c æ€§èƒ½æµ‹è¯„å·¥å…·\næ€§èƒ½è°ƒä¼˜å·¥å…·\nå‚è€ƒ ç”¨åæ¡å‘½ä»¤åœ¨ä¸€åˆ†é’Ÿå†…æ£€æŸ¥LinuxæœåŠ¡å™¨æ€§èƒ½\nä½ å€¼å¾—æ‹¥æœ‰ â€”â€” 25 ä¸ª Linux æ€§èƒ½ç›‘æ§å·¥å…·\nTopå‘½ä»¤è¯¦è§£\ngglsofå‘½ä»¤å…¥é—¨\nLinuxç¼“å­˜æœºåˆ¶\n30ä¸ªå®ä¾‹è¯¦è§£TOPå‘½ä»¤\nlsofå‘½ä»¤è¡Œç¥å™¨å…¥é—¨\nè¶…å…¨æ•´ç†ï¼Linuxæ€§èƒ½åˆ†æå·¥å…·æ±‡æ€»åˆé›†\n","permalink":"https://blog.niuhemoon.win/posts/tech/linux-peformence-test/","summary":"ç®€ä»‹ Linuxä¸Šå¯¹ç³»ç»Ÿè¿›è¡Œæ€§èƒ½æ£€æµ‹çš„å·¥å…·éå¸¸å¤šï¼Œæœ¬æ–‡ä»‹ç»ä¸€äº›å¸¸ç”¨å·¥å…·çš„ä½¿ç”¨ æ€§èƒ½è§‚æµ‹å·¥å…· â–ª é¦–å…ˆå­¦ä¹ çš„Basic Toolæœ‰å¦‚ä¸‹ï¼š uptimeã€top(htop)ã€mpstatã€isstatã€vmstatã€freeã€pingã€nicstatã€dstatã€‚ â–ª é«˜çº§çš„å‘½ä»¤å¦‚ä¸‹ï¼š sarã€net","title":"Linuxæ€§èƒ½æµ‹è¯•"},{"content":"Core Dumpæ–‡ä»¶ å‡¡äº‹çš†æœ‰ä¸¤é¢æ€§ï¼ŒOSåœ¨å‡ºCoreçš„åŒæ—¶ï¼Œè™½ç„¶ä¼šç»ˆæ­¢æ‰å½“å‰è¿›ç¨‹ï¼Œä½†æ˜¯ä¹Ÿä¼šä¿ç•™ä¸‹ç¬¬ä¸€æ‰‹çš„ç°åœºæ•°æ®ï¼ŒOSä»¿ä½›æ˜¯ä¸€æ¶è¢«æŒ‰ä¸‹å¿«é—¨çš„ç›¸æœºï¼Œè€Œç…§ç‰‡å°±æ˜¯äº§å‡ºçš„Coreæ–‡ä»¶ã€‚é‡Œé¢å«æœ‰å½“è¿›ç¨‹è¢«ç»ˆæ­¢æ—¶å†…å­˜ã€CPUå¯„å­˜å™¨ç­‰ä¿¡æ¯ï¼Œå¯ä»¥ä¾›åç»­å¼€å‘äººå‘˜è¿›è¡Œè°ƒè¯•ã€‚\nGdbå¯ä»¥é™„ç€åœ¨ç‰¹å®šè¿›ç¨‹ä¸Šè°ƒè¯•ï¼Œä½†æ˜¯ä¸ºäº†ä¸å½±å“è¿è¡Œä¸­çš„è¿›ç¨‹ï¼Œå¯ä»¥é€šè¿‡ç”Ÿæˆ core file çš„æ–¹å¼æ¥ä¿å­˜è¿›ç¨‹çš„å½“å‰ä¿¡æ¯ã€‚\nå®éªŒç¯å¢ƒé…ç½® ç¯å¢ƒæ˜¯Ubuntu20.04\n# æ–°å¼€ä¸€ä¸ªShellçš„æ—¶å€™ï¼Œulimité€‰é¡¹éƒ½æ¢å¤äº†é»˜è®¤é€‰é¡¹ï¼Œéœ€è¦é‡æ–°è®¾ç½®è¯¥å€¼ # æŸ¥çœ‹shellè¿›ç¨‹èµ„æº ulimit -a # æŸ¥çœ‹coreæ–‡ä»¶å¤§å°é™åˆ¶ ulimit -c # ä¿®æ”¹coreæ–‡ä»¶å¤§å°é™åˆ¶ ulimit -c unlimited # æŸ¥çœ‹ä¿®æ”¹æ˜¯å¦ç”Ÿæ•ˆ ulimit -c # è®¾ç½®core_pattern # core_patternæ–‡ä»¶ä¸­å®šä¹‰äº†å½“äº§ç”Ÿcore dumpåå¯¹coreæ–‡ä»¶è¿›è¡Œä»€ä¹ˆæ“ä½œ cat /proc/sys/kernel/core_pattern # éœ€è¦ä¿®æ”¹core_patternæ–‡ä»¶ä½¿å¾—coreæ–‡ä»¶ä¿å­˜åœ¨ç£ç›˜ä¸Š # æ–¹æ³•1 # æš‚åœapportæœåŠ¡ sudo service apport stop cat /proc/sys/kernel/core_pattern # ç”Ÿæˆcoreæ–‡ä»¶åæ¢å¤apportæœåŠ¡ sudo service apport start # æ–¹æ³•2 mkdir /var/cores echo \u0026#34;/var/cores/core.%e.%p\u0026#34; \u0026gt; /proc/sys/kernel/core_pattern # æ–¹æ³•3 vim /etc/sysctl.conf # åœ¨æœ€åä¸€è¡Œæ·»åŠ kernel.core_uses_pid = 1 sysctl -p # é˜…è¯»coreæ–‡ä»¶å¤´\treadelf -h core å®‰è£…Python-dbg\nsudo apt install gdb python3-dbg GDBè°ƒè¯•Pythonä»£ç  å®éªŒ1ï¼šç›´æ¥è°ƒè¯•core dumpæ–‡ä»¶ å°†å¦‚ä¸‹ä»£ç ä¿å­˜ä¸ºexplode.py\nimport os def my_exploding_func(): my_local_var = \u0026#39;hi\u0026#39; number = 4 number2 = 5 number4 = number+3 os.abort() my_exploding_func() æ‰§è¡Œä»£ç ï¼Œäº§ç”Ÿcore dumpæ–‡ä»¶\npython explode.py åŒæ ·çš„Pythonç‰ˆæœ¬æ‰§è¡Œgdbè°ƒè¯•\n# è¯»å–coreæ–‡ä»¶ gdb `which python` core å¯ä»¥ä½¿ç”¨ä¸€äº›å¸¸è§çš„å‘½ä»¤è°ƒè¯•\n#0 __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:50 50\t../sysdeps/unix/sysv/linux/raise.c: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•. (gdb) py-list 3 def my_exploding_func(): 4 my_local_var = \u0026#39;hi\u0026#39; 5 number = 4 6 number2 = 5 7 number4 = number+3 \u0026gt;8 os.abort() 9 10 my_exploding_func() (gdb) py-bt Traceback (most recent call first): \u0026lt;built-in method abort of module object at remote 0x7f08dfc7d360\u0026gt; File \u0026#34;explode.py\u0026#34;, line 8, in my_exploding_func os.abort() File \u0026#34;explode.py\u0026#34;, line 10, in \u0026lt;module\u0026gt; my_exploding_func() å®éªŒ2:ä¸»åŠ¨ç”Ÿæˆcore dumpæ–‡ä»¶ å¦‚ä¸‹ä»£ç ä¿å­˜ä¸ºtest.py\nimport time def do(x): time.sleep(10) def main(): for x in range(10000): do(x) if __name__ == \u0026#39;__main__\u0026#39;: main() è¿è¡Œè¯¥ä»£ç åæ‰¾åˆ°PID\nps -ef | grep \u0026#34;python test.py\u0026#34; ä¸»åŠ¨ç”Ÿæˆcore dumpæ–‡ä»¶,ä¸å½±å“è¿›ç¨‹ç»§ç»­è¿è¡Œ\ngdb python PID generate-core-file æ‰€æœ‰gdbå‘½ä»¤éƒ½æ”¯æŒä½¿ç”¨ï¼ŒåŒæ—¶è¿˜æœ‰å®‰è£…python-dbgæ”¯æŒçš„å‘½ä»¤\nåœ¨gdbè°ƒè¯•å‘½ä»¤è¡Œä¸­è¾“å…¥\n# py + TABé”®ä½å¼¹å‡ºå¸¸ç”¨å‘½ä»¤ py-bt py-list py-up py-bt-full py-locals python py-down py-print python-interactive # help + å‘½ä»¤æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ help py-bt å‚è€ƒ gdb Debugging Full Example Linuxä¸ŠCore Dumpæ–‡ä»¶çš„å½¢æˆå’Œåˆ†æ\nLinuxä¸Šcoredumpå®éªŒ\nGDBè°ƒè¯•Pythonå‘½ä»¤\nDebuggin with gdb\n","permalink":"https://blog.niuhemoon.win/posts/tech/gdb-debug-python/","summary":"Core Dumpæ–‡ä»¶ å‡¡äº‹çš†æœ‰ä¸¤é¢æ€§ï¼ŒOSåœ¨å‡ºCoreçš„åŒæ—¶ï¼Œè™½ç„¶ä¼šç»ˆæ­¢æ‰å½“å‰è¿›ç¨‹ï¼Œä½†æ˜¯ä¹Ÿä¼šä¿ç•™ä¸‹ç¬¬ä¸€æ‰‹çš„ç°åœºæ•°æ®ï¼ŒOSä»¿ä½›æ˜¯ä¸€æ¶è¢«æŒ‰ä¸‹å¿«é—¨çš„ç›¸æœºï¼Œè€Œç…§ç‰‡å°±æ˜¯äº§å‡ºçš„Coreæ–‡ä»¶ã€‚é‡Œé¢å«æœ‰å½“è¿›ç¨‹è¢«ç»ˆæ­¢æ—¶å†…å­˜ã€CPUå¯„å­˜å™¨ç­‰ä¿¡æ¯ï¼Œå¯ä»¥ä¾›åç»­å¼€å‘äººå‘˜è¿›è¡Œè°ƒè¯•ã€‚ Gdbå¯ä»¥é™„ç€åœ¨ç‰¹å®šè¿›ç¨‹ä¸Šè°ƒè¯•ï¼Œä½†","title":"GDBè°ƒè¯•Pythonä»£ç "},{"content":" æœ‰ä¸¤ç§å¸¸ç”¨çš„æ–¹æ³•å¯ä»¥ä½¿å¾—ä»£ç å¹¶è¡Œæ‰§è¡Œï¼Œå¤šçº¿ç¨‹å’Œå¤šè¿›ç¨‹ ã€‚å› ä¸ºCythonè§£é‡Šå™¨çš„å®ç°ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå…·æœ‰GILé”ï¼ŒåŒä¸€æ—¶åˆ»ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è·å¾—è§£é‡Šå™¨çš„é”ã€‚å› æ­¤ï¼ŒPythonåˆ©ç”¨å¤šæ ¸å¿ƒçš„CPUåªèƒ½é€šè¿‡å¤šè¿›ç¨‹ï¼Œè€Œå¤šçº¿ç¨‹åªé€‚ç”¨äºIOå¯†é›†å‹çš„ç¨‹åºã€‚\nå¤šè¿›ç¨‹åŸºç¡€ åˆ›å»ºå¹¶å¼€å¯è¿›ç¨‹ å¯ä»¥ä½¿ç”¨multiprocessing.Process()æ¥åˆ›å»ºè¿›ç¨‹ï¼Œå®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼š\ntargetï¼Œä¸€ä¸ªå¯è°ƒç”¨çš„å‡½æ•°ï¼Œå½“è¿›ç¨‹å¼€å§‹æ—¶ä¼šæ‰§è¡Œ argsï¼Œä¸€ä¸ªå…ƒç»„ï¼Œæä¾›ç›®æ ‡å‡½æ•°çš„å‚æ•° ä½¿ç”¨process.start()æ¥å¼€å§‹æ‰§è¡Œä¸€ä¸ªè¿›ç¨‹\nè°ƒç”¨process.join()æ¥å‘Šè¯‰ç¨‹åºç­‰å¾…è¿›ç¨‹ç»“æŸå†æ‰§è¡Œåç»­ä»£ç ï¼Œä¸»è¿›ç¨‹å°†ä¼šè¢«é˜»å¡\nfrom multiprocessing import Process import os def square_numbers(): for i in range(1000): result = i * i if __name__ == \u0026#34;__main__\u0026#34;: processes = [] num_processes = os.cpu_count() # number of CPUs on the machine. Usually a good choise for the number of processes # create processes and asign a function for each process for i in range(num_processes): process = Process(target=square_numbers) processes.append(process) # start all processes for process in processes: process.start() # wait for all processes to finish # block the main programm until these processes are finished for process in processes: process.join() è¿›ç¨‹é—´åˆ†äº«æ•°æ® å› ä¸ºè¿›ç¨‹çš„å†…å­˜ç©ºé—´ä¸åŒï¼Œéœ€è¦ç‰¹æ®Šçš„å…±äº«å†…å­˜å¯¹è±¡æ¥åˆ†äº«æ•°æ®ã€‚\næ•°æ®å¯ä»¥ä¿å­˜åœ¨å…±äº«å†…å­˜å˜é‡ä¸­ï¼Œä½¿ç”¨Valueæˆ–è€…Array\nValue(type, value)åˆ›å»ºä¸€ä¸ªctypeå¯¹è±¡ Array(type, value)åˆ›å»ºä¸€ä¸ªctypeç±»å‹çš„åˆ—è¡¨ å¦‚ä¸‹ç¨‹åºæ¼”ç¤ºå¹´race conditionèµ„æºç«Ÿæ€ï¼Œæ¯æ¬¡æ‰§è¡Œç»“æœéƒ½ä¸ä¸€æ ·ï¼Œä¾‹å¦‚å½“ä¸¤ä¸ªè¿›ç¨‹è¯»å–åŒä¸€ä¸ªå€¼ï¼Œå¹¶å¯¹å…¶æ‰§è¡Œ+1æ“ä½œï¼Œç„¶åå†™ä¼šåŸæœ‰åœ°å€ï¼Œå…¶ç»“æœå¹¶ä¸æ˜¯é¢„æƒ³çš„åŠ 2ã€‚\nfrom multiprocessing import Process, Value, Array import time def add_100(number): for _ in range(100): time.sleep(0.001) number.value += 1 def add_100_array(numbers): for _ in range(100): time.sleep(0.01) for i in range(len(numbers)): numbers[i] += 1 if __name__ == \u0026#34;__main__\u0026#34;: shared_number = Value(\u0026#39;i\u0026#39;, 0) print(\u0026#39;Value at beginning:\u0026#39;, shared_number.value) shared_array = Array(\u0026#39;d\u0026#39;, [0.0, 100.0, 200.0]) print(\u0026#39;Array at beginning:\u0026#39;, shared_array[:]) process1 = Process(target=add_100, args=(shared_number,)) process2 = Process(target=add_100, args=(shared_number,)) process3 = Process(target=add_100_array, args=(shared_array,)) process4 = Process(target=add_100_array, args=(shared_array,)) process1.start() process2.start() process3.start() process4.start() process1.join() process2.join() process3.join() process4.join() print(\u0026#39;Value at end:\u0026#39;, shared_number.value) print(\u0026#39;Array at end:\u0026#39;, shared_array[:]) print(\u0026#39;end main\u0026#39;) \u0026#34;\u0026#34;\u0026#34; Value at beginning: 0 Array at beginning: [0.0, 100.0, 200.0] Value at end: 144 Array at end: [134.0, 237.0, 339.0] end main \u0026#34;\u0026#34;\u0026#34; å¯ä»¥ä½¿ç”¨é”é¿å…èµ„æºç«Ÿæ€ é”ï¼ˆä¹Ÿç§°ä¸ºäº’æ–¥é”ï¼‰æ˜¯ä¸€ç§åŒæ­¥æœºåˆ¶ï¼Œç”¨äºåœ¨å­˜åœ¨è®¸å¤šæ‰§è¡Œè¿›ç¨‹/çº¿ç¨‹çš„ç¯å¢ƒä¸­å¼ºåˆ¶é™åˆ¶å¯¹èµ„æºçš„è®¿é—®ã€‚é”å…·æœ‰ä¸¤ç§çŠ¶æ€ï¼šé”å®šå’Œè§£é”ã€‚ å¦‚æœçŠ¶æ€ä¸ºé”å®šï¼Œåˆ™åœ¨å†æ¬¡è§£é™¤é”å®šçŠ¶æ€ä¹‹å‰ï¼Œä¸å…è®¸å…¶ä»–å¹¶å‘è¿›ç¨‹/çº¿ç¨‹è¿›å…¥æ­¤ä»£ç æ®µã€‚\n# import Lock from multiprocessing import Lock from multiprocessing import Process, Value, Array import time def add_100(number, lock): for _ in range(100): time.sleep(0.001) # lock the state lock.acquire() number.value += 1 # unlock the state lock.release() def add_100_array(numbers, lock): for _ in range(100): time.sleep(0.01) for i in range(len(numbers)): lock.acquire() numbers[i] += 1 lock.release() if __name__ == \u0026#34;__main__\u0026#34;: # create a lock lock1 = Lock() lock2 = Lock() shared_number = Value(\u0026#39;i\u0026#39;, 0) print(\u0026#39;Value at beginning:\u0026#39;, shared_number.value) shared_array = Array(\u0026#39;d\u0026#39;, [0.0, 100.0, 200.0]) print(\u0026#39;Array at beginning:\u0026#39;, shared_array[:]) # pass the lock to the target function process1 = Process(target=add_100, args=(shared_number, lock1)) process2 = Process(target=add_100, args=(shared_number, lock1)) process3 = Process(target=add_100_array, args=(shared_array, lock2)) process4 = Process(target=add_100_array, args=(shared_array, lock2)) process1.start() process2.start() process3.start() process4.start() process1.join() process2.join() process3.join() process4.join() print(\u0026#39;Value at end:\u0026#39;, shared_number.value) print(\u0026#39;Array at end:\u0026#39;, shared_array[:]) print(\u0026#39;end main\u0026#39;) \u0026#34;\u0026#34;\u0026#34; Value at beginning: 0 Array at beginning: [0.0, 100.0, 200.0] Value at end: 200 Array at end: [200.0, 300.0, 400.0] end main \u0026#34;\u0026#34;\u0026#34; åœ¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨ä¸­ä½¿ç”¨é” ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨ç®¡ç†é”çš„è·å–å’Œé‡Šæ”¾æ›´åŠ å®‰å…¨\ndef add_100(number, lock): for _ in range(100): time.sleep(0.01) with lock: number.value += 1 å¤šè¿›ç¨‹ä½¿ç”¨é˜Ÿåˆ—é€šä¿¡ ä½¿ç”¨é˜Ÿåˆ—çš„æ“ä½œæ˜¯è¿›ç¨‹å®‰å…¨çš„ã€‚å¤šè¿›ç¨‹é˜Ÿåˆ—å®ç°äº†é˜Ÿåˆ—çš„æ‰€æœ‰æ–¹æ³•ã€‚done()å’Œjoin()é™¤å¤–ã€‚\nq.get():ç§»é™¤é˜Ÿé¦–ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œé»˜è®¤æƒ…å†µï¼Œä¼šé˜»å¡ç›´åˆ°æœ‰å…ƒç´ å¯ç”¨ q.put(item)å°†å…ƒç´ å‹åˆ°é˜Ÿå°¾ï¼Œé»˜è®¤æƒ…å†µï¼Œé˜»å¡ç›´åˆ°é˜Ÿåˆ—æœ‰ç©ºçš„æ§½ q.empty()å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œè¿”å›True q.close()è¡¨æ˜å½“å‰è¿›ç¨‹ä¸ä¼šæœ‰æ–°çš„æ•°æ®æ”¾åˆ°é˜Ÿåˆ—ä¸­äº† # communicate between processes with the multiprocessing Queue # Queues are thread and process safe from multiprocessing import Process, Queue import time def square(numbers, queue): for i in numbers: time.sleep(0.01) queue.put(i*i) def make_negative(numbers, queue): for i in numbers: time.sleep(0.01) queue.put(i*-1) if __name__ == \u0026#34;__main__\u0026#34;: numbers = range(1, 6) q = Queue() p1 = Process(target=square, args=(numbers,q)) p2 = Process(target=make_negative, args=(numbers,q)) p1.start() p2.start() p1.join() p2.join() # order might not be sequential while not q.empty(): print(q.get()) print(\u0026#39;end main\u0026#39;) \u0026#34;\u0026#34;\u0026#34; 1 -1 4 -2 9 -3 16 -4 25 -5 end main \u0026#34;\u0026#34;\u0026#34; è¿›ç¨‹æ±  è¿›ç¨‹æ± å¯¹è±¡æ§åˆ¶ä¸€äº›å·¥ä½œè¿›ç¨‹workerï¼Œå¯ä»¥æ”¯æŒè¶…æ—¶å’Œå›è°ƒä»¥å®ç°å¼‚æ­¥å¤„ç†ï¼Œä¹Ÿæœ‰ä¸€äº›å¹¶è¡Œçš„mapå®ç°ã€‚å®ƒå¯ä»¥è‡ªåŠ¨ç®¡ç†å¤šä¸ªå¤„ç†å™¨ï¼Œå¹¶å°†æ•°æ®åˆ†æˆå°å—ï¼Œåœ¨å¤šä¸ªå¤„ç†å™¨ä¸Šå¹¶è¡Œå¤„ç†ã€‚\né‡è¦çš„å‡½æ•°åŒ…æ‹¬ï¼š\nmap(func, iterable[, chunksize])å°†å¯è¿­ä»£å¯¹è±¡åˆ‡åˆ†æˆå°å—ï¼Œä½œä¸ºç‹¬ç«‹ä»»åŠ¡æäº¤åˆ°è¿›ç¨‹æ± ï¼Œå¹¶è¡Œå¤„ç†ã€‚å‡½æ•°å°†ä¼šé˜»å¡ï¼Œç›´åˆ°è¿”å›ç»“æœã€‚ close()é˜»æ­¢æ›´å¤šä»»åŠ¡æ·»åŠ åˆ°è¿›ç¨‹æ± ï¼Œä¸€æ—¦ä»»åŠ¡å®Œæˆï¼Œworkerè¿›ç¨‹å°†é€€å‡º join()ç­‰å¾…å·¥ä½œè¿›ç¨‹é€€å‡ºï¼Œåœ¨è°ƒç”¨join()ä¹‹å‰éœ€è¦è°ƒç”¨close()æˆ–è€…terminate() apply(func, args)è°ƒç”¨funcå‡½æ•°ï¼Œå‚æ•°æ˜¯argsã€‚é˜»å¡ç›´åˆ°è¿”å›ç»“æœï¼Œfuncå‡½æ•°åªåœ¨è¿›ç¨‹æ± ä¸­ä¸€ä¸ªworkerä¸­æ‰§è¡Œ æœ‰map_async()å’Œapply_async()è¿™ç§éé˜»å¡çš„å¼‚æ­¥å‡½æ•° from multiprocessing import Pool import random import time def cube(number): print(\u0026#34;Hi\u0026#34;) time.sleep(random.randint(1,2)) return number * number * number if __name__ == \u0026#34;__main__\u0026#34;: numbers = range(10) p = Pool() # by default this allocates the maximum number of available # processors for this task --\u0026gt; os.cpu_count() result = p.map(cube, numbers) # or # result = [p.apply(cube, args=(i,)) for i in numbers] p.close() p.join() print(result) å¤šçº¿ç¨‹åŸºç¡€ Pythonå¤šçº¿ç¨‹ç›¸å¯¹æ¯”è¾ƒé¸¡è‚‹ï¼Œå…¶ä½¿ç”¨å’Œå¤šè¿›ç¨‹ç±»ä¼¼\nåˆ›å»ºå¹¶å¼€å§‹çº¿ç¨‹ ä½¿ç”¨threadingåº“å®ç°\nfrom threading import Thread def square_numbers(): for i in range(1000): result = i * i if __name__ == \u0026#34;__main__\u0026#34;: threads = [] num_threads = 10 # create threads and asign a function for each thread for i in range(num_threads): thread = Thread(target=square_numbers) threads.append(thread) # start all threads for thread in threads: thread.start() # wait for all threads to finish # block the main thread until these threads are finished for thread in threads: thread.join() çº¿ç¨‹é—´å…±äº«æ•°æ® çº¿ç¨‹é—´å¯ä»¥é€šè¿‡å…¨å±€å˜é‡æ¥å…±äº«æ•°æ®ï¼Œå› ä¸ºçº¿ç¨‹é—´æ˜¯å…±äº«å†…å­˜ç©ºé—´çš„\nfrom threading import Thread import time # all threads can access this global variable database_value = 0 def increase(): global database_value # needed to modify the global value # get a local copy (simulate data retrieving) local_copy = database_value # simulate some modifying operation local_copy += 1 time.sleep(0.1) # write the calculated new value into the global variable database_value = local_copy if __name__ == \u0026#34;__main__\u0026#34;: print(\u0026#39;Start value: \u0026#39;, database_value) t1 = Thread(target=increase) t2 = Thread(target=increase) t1.start() t2.start() t1.join() t2.join() print(\u0026#39;End value:\u0026#39;, database_value) print(\u0026#39;end main\u0026#39;) \u0026#34;\u0026#34;\u0026#34; Start value: 0 End value: 1 end main \u0026#34;\u0026#34;\u0026#34; ä½¿ç”¨é”å¤„ç†èµ„æºç«Ÿæ€ # import Lock from threading import Thread, Lock import time database_value = 0 def increase(lock): global database_value # lock the state lock.acquire() local_copy = database_value local_copy += 1 time.sleep(0.1) database_value = local_copy # unlock the state lock.release() if __name__ == \u0026#34;__main__\u0026#34;: # create a lock lock = Lock() print(\u0026#39;Start value: \u0026#39;, database_value) # pass the lock to the target function t1 = Thread(target=increase, args=(lock,)) # notice the comma after lock since args must be a tuple t2 = Thread(target=increase, args=(lock,)) t1.start() t2.start() t1.join() t2.join() print(\u0026#39;End value:\u0026#39;, database_value) print(\u0026#39;end main\u0026#39;) ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨\ndef increase(lock): global database_value with lock: local_copy = database_value local_copy += 1 time.sleep(0.1) database_value = local_copy å¤šçº¿ç¨‹æ¶ˆæ¯é˜Ÿåˆ—é€šä¿¡ å¯¹é˜Ÿåˆ—çš„æ“ä½œæ˜¯çº¿ç¨‹å®‰å…¨çš„\nfrom threading import Thread, Lock, current_thread from queue import Queue def worker(q, lock): while True: value = q.get() # blocks until the item is available # do stuff... with lock: # prevent printing at the same time with this lock print(f\u0026#34;in {current_thread().name} got {value}\u0026#34;) # ... # For each get(), a subsequent call to task_done() tells the queue # that the processing on this item is complete. # If all tasks are done, q.join() can unblock q.task_done() if __name__ == \u0026#39;__main__\u0026#39;: q = Queue() num_threads = 10 lock = Lock() for i in range(num_threads): t = Thread(name=f\u0026#34;Thread{i+1}\u0026#34;, target=worker, args=(q, lock)) t.daemon = True # dies when the main thread dies t.start() # fill the queue with items for x in range(20): q.put(x) q.join() # Blocks until all items in the queue have been gotten and processed. print(\u0026#39;main done\u0026#39;) \u0026#34;\u0026#34;\u0026#34; in Thread1 got 0 in Thread2 got 1 in Thread2 got 11 in Thread2 got 12 in Thread2 got 13 in Thread2 got 14 in Thread2 got 15 in Thread2 got 16 in Thread2 got 17 in Thread2 got 18 in Thread2 got 19 in Thread8 got 5 in Thread4 got 9 in Thread1 got 10 in Thread5 got 2 in Thread6 got 3 in Thread9 got 6 in Thread7 got 4 in Thread10 got 7 in Thread3 got 8 main done \u0026#34;\u0026#34;\u0026#34; Pythonæ ‡å‡†åº“è‡ªå¸¦çš„ä¸€äº›å°å·¥å…· # æŸ¥çœ‹åŒ…å®‰è£…è·¯å¾„ python -m site # å¼€å¯ç®€å•çš„http server python -m http.server # base64ç¼–ç å’Œè§£ç  echo \u0026#34;hello\u0026#34; | python -m base64 # top level await console python -m asyncio # æŸ¥çœ‹tokenizeå’Œastç»“æœ python -m tokenize cgi.py pythono -m ast cgi.py # jsonç¾åŒ–è¾“å‡º echo \u0026#39;{\u0026#34;foo\u0026#34;: \u0026#34;bar\u0026#34;}\u0026#39; | python -m json.tool # æ˜¾ç¤ºæ—¥å† python -m calendar å‚è€ƒ Pythonå¤šçº¿ç¨‹å’Œå¤šè¿›ç¨‹ CLI tools hidden in the Python standard library | Simon Willisonâ€™s TILs\n","permalink":"https://blog.niuhemoon.win/posts/tech/python-advanced-3/","summary":"æœ‰ä¸¤ç§å¸¸ç”¨çš„æ–¹æ³•å¯ä»¥ä½¿å¾—ä»£ç å¹¶è¡Œæ‰§è¡Œï¼Œå¤šçº¿ç¨‹å’Œå¤šè¿›ç¨‹ ã€‚å› ä¸ºCythonè§£é‡Šå™¨çš„å®ç°ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå…·æœ‰GILé”ï¼ŒåŒä¸€æ—¶åˆ»ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è·å¾—è§£é‡Šå™¨çš„é”ã€‚å› æ­¤ï¼ŒPythonåˆ©ç”¨å¤šæ ¸å¿ƒçš„CPUåªèƒ½é€šè¿‡å¤šè¿›ç¨‹ï¼Œè€Œå¤šçº¿ç¨‹åªé€‚ç”¨äºIOå¯†é›†å‹çš„ç¨‹åºã€‚ å¤šè¿›ç¨‹åŸºç¡€ åˆ›å»ºå¹¶å¼€å¯è¿›ç¨‹ å¯ä»¥ä½¿ç”¨mult","title":"Pythonè¿›é˜¶ä¸‹"},{"content":"ç”Ÿæˆå™¨Generator def countdown(num): print(\u0026#39;Starting\u0026#39;) while num \u0026gt; 0: yield num num -= 1 # this will not print \u0026#39;Starting\u0026#39; cd = countdown(3) # this will print \u0026#39;Starting\u0026#39; and the first value print(next(cd)) # will print the next values print(next(cd)) print(next(cd)) # this will raise a StopIteration print(next(cd)) è¿­ä»£å™¨ä½¿ç”¨æ–¹å¼\n# you can iterate over a generator object with a for in loop cd = countdown(3) for x in cd: print(x) # you can use it for functions that take iterables as input cd = countdown(3) sum_cd = sum(cd) print(sum_cd) cd = countdown(3) sorted_cd = sorted(cd) print(sorted_cd) ç”Ÿæˆå™¨è¡¨è¾¾å¼\n# generator expression mygenerator = (i for i in range(1000) if i % 2 == 0) print(sys.getsizeof(mygenerator), \u0026#34;bytes\u0026#34;) # list comprehension mylist = [i for i in range(1000) if i % 2 == 0] print(sys.getsizeof(mylist), \u0026#34;bytes\u0026#34;) # 120bytes # 4272 bytes ç”Ÿæˆå™¨æ¦‚å¿µ ç±»å¯ä»¥å®ç°ç”Ÿæˆå™¨ä½œä¸ºä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œå®ƒéœ€è¦å®ç°__iter__æ–¹æ³•å’Œ__next__æ–¹æ³•ï¼Œä½¿å¾—ç±»å¯¹è±¡å¯è¿­ä»£ã€‚æ­¤å¤–ï¼Œè¿˜éœ€è¦æ³¨æ„è®°å½•è¿­ä»£æ¬¡æ•°ï¼Œä»¥åŠæœ€åraiseä¸€ä¸ªStopIterationå¼‚å¸¸ã€‚\nclass firstn: def __init__(self, n): self.n = n self.num = 0 def __iter__(self): return self def __next__(self): if self.num \u0026lt; self.n: cur = self.num self.num += 1 return cur else: raise StopIteration() firstn_object = firstn(1000000) print(sum(firstn_object)) è£…é¥°å™¨Decorators è£…é¥°å™¨çš„å…¸å‹ä½¿ç”¨åœºæ™¯æœ‰ï¼š\nè®¡ç®—å‡½æ•°æ‰§è¡Œæ—¶é—´ ç”¨äºè°ƒè¯•ï¼Œæ‰“å°å‡ºå‡½æ•°çš„å‚æ•°å’Œè°ƒç”¨ä¿¡æ¯ ä½œä¸ºå‡½æ•°çš„å‚æ•°æ ¡éªŒ ä»¥æ’ä»¶çš„å½¢å¼æ³¨å†Œå‡½æ•° é™ä½ä»£ç æ‰§è¡Œé€Ÿåº¦æ¥æµ‹è¯•ç½‘ç»œï¼Œå¦‚ä½¿ç”¨sleepå‡½æ•° ç¼“å­˜ä»£ç æ‰§è¡Œç»“æœMemoization é™„åŠ ä¿¡æ¯æˆ–è€…æ›´æ–°çŠ¶æ€ è£…é¥°å™¨å°±æ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œå¦‚ä¸‹è£…é¥°å™¨å°±ç±»ä¼¼target = somedecorator(target)\nè£…é¥°å™¨ä¸€ä¸ªç‰¹æ€§å°±æ˜¯å°†è¢«è£…é¥°å‡½æ•°æ›¿æ¢ä¸ºå…¶ä»–å‡½æ•°\n@somedecorator def target(): print(\u0026#34;running target\u0026#34;) ç®€å•è£…é¥°å™¨æ¨¡æ¿\nimport functools def my_decorator(func): @functools.wraps(func)\t# ä¿æŒè¢«è£…é¥°å‡½æ•°çš„å±æ€§ def wrapper(*args, **kwargs): # Do something before result = func(*args, **kwargs) # Do something after return result return wrapper å¸¦å‚æ•°çš„è£…é¥°å™¨å‡½æ•°ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯ä¸¤å±‚å‡½æ•°ï¼Œåœ¨ç®€å•è£…é¥°å™¨å¤–éƒ¨å¥—ä¸€ä¸ªå‡½æ•°æ¥æ‰©å±•è£…é¥°å™¨çš„è¡Œä¸ºã€‚\nå³ä¸¤å±‚é—­åŒ…ï¼Œä¸€ä¸ªæŒæœ‰å¤–éƒ¨ç¯å¢ƒå˜é‡çš„å‡½æ•°å°±æ˜¯é—­åŒ…ã€‚\ndef repeat(num_times): def decorator_repeat(func): @functools.wraps(func) def wrapper(*args, **kwargs): for _ in range(num_times): result = func(*args, **kwargs) return result return wrapper return decorator_repeat @repeat(num_times=3) def greet(name): print(f\u0026#34;Hello {name}\u0026#34;) greet(\u0026#39;Alex\u0026#39;) # è¾“å‡º \u0026#34;\u0026#34;\u0026#34; Hello Alex Hello Alex Hello Alex \u0026#34;\u0026#34;\u0026#34; å±‚å è£…é¥°å™¨ è£…é¥°å™¨çš„æ‰§è¡Œé¡ºåºæ˜¯decorator(func)ï¼Œä»å¤–åˆ°å†…æ‰§è¡Œï¼Œå¦‚æœæœ‰å¤šä¸ªè£…é¥°å™¨å †å åœ¨ä¸€èµ·ï¼ŒæŒ‰ç…§decorator2(docorator1(func))çš„æ‰§è¡Œé¡ºåºã€‚\nå…¶æ›´æ¸…æ™°çš„æ‰§è¡Œé¡ºåºæ˜¯ï¼š\nfunc = decorator1(func) func = decorator2(func) func() å¤šä¸ªè£…é¥°å™¨è£…é¥°å‡½æ•°æ—¶ï¼Œæœ‰ä¸ªè§„å¾‹æ˜¯ä»ä¸‹åˆ°ä¸ŠåŒ…è£¹ï¼ˆè£…é¥°ï¼‰å‡½æ•°ï¼Œåœ¨è£…é¥°çš„è¿‡ç¨‹ä¸­æ‰§è¡Œè£…é¥°å™¨å‡½æ•°å’Œå†…éƒ¨é—­åŒ…wrapperå‡½æ•°ä¹‹é—´ä»£ç ï¼Œé—­åŒ…å‡½æ•°çŸ¥è¯†ä½œä¸ºä¸€ä¸ªå¯¹è±¡è¢«è¿”å›ï¼Œåœ¨è£…é¥°è¿‡ç¨‹ä¸­å¹¶ä¸æ‰§è¡Œã€‚\nè€Œåœ¨æ‰§è¡Œè¢«è£…é¥°å‡½æ•°çš„è¿‡ç¨‹ä¸­ï¼Œä»ä¸Šåˆ°ä¸‹æ‰§è¡Œwrapperå‡½æ•°å†…éƒ¨çš„ä»£ç ã€‚\nå¦‚ä¸‹ä»£ç å¤šä¸ªè£…é¥°å™¨ï¼Œå…¶è£…é¥°çš„é¡ºåºå’Œwrapperæ‰§è¡Œçš„é¡ºåºç›¸åã€‚\n# è£…é¥°è¿‡ç¨‹ say_hello = start_end_decorator_2(start_end_decorator_1(say_hello)) say_hello() å¤šè£…é¥°å™¨å®éªŒ\nimport functools # a decorator function that prints debug information about the wrapped function def start_end_decorator_2(func): print(\u0026#39;Start decorator2\u0026#39;) @functools.wraps(func) def wrapper2(*args, **kwargs): print(\u0026#39;Exec wrapper 2\u0026#39;) result = func(*args, **kwargs) print(\u0026#39;End wrapper 2\u0026#39;) return result return wrapper2 def start_end_decorator_1(func): print(\u0026#39;Start decorator1\u0026#39;) @functools.wraps(func) def wrapper1(*args, **kwargs): print(\u0026#39;Exec wrapper 1\u0026#39;) result = func(*args, **kwargs) print(\u0026#39;End wrapper 1\u0026#39;) return result return wrapper1 @start_end_decorator_2 @start_end_decorator_1 def say_hello(name): greeting = f\u0026#39;Hello {name}\u0026#39; print(greeting) return greeting \u0026#34;\u0026#34;\u0026#34; ç›¸å½“äº func = start_end_decorator_1(func) æ­¤æ—¶funcæ˜¯ä¸‹é¢è¿™ä¸ªwrapper1å‡½æ•° def wrapper1(*args, **kwargs): print(\u0026#39;Exec wrapper 1\u0026#39;) result = func(*args, **kwargs) print(\u0026#39;End wrapper 1\u0026#39;) return result å†ç»è¿‡ä¸‹ä¸€ä¸ªè£…é¥°å™¨start_end_decorator_2 funcå†æ¬¡è¢«æ›¿æ¢ func = start_end_decorator_2(start_end_decorator_1(func)) \u0026#34;\u0026#34;\u0026#34; say_hello(name=\u0026#39;Alex\u0026#39;) # exec result \u0026#34;\u0026#34;\u0026#34; Start decorator1 Start decorator2 Exec wrapper 2 Exec wrapper 1 Hello Alex End wrapper 1 End wrapper 2 \u0026#34;\u0026#34;\u0026#34; è£…é¥°å™¨æ‰§è¡Œæ—¶é—´ è£…é¥°å™¨éœ€è¦åŒºåˆ†å¯¼å…¥æ—¶å’Œè¿è¡Œæ—¶ï¼Œ\nè£…é¥°å™¨ä¸€ä¸ªç‰¹æ€§å°±æ˜¯è£…é¥°çš„è¿‡ç¨‹åœ¨importæ—¶æ‰§è¡Œï¼Œå½“importä»£ç æ—¶ï¼Œè£…é¥°å™¨ç«‹åˆ»æ‰§è¡Œï¼Œå°†è¢«è£…é¥°å‡½æ•°å˜ä¸ºå¦ä¸€ä¸ªå‡½æ•°ã€‚\nregistry = [] def register(func): print(\u0026#34;running register(%s)\u0026#34; % func) registry.append(func) return func @register def f1(): print(\u0026#34;running f1\u0026#34;) @register def f2(): print(\u0026#34;running f2\u0026#34;) def f3(): print(\u0026#34;running f3\u0026#34;) def main(): print(\u0026#34;running main\u0026#34;) print(\u0026#34;registry -\u0026gt;\u0026#34;, registry) f1() f2() f3() if __name__ == \u0026#34;__main__\u0026#34;: main() # importè¯¥æ¨¡å—çš„è¾“å‡ºå¦‚ä¸‹ \u0026#34;\u0026#34;\u0026#34; running register(\u0026lt;function f1 at 0x7f4105056af0\u0026gt;) running register(\u0026lt;function f2 at 0x7f4105056c10\u0026gt;) \u0026#34;\u0026#34;\u0026#34; # æ‰§è¡Œmainå‡½æ•°çš„è¾“å‡ºå¦‚ä¸‹ # åœ¨è¿è¡Œæ—¶ï¼Œè¢«è£…é¥°å‡½æ•°æ‰å¼€å§‹æ‰§è¡Œ \u0026#34;\u0026#34;\u0026#34; running register(\u0026lt;function f1 at 0x7f65b62d70d0\u0026gt;) running register(\u0026lt;function f2 at 0x7f65b62d7160\u0026gt;) running main registry -\u0026gt; [\u0026lt;function f1 at 0x7f65b62d70d0\u0026gt;, \u0026lt;function f2 at 0x7f65b62d7160\u0026gt;] running f1 running f2 running f3 \u0026#34;\u0026#34;\u0026#34; ç±»è£…é¥°å™¨ å¯ä»¥ä½¿ç”¨ç±»ä½œä¸ºè£…é¥°å™¨ï¼Œå› æ­¤ï¼Œéœ€è¦é¦–å…ˆå®ç°é­”æ³•æ–¹æ³•__call__ï¼Œä½¿å¾—å¯¹è±¡æ˜¯callableå¯è°ƒç”¨çš„ï¼Œç±»è£…é¥°å™¨å…¸å‹ç”¨å¤„æ˜¯ä¿å­˜çŠ¶æ€ï¼Œå¦‚å‡½æ•°è¢«è°ƒç”¨æ¬¡æ•°ã€‚æˆ‘ä»¬ä½¿ç”¨functools.update_wrapper()è€Œä¸æ˜¯functools.wrapsæ¥æŒä¹…åŒ–è¢«è£…é¥°å™¨å‡½æ•°ä¿¡æ¯ã€‚\nimport functools class CountCalls: # the init needs to have the func as argument and stores it def __init__(self, func): functools.update_wrapper(self, func) self.func = func self.num_calls = 0 # extend functionality, execute function, and return the result def __call__(self, *args, **kwargs): self.num_calls += 1 print(f\u0026#34;Call {self.num_calls} of {self.func.__name__!r}\u0026#34;) return self.func(*args, **kwargs) @CountCalls def say_hello(num): print(\u0026#34;Hello!\u0026#34;) say_hello(5) say_hello(5) # result \u0026#34;\u0026#34;\u0026#34; Call 1 of \u0026#39;say_hello\u0026#39; Hello! Call 2 of \u0026#39;say_hello\u0026#39; Hello! \u0026#34;\u0026#34;\u0026#34; Context Managers ä¸Šä¸‹æ–‡ç®¡ç†å™¨ç”¨äºèµ„æºç®¡ç†ï¼Œå…è®¸ä½ æ–¹ä¾¿çš„åˆ†é…å’Œé‡Šæ”¾èµ„æº\nPythonå†…ç½®çš„å…³é”®å­—withç”¨äºå¤„ç†ä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼Œä¸Šä¸‹æ–‡ç®¡ç†å™¨å…¸å‹çš„ç”¨é€”æœ‰ï¼š\næ‰“å¼€å’Œå…³é—­æ–‡ä»¶ æ‰“å¼€å’Œå…³é—­æ•°æ®åº“è¿æ¥ è·å¾—å’Œé‡Šæ”¾é” from threading import Lock lock = Lock() # error-prone: lock.acquire() # do stuff # lock should always be released! lock.release() # Better: with lock: # do stuff å®ç°ä¸€ä¸ªä¸Šä¸‹æ–‡ç®¡ç†å™¨ç±» ä¸ºäº†æ”¯æŒwithå…³é”®å­—ï¼Œéœ€è¦åœ¨ç±»ä¸­å®ç°__enter__å’Œ__exit__æ–¹æ³•ï¼Œå½“Pythonæ‰§è¡Œåˆ°withè¯­å¥ï¼Œä¼šæ‰§è¡Œ__enter__æ–¹æ³•ï¼Œæ­¤æ—¶åº”è¯¥è·å–èµ„æºå¹¶è¿”å›ï¼Œè€Œå½“ç¦»å¼€ä¸Šä¸‹æ–‡ç¯å¢ƒæ—¶ï¼Œå°†æ‰§è¡Œ__exit__æ–¹æ³•ï¼Œæ­¤æ—¶åº”è¯¥é‡Šæ”¾èµ„æºã€‚\nclass ManagedFile: def __init__(self, filename): print(\u0026#39;init\u0026#39;, filename) self.filename = filename def __enter__(self): print(\u0026#39;enter\u0026#39;) self.file = open(self.filename, \u0026#39;w\u0026#39;) return self.file def __exit__(self, exc_type, exc_value, exc_traceback): if self.file: self.file.close() print(\u0026#39;exit\u0026#39;) with ManagedFile(\u0026#39;notes.txt\u0026#39;) as f: print(\u0026#39;doing stuff...\u0026#39;) f.write(\u0026#39;some todo...\u0026#39;) å¤„ç†å¼‚å¸¸ å½“å¼‚å¸¸äº§ç”Ÿæ—¶ï¼ŒPythonå°†å¼‚å¸¸ç±»å‹ã€å€¼å’Œtracebackä¿¡æ¯ä¼ é€’ç»™__exit__æ–¹æ³•ï¼Œå®ƒå¯ä»¥å¤„ç†è¯¥å¼‚å¸¸ã€‚å¦‚æœ__exit__æ–¹æ³•è¿”å›äº†é™¤Trueä¹‹å¤–çš„ä»»ä½•å€¼ï¼Œåˆ™ç”±withè¯­å¥å¼•å‘å¼‚å¸¸ã€‚\nclass ManagedFile: def __init__(self, filename): print(\u0026#39;init\u0026#39;, filename) self.filename = filename def __enter__(self): print(\u0026#39;enter\u0026#39;) self.file = open(self.filename, \u0026#39;w\u0026#39;) return self.file def __exit__(self, exc_type, exc_value, exc_traceback): if self.file: self.file.close() print(\u0026#39;exc:\u0026#39;, exc_type, exc_value) print(\u0026#39;exit\u0026#39;) # No exception with ManagedFile(\u0026#39;notes.txt\u0026#39;) as f: print(\u0026#39;doing stuff...\u0026#39;) f.write(\u0026#39;some todo...\u0026#39;) print(\u0026#39;continuing...\u0026#39;) print() # Exception is raised, but the file can still be closed with ManagedFile(\u0026#39;notes2.txt\u0026#39;) as f: print(\u0026#39;doing stuff...\u0026#39;) f.write(\u0026#39;some todo...\u0026#39;) f.do_something() print(\u0026#39;continuing...\u0026#39;) ä¹Ÿå¯ä»¥åœ¨__exit__æ–¹æ³•ä¸­å¤„ç†å¼‚å¸¸ï¼Œå¹¶è¿”å›True\nclass ManagedFile: def __init__(self, filename): print(\u0026#39;init\u0026#39;, filename) self.filename = filename def __enter__(self): print(\u0026#39;enter\u0026#39;) self.file = open(self.filename, \u0026#39;w\u0026#39;) return self.file def __exit__(self, exc_type, exc_value, exc_traceback): if self.file: self.file.close() if exc_type is not None: print(\u0026#39;Exception has been handled\u0026#39;) print(\u0026#39;exit\u0026#39;) return True with ManagedFile(\u0026#39;notes2.txt\u0026#39;) as f: print(\u0026#39;doing stuff...\u0026#39;) f.write(\u0026#39;some todo...\u0026#39;) f.do_something() print(\u0026#39;continuing...\u0026#39;) ç”¨ç”Ÿæˆå™¨å®ç°ä¸€ä¸ªä¸Šä¸‹æ–‡ç®¡ç†å™¨ ä¸å…¶å†™ä¸€ä¸ªç±»ï¼Œä¹Ÿå¯ä»¥å†™ä¸€ä¸ªç”Ÿæˆå™¨å‡½æ•°ï¼Œå¹¶ç”¨contextlib.contextmanageræ¥è£…é¥°å®ƒã€‚\nä¸ºäº†å®ç°è¿™ä¸ªç›®çš„ï¼Œå‡½æ•°å¿…é¡»åœ¨tryè¯­å¥æ®µä¸­yieldèµ„æºï¼Œè€Œåœ¨finallyè¯­å¥ä¸­å®ç°ç±»ä¼¼__exit__çš„åŠŸèƒ½ï¼Œå³é‡Šæ”¾èµ„æºã€‚\nfrom contextlib import contextmanager @contextmanager def open_managed_file(filename): f = open(filename, \u0026#39;w\u0026#39;) try: yield f finally: f.close() with open_managed_file(\u0026#39;notes.txt\u0026#39;) as f: f.write(\u0026#39;some todo...\u0026#39;) ç”Ÿæˆå™¨é¦–å…ˆè·å–èµ„æºï¼Œç„¶åæš‚æ—¶æŒ‚èµ·æ‰§è¡Œæµç¨‹ï¼Œå¹¶yeildè¿”å›èµ„æºï¼Œèµ„æºå¯ä»¥è¢«è°ƒç”¨è€…ä½¿ç”¨ï¼Œå½“è°ƒç”¨ç€ç¦»å¼€withä¸Šä¸‹æ–‡ï¼Œç”Ÿæˆå™¨æ¥ç€æ‰§è¡Œåç»­çš„finallyè¯­å¥ï¼Œé‡Šæ”¾èµ„æºã€‚\nPythonä¸­çš„è§£å¼•ç”¨ Pythonä¸­çš„*å·å…·æœ‰å¤šç§ä½œç”¨ï¼š\nUse *args for variable-length arguments Use **kwargs for variable-length keyword arguments Use *, followed by more function parameters to enforce keyword-only arguments def my_function(*args, **kwargs): for arg in args: print(arg) for key in kwargs: print(key, kwargs[key]) my_function(\u0026#34;Hey\u0026#34;, 3, [0, 1, 2], name=\u0026#34;Alex\u0026#34;, age=8) # Parameters after \u0026#39;*\u0026#39; or \u0026#39;*identifier\u0026#39; are keyword-only parameters and may only be passed using keyword arguments. def my_function2(name, *, age): print(name) print(age) # my_function2(\u0026#34;Michael\u0026#34;, 5) --\u0026gt; this would raise a TypeError my_function2(\u0026#34;Michael\u0026#34;, age=5) Pythonå‡½æ•°ä¼ å‚ä»¥åŠæ·±æ‹·è´æµ…æ‹·è´ åœ¨Pythonä¸­ï¼Œèµ‹å€¼è¯­å¥obj_b = obj_aä¸äº§ç”ŸçœŸæ­£çš„å¯¹è±¡æ‹·è´ï¼Œåªåˆ›å»ºä¸€ä¸ªæ–°çš„å˜é‡å’Œobj_aå…·æœ‰ç›¸åŒçš„å¼•ç”¨ï¼Œå› æ­¤å½“ä½ æƒ³è¦äº§ç”Ÿå¯å˜å¯¹è±¡çš„çœŸæ­£çš„æ‹·è´ï¼Œå¹¶åœ¨ä¸å½±å“åŸæ¥å¯¹è±¡çš„æƒ…å†µä¸‹ä¿®æ”¹æ‹·è´å¯¹è±¡æ—¶ï¼Œéœ€è¦æ ¼å¤–å°å¿ƒã€‚\nå¯ä»¥ä½¿ç”¨copyæ¨¡å—äº§ç”ŸçœŸæ­£çš„æ‹·è´ï¼Œç„¶è€Œï¼Œå¯¹äºæ··åˆ/åµŒå¥—å¯¹è±¡ï¼Œæµ…æ‹·è´å’Œæ·±æ‹·è´æœ‰é‡è¦çš„åŒºåˆ«ï¼Œ\næµ…æ‹·è´\nåªæœ‰ä¸€å±‚æ·±ï¼Œå¯¹äºæ¯”ä¸€å±‚æ·±çš„åµŒå¥—å¯¹è±¡æ˜¯æºå¯¹è±¡çš„å¼•ç”¨ï¼Œå› æ­¤ä¿®æ”¹ä¼šå¯¼è‡´æºå¯¹è±¡çš„æ›´æ”¹\næ·±æ‹·è´\nä¸€ä»½å®Œå…¨ç‹¬ç«‹çš„æ‹·è´ï¼Œé€’å½’äº§ç”Ÿæºå¯¹è±¡ä¸­æ‰€æœ‰åµŒå¥—å¯¹è±¡çš„æ‹·è´\nèµ‹å€¼æ“ä½œ ä¼šäº§ç”Ÿæºå¯¹è±¡çš„ä¸€ä¸ªå¼•ç”¨ï¼Œä¿®æ”¹ä¼šå¯¼è‡´æºå¯¹è±¡çš„å˜æ›´\nlist_a = [1, 2, 3, 4, 5] list_b = list_a list_a[0] = -10 print(list_a) print(list_b) \u0026#34;\u0026#34;\u0026#34; [-10, 2, 3, 4, 5] [-10, 2, 3, 4, 5] \u0026#34;\u0026#34;\u0026#34; æµ…æ‹·è´ æµ…æ‹·è´åªæœ‰ä¸€å±‚æ·±åº¦ï¼Œä¿®æ”¹ç¬¬ä¸€å±‚ä¸ä¼šå½±å“æºå¯¹è±¡ï¼Œä½¿ç”¨copy.copy()æ–¹æ³•æˆ–è€…å¯¹è±¡ç‰¹å®šçš„æ‹·è´æ–¹æ³•æˆ–è€…æ‹·è´æ„é€ å‡½æ•°\nimport copy list_a = [1, 2, 3, 4, 5] list_b = copy.copy(list_a) # not affects the other list list_b[0] = -10 print(list_a) print(list_b) ä½†æ˜¯åœ¨åµŒå¥—å¯¹è±¡ä¸­ï¼Œä¿®æ”¹ç¬¬äºŒå±‚æˆ–è€…æ›´æ·±å±‚æ¬¡çš„æ•°æ®æ—¶ï¼Œä¼šå½±å“åˆ°æºå¯¹è±¡ï¼Œå› ä¸ºåœ¨ç¬¬äºŒå±‚æ—¶æ‹·è´çš„æ˜¯å¼•ç”¨ï¼Œè€Œä¸æ˜¯å€¼ã€‚\nimport copy list_a = [[1, 2, 3, 4, 5], [6, 7, 8, 9, 10]] list_b = copy.copy(list_a) # affects the other! list_a[0][0]= -10 print(list_a) print(list_b) \u0026#34;\u0026#34;\u0026#34; [[-10, 2, 3, 4, 5], [6, 7, 8, 9, 10]] [[-10, 2, 3, 4, 5], [6, 7, 8, 9, 10]] \u0026#34;\u0026#34;\u0026#34; å¯¹äºåˆ—è¡¨ï¼Œç±»ä¼¼çš„æµ…æ‹·è´æ–¹æ³•è¿˜æœ‰\n# shallow copies list_b = list(list_a) list_b = list_a[:] list_b = list_a.copy() æ·±æ‹·è´ æ·±æ‹·è´æ˜¯ä¸€ä»½å®Œå…¨ç‹¬ç«‹çš„å…‹éš†ï¼Œä½¿ç”¨copy.deepcopyæ–¹æ³•å®ç°\nimport copy list_a = [[1, 2, 3, 4, 5], [6, 7, 8, 9, 10]] list_b = copy.deepcopy(list_a) # not affects the other list_a[0][0]= -10 print(list_a) print(list_b) \u0026#34;\u0026#34;\u0026#34; [[-10, 2, 3, 4, 5], [6, 7, 8, 9, 10]] [[1, 2, 3, 4, 5], [6, 7, 8, 9, 10]] \u0026#34;\u0026#34;\u0026#34; å¯¹è±¡çš„æ·±æ‹·è´å’Œæµ…æ‹·è´ å¯ä»¥ä½¿ç”¨copyæ¨¡å—å®ç°å¯¹ç‰¹å®šå¯¹è±¡çš„æ·±æ‹·è´æˆ–è€…æµ…æ‹·è´\nèµ‹å€¼åªæ‹·è´å¯¹è±¡å¼•ç”¨ class Person: def __init__(self, name, age): self.name = name self.age = age # Only copies the reference p1 = Person(\u0026#39;Alex\u0026#39;, 27) p2 = p1 p2.age = 28 print(p1.age) print(p2.age) \u0026#34;\u0026#34;\u0026#34; 28 28 \u0026#34;\u0026#34;\u0026#34; æµ…æ‹·è´æ‹·è´ä¸€å±‚ # shallow copy import copy p1 = Person(\u0026#39;Alex\u0026#39;, 27) p2 = copy.copy(p1) p2.age = 28 print(p1.age) print(p2.age) \u0026#34;\u0026#34;\u0026#34; 27 28 \u0026#34;\u0026#34;\u0026#34; æ·±æ‹·è´å¯ä»¥å®Œæ•´æ‹·è´ class Company: def __init__(self, boss, employee): self. boss = boss self.employee = employee # shallow copy will affect nested objects boss = Person(\u0026#39;Jane\u0026#39;, 55) employee = Person(\u0026#39;Joe\u0026#39;, 28) company = Company(boss, employee) company_clone = copy.copy(company) company_clone.boss.age = 56 print(company.boss.age) print(company_clone.boss.age) \u0026#34;\u0026#34;\u0026#34; 56 56 \u0026#34;\u0026#34;\u0026#34; # deep copy will not affect nested objects boss = Person(\u0026#39;Jane\u0026#39;, 55) employee = Person(\u0026#39;Joe\u0026#39;, 28) company = Company(boss, employee) company_clone = copy.deepcopy(company) company_clone.boss.age = 56 print(company.boss.age) print(company_clone.boss.age) \u0026#34;\u0026#34;\u0026#34; 55 56 \u0026#34;\u0026#34;\u0026#34; å‡½æ•°ä¼ å‚ åœ¨Cè¯­è¨€ä¸­ä¼ å‚æœ‰æ˜¾å¼çš„å€¼ä¼ é€’å’Œåœ°å€ä¼ é€’ï¼Œåœ¨Pythonä¸­ä¹Ÿæœ‰ç±»ä¼¼çš„æœºåˆ¶ã€‚\nPythonä¸­æ•°æ®ç±»å‹å­˜åœ¨å¯å˜å’Œä¸å¯å˜çš„åŒºåˆ«ï¼Œå³mutableå’Œimmutableã€‚\nå¯¹äºå¯å˜ç±»å‹ï¼Œä¾‹å¦‚åˆ—è¡¨ï¼Œç”±äºä¼ é€’çš„æ˜¯åˆ—è¡¨çš„å¼•ç”¨ï¼Œåˆ—è¡¨å¯ä»¥åœ¨ä¸€ä¸ªæ–¹æ³•ä¸­è¢«ä¿®æ”¹\n# immutable objects -\u0026gt; no change def foo(x): x = 5 # x += 5 also no effect since x is immutable and a new variable must be created var = 10 print(\u0026#39;var before foo():\u0026#39;, var) foo(var) print(\u0026#39;var after foo():\u0026#39;, var) \u0026#34;\u0026#34;\u0026#34; var before foo(): 10 var after foo(): 10 \u0026#34;\u0026#34;\u0026#34; å¯å˜å¯¹è±¡ # mutable objects -\u0026gt; change def foo(a_list): a_list.append(4) my_list = [1, 2, 3] print(\u0026#39;my_list before foo():\u0026#39;, my_list) foo(my_list) print(\u0026#39;my_list after foo():\u0026#39;, my_list) \u0026#34;\u0026#34;\u0026#34; my_list before foo(): [1, 2, 3] my_list after foo(): [1, 2, 3, 4] \u0026#34;\u0026#34;\u0026#34; é‡æ–°ç»‘å®šä¸€ä¸ªå¯å˜å¯¹è±¡çš„å¼•ç”¨ # Rebind a mutable reference -\u0026gt; no change def foo(a_list): # èµ‹å€¼æ“ä½œäº§ç”Ÿä¸€ä¸ªæ–°çš„å±€éƒ¨å˜é‡ a_list = [50, 60, 70] # a_list is now a new local variable within the function a_list.append(50) my_list = [1, 2, 3] print(\u0026#39;my_list before foo():\u0026#39;, my_list) foo(my_list) print(\u0026#39;my_list after foo():\u0026#39;, my_list) åŒºåˆ†+=å’Œ= # another example with rebinding references: def foo(a_list): a_list += [4, 5] # this chanches the outer variable def bar(a_list): a_list = a_list + [4, 5] # this rebinds the reference to a new local variable my_list = [1, 2, 3] print(\u0026#39;my_list before foo():\u0026#39;, my_list) foo(my_list) print(\u0026#39;my_list after foo():\u0026#39;, my_list) my_list = [1, 2, 3] print(\u0026#39;my_list before bar():\u0026#39;, my_list) bar(my_list) print(\u0026#39;my_list after bar():\u0026#39;, my_list) \u0026#34;\u0026#34;\u0026#34; my_list before foo(): [1, 2, 3] my_list after foo(): [1, 2, 3, 4, 5] my_list before bar(): [1, 2, 3] my_list after bar(): [1, 2, 3] \u0026#34;\u0026#34;\u0026#34; å‚è€ƒ Python-Notebook\nPythonä¸­çš„*å·\né—­åŒ…æ¦‚å¿µ\nPythonè£…é¥°å™¨\n","permalink":"https://blog.niuhemoon.win/posts/tech/python-advanced-2/","summary":"ç”Ÿæˆå™¨Generator def countdown(num): print(\u0026#39;Starting\u0026#39;) while num \u0026gt; 0: yield num num -= 1 # this will not print \u0026#39;Starting\u0026#39; cd = countdown(3) # this will print \u0026#39;Starting\u0026#39; and the first value print(next(cd)) # will print the next values print(next(cd)) print(next(cd)) # this will raise a StopIteration print(next(cd)) è¿­ä»£å™¨ä½¿ç”¨æ–¹å¼ # you can iterate over a generator object with a for in loop cd = countdown(3) for x in cd: print(x) # you can use it for functions that take iterables as input cd = countdown(3) sum_cd = sum(cd) print(sum_cd) cd = countdown(3) sorted_cd = sorted(cd) print(sorted_cd) ç”Ÿæˆå™¨è¡¨è¾¾å¼ # generator expression mygenerator = (i for i in range(1000) if i % 2 == 0) print(sys.getsizeof(mygenerator), \u0026#34;bytes\u0026#34;) # list comprehension mylist","title":"Pythonè¿›é˜¶ä¸­"},{"content":" Ubuntn ä¸Šä¸€ç›´ä»¥æ¥å¯¹ä¸­æ–‡è¾“å…¥æ³•çš„æ”¯æŒéƒ½ä¸æ˜¯å¾ˆå®Œå–„ï¼Œåœ¨å‡çº§åˆ° 20.04 ç‰ˆæœ¬ä¹‹åï¼Œç³»ç»Ÿé»˜è®¤è‡ªå¸¦çš„æ˜¯ ibus è¾“å…¥æ³•ï¼Œåˆšåˆšä¸Šæ‰‹ä½¿ç”¨ä¹‹åä¸æ˜¯å¾ˆå¥½ç”¨ã€‚åœ¨å°è¯•å®‰è£… fcitx å’Œæœç‹—è¾“å…¥æ³•ä¹‹åï¼Œå› ä¸ºæœç‹—è¾“å…¥æ³•å’Œ Pycharm ç­‰ IDE å†²çªï¼Œä¼šå¯¼è‡´è½¯ä»¶å¡æ­»ï¼Œè€Œä¸”èµ„æºå ç”¨è¾ƒé«˜ã€‚è¿˜æ˜¯åˆ‡æ¢å›äº† ibus è¾“å…¥æ³•ã€‚\nåœ¨ç®€å•è°ƒæ•™ä¹‹åï¼Œå‘ç° ibus è¿˜æ˜¯å¾ˆå¥½ç”¨çš„ã€‚\næ‰“å¼€ Ibus é¦–é€‰é¡¹\nå‹¾é€‰å°†æ¯ä¸ªè¾“å…¥è®°å½•ä¸ºæ–°è¯æ±‡ï¼Œç„¶åä¼šè®°å½•ç”¨æˆ·çš„è¾“å…¥å†å²ï¼Œæ–¹ä¾¿å¯¼å‡ºå¹¶è½¬ç§»\nå¯ç”¨æ¨¡ç³Šæ‹¼éŸ³å’Œè¯å…¸åŒæ ·å¯ä»¥æé«˜è¯æ±‡åŒ¹é…çš„å‡†ç¡®ç¨‹åº¦ å¯¹äºç”¨æˆ·æ•°æ®å¯ä»¥å®šæœŸå¤‡ä»½æˆ–è€…æ¸…é™¤ å½“ä¿®æ”¹é…ç½®åï¼Œéœ€è¦é‡å¯ ibus æœåŠ¡ä½¿å…¶ç”Ÿæ•ˆã€‚ä½¿ç”¨ä¸‹é¢å‘½ä»¤è¡Œé‡å¯ ibus\nibus-daemon -r -d -x éšç€æ—¥å¸¸ä½¿ç”¨ä¹‹åï¼Œibus ä¼šæ ¹æ®ä½ çš„è¾“å…¥è®°å½•ï¼Œä¼˜åŒ–å…¶è¾“å…¥æ³•ã€‚\n","permalink":"https://blog.niuhemoon.win/posts/tech/ibus-input/","summary":"Ubuntn ä¸Šä¸€ç›´ä»¥æ¥å¯¹ä¸­æ–‡è¾“å…¥æ³•çš„æ”¯æŒéƒ½ä¸æ˜¯å¾ˆå®Œå–„ï¼Œåœ¨å‡çº§åˆ° 20.04 ç‰ˆæœ¬ä¹‹åï¼Œç³»ç»Ÿé»˜è®¤è‡ªå¸¦çš„æ˜¯ ibus è¾“å…¥æ³•ï¼Œåˆšåˆšä¸Šæ‰‹ä½¿ç”¨ä¹‹åä¸æ˜¯å¾ˆå¥½ç”¨ã€‚åœ¨å°è¯•å®‰è£… fcitx å’Œæœç‹—è¾“å…¥æ³•ä¹‹åï¼Œå› ä¸ºæœç‹—è¾“å…¥æ³•å’Œ Pycharm ç­‰ IDE å†²çªï¼Œä¼šå¯¼è‡´è½¯ä»¶å¡æ­»ï¼Œè€Œä¸”èµ„æºå ç”¨è¾ƒé«˜ã€‚è¿˜æ˜¯åˆ‡æ¢å›äº† ibus è¾“å…¥æ³•ã€‚ åœ¨ç®€å•è°ƒæ•™ä¹‹åï¼Œå‘ç° ibus è¿˜æ˜¯å¾ˆå¥½ç”¨çš„ã€‚ æ‰“å¼€ Ibus é¦–é€‰é¡¹","title":"Ubuntu20_04ä¸Šä½¿ç”¨ibusä¸­æ–‡è¾“å…¥æ³•"},{"content":"åŸºç¡€ 1.1 å­—ç¬¦åŒ¹é… å­—ç¬¦ è¯´æ˜ \\ è½¬ä¹‰ç¬¦ \\d [0-9]ã€‚è¡¨ç¤ºæ˜¯ä¸€ä½æ•°å­—ã€‚ \\D [^0-9]ã€‚è¡¨ç¤ºé™¤æ•°å­—å¤–çš„ä»»æ„å­—ç¬¦ã€‚ \\w [0-9a-zA-Z_]ã€‚è¡¨ç¤ºæ•°å­—ã€å¤§å°å†™å­—æ¯å’Œä¸‹åˆ’çº¿ã€‚ \\W [^0-9a-za-z_]ã€‚éå•è¯å­—ç¬¦ã€‚ \\s [\\t\\v\\n\\r\\f]ã€‚è¡¨ç¤ºç©ºç™½ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€æ°´å¹³åˆ¶è¡¨ç¬¦ã€ å‚ç›´åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦ã€å›è½¦ç¬¦ã€æ¢é¡µç¬¦ã€‚ \\S [^\\t\\v\\n\\r\\f]ã€‚éç©ºç™½ç¬¦ã€‚ . [^\\n\\r\\u2028\\u2029]ã€‚é€šé…ç¬¦ï¼Œè¡¨ç¤ºå‡ ä¹ä»»æ„å­—ç¬¦ã€‚ æ¢è¡Œç¬¦ã€å›è½¦ç¬¦ã€è¡Œåˆ†éš”ç¬¦å’Œæ®µåˆ†éš”ç¬¦é™¤å¤–ã€‚ \\uxxxx æŸ¥æ‰¾ä»¥åå…­è¿›åˆ¶æ•° xxxx è§„å®šçš„ Unicode å­—ç¬¦ã€‚ \\f åŒ¹é…ä¸€ä¸ªæ¢é¡µç¬¦ (U+000C)ã€‚ \\n åŒ¹é…ä¸€ä¸ªæ¢è¡Œç¬¦ (U+000A)ã€‚ \\r åŒ¹é…ä¸€ä¸ªå›è½¦ç¬¦ (U+000D)ã€‚ \\t åŒ¹é…ä¸€ä¸ªæ°´å¹³åˆ¶è¡¨ç¬¦ (U+0009)ã€‚ \\v åŒ¹é…ä¸€ä¸ªå‚ç›´åˆ¶è¡¨ç¬¦ (U+000B)ã€‚ \\0 åŒ¹é… NULLï¼ˆU+0000ï¼‰å­—ç¬¦ï¼Œ ä¸è¦åœ¨è¿™åé¢è·Ÿå…¶å®ƒå°æ•°ï¼Œå› ä¸º \\0 æ˜¯ä¸€ä¸ª å…«è¿›åˆ¶è½¬ä¹‰åºåˆ—ã€‚ [\\b] åŒ¹é…ä¸€ä¸ªé€€æ ¼(U+0008)ã€‚ï¼ˆä¸è¦å’Œ\\b æ··æ·†äº†ã€‚ï¼‰ [abc] any of a, b, or c [^abc] not a, b, or c [a-g] character between a \u0026amp; g 1.2 ä½ç½®åŒ¹é… å­—ç¬¦ è¯´æ˜ \\b æ˜¯å•è¯è¾¹ç•Œï¼Œå…·ä½“å°±æ˜¯\\w å’Œ\\W ä¹‹é—´çš„ä½ç½®ï¼Œä¹ŸåŒ…æ‹¬\\w å’Œ ^ ä¹‹é—´çš„ä½ç½®ï¼Œ ä¹ŸåŒ…æ‹¬\\w å’Œ ä¹‹é—´çš„ä½ç½®ã€‚ \\B æ˜¯\\b çš„åé¢çš„æ„æ€ï¼Œéå•è¯è¾¹ç•Œã€‚ä¾‹å¦‚åœ¨å­—ç¬¦ä¸²ä¸­æ‰€æœ‰ä½ç½®ä¸­ï¼Œæ‰£æ‰\\bï¼Œ å‰©ä¸‹çš„éƒ½æ˜¯\\B çš„ã€‚ ^abc$ å­—ç¬¦ä¸²å¼€å§‹ã€ç»“æŸçš„ä½ç½® 1.3 ç»„ å­—ç¬¦ è¯´æ˜ (abc) capture groupï¼Œæ•è·ç»„ \\n backreference to group #nï¼Œåˆ†ç»„å¼•ç”¨ï¼Œå¼•ç”¨ç¬¬ n ä¸ªæ•è·ç»„åŒ¹é…çš„å†…å®¹, å…¶ä¸­ n æ˜¯æ­£æ•´æ•° (?:abc) non-capturing groupï¼Œéæ•è·ç»„ 1.4 å…ˆè¡Œæ–­è¨€ å­—ç¬¦ è¯´æ˜ a(?=b) positive lookaheadï¼Œå…ˆè¡Œæ–­è¨€ï¼Œa åªæœ‰åœ¨ b å‰é¢æ‰åŒ¹é… a(?!b) negative lookaheadï¼Œå…ˆè¡Œå¦å®šæ–­è¨€ï¼Œa åªæœ‰ä¸åœ¨ b å‰é¢æ‰åŒ¹é… 1.5 åè¡Œæ–­è¨€ å­—ç¬¦ è¯´æ˜ (?\u0026lt;=b)a positive lookbehindï¼Œåè¡Œæ–­è¨€ï¼Œa åªæœ‰åœ¨ b åé¢æ‰åŒ¹é… (?\u0026lt;!b)a negative lookbehindï¼Œåè¡Œå¦å®šæ–­è¨€ï¼Œa åªæœ‰ä¸åœ¨ b åé¢æ‰åŒ¹é… 1.6 é‡è¯å’Œåˆ†æ”¯ å­—ç¬¦ è¯´æ˜ a* 0 or more a+ 1 or more a? 0 or 1 a{5} exactly five a{2,} two or more a{1,3} between one \u0026amp; three a+? a{2,}? match as few as possibleï¼Œæƒ°æ€§åŒ¹é…ï¼Œå°±æ˜¯å°½å¯èƒ½å°‘çš„åŒ¹é… ä»¥ä¸‹éƒ½æ˜¯æƒ°æ€§åŒ¹é…ï¼š {m,n}? {m,}? ?? +? *?\n1.7 åˆ†æ”¯ å­—ç¬¦ è¯´æ˜ ab|cd match ab or cdï¼ŒåŒ¹é…\u0026rsquo;ab\u0026rsquo;æˆ–è€…\u0026rsquo;cd\u0026rsquo;å­—ç¬¦å­ä¸² 1.8 ä¿®é¥°ç¬¦ å­—ç¬¦ è¯´æ˜ i æ‰§è¡Œå¯¹å¤§å°å†™ä¸æ•æ„Ÿçš„åŒ¹é…ã€‚ g æ‰§è¡Œå…¨å±€åŒ¹é…ï¼ˆæŸ¥æ‰¾æ‰€æœ‰åŒ¹é…è€Œéåœ¨æ‰¾åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…ååœæ­¢ï¼‰ã€‚ m æ‰§è¡Œå¤šè¡ŒåŒ¹é…ã€‚ u å¼€å¯\u0026quot;Unicode æ¨¡å¼\u0026quot;ï¼Œç”¨æ¥æ­£ç¡®å¤„ç†å¤§äº\\uFFFF çš„ Unicode å­—ç¬¦ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¼šæ­£ç¡®å¤„ç†å››ä¸ªå­—èŠ‚çš„ UTF-16 ç¼–ç ã€‚ s å…è®¸ . åŒ¹é…æ¢è¡Œç¬¦ã€‚ y y ä¿®é¥°ç¬¦çš„ä½œç”¨ä¸ g ä¿®é¥°ç¬¦ç±»ä¼¼ï¼Œä¹Ÿæ˜¯å…¨å±€åŒ¹é…ï¼Œåä¸€æ¬¡åŒ¹é…éƒ½ä»ä¸Šä¸€æ¬¡åŒ¹é…æˆåŠŸçš„ä¸‹ä¸€ä¸ªä½ç½®å¼€å§‹ã€‚ä¸åŒä¹‹å¤„åœ¨äºï¼Œg ä¿®é¥°ç¬¦åªè¦å‰©ä½™ä½ç½®ä¸­å­˜åœ¨åŒ¹é…å°±å¯ï¼Œè€Œ y ä¿®é¥°ç¬¦ç¡®ä¿åŒ¹é…å¿…é¡»ä»å‰©ä½™çš„ç¬¬ä¸€ä¸ªä½ç½®å¼€å§‹ï¼Œè¿™ä¹Ÿå°±æ˜¯\u0026quot;ç²˜è¿\u0026quot;çš„æ¶µä¹‰ 2. è¿ç®—ç¬¦ä¼˜å…ˆçº§ è¿ç®—ç¬¦ æè¿° \\ è½¬ä¹‰ç¬¦ (), (?:), (?=), [] åœ†æ‹¬å·å’Œæ–¹æ‹¬å· *, +, ?, {n}, {n,}, {n,m} é™å®šç¬¦ ^, $, \\ä»»ä½•å…ƒå­—ç¬¦ã€ä»»ä½•å­—ç¬¦ å®šä½ç‚¹å’Œåºåˆ—ï¼ˆå³ï¼šä½ç½®å’Œé¡ºåºï¼‰ | æ›¿æ¢ï¼Œ\u0026ldquo;æˆ–\u0026quot;æ“ä½œ å­—ç¬¦å…·æœ‰é«˜äºæ›¿æ¢è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ï¼Œä½¿å¾—\u0026quot;m|food\u0026quot;åŒ¹é…\u0026quot;m\u0026quot;æˆ–\u0026quot;food\u0026rdquo;ã€‚è‹¥è¦åŒ¹é…\u0026quot;mood\u0026quot;æˆ–\u0026quot;food\u0026quot;ï¼Œè¯·ä½¿ç”¨æ‹¬å·åˆ›å»ºå­è¡¨è¾¾å¼ï¼Œä»è€Œäº§ç”Ÿ\u0026quot;(m|f)ood\u0026quot;ã€‚ ä½¿ç”¨æ¡ˆä¾‹ ä¸€ã€20 ä¸ªæœ€å¸¸ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼ #1 . æ ¡éªŒå¯†ç å¼ºåº¦ï¼šå¯†ç çš„å¼ºåº¦å¿…é¡»æ˜¯åŒ…å«å¤§å°å†™å­—æ¯å’Œæ•°å­—çš„ç»„åˆï¼Œä¸èƒ½ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦ï¼Œé•¿åº¦åœ¨8-10ä¹‹é—´ ^(?=.*\\\\d)(?=.*[a-z])(?=.*[A-Z]).{8,10}$ #2. æ ¡éªŒä¸­æ–‡ï¼šå­—ç¬¦ä¸²ä»…èƒ½æ˜¯ä¸­æ–‡ ^[\\\\u4e00-\\\\u9fa5]{0,}$ # 3. ç”±æ•°å­—ã€26ä¸ªè‹±æ–‡å­—æ¯æˆ–ä¸‹åˆ’çº¿ç»„æˆçš„å­—ç¬¦ä¸²ï¼š ^\\\\w+$ #4. æ ¡éªŒE-Mail åœ°å€ï¼šåŒå¯†ç ä¸€æ ·ï¼Œä¸‹é¢æ˜¯E-mailåœ°å€åˆè§„æ€§çš„æ­£åˆ™æ£€æŸ¥è¯­å¥ã€‚ [\\\\w!#$%\u0026amp;\u0026#39;*+/=?^_`{|}~-]+(?:\\\\.[\\\\w!#$%\u0026amp;\u0026#39;*+/=?^_`{|}~-]+)*@(?:[\\\\w](?:[\\\\w-]*[\\\\w])?\\\\.)+[\\\\w](?:[\\\\w #5. æ ¡éªŒèº«ä»½è¯å·ç ï¼šä¸‹é¢æ˜¯èº«ä»½è¯å·ç çš„æ­£åˆ™æ ¡éªŒã€‚15 æˆ– 18ä½ã€‚ #15ä½ ^[1-9]\\\\d{7}((0\\\\d)|(1[0-2]))(([0|1|2]\\\\d)|3[0-1])\\\\d{3}$ #18ä½ ^[1-9]\\\\d{5}[1-9]\\\\d{3}((0\\\\d)|(1[0-2]))(([0|1|2]\\\\d)|3[0-1])\\\\d{3}([0-9]|X)$ #6. æ ¡éªŒæ—¥æœŸï¼šâ€œyyyy-mm-ddâ€œ æ ¼å¼çš„æ—¥æœŸæ ¡éªŒï¼Œå·²è€ƒè™‘å¹³é—°å¹´ã€‚ ^(?:(?!0000)[0-9]{4}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-8])|(?:0[13-9]|1[0-2])-(?:29|30)|(?:0[13578]|1[02])-31)|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)-02-29)$ #7. æ ¡éªŒé‡‘é¢ï¼šé‡‘é¢æ ¡éªŒï¼Œç²¾ç¡®åˆ°2ä½å°æ•°ã€‚ ^[0-9]+(.[0-9]{2})?$ #8. æ ¡éªŒæ‰‹æœºå·ï¼šä¸‹é¢æ˜¯å›½å†… 13ã€15ã€18å¼€å¤´çš„æ‰‹æœºå·æ­£åˆ™è¡¨è¾¾å¼ã€‚ ^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\\\\d{8}$ #9. åˆ¤æ–­IEçš„ç‰ˆæœ¬ï¼šIEç›®å‰è¿˜æ²¡è¢«å®Œå…¨å–ä»£ï¼Œå¾ˆå¤šé¡µé¢è¿˜æ˜¯éœ€è¦åšç‰ˆæœ¬å…¼å®¹ï¼Œä¸‹é¢æ˜¯IEç‰ˆæœ¬æ£€æŸ¥çš„è¡¨è¾¾å¼ã€‚ ^.*MSIE [5-8](?:\\\\.[0-9]+)?(?!.*Trident\\\\/[5-9]\\\\.0).*$ #10. æ ¡éªŒIP-v4åœ°å€ï¼šIP4 æ­£åˆ™è¯­å¥ \\\\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\\\b #11. æ ¡éªŒIP-v6åœ°å€ï¼šIP6 æ­£åˆ™è¯­å¥ã€‚ (([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])) #12. æ£€æŸ¥URLçš„å‰ç¼€ï¼šåº”ç”¨å¼€å‘ä¸­å¾ˆå¤šæ—¶å€™éœ€è¦åŒºåˆ†è¯·æ±‚æ˜¯HTTPSè¿˜æ˜¯HTTPï¼Œé€šè¿‡ä¸‹é¢çš„è¡¨è¾¾å¼å¯ä»¥å–å‡ºä¸€ä¸ªurlçš„å‰ç¼€ç„¶åå†é€»è¾‘åˆ¤æ–­ã€‚ if (!s.match(/^[a-zA-Z]+:\\\\/\\\\//)) { s = \u0026#39;http://\u0026#39; + s; } #13. æå–URLé“¾æ¥ï¼šä¸‹é¢çš„è¿™ä¸ªè¡¨è¾¾å¼å¯ä»¥ç­›é€‰å‡ºä¸€æ®µæ–‡æœ¬ä¸­çš„URLã€‚ ^(f|ht){1}(tp|tps):\\\\/\\\\/([\\\\w-]+\\\\.)+[\\\\w-]+(\\\\/[\\\\w- ./?%\u0026amp;=]*)? #14. æ–‡ä»¶è·¯å¾„åŠæ‰©å±•åæ ¡éªŒï¼šä¸‹é¢çš„è¿™ä¸ªè¡¨è¾¾å¼å¯ä»¥ç­›é€‰å‡ºä¸€æ®µæ–‡æœ¬ä¸­çš„URLã€‚ ^(f|ht){1}(tp|tps):\\\\/\\\\/([\\\\w-]+\\\\.)+[\\\\w-]+(\\\\/[\\\\w- ./?%\u0026amp;=]*)? #14. æ–‡ä»¶è·¯å¾„åŠæ‰©å±•åæ ¡éªŒï¼šéªŒè¯æ–‡ä»¶è·¯å¾„å’Œæ‰©å±•å ^([a-zA-Z]\\\\:|\\\\\\\\)\\\\\\\\([^\\\\\\\\]+\\\\\\\\)*[^\\\\/:*?\u0026#34;\u0026lt;\u0026gt;|]+\\\\.txt(l)?$ #15. æå–Color Hex Codesï¼šæœ‰æ—¶éœ€è¦æŠ½å–ç½‘é¡µä¸­çš„é¢œè‰²ä»£ç ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„è¡¨è¾¾å¼ã€‚ \\\\#([a-fA-F]|[0-9]){3,6} #16. æå–ç½‘é¡µå›¾ç‰‡ï¼šå‡è‹¥ä½ æƒ³æå–ç½‘é¡µä¸­æ‰€æœ‰å›¾ç‰‡ä¿¡æ¯ï¼Œå¯ä»¥åˆ©ç”¨ä¸‹é¢çš„è¡¨è¾¾å¼ã€‚ \\\\\u0026lt; *[img][^\\\\\u0026gt;]*[src] *= *[\\\\\u0026#34;\\\\\u0026#39;]{0,1}([^\\\\\u0026#34;\\\\\u0026#39;\\\\ \u0026gt;]*) #17. æå–é¡µé¢è¶…é“¾æ¥ï¼šæå–htmlä¸­çš„è¶…é“¾æ¥ã€‚ (\u0026lt;;a\\\\s*(?!.*\\\\brel=)[^\u0026gt;;]*)(href=\u0026#34;https?://)((?!(?:(?:www\\\\.)?\u0026#39;.implode(\u0026#39;|(?:www\\\\.)?\u0026#39;, $follow_list) #18. ç²¾ç‚¼CSSï¼šé€šè¿‡ä¸‹é¢çš„è¡¨è¾¾å¼ï¼Œå¯ä»¥æœç´¢ç›¸åŒå±æ€§å€¼çš„CSSï¼Œä»è€Œè¾¾åˆ°ç²¾ç‚¼ä»£ç çš„ç›®çš„ã€‚ ^\\\\s*[a-zA-Z\\\\-]+\\\\s*[:]{1}\\\\s[a-zA-Z0-9\\\\s.#]+[;]{1} #19. æŠ½å–æ³¨é‡Šï¼šå¦‚æœä½ éœ€è¦ç§»é™¤HMTLä¸­çš„æ³¨é‡Šï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„è¡¨è¾¾å¼ã€‚ \u0026lt;!--(.*?)--\u0026gt; #20. åŒ¹é…HTMLæ ‡ç­¾ï¼šé€šè¿‡ä¸‹é¢çš„è¡¨è¾¾å¼å¯ä»¥åŒ¹é…å‡ºHTMLä¸­çš„æ ‡ç­¾ã€‚ \u0026lt;/?\\\\w+((\\\\s+\\\\w+(\\\\s*=\\\\s*(?:\u0026#34;.*?\u0026#34;|\u0026#39;.*?\u0026#39;|[\\\\^\u0026#39;\u0026#34;\u0026gt;\\\\s]+))?)+\\\\s*|\\\\s*)/?\u0026gt; äºŒã€æ ¡éªŒæ•°å­—è¡¨è¾¾å¼ 1 æ•°å­—ï¼š^[0-9]*$ 2 nä½çš„æ•°å­—ï¼š^\\d{n}$ 3 è‡³å°‘nä½çš„æ•°å­—ï¼š^\\d{n,}$ 4 m-nä½çš„æ•°å­—ï¼š^\\d{m,n}$ 5 é›¶å’Œéé›¶å¼€å¤´çš„æ•°å­—ï¼š^(0|[1-9][0-9]*)$ 6 éé›¶å¼€å¤´çš„æœ€å¤šå¸¦ä¸¤ä½å°æ•°çš„æ•°å­—ï¼š^([1-9][0-9]*)+(.[0-9]{1,2})?$ 7 å¸¦1-2ä½å°æ•°çš„æ­£æ•°æˆ–è´Ÿæ•°ï¼š^(\\-)?\\d+(\\.\\d{1,2})?$ 8 æ­£æ•°ã€è´Ÿæ•°ã€å’Œå°æ•°ï¼š^(\\-|\\+)?\\d+(\\.\\d+)?$ 9 æœ‰ä¸¤ä½å°æ•°çš„æ­£å®æ•°ï¼š^[0-9]+(.[0-9]{2})?$ 10 æœ‰1~3ä½å°æ•°çš„æ­£å®æ•°ï¼š^[0-9]+(.[0-9]{1,3})?$ 11 éé›¶çš„æ­£æ•´æ•°ï¼š^[1-9]\\d*$ æˆ– ^([1-9][0-9]*){1,3}$ æˆ– ^\\+?[1-9][0-9]*$ 12 éé›¶çš„è´Ÿæ•´æ•°ï¼š^\\-[1-9][]0-9\u0026#34;*$ æˆ– ^-[1-9]\\d*$ 13 éè´Ÿæ•´æ•°ï¼š^\\d+$ æˆ– ^[1-9]\\d*|0$ 14 éæ­£æ•´æ•°ï¼š^-[1-9]\\d*|0$ æˆ– ^((-\\d+)|(0+))$ 15 éè´Ÿæµ®ç‚¹æ•°ï¼š^\\d+(\\.\\d+)?$ æˆ– ^[1-9]\\d*\\.\\d*|0\\.\\d*[1-9]\\d*|0?\\.0+|0$ 16 éæ­£æµ®ç‚¹æ•°ï¼š^((-\\d+(\\.\\d+)?)|(0+(\\.0+)?))$ æˆ– ^(-([1-9]\\d*\\.\\d*|0\\.\\d*[1-9]\\d*))|0?\\.0+|0$ 17 æ­£æµ®ç‚¹æ•°ï¼š^[1-9]\\d*\\.\\d*|0\\.\\d*[1-9]\\d*$ æˆ– ^(([0-9]+\\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\\.[0-9]+)|([0-9]*[1-9][0-9]*))$ 18 è´Ÿæµ®ç‚¹æ•°ï¼š^-([1-9]\\d*\\.\\d*|0\\.\\d*[1-9]\\d*)$ æˆ– ^(-(([0-9]+\\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\\.[0-9]+)|([0-9]*[1-9][0-9]*)))$ 19 æµ®ç‚¹æ•°ï¼š^(-?\\d+)(\\.\\d+)?$ æˆ– ^-?([1-9]\\d*\\.\\d*|0\\.\\d*[1-9]\\d*|0?\\.0+|0)$ ä¸‰ã€æ ¡éªŒå­—ç¬¦çš„è¡¨è¾¾å¼ 1 æ±‰å­—ï¼š^[\\u4e00-\\u9fa5]{0,}$ 2 è‹±æ–‡å’Œæ•°å­—ï¼š^[A-Za-z0-9]+$ æˆ– ^[A-Za-z0-9]{4,40}$ 3 é•¿åº¦ä¸º3-20çš„æ‰€æœ‰å­—ç¬¦ï¼š^.{3,20}$ 4 ç”±26ä¸ªè‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼š^[A-Za-z]+$ 5 ç”±26ä¸ªå¤§å†™è‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼š^[A-Z]+$ 6 ç”±26ä¸ªå°å†™è‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼š^[a-z]+$ 7 ç”±æ•°å­—å’Œ26ä¸ªè‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼š^[A-Za-z0-9]+$ 8 ç”±æ•°å­—ã€26ä¸ªè‹±æ–‡å­—æ¯æˆ–è€…ä¸‹åˆ’çº¿ç»„æˆçš„å­—ç¬¦ä¸²ï¼š^\\w+$ æˆ– ^\\w{3,20}$ 9 ä¸­æ–‡ã€è‹±æ–‡ã€æ•°å­—åŒ…æ‹¬ä¸‹åˆ’çº¿ï¼š^[\\u4E00-\\u9FA5A-Za-z0-9_]+$ 10 ä¸­æ–‡ã€è‹±æ–‡ã€æ•°å­—ä½†ä¸åŒ…æ‹¬ä¸‹åˆ’çº¿ç­‰ç¬¦å·ï¼š^[\\u4E00-\\u9FA5A-Za-z0-9]+$ æˆ– ^[\\u4E00-\\u9FA5A-Za-z0-9]{2,20}$ 11 å¯ä»¥è¾“å…¥å«æœ‰^%\u0026amp;\u0026#39;,;=?$\\\u0026#34;ç­‰å­—ç¬¦ï¼š[^%\u0026amp;\u0026#39;,;=?$\\x22]+ 12 ç¦æ­¢è¾“å…¥å«æœ‰~çš„å­—ç¬¦ï¼š[^~\\x22]+ å››ã€ç‰¹æ®Šéœ€æ±‚è¡¨è¾¾å¼ 1 Emailåœ°å€ï¼š^\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$ 2 åŸŸåï¼š[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(/.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+/.? 3 InternetURLï¼š[a-zA-z]+://[^\\s]* æˆ– ^http://([\\w-]+\\.)+[\\w-]+(/[\\w-./?%\u0026amp;=]*)?$ 4 æ‰‹æœºå·ç ï¼š^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\\d{8}$ 5 ç”µè¯å·ç (\u0026#34;XXX-XXXXXXX\u0026#34;ã€\u0026#34;XXXX-XXXXXXXX\u0026#34;ã€\u0026#34;XXX-XXXXXXX\u0026#34;ã€\u0026#34;XXX-XXXXXXXX\u0026#34;ã€\u0026#34;XXXXXXX\u0026#34;å’Œ\u0026#34;XXXXXXXX)ï¼š^(\\(\\d{3,4}-)|\\d{3.4}-)?\\d{7,8}$ 6 å›½å†…ç”µè¯å·ç (0511-4405222ã€021-87888822)ï¼š\\d{3}-\\d{8}|\\d{4}-\\d{7} 7 èº«ä»½è¯å·(15ä½ã€18ä½æ•°å­—)ï¼š^\\d{15}|\\d{18}$ 8 çŸ­èº«ä»½è¯å·ç (æ•°å­—ã€å­—æ¯xç»“å°¾)ï¼š^([0-9]){7,18}(x|X)?$ æˆ– ^\\d{8,18}|[0-9x]{8,18}|[0-9X]{8,18}?$ 9 å¸å·æ˜¯å¦åˆæ³•(å­—æ¯å¼€å¤´ï¼Œå…è®¸5-16å­—èŠ‚ï¼Œå…è®¸å­—æ¯æ•°å­—ä¸‹åˆ’çº¿)ï¼š^[a-zA-Z][a-zA-Z0-9_]{4,15}$ 10 å¯†ç (ä»¥å­—æ¯å¼€å¤´ï¼Œé•¿åº¦åœ¨6~18ä¹‹é—´ï¼Œåªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿)ï¼š^[a-zA-Z]\\w{5,17}$ 11 å¼ºå¯†ç (å¿…é¡»åŒ…å«å¤§å°å†™å­—æ¯å’Œæ•°å­—çš„ç»„åˆï¼Œä¸èƒ½ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦ï¼Œé•¿åº¦åœ¨8-10ä¹‹é—´)ï¼š^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).{8,10}$ 12 æ—¥æœŸæ ¼å¼ï¼š^\\d{4}-\\d{1,2}-\\d{1,2} 13 ä¸€å¹´çš„12ä¸ªæœˆ(01ï½09å’Œ1ï½12)ï¼š^(0?[1-9]|1[0-2])$ 14 ä¸€ä¸ªæœˆçš„31å¤©(01ï½09å’Œ1ï½31)ï¼š^((0?[1-9])|((1|2)[0-9])|30|31)$ 15 é’±çš„è¾“å…¥æ ¼å¼ï¼š 16 1.æœ‰å››ç§é’±çš„è¡¨ç¤ºå½¢å¼æˆ‘ä»¬å¯ä»¥æ¥å—:\u0026#34;10000.00\u0026#34; å’Œ \u0026#34;10,000.00\u0026#34;, å’Œæ²¡æœ‰ \u0026#34;åˆ†\u0026#34; çš„ \u0026#34;10000\u0026#34; å’Œ \u0026#34;10,000\u0026#34;ï¼š^[1-9][0-9]*$ 17 2.è¿™è¡¨ç¤ºä»»æ„ä¸€ä¸ªä¸ä»¥0å¼€å¤´çš„æ•°å­—,ä½†æ˜¯,è¿™ä¹Ÿæ„å‘³ç€ä¸€ä¸ªå­—ç¬¦\u0026#34;0\u0026#34;ä¸é€šè¿‡,æ‰€ä»¥æˆ‘ä»¬é‡‡ç”¨ä¸‹é¢çš„å½¢å¼ï¼š^(0|[1-9][0-9]*)$ 18 3.ä¸€ä¸ª0æˆ–è€…ä¸€ä¸ªä¸ä»¥0å¼€å¤´çš„æ•°å­—.æˆ‘ä»¬è¿˜å¯ä»¥å…è®¸å¼€å¤´æœ‰ä¸€ä¸ªè´Ÿå·ï¼š^(0|-?[1-9][0-9]*)$ 19 4.è¿™è¡¨ç¤ºä¸€ä¸ª0æˆ–è€…ä¸€ä¸ªå¯èƒ½ä¸ºè´Ÿçš„å¼€å¤´ä¸ä¸º0çš„æ•°å­—.è®©ç”¨æˆ·ä»¥0å¼€å¤´å¥½äº†.æŠŠè´Ÿå·çš„ä¹Ÿå»æ‰,å› ä¸ºé’±æ€»ä¸èƒ½æ˜¯è´Ÿçš„å§.ä¸‹é¢æˆ‘ä»¬è¦åŠ çš„æ˜¯è¯´æ˜å¯èƒ½çš„å°æ•°éƒ¨åˆ†ï¼š^[0-9]+(.[0-9]+)?$ 20 5.å¿…é¡»è¯´æ˜çš„æ˜¯,å°æ•°ç‚¹åé¢è‡³å°‘åº”è¯¥æœ‰1ä½æ•°,æ‰€ä»¥\u0026#34;10.\u0026#34;æ˜¯ä¸é€šè¿‡çš„,ä½†æ˜¯ \u0026#34;10\u0026#34; å’Œ \u0026#34;10.2\u0026#34; æ˜¯é€šè¿‡çš„ï¼š^[0-9]+(.[0-9]{2})?$ 21 6.è¿™æ ·æˆ‘ä»¬è§„å®šå°æ•°ç‚¹åé¢å¿…é¡»æœ‰ä¸¤ä½,å¦‚æœä½ è®¤ä¸ºå¤ªè‹›åˆ»äº†,å¯ä»¥è¿™æ ·ï¼š^[0-9]+(.[0-9]{1,2})?$ 22 7.è¿™æ ·å°±å…è®¸ç”¨æˆ·åªå†™ä¸€ä½å°æ•°.ä¸‹é¢æˆ‘ä»¬è¯¥è€ƒè™‘æ•°å­—ä¸­çš„é€—å·äº†,æˆ‘ä»¬å¯ä»¥è¿™æ ·ï¼š^[0-9]{1,3}(,[0-9]{3})*(.[0-9]{1,2})?$ 23 8.1åˆ°3ä¸ªæ•°å­—,åé¢è·Ÿç€ä»»æ„ä¸ª é€—å·+3ä¸ªæ•°å­—,é€—å·æˆä¸ºå¯é€‰,è€Œä¸æ˜¯å¿…é¡»ï¼š^([0-9]+|[0-9]{1,3}(,[0-9]{3})*)(.[0-9]{1,2})?$ 24 å¤‡æ³¨ï¼šè¿™å°±æ˜¯æœ€ç»ˆç»“æœäº†,åˆ«å¿˜äº†\u0026#34;+\u0026#34;å¯ä»¥ç”¨\u0026#34;*\u0026#34;æ›¿ä»£å¦‚æœä½ è§‰å¾—ç©ºå­—ç¬¦ä¸²ä¹Ÿå¯ä»¥æ¥å—çš„è¯(å¥‡æ€ª,ä¸ºä»€ä¹ˆ?)æœ€å,åˆ«å¿˜äº†åœ¨ç”¨å‡½æ•°æ—¶å»æ‰å»æ‰é‚£ä¸ªåæ–œæ ,ä¸€èˆ¬çš„é”™è¯¯éƒ½åœ¨è¿™é‡Œ 25 xmlæ–‡ä»¶ï¼š^([a-zA-Z]+-?)+[a-zA-Z0-9]+\\\\.[x|X][m|M][l|L]$ 26 ä¸­æ–‡å­—ç¬¦çš„æ­£åˆ™è¡¨è¾¾å¼ï¼š[\\u4e00-\\u9fa5] 27 åŒå­—èŠ‚å­—ç¬¦ï¼š[^\\x00-\\xff] (åŒ…æ‹¬æ±‰å­—åœ¨å†…ï¼Œå¯ä»¥ç”¨æ¥è®¡ç®—å­—ç¬¦ä¸²çš„é•¿åº¦(ä¸€ä¸ªåŒå­—èŠ‚å­—ç¬¦é•¿åº¦è®¡2ï¼ŒASCIIå­—ç¬¦è®¡1)) 28 ç©ºç™½è¡Œçš„æ­£åˆ™è¡¨è¾¾å¼ï¼š\\n\\s*\\r (å¯ä»¥ç”¨æ¥åˆ é™¤ç©ºç™½è¡Œ) 29 HTMLæ ‡è®°çš„æ­£åˆ™è¡¨è¾¾å¼ï¼š\u0026lt;(\\S*?)[^\u0026gt;]*\u0026gt;.*?\u0026lt;/\\1\u0026gt;|\u0026lt;.*? /\u0026gt; (ç½‘ä¸Šæµä¼ çš„ç‰ˆæœ¬å¤ªç³Ÿç³•ï¼Œä¸Šé¢è¿™ä¸ªä¹Ÿä»…ä»…èƒ½éƒ¨åˆ†ï¼Œå¯¹äºå¤æ‚çš„åµŒå¥—æ ‡è®°ä¾æ—§æ— èƒ½ä¸ºåŠ›) 30 é¦–å°¾ç©ºç™½å­—ç¬¦çš„æ­£åˆ™è¡¨è¾¾å¼ï¼š^\\s*|\\s*$æˆ–(^\\s*)|(\\s*$) (å¯ä»¥ç”¨æ¥åˆ é™¤è¡Œé¦–è¡Œå°¾çš„ç©ºç™½å­—ç¬¦(åŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰ç­‰)ï¼Œéå¸¸æœ‰ç”¨çš„è¡¨è¾¾å¼) 31 è…¾è®¯QQå·ï¼š[1-9][0-9]{4,} (è…¾è®¯QQå·ä»10000å¼€å§‹) 32 ä¸­å›½é‚®æ”¿ç¼–ç ï¼š[1-9]\\d{5}(?!\\d) (ä¸­å›½é‚®æ”¿ç¼–ç ä¸º6ä½æ•°å­—) 33 IPåœ°å€ï¼š\\d+\\.\\d+\\.\\d+\\.\\d+ (æå–IPåœ°å€æ—¶æœ‰ç”¨) 34 IPåœ°å€ï¼š((?:(?:25[0-5]|2[0-4]\\\\d|[01]?\\\\d?\\\\d)\\\\.){3}(?:25[0-5]|2[0-4]\\\\d|[01]?\\\\d?\\\\d)) æ’é™¤ç‰¹å®šå­—ç¬¦ä¸² # ä¸ä»¥comç»“å°¾çš„ ^.*?(?\u0026lt;!com)$ # ä»¥comç»“å°¾ ^.*?(?\u0026lt;=com)$ ^.*?com$ # ä¸åŒ…å«helloworldçš„å­—ç¬¦ä¸² ^(?!.*helloworld).*$ åŒ¹é…æµ‹è¯•å·¥å…· åœ¨çº¿éªŒè¯å·¥å…· https://regexr.com/ https://www.debuggex.com/ https://deerchao.cn/tools/wegester/ https://regex101.com/ æ­£åˆ™å¯è§†åŒ–å·¥å…· https://jex.im/regulex/#!flags=\u0026amp;re=%5E(a%7Cb)*%3F%24 https://regexper.com/ å‚è€ƒ æ­£åˆ™è¡¨è¾¾å¼å¼•æ“æ‰§è¡ŒåŸç†\nå¦‚ä½•åŒ¹é… 3 çš„å€æ•°\nå®ç°ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼\næ­£åˆ™è¡¨è¾¾å¼ 30 åˆ†é’Ÿå…¥é—¨\nPython æ­£åˆ™è¡¨è¾¾å¼\nPython æ­£åˆ™è¡¨è¾¾å¼æŒ‡å—\nåˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼æ’é™¤ç‰¹å®šå­—ç¬¦ä¸²\nä¸€æ–‡æŒæ¡å¼€å‘åˆ©å™¨ï¼šæ­£åˆ™è¡¨è¾¾å¼\nJavascript æ­£åˆ™ cheatsheet\nPython æ­£åˆ™ cheatsheet\n","permalink":"https://blog.niuhemoon.win/posts/tech/re-usage/","summary":"åŸºç¡€ 1.1 å­—ç¬¦åŒ¹é… å­—ç¬¦ è¯´æ˜ \\ è½¬ä¹‰ç¬¦ \\d [0-9]ã€‚è¡¨ç¤ºæ˜¯ä¸€ä½æ•°å­—ã€‚ \\D [^0-9]ã€‚è¡¨ç¤ºé™¤æ•°å­—å¤–çš„ä»»æ„å­—ç¬¦ã€‚ \\w [0-9a-zA-Z_]ã€‚è¡¨ç¤ºæ•°å­—ã€å¤§å°å†™å­—æ¯å’Œä¸‹åˆ’çº¿ã€‚ \\W [^0-9a-za-z_]ã€‚éå•è¯å­—ç¬¦ã€‚ \\s [\\t\\v\\n\\r\\f]ã€‚è¡¨ç¤ºç©ºç™½ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€æ°´å¹³åˆ¶è¡¨ç¬¦ã€ å‚ç›´åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦","title":"æ­£åˆ™è¡¨è¾¾å¼åŸºæœ¬ä½¿ç”¨"},{"content":" æœ¬æ–‡ä¸»è¦ä»‹ç»PlantUMLç»˜å›¾ç¯å¢ƒçš„æ­å»ºä»¥åŠæ—¶åºå›¾çš„ç»˜åˆ¶ï¼Œä¸»è¦ä»¥Linuxå¹³å°ä¸ºä¾‹ã€‚\nå®‰è£… è‹¥å®‰è£…æ—¶åºå›¾å’Œæ´»åŠ¨å›¾ä»¥å¤–çš„å›¾å½¢ï¼Œéœ€è¦å®‰è£…graphviz\nsudo apt install graphviz VScodeå®‰è£…æ’ä»¶\nPlantUML Markdown Preview Enhanced æ’ä»¶æ”¯æŒçš„æ–‡ä»¶ååç¼€æ˜¯ï¼š.wsd, .pu, .puml, .plantuml, .iuml\nç¼–è¾‘æ–‡ä»¶å®Œæˆåï¼ŒæŒ‰å¿«æ·é”®ALT+Dé¢„è§ˆ\nCtrl+Shift+på¯ä»¥é€‰æ‹©å¯¼å‡ºå›¾ç‰‡\néœ€è¦java\nsudo apt install default-jre æµè§ˆå™¨æ’ä»¶æ”¯æŒPlantUML\nPlantUML Vieweræ’ä»¶å¯ä»¥æ‰“å¼€UMLæ–‡æœ¬å¹¶é¢„è§ˆ\næ—¶åºå›¾ç¤ºä¾‹ ä½ å¯ä»¥ç”¨-\u0026gt;æ¥ç»˜åˆ¶å‚ä¸è€…ä¹‹é—´ä¼ é€’çš„æ¶ˆæ¯ï¼Œ è€Œä¸å¿…æ˜¾å¼åœ°å£°æ˜å‚ä¸è€…ã€‚\n@startuml ç”¨æˆ· -\u0026gt; è®¤è¯ä¸­å¿ƒ: ç™»å½•æ“ä½œ è®¤è¯ä¸­å¿ƒ -\u0026gt; ç¼“å­˜: å­˜æ”¾(key=token+ip,value=token)token ç”¨æˆ· \u0026lt;- è®¤è¯ä¸­å¿ƒ : è®¤è¯æˆåŠŸè¿”å›token ç”¨æˆ· -\u0026gt; è®¤è¯ä¸­å¿ƒ: ä¸‹æ¬¡è®¿é—®å¤´éƒ¨æºå¸¦tokenè®¤è¯ è®¤è¯ä¸­å¿ƒ \u0026lt;- ç¼“å­˜: key=token+ipè·å–token å…¶ä»–æœåŠ¡ \u0026lt;- è®¤è¯ä¸­å¿ƒ: å­˜åœ¨ä¸”æ ¡éªŒæˆåŠŸåˆ™è·³è½¬åˆ°ç”¨æˆ·è¯·æ±‚çš„å…¶ä»–æœåŠ¡ å…¶ä»–æœåŠ¡ -\u0026gt; ç”¨æˆ·: ä¿¡æ¯ @enduml ä¹Ÿå¯ä»¥é€šè¿‡å…³é”®å­—å£°æ˜å‚ä¸è€…\n@startuml actor Foo1 boundary Foo2 control Foo3 entity Foo4 database Foo5 collections Foo6 Foo1 -\u0026gt; Foo2 : To boundary Foo1 -\u0026gt; Foo3 : To control Foo1 -\u0026gt; Foo4 : To entity Foo1 -\u0026gt; Foo5 : To database Foo1 -\u0026gt; Foo6 : To collections @enduml @startuml title: åºåˆ—å›¾sequence(ç¤ºä¾‹) participant A participant B participant C participant D participant E note left of A: Aå·¦ä¾§è¯´æ˜ note over D: è¦†ç›–Dçš„è¯´æ˜ note right of F: Få³ä¾§è¯´æ˜ A -\u0026gt;x B: ä¸¢å¤±çš„æ¶ˆæ¯ B -\u0026gt; C: å®çº¿ç®­å¤´ C -\u0026gt;\u0026gt; D: å®çº¿ç»†ç®­å¤´ D -\\ E: å®çº¿åŠç®­å¤´ E -\\\\ F: å®çº¿åŠç®­å¤´ F --/ E: è™šçº¿åŠç®­å¤´ E --\u0026gt;o D: è™šçº¿ç®­å¤´åŠ åœˆ D --\\o C: è™šçº¿åŠç®­å¤´åŠ åœˆ C \u0026lt;--\u0026gt; B: å®çº¿åŒå‘ç®­å¤´ A --\u0026gt; A: è‡ªå·±åˆ°è‡ªå·± @enduml å‚è€ƒ PlantUMLå®˜ç½‘\næµè§ˆå™¨æ’ä»¶\næ—¶åºå›¾ç¤ºä¾‹\n","permalink":"https://blog.niuhemoon.win/posts/tech/plantuml-sequence/","summary":"\u003cblockquote\u003e\n\u003cp\u003eæœ¬æ–‡ä¸»è¦ä»‹ç»PlantUMLç»˜å›¾ç¯å¢ƒçš„æ­å»ºä»¥åŠæ—¶åºå›¾çš„ç»˜åˆ¶ï¼Œä¸»è¦ä»¥Linuxå¹³å°ä¸ºä¾‹ã€‚\u003c/p\u003e\n\u003c/blockquote\u003e","title":"PlantUMLç”»æ—¶åºå›¾"},{"content":"Gitç‰ˆæœ¬æ§åˆ¶ å°½ç®¡ Git çš„æ¥å£æœ‰äº›ä¸‘é™‹ï¼Œä½†æ˜¯å®ƒçš„åº•å±‚è®¾è®¡å’Œæ€æƒ³å´æ˜¯éå¸¸ä¼˜é›…çš„ã€‚ä¸‘é™‹çš„æ¥å£åªèƒ½é æ­»è®°ç¡¬èƒŒï¼Œè€Œä¼˜é›…çš„åº•å±‚è®¾è®¡åˆ™éå¸¸å®¹æ˜“è¢«äººç†è§£ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†é€šè¿‡ä¸€ç§è‡ªåº•å‘ä¸Šçš„æ–¹å¼åƒæ‚¨ä»‹ç» Gitã€‚æˆ‘ä»¬ä¼šä»æ•°æ®æ¨¡å‹å¼€å§‹ï¼Œæœ€åå†å­¦ä¹ å®ƒçš„æ¥å£ã€‚ä¸€æ—¦æ‚¨ææ‡‚äº† Git çš„æ•°æ®æ¨¡å‹ï¼Œå†å­¦ä¹ å…¶æ¥å£å¹¶ç†è§£è¿™äº›æ¥å£æ˜¯å¦‚ä½•æ“ä½œæ•°æ®æ¨¡å‹çš„å°±éå¸¸å®¹æ˜“äº†ã€‚\nGit çš„æ•°æ®æ¨¡å‹ è¿›è¡Œç‰ˆæœ¬æ§åˆ¶çš„æ–¹æ³•å¾ˆå¤šã€‚Git æ‹¥æœ‰ä¸€ä¸ªç»è¿‡ç²¾å¿ƒè®¾è®¡çš„æ¨¡å‹ï¼Œè¿™ä½¿å…¶èƒ½å¤Ÿæ”¯æŒç‰ˆæœ¬æ§åˆ¶æ‰€éœ€çš„æ‰€æœ‰ç‰¹æ€§ï¼Œä¾‹å¦‚ç»´æŠ¤å†å²è®°å½•ã€æ”¯æŒåˆ†æ”¯å’Œä¿ƒè¿›åä½œã€‚\nå¿«ç…§ Git å°†é¡¶çº§ç›®å½•ä¸­çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ä½œä¸ºé›†åˆï¼Œå¹¶é€šè¿‡ä¸€ç³»åˆ—å¿«ç…§æ¥ç®¡ç†å…¶å†å²è®°å½•ã€‚åœ¨Gitçš„æœ¯è¯­é‡Œï¼Œæ–‡ä»¶è¢«ç§°ä½œBlobå¯¹è±¡ï¼ˆæ•°æ®å¯¹è±¡ï¼‰ï¼Œä¹Ÿå°±æ˜¯ä¸€ç»„æ•°æ®ã€‚ç›®å½•åˆ™è¢«ç§°ä¹‹ä¸ºâ€œæ ‘â€ï¼Œå®ƒå°†åå­—ä¸Blobå¯¹è±¡æˆ–æ ‘å¯¹è±¡è¿›è¡Œæ˜ å°„ï¼ˆä½¿å¾—ç›®å½•ä¸­å¯ä»¥åŒ…å«å…¶ä»–ç›®å½•ï¼‰ã€‚å¿«ç…§åˆ™æ˜¯è¢«è¿½è¸ªçš„æœ€é¡¶å±‚çš„æ ‘ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ ‘çœ‹èµ·æ¥å¯èƒ½æ˜¯è¿™æ ·çš„ï¼š\n\u0026lt;root\u0026gt; (tree) | +- foo (tree) | | | + bar.txt (blob, contents = \u0026#34;hello world\u0026#34;) | +- baz.txt (blob, contents = \u0026#34;git is wonderful\u0026#34;) è¿™ä¸ªé¡¶å±‚çš„æ ‘åŒ…å«äº†ä¸¤ä¸ªå…ƒç´ ï¼Œä¸€ä¸ªåä¸º â€œfooâ€ çš„æ ‘(å®ƒæœ¬èº«åŒ…å«äº†ä¸€ä¸ªblobå¯¹è±¡ â€œbar.txtâ€)ï¼Œä»¥åŠä¸€ä¸ªå¯¹blobå¯¹è±¡ â€œbaz.txtâ€ã€‚\nå†å²è®°å½•å»ºæ¨¡ï¼šå…³è”å¿«ç…§ ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿå’Œå¿«ç…§æœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿçº¿æ€§å†å²è®°å½•æ˜¯ä¸€ç§æœ€ç®€å•çš„æ¨¡å‹ï¼Œå®ƒåŒ…å«äº†ä¸€ç»„æŒ‰ç…§æ—¶é—´é¡ºåºçº¿æ€§æ’åˆ—çš„å¿«ç…§ã€‚ä¸è¿‡å¤„äºç§ç§åŸå› ï¼ŒGit å¹¶æ²¡æœ‰é‡‡ç”¨è¿™æ ·çš„æ¨¡å‹ã€‚\nåœ¨ Git ä¸­ï¼Œå†å²è®°å½•æ˜¯ä¸€ä¸ªç”±å¿«ç…§ç»„æˆçš„æœ‰å‘æ— ç¯å›¾ã€‚æœ‰å‘æ— ç¯å›¾ï¼Œå¬ä¸Šå»ä¼¼ä¹æ˜¯ä»€ä¹ˆé«˜å¤§ä¸Šçš„æ•°å­¦åè¯ã€‚ä¸è¿‡ä¸è¦æ€•ï¼Œæ‚¨åªéœ€è¦çŸ¥é“è¿™ä»£è¡¨ Git ä¸­çš„æ¯ä¸ªå¿«ç…§éƒ½æœ‰ä¸€ç³»åˆ—çš„â€œçˆ¶è¾ˆâ€ï¼Œä¹Ÿå°±æ˜¯å…¶ä¹‹å‰çš„ä¸€ç³»åˆ—å¿«ç…§ã€‚æ³¨æ„ï¼Œå¿«ç…§å…·æœ‰å¤šä¸ªâ€œçˆ¶è¾ˆâ€è€Œéä¸€ä¸ªï¼Œå› ä¸ºæŸä¸ªå¿«ç…§å¯èƒ½ç”±å¤šä¸ªçˆ¶è¾ˆè€Œæ¥ã€‚ä¾‹å¦‚ï¼Œç»è¿‡åˆå¹¶åçš„ä¸¤æ¡åˆ†æ”¯ã€‚\nåœ¨ Git ä¸­ï¼Œè¿™äº›å¿«ç…§è¢«ç§°ä¸ºâ€œæäº¤â€ã€‚é€šè¿‡å¯è§†åŒ–çš„æ–¹å¼æ¥è¡¨ç¤ºè¿™äº›å†å²æäº¤è®°å½•æ—¶ï¼Œçœ‹èµ·æ¥å·®ä¸å¤šæ˜¯è¿™æ ·çš„ï¼š\no \u0026lt;-- o \u0026lt;-- o \u0026lt;-- o ^ \\ --- o \u0026lt;-- o ä¸Šé¢æ˜¯ä¸€ä¸ª ASCII ç æ„æˆçš„ç®€å›¾ï¼Œå…¶ä¸­çš„ o è¡¨ç¤ºä¸€æ¬¡æäº¤ï¼ˆå¿«ç…§ï¼‰ã€‚\nç®­å¤´æŒ‡å‘äº†å½“å‰æäº¤çš„çˆ¶è¾ˆï¼ˆè¿™æ˜¯ä¸€ç§â€œåœ¨ã€‚ã€‚ã€‚ä¹‹å‰â€ï¼Œè€Œä¸æ˜¯â€œåœ¨ã€‚ã€‚ã€‚ä¹‹åâ€çš„å…³ç³»ï¼‰ã€‚åœ¨ç¬¬ä¸‰æ¬¡æäº¤ä¹‹åï¼Œå†å²è®°å½•åˆ†å²”æˆäº†ä¸¤æ¡ç‹¬ç«‹çš„åˆ†æ”¯ã€‚è¿™å¯èƒ½å› ä¸ºæ­¤æ—¶éœ€è¦åŒæ—¶å¼€å‘ä¸¤ä¸ªä¸åŒçš„ç‰¹æ€§ï¼Œå®ƒä»¬ä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚å¼€å‘å®Œæˆåï¼Œè¿™äº›åˆ†æ”¯å¯èƒ½ä¼šè¢«åˆå¹¶å¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„æäº¤ï¼Œè¿™ä¸ªæ–°çš„æäº¤ä¼šåŒæ—¶åŒ…å«è¿™äº›ç‰¹æ€§ã€‚æ–°çš„æäº¤ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å†å²è®°å½•ï¼Œçœ‹ä¸Šå»åƒè¿™æ ·ï¼ˆæœ€æ–°çš„åˆå¹¶æäº¤ç”¨ç²—ä½“æ ‡è®°ï¼‰ï¼š\no \u0026lt;\u0026ndash; o \u0026lt;\u0026ndash; o \u0026lt;\u0026ndash; o \u0026lt;\u0026mdash;- o ^ / \\ v \u0026mdash; o \u0026lt;\u0026ndash; o\nGit ä¸­çš„æäº¤æ˜¯ä¸å¯æ”¹å˜çš„ã€‚ä½†è¿™å¹¶ä¸ä»£è¡¨é”™è¯¯ä¸èƒ½è¢«ä¿®æ”¹ï¼Œåªä¸è¿‡è¿™ç§â€œä¿®æ”¹â€å®é™…ä¸Šæ˜¯åˆ›å»ºäº†ä¸€ä¸ªå…¨æ–°çš„æäº¤è®°å½•ã€‚è€Œå¼•ç”¨ï¼ˆå‚è§ä¸‹æ–‡ï¼‰åˆ™è¢«æ›´æ–°ä¸ºæŒ‡å‘è¿™äº›æ–°çš„æäº¤ã€‚\næ•°æ®æ¨¡å‹åŠå…¶ä¼ªä»£ç è¡¨ç¤º ä»¥ä¼ªä»£ç çš„å½¢å¼æ¥å­¦ä¹  Git çš„æ•°æ®æ¨¡å‹ï¼Œå¯èƒ½æ›´åŠ æ¸…æ™°ï¼š\n// æ–‡ä»¶å°±æ˜¯ä¸€ç»„æ•°æ® type blob = array\u0026lt;byte\u0026gt; // ä¸€ä¸ªåŒ…å«æ–‡ä»¶å’Œç›®å½•çš„ç›®å½• type tree = map\u0026lt;string, tree | file\u0026gt; // æ¯ä¸ªæäº¤éƒ½åŒ…å«ä¸€ä¸ªçˆ¶è¾ˆï¼Œå…ƒæ•°æ®å’Œé¡¶å±‚æ ‘ type commit = struct { parent: array\u0026lt;commit\u0026gt; author: string message: string snapshot: tree } è¿™æ˜¯ä¸€ç§ç®€æ´çš„å†å²æ¨¡å‹ã€‚\nå¯¹è±¡å’Œå†…å­˜å¯»å€ Git ä¸­çš„å¯¹è±¡å¯ä»¥æ˜¯ blobã€æ ‘æˆ–æäº¤ï¼š\ntype object = blob | tree | commit Git åœ¨å‚¨å­˜æ•°æ®æ—¶ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½ä¼šåŸºäºå®ƒä»¬çš„SHA-1 hashè¿›è¡Œå¯»å€ã€‚\nobjects = map\u0026lt;string, object\u0026gt; def store(object): id = sha1(object) objects[id] = object def load(id): return objects[id] Blobsã€æ ‘å’Œæäº¤éƒ½ä¸€æ ·ï¼Œå®ƒä»¬éƒ½æ˜¯å¯¹è±¡ã€‚å½“å®ƒä»¬å¼•ç”¨å…¶ä»–å¯¹è±¡æ—¶ï¼Œå®ƒä»¬å¹¶æ²¡æœ‰çœŸæ­£çš„åœ¨ç¡¬ç›˜ä¸Šä¿å­˜è¿™äº›å¯¹è±¡ï¼Œè€Œæ˜¯ä»…ä»…ä¿å­˜äº†å®ƒä»¬çš„å“ˆå¸Œå€¼ä½œä¸ºå¼•ç”¨ã€‚\nä¾‹å¦‚ï¼Œaboveä¾‹å­ä¸­çš„æ ‘ï¼ˆå¯ä»¥é€šè¿‡git cat-file -p 698281bc680d1995c5f4caaf3359721a5a58d48d æ¥è¿›è¡Œå¯è§†åŒ–ï¼‰ï¼Œçœ‹ä¸Šå»æ˜¯è¿™æ ·çš„ï¼š\n100644 blob 4448adbf7ecd394f42ae135bbeed9676e894af85 baz.txt 040000 tree c68d233a33c5c06e0340e4c224f0afca87c8ce87 foo æ ‘æœ¬èº«ä¼šåŒ…å«ä¸€äº›æŒ‡å‘å…¶ä»–å†…å®¹çš„æŒ‡é’ˆï¼Œä¾‹å¦‚baz.txt (blob) å’Œ foo (æ ‘)ã€‚å¦‚æœæˆ‘ä»¬ç”¨git cat-file -p 4448adbf7ecd394f42ae135bbeed9676e894af85ï¼Œå³é€šè¿‡å“ˆå¸Œå€¼æŸ¥çœ‹ baz.txte çš„å†…å®¹ï¼Œä¼šå¾—åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š\ngit is wonderful å¼•ç”¨ ç°åœ¨ï¼Œæ‰€æœ‰çš„å¿«ç…§éƒ½å¯ä»¥é€šè¿‡å®ƒä»¬çš„ SHA-1 å“ˆå¸Œå€¼æ¥æ ‡è®°äº†ã€‚ä½†è¿™ä¹Ÿå¤ªä¸æ–¹ä¾¿äº†ï¼Œè°ä¹Ÿè®°ä¸ä½ä¸€ä¸² 40 ä½çš„åå…­è¿›åˆ¶å­—ç¬¦ã€‚\né’ˆå¯¹è¿™ä¸€é—®é¢˜ï¼ŒGit çš„è§£å†³æ–¹æ³•æ˜¯ç»™è¿™äº›å“ˆå¸Œå€¼èµ‹äºˆäººç±»å¯è¯»çš„åå­—ï¼Œä¹Ÿå°±æ˜¯å¼•ç”¨ï¼ˆreferencesï¼‰ã€‚å¼•ç”¨æ˜¯æŒ‡å‘æäº¤çš„æŒ‡é’ˆã€‚ä¸å¯¹è±¡ä¸åŒçš„æ˜¯ï¼Œå®ƒæ˜¯å¯å˜çš„ï¼ˆå¼•ç”¨å¯ä»¥è¢«æ›´æ–°ï¼ŒæŒ‡å‘æ–°çš„æäº¤ï¼‰ã€‚ä¾‹å¦‚ï¼Œmaster å¼•ç”¨é€šå¸¸ä¼šæŒ‡å‘ä¸»åˆ†æ”¯çš„æœ€æ–°ä¸€æ¬¡æäº¤ã€‚\nreferences = map\u0026lt;string, string\u0026gt; def update_reference(name, id): references[name] = id def read_reference(name): return references[name] def load_reference(name_or_id): if name_or_id in references: return load(references[name_or_id]) else: return load(name_or_id) è¿™æ ·ï¼ŒGit å°±å¯ä»¥ä½¿ç”¨è¯¸å¦‚ â€œmasterâ€ è¿™æ ·äººç±»åˆ»åº¦çš„åç§°æ¥è¡¨ç¤ºå†å²è®°å½•ä¸­æŸä¸ªç‰¹å®šçš„æäº¤ï¼Œè€Œä¸éœ€è¦åœ¨ä½¿ç”¨ä¸€é•¿ä¸²åå…­è¿›åˆ¶å­—ç¬¦äº†ã€‚\næœ‰ä¸€ä¸ªç»†èŠ‚éœ€è¦æˆ‘ä»¬æ³¨æ„ï¼Œ é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šæƒ³è¦çŸ¥é“â€œæˆ‘ä»¬å½“å‰æ‰€åœ¨ä½ç½®â€ï¼Œå¹¶å°†å…¶æ ‡è®°ä¸‹æ¥ã€‚è¿™æ ·å½“æˆ‘ä»¬åˆ›å»ºæ–°çš„å¿«ç…§çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥çŸ¥é“å®ƒçš„ç›¸å¯¹ä½ç½®ï¼ˆå¦‚ä½•è®¾ç½®å®ƒçš„â€œçˆ¶è¾ˆâ€ï¼‰ã€‚åœ¨ Git ä¸­ï¼Œæˆ‘ä»¬å½“å‰çš„ä½ç½®æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ç´¢å¼•ï¼Œå®ƒå°±æ˜¯â€HEADâ€ã€‚\nä»“åº“ æœ€åï¼Œæˆ‘ä»¬å¯ä»¥ç²—ç•¥åœ°ç»™å‡º Git ä»“åº“çš„å®šä¹‰äº†ï¼šå¯¹è±¡ å’Œ å¼•ç”¨ã€‚\nåœ¨ç¡¬ç›˜ä¸Šï¼ŒGit ä»…å­˜å‚¨å¯¹è±¡å’Œå¼•ç”¨ï¼šå› ä¸ºå…¶æ•°æ®æ¨¡å‹ä»…åŒ…å«è¿™äº›ä¸œè¥¿ã€‚æ‰€æœ‰çš„ git å‘½ä»¤éƒ½å¯¹åº”ç€å¯¹æäº¤æ ‘çš„æ“ä½œï¼Œä¾‹å¦‚å¢åŠ å¯¹è±¡ï¼Œå¢åŠ æˆ–åˆ é™¤å¼•ç”¨ã€‚\nå½“æ‚¨è¾“å…¥æŸä¸ªæŒ‡ä»¤æ—¶ï¼Œè¯·æ€è€ƒä¸€äº›è¿™æ¡å‘½ä»¤æ˜¯å¦‚ä½•å¯¹åº•å±‚çš„å›¾æ•°æ®ç»“æ„è¿›è¡Œæ“ä½œçš„ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœæ‚¨å¸Œæœ›ä¿®æ”¹æäº¤æ ‘ï¼Œä¾‹å¦‚â€œä¸¢å¼ƒæœªæäº¤çš„ä¿®æ”¹å’Œå°† â€˜masterâ€™ å¼•ç”¨æŒ‡å‘æäº¤5d83f9e æ—¶ï¼Œæœ‰ä»€ä¹ˆå‘½ä»¤å¯ä»¥å®Œæˆè¯¥æ“ä½œï¼ˆé’ˆå¯¹è¿™ä¸ªå…·ä½“é—®é¢˜ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨git checkout master; git reset --hard 5d83f9eï¼‰\næš‚å­˜åŒº Git ä¸­è¿˜åŒ…æ‹¬ä¸€ä¸ªå’Œæ•°æ®æ¨¡å‹å®Œå…¨ä¸ç›¸å…³çš„æ¦‚å¿µï¼Œä½†å®ƒç¡®æ˜¯åˆ›å»ºæäº¤çš„æ¥å£çš„ä¸€éƒ¨åˆ†ã€‚\nå°±ä¸Šé¢ä»‹ç»çš„å¿«ç…§ç³»ç»Ÿæ¥è¯´ï¼Œæ‚¨ä¹Ÿè®¸ä¼šæœŸæœ›å®ƒçš„å®ç°é‡ŒåŒ…æ‹¬ä¸€ä¸ª â€œåˆ›å»ºå¿«ç…§â€ çš„å‘½ä»¤ï¼Œè¯¥å‘½ä»¤èƒ½å¤ŸåŸºäºå½“å‰å·¥ä½œç›®å½•çš„å½“å‰çŠ¶æ€åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„å¿«ç…§ã€‚æœ‰äº›ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿç¡®å®æ˜¯è¿™æ ·å·¥ä½œçš„ï¼Œä½† Git ä¸æ˜¯ã€‚æˆ‘ä»¬å¸Œæœ›ç®€æ´çš„å¿«ç…§ï¼Œè€Œä¸”æ¯æ¬¡ä»å½“å‰çŠ¶æ€åˆ›å»ºå¿«ç…§å¯èƒ½æ•ˆæœå¹¶ä¸ç†æƒ³ã€‚ä¾‹å¦‚ï¼Œè€ƒè™‘å¦‚ä¸‹åœºæ™¯ï¼Œæ‚¨å¼€å‘äº†ä¸¤ä¸ªç‹¬ç«‹çš„ç‰¹æ€§ï¼Œç„¶åæ‚¨å¸Œæœ›åˆ›å»ºä¸¤ä¸ªç‹¬ç«‹çš„æäº¤ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªæäº¤ä»…åŒ…å«ç¬¬ä¸€ä¸ªç‰¹æ€§ï¼Œè€Œç¬¬äºŒä¸ªæäº¤ä»…åŒ…å«ç¬¬äºŒä¸ªç‰¹æ€§ã€‚æˆ–è€…ï¼Œå‡è®¾æ‚¨åœ¨è°ƒè¯•ä»£ç æ—¶æ·»åŠ äº†å¾ˆå¤šæ‰“å°è¯­å¥ï¼Œç„¶åæ‚¨ä»…ä»…å¸Œæœ›æäº¤å’Œä¿®å¤ bug ç›¸å…³çš„ä»£ç è€Œä¸¢å¼ƒæ‰€æœ‰çš„æ‰“å°è¯­å¥ã€‚\nGit å¤„ç†è¿™äº›åœºæ™¯çš„æ–¹æ³•æ˜¯ä½¿ç”¨ä¸€ç§å«åš â€œæš‚å­˜åŒºï¼ˆstaging areaï¼‰â€çš„æœºåˆ¶ï¼Œå®ƒå…è®¸æ‚¨æŒ‡å®šä¸‹æ¬¡å¿«ç…§ä¸­è¦åŒ…æ‹¬é‚£äº›æ”¹åŠ¨ã€‚\nGit çš„å‘½ä»¤è¡Œæ¥å£ ä¸ºäº†é¿å…é‡å¤ä¿¡æ¯ï¼Œæˆ‘ä»¬å°†ä¸ä¼šè¯¦ç»†è§£é‡Šä»¥ä¸‹å‘½ä»¤è¡Œã€‚å¼ºçƒˆæ¨èæ‚¨é˜…è¯»Pro Git ä¸­æ–‡ç‰ˆæˆ–å¯ä»¥è§‚çœ‹æœ¬è®²åº§çš„è§†é¢‘æ¥å­¦ä¹ ã€‚\nåŸºç¡€ git help \u0026lt;command\u0026gt;: è·å– git å‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯ git init: åˆ›å»ºä¸€ä¸ªæ–°çš„ git ä»“åº“ï¼Œå…¶æ•°æ®ä¼šå­˜æ”¾åœ¨ä¸€ä¸ªåä¸º .git çš„ç›®å½•ä¸‹ git status: æ˜¾ç¤ºå½“å‰çš„ä»“åº“çŠ¶æ€ git add \u0026lt;filename\u0026gt;: æ·»åŠ æ–‡ä»¶åˆ°æš‚å­˜åŒº git commit: åˆ›å»ºä¸€ä¸ªæ–°çš„æäº¤ å¦‚ä½•ç¼–å†™ è‰¯å¥½çš„æäº¤ä¿¡æ¯! git log: æ˜¾ç¤ºå†å²æ—¥å¿— git log --all --graph --decorate: å¯è§†åŒ–å†å²è®°å½•ï¼ˆæœ‰å‘æ— ç¯å›¾ï¼‰ git diff \u0026lt;filename\u0026gt;: æ˜¾ç¤ºä¸ä¸Šä¸€æ¬¡æäº¤ä¹‹é—´çš„å·®å¼‚ git diff \u0026lt;revision\u0026gt; \u0026lt;filename\u0026gt;: æ˜¾ç¤ºæŸä¸ªæ–‡ä»¶ä¸¤ä¸ªç‰ˆæœ¬ä¹‹é—´çš„å·®å¼‚ git checkout \u0026lt;revision\u0026gt;: æ›´æ–° HEAD å’Œç›®å‰çš„åˆ†æ”¯ åˆ†æ”¯å’Œåˆå¹¶ git branch: æ˜¾ç¤ºåˆ†æ”¯ git branch \u0026lt;name\u0026gt;: åˆ›å»ºåˆ†æ”¯ git checkout -b \u0026lt;name\u0026gt;: åˆ›å»ºåˆ†æ”¯å¹¶åˆ‡æ¢åˆ°è¯¥åˆ†æ”¯ ç›¸å½“äº git branch \u0026lt;name\u0026gt;; git checkout \u0026lt;name\u0026gt; git merge \u0026lt;revision\u0026gt;: åˆå¹¶åˆ°å½“å‰åˆ†æ”¯ git mergetool: ä½¿ç”¨å·¥å…·æ¥å¤„ç†åˆå¹¶å†²çª git rebase: å°†ä¸€ç³»åˆ—è¡¥ä¸å˜åŸºï¼ˆrebaseï¼‰ä¸ºæ–°çš„åŸºçº¿ è¿œç«¯æ“ä½œ git remote: åˆ—å‡ºè¿œç«¯ git remote add \u0026lt;name\u0026gt; \u0026lt;url\u0026gt;: æ·»åŠ ä¸€ä¸ªè¿œç«¯ git push \u0026lt;remote\u0026gt; \u0026lt;local branch\u0026gt;:\u0026lt;remote branch\u0026gt;: å°†å¯¹è±¡ä¼ é€è‡³è¿œç«¯å¹¶æ›´æ–°è¿œç«¯å¼•ç”¨ git branch --set-upstream-to=\u0026lt;remote\u0026gt;/\u0026lt;remote branch\u0026gt;: åˆ›å»ºæœ¬åœ°å’Œè¿œç«¯åˆ†æ”¯çš„å…³è”å…³ç³» git fetch: ä»è¿œç«¯è·å–å¯¹è±¡/ç´¢å¼• git pull: ç›¸å½“äº git fetch; git merge git clone: ä»è¿œç«¯ä¸‹è½½ä»“åº“ æ’¤é”€ git commit --amend: ç¼–è¾‘æäº¤çš„å†…å®¹æˆ–ä¿¡æ¯ git reset HEAD \u0026lt;file\u0026gt;: æ¢å¤æš‚å­˜çš„æ–‡ä»¶ git checkout -- \u0026lt;file\u0026gt;: ä¸¢å¼ƒä¿®æ”¹ Git é«˜çº§æ“ä½œ git config: Git æ˜¯ä¸€ä¸ª é«˜åº¦å¯å®šåˆ¶çš„ å·¥å…· åˆ—å‡ºæ‰€æœ‰configæ–‡ä»¶é‡Œçš„è®¾ç½®é¡¹\ngit config --system -l # ç³»ç»Ÿçº§çš„é…ç½® /etcæ–‡ä»¶åŠ ä¸‹ git config --global -l # ç”¨æˆ·çº§çš„é…ç½® /home/ç”¨æˆ·å/çš„æ–‡ä»¶ä¸‹ git config --local -l # ä»“åº“/é¡¹ç›®çº§ ./.git/ç›®å½•ä¸‹ git config user.name \u0026#39;ä½ çš„å§“å\u0026#39; git config user.email \u0026#39;ä½ çš„email\u0026#39; åˆ é™¤é…ç½®æ–‡ä»¶ä¸­çš„é…ç½®é¡¹\ngit config --unset user.name æŸ¥çœ‹é…ç½®æ–‡ä»¶ä¸­çš„é…ç½®é¡¹\ngit config --get user.name å®šä¹‰æŒ‡ä»¤åˆ«å\n# git config alias.æŒ‡ä»¤åˆ«å \u0026#39;æ ‡å‡†æŒ‡ä»¤\u0026#39; git config alias.con \u0026#39;config -l\u0026#39; git con git config --unset alias.con åˆ›å»º.gitignoreæ–‡ä»¶ vi .gitignore .gitignoreæ–‡ä»¶è§„å®šäº†gitç³»ç»Ÿè¯¥å¿½ç•¥å“ªäº›æ–‡ä»¶\n/images *.txt !requirements.txt å¦‚ä»¥ä¸Šé…ç½®è§„å®šäº†gitå¿½ç•¥\n/imagesç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ é™¤äº†requirements.txtå¤–çš„æ‰€æœ‰txtæ–‡ä»¶ git clone --shallow: å…‹éš†ä»“åº“ï¼Œä½†æ˜¯ä¸åŒ…æ‹¬ç‰ˆæœ¬å†å²ä¿¡æ¯ git add -p: äº¤äº’å¼æš‚å­˜ git rebase -i: äº¤äº’å¼å˜åŸº git blame: æŸ¥çœ‹æœ€åä¿®æ”¹æŸè¡Œçš„äºº git stash: æš‚æ—¶ç§»é™¤å·¥ä½œç›®å½•ä¸‹çš„ä¿®æ”¹å†…å®¹ git bisect: é€šè¿‡äºŒåˆ†æŸ¥æ‰¾æœç´¢å†å²è®°å½• .gitignore: æŒ‡å®š æ•…æ„ä¸è¿½è¸ªçš„æ–‡ä»¶ æ‚é¡¹ å›¾å½¢ç”¨æˆ·ç•Œé¢: Git çš„ å›¾å½¢ç”¨æˆ·ç•Œé¢å®¢æˆ·ç«¯ æœ‰å¾ˆå¤šï¼Œä½†æ˜¯æˆ‘ä»¬è‡ªå·±å¹¶ä¸ä½¿ç”¨è¿™äº›å›¾å½¢ç”¨æˆ·ç•Œé¢çš„å®¢æˆ·ç«¯ï¼Œæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨å‘½ä»¤è¡Œæ¥å£ Shell é›†æˆ: å°† Git çŠ¶æ€é›†æˆåˆ°æ‚¨çš„ shell ä¸­ä¼šéå¸¸æ–¹ä¾¿ã€‚(zsh,bash)ã€‚Oh My Zshè¿™æ ·çš„æ¡†æ¶ä¸­ä¸€èˆ¬ä»¥åŠé›†æˆäº†è¿™ä¸€åŠŸèƒ½ ç¼–è¾‘å™¨é›†æˆ: å’Œä¸Šé¢ä¸€æ¡ç±»ä¼¼ï¼Œå°† Git é›†æˆåˆ°ç¼–è¾‘å™¨ä¸­å¥½å¤„å¤šå¤šã€‚fugitive.vim æ˜¯ Vim ä¸­é›†æˆ GIt çš„å¸¸ç”¨æ’ä»¶ å·¥ä½œæµ:æˆ‘ä»¬å·²ç»è®²è§£äº†æ•°æ®æ¨¡å‹ä¸ä¸€äº›åŸºç¡€å‘½ä»¤ï¼Œä½†è¿˜æ²¡è®¨è®ºåˆ°è¿›è¡Œå¤§å‹é¡¹ç›®æ—¶çš„ä¸€äº›æƒ¯ä¾‹ ( æœ‰å¾ˆå¤š ä¸åŒçš„ å¤„ç†æ–¹æ³•) GitHub: Git å¹¶ä¸ç­‰åŒäº GitHubã€‚ åœ¨ GitHub ä¸­æ‚¨éœ€è¦ä½¿ç”¨ä¸€ä¸ªè¢«ç§°ä½œæ‹‰å–è¯·æ±‚ï¼ˆpull requestï¼‰çš„æ–¹æ³•æ¥åƒå…¶ä»–é¡¹ç›®è´¡çŒ®ä»£ç  Other Git æä¾›å•†: GitHub å¹¶ä¸æ˜¯å”¯ä¸€çš„ã€‚è¿˜æœ‰åƒGitLab å’Œ BitBucketè¿™æ ·çš„å¹³å°ã€‚ èµ„æº Pro Git ï¼Œå¼ºçƒˆæ¨èï¼å­¦ä¹ å‰äº”ç« çš„å†…å®¹å¯ä»¥æ•™ä¼šæ‚¨æµç•…ä½¿ç”¨ Git çš„ç»å¤§å¤šæ•°æŠ€å·§ï¼Œå› ä¸ºæ‚¨å·²ç»ç†è§£äº† Git çš„æ•°æ®æ¨¡å‹ã€‚åé¢çš„ç« èŠ‚æä¾›äº†å¾ˆå¤šæœ‰è¶£çš„é«˜çº§ä¸»é¢˜ã€‚ï¼ˆPro Git ä¸­æ–‡ç‰ˆï¼‰ï¼› Oh Shit, Git!?! ï¼Œç®€çŸ­çš„ä»‹ç»äº†å¦‚ä½•ä» Git é”™è¯¯ä¸­æ¢å¤ï¼› Git for Computer Scientists ï¼Œç®€çŸ­çš„ä»‹ç»äº† Git çš„æ•°æ®æ¨¡å‹ï¼Œä¸æœ¬æ–‡ç›¸æ¯”åŒ…å«è¾ƒå°‘é‡çš„ä¼ªä»£ç ä»¥åŠå¤§é‡çš„ç²¾ç¾å›¾ç‰‡ï¼› Git from the Bottom Upè¯¦ç»†çš„ä»‹ç»äº† Git çš„å®ç°ç»†èŠ‚ï¼Œè€Œä¸ä»…ä»…å±€é™äºæ•°æ®æ¨¡å‹ã€‚å¥½å¥‡çš„åŒå­¦å¯ä»¥çœ‹çœ‹ï¼› How to explain git in simple wordsï¼› Learn Git Branching é€šè¿‡åŸºäºæµè§ˆå™¨çš„æ¸¸æˆæ¥å­¦ä¹  Git ï¼› å‚è€ƒ è¯¾ç¨‹åˆ—è¡¨\n","permalink":"https://blog.niuhemoon.win/posts/tech/coding-tools-git/","summary":"Gitç‰ˆæœ¬æ§åˆ¶ å°½ç®¡ Git çš„æ¥å£æœ‰äº›ä¸‘é™‹ï¼Œä½†æ˜¯å®ƒçš„åº•å±‚è®¾è®¡å’Œæ€æƒ³å´æ˜¯éå¸¸ä¼˜é›…çš„ã€‚ä¸‘é™‹çš„æ¥å£åªèƒ½é æ­»è®°ç¡¬èƒŒï¼Œè€Œä¼˜é›…çš„åº•å±‚è®¾è®¡åˆ™éå¸¸å®¹æ˜“è¢«äººç†è§£ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†é€šè¿‡ä¸€ç§è‡ªåº•å‘ä¸Šçš„æ–¹å¼åƒæ‚¨ä»‹ç» Gitã€‚æˆ‘ä»¬ä¼šä»æ•°æ®æ¨¡å‹å¼€å§‹ï¼Œæœ€åå†å­¦ä¹ å®ƒçš„æ¥å£ã€‚ä¸€æ—¦æ‚¨ææ‡‚äº† Git çš„æ•°æ®æ¨¡å‹ï¼Œå†å­¦ä¹ å…¶æ¥å£å¹¶ç†è§£è¿™äº›æ¥å£","title":"ç¼–ç¨‹å·¥å…·ä¹‹Git"},{"content":"Vimç¼–è¾‘å™¨ ç¼–è¾‘æ¨¡å¼ Vimçš„è®¾è®¡ä»¥å¤§å¤šæ•°æ—¶é—´éƒ½èŠ±åœ¨é˜…è¯»ã€æµè§ˆå’Œè¿›è¡Œå°‘é‡ç¼–è¾‘æ”¹åŠ¨ä¸ºåŸºç¡€ï¼Œå› æ­¤å®ƒå…·æœ‰å¤šç§æ“ä½œæ¨¡å¼ï¼š\næ­£å¸¸æ¨¡å¼ï¼šåœ¨æ–‡ä»¶ä¸­å››å¤„ç§»åŠ¨å…‰æ ‡è¿›è¡Œä¿®æ”¹ æ’å…¥æ¨¡å¼ï¼šæ’å…¥æ–‡æœ¬ æ›¿æ¢æ¨¡å¼ï¼šæ›¿æ¢æ–‡æœ¬ å¯è§†åŒ–ï¼ˆä¸€èˆ¬ï¼Œè¡Œï¼Œå—ï¼‰æ¨¡å¼ï¼šé€‰ä¸­æ–‡æœ¬å— å‘½ä»¤æ¨¡å¼ï¼šç”¨äºæ‰§è¡Œå‘½ä»¤ åœ¨ä¸åŒçš„æ“ä½œæ¨¡å¼ä¸‹ï¼Œ é”®ç›˜æ•²å‡»çš„å«ä¹‰ä¹Ÿä¸åŒã€‚æ¯”å¦‚ï¼Œx åœ¨æ’å…¥æ¨¡å¼ä¼šæ’å…¥å­—æ¯xï¼Œä½†æ˜¯åœ¨æ­£å¸¸æ¨¡å¼ ä¼šåˆ é™¤å½“å‰å…‰æ ‡æ‰€åœ¨ä¸‹çš„å­—æ¯ï¼Œåœ¨å¯è§†æ¨¡å¼ä¸‹åˆ™ä¼šåˆ é™¤é€‰ä¸­æ–‡å—ã€‚\nåœ¨é»˜è®¤è®¾ç½®ä¸‹ï¼ŒVimä¼šåœ¨å·¦ä¸‹è§’æ˜¾ç¤ºå½“å‰çš„æ¨¡å¼ã€‚ Vimå¯åŠ¨æ—¶çš„é»˜è®¤æ¨¡å¼æ˜¯æ­£å¸¸æ¨¡å¼ã€‚é€šå¸¸ä½ ä¼šæŠŠå¤§éƒ¨åˆ† æ—¶é—´èŠ±åœ¨æ­£å¸¸æ¨¡å¼å’Œæ’å…¥æ¨¡å¼ã€‚\nä½ å¯ä»¥æŒ‰ä¸‹ \u0026lt;ESC\u0026gt; ï¼ˆé€ƒè„±é”®ï¼‰ ä»ä»»ä½•å…¶ä»–æ¨¡å¼è¿”å›æ­£å¸¸æ¨¡å¼ã€‚ åœ¨æ­£å¸¸æ¨¡å¼ï¼Œé”®å…¥ i è¿›å…¥æ’å…¥ æ¨¡å¼ï¼Œ R è¿›å…¥æ›¿æ¢æ¨¡å¼ï¼Œ v è¿›å…¥å¯è§†ï¼ˆä¸€èˆ¬ï¼‰æ¨¡å¼ï¼Œ V è¿›å…¥å¯è§†ï¼ˆè¡Œï¼‰æ¨¡å¼ï¼Œ \u0026lt;C-v\u0026gt; ï¼ˆCtrl-V, æœ‰æ—¶ä¹Ÿå†™ä½œ ^Vï¼‰è¿›å…¥å¯è§†ï¼ˆå—ï¼‰æ¨¡å¼ï¼Œ : è¿›å…¥å‘½ä»¤æ¨¡å¼ã€‚\nå› ä¸ºä½ ä¼šåœ¨ä½¿ç”¨ Vim æ—¶å¤§é‡ä½¿ç”¨ \u0026lt;ESC\u0026gt; é”®ï¼Œå¯ä»¥è€ƒè™‘æŠŠå¤§å°å†™é”å®šé”®é‡å®šä¹‰æˆé€ƒè„±é”® ï¼ˆMacOS æ•™ç¨‹ ï¼‰ã€‚\nåŸºæœ¬æ“ä½œ æ’å…¥æ–‡æœ¬ åœ¨æ­£å¸¸æ¨¡å¼ï¼Œ é”®å…¥ i è¿›å…¥æ’å…¥æ¨¡å¼ã€‚ ç°åœ¨ Vim è·Ÿå¾ˆå¤šå…¶ä»–çš„ç¼–è¾‘å™¨ä¸€æ ·ï¼Œ ç›´åˆ°ä½ é”®å…¥\u0026lt;ESC\u0026gt; è¿”å›æ­£å¸¸æ¨¡å¼ã€‚ ä½ åªéœ€è¦æŒæ¡è¿™ä¸€ç‚¹å’Œä¸Šé¢ä»‹ç»çš„æ‰€æœ‰åŸºçŸ¥è¯†å°±å¯ä»¥ä½¿ç”¨ Vim æ¥ç¼–è¾‘æ–‡ä»¶äº† ï¼ˆè™½ç„¶å¦‚æœä½ ä¸€ç›´åœç•™åœ¨æ’å…¥æ¨¡å¼å†…ä¸ä¸€å®šé«˜æ•ˆï¼‰ã€‚\nç¼“å­˜ï¼Œ æ ‡ç­¾é¡µï¼Œ çª—å£ Vim ä¼šç»´æŠ¤ä¸€ç³»åˆ—æ‰“å¼€çš„æ–‡ä»¶ï¼Œç§°ä¸º â€œç¼“å­˜â€ã€‚ ä¸€ä¸ª Vim ä¼šè¯åŒ…å«ä¸€ç³»åˆ—æ ‡ç­¾é¡µï¼Œæ¯ä¸ªæ ‡ç­¾é¡µåŒ…å« ä¸€ç³»åˆ—çª—å£ ï¼ˆåˆ†éš”é¢æ¿ï¼‰ã€‚æ¯ä¸ªçª—å£æ˜¾ç¤ºä¸€ä¸ªç¼“å­˜ã€‚ è·Ÿç½‘é¡µæµè§ˆå™¨ç­‰å…¶ä»–ä½ ç†Ÿæ‚‰çš„ç¨‹åºä¸ä¸€æ ·çš„æ˜¯ï¼Œ ç¼“å­˜å’Œçª—å£ä¸æ˜¯ä¸€ä¸€å¯¹åº”çš„å…³ç³»ï¼› çª—å£åªæ˜¯è§†è§’ã€‚ ä¸€ä¸ªç¼“å­˜å¯ä»¥åœ¨ å¤šä¸ª çª—å£æ‰“å¼€ï¼Œç”šè‡³åœ¨åŒä¸€ ä¸ªæ ‡ç­¾é¡µå†…çš„å¤šä¸ªçª—å£æ‰“å¼€ã€‚è¿™ä¸ªåŠŸèƒ½å…¶å®å¾ˆå¥½ç”¨ï¼Œ æ¯”å¦‚åœ¨æŸ¥çœ‹åŒä¸€ä¸ªæ–‡ä»¶çš„ä¸åŒéƒ¨åˆ†çš„æ—¶å€™ã€‚\nVim é»˜è®¤æ‰“å¼€ä¸€ä¸ªæ ‡ç­¾é¡µï¼Œè¿™ä¸ªæ ‡ç­¾ä¹ŸåŒ…å«ä¸€ä¸ªçª—å£ã€‚\nå‘½ä»¤è¡Œ åœ¨æ­£å¸¸æ¨¡å¼ä¸‹é”®å…¥ : è¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼ã€‚ åœ¨é”®å…¥ : åï¼Œä½ çš„å…‰æ ‡ä¼šç«‹å³è·³åˆ°å±å¹•ä¸‹æ–¹çš„å‘½ä»¤è¡Œã€‚ è¿™ä¸ªæ¨¡å¼æœ‰å¾ˆå¤šåŠŸèƒ½ï¼Œ åŒ…æ‹¬æ‰“å¼€ï¼Œ ä¿å­˜ï¼Œ å…³é—­æ–‡ä»¶ï¼Œ ä»¥åŠ é€€å‡º Vimã€‚\n:q é€€å‡º ï¼ˆå…³é—­çª—å£ï¼‰ :w ä¿å­˜ ï¼ˆå†™ï¼‰ :wq ä¿å­˜ç„¶åé€€å‡º :e {æ–‡ä»¶å} æ‰“å¼€è¦ç¼–è¾‘çš„æ–‡ä»¶ :ls æ˜¾ç¤ºæ‰“å¼€çš„ç¼“å­˜ :help {æ ‡é¢˜} æ‰“å¼€å¸®åŠ©æ–‡æ¡£ :help :w æ‰“å¼€ :w å‘½ä»¤çš„å¸®åŠ©æ–‡æ¡£ :help w æ‰“å¼€ w ç§»åŠ¨çš„å¸®åŠ©æ–‡æ¡£ Vim çš„æ¥å£å…¶å®æ˜¯ä¸€ç§ç¼–ç¨‹è¯­è¨€ Vim æœ€é‡è¦çš„è®¾è®¡æ€æƒ³æ˜¯ Vim çš„ç•Œé¢æœ¬èº«æ˜¯ä¸€ä¸ªç¨‹åºè¯­è¨€ã€‚ é”®å…¥æ“ä½œ ï¼ˆä»¥åŠä»–ä»¬çš„åŠ©è®°åï¼‰ æœ¬èº«æ˜¯å‘½ä»¤ï¼Œ è¿™äº›å‘½ä»¤å¯ä»¥ç»„åˆä½¿ç”¨ã€‚ è¿™ä½¿å¾—ç§»åŠ¨å’Œç¼–è¾‘æ›´åŠ é«˜æ•ˆï¼Œç‰¹åˆ«æ˜¯ä¸€æ—¦å½¢æˆè‚Œè‚‰è®°å¿†ã€‚\nç§»åŠ¨ å¤šæ•°æ—¶å€™ä½ ä¼šåœ¨æ­£å¸¸æ¨¡å¼ä¸‹ï¼Œä½¿ç”¨ç§»åŠ¨å‘½ä»¤åœ¨ç¼“å­˜ä¸­å¯¼èˆªã€‚åœ¨ Vim é‡Œé¢ç§»åŠ¨ä¹Ÿè¢«æˆä¸º â€œåè¯â€ï¼Œ å› ä¸ºå®ƒä»¬æŒ‡å‘æ–‡å­—å—ã€‚\nåŸºæœ¬ç§»åŠ¨: hjkl ï¼ˆå·¦ï¼Œ ä¸‹ï¼Œ ä¸Šï¼Œ å³ï¼‰ è¯ï¼š w ï¼ˆä¸‹ä¸€ä¸ªè¯ï¼‰ï¼Œ b ï¼ˆè¯åˆï¼‰ï¼Œ e ï¼ˆè¯å°¾ï¼‰ è¡Œï¼š 0 ï¼ˆè¡Œåˆï¼‰ï¼Œ ^ ï¼ˆç¬¬ä¸€ä¸ªéç©ºæ ¼å­—ç¬¦ï¼‰ï¼Œ $ ï¼ˆè¡Œå°¾ï¼‰ å±å¹•ï¼š H ï¼ˆå±å¹•é¦–è¡Œï¼‰ï¼Œ M ï¼ˆå±å¹•ä¸­é—´ï¼‰ï¼Œ L ï¼ˆå±å¹•åº•éƒ¨ï¼‰ ç¿»é¡µï¼š Ctrl-u ï¼ˆä¸Šç¿»ï¼‰ï¼Œ Ctrl-d ï¼ˆä¸‹ç¿»ï¼‰ æ–‡ä»¶ï¼š gg ï¼ˆæ–‡ä»¶å¤´ï¼‰ï¼Œ G ï¼ˆæ–‡ä»¶å°¾ï¼‰ è¡Œæ•°ï¼š :{è¡Œæ•°}\u0026lt;CR\u0026gt; æˆ–è€… {è¡Œæ•°}G ({è¡Œæ•°}ä¸ºè¡Œæ•°) æ‚é¡¹ï¼š % ï¼ˆæ‰¾åˆ°é…å¯¹ï¼Œæ¯”å¦‚æ‹¬å·æˆ–è€… /* */ ä¹‹ç±»çš„æ³¨é‡Šå¯¹ï¼‰ æŸ¥æ‰¾ï¼š f{å­—ç¬¦}ï¼Œ t{å­—ç¬¦}ï¼Œ F{å­—ç¬¦}ï¼Œ T{å­—ç¬¦} æŸ¥æ‰¾/åˆ° å‘å‰/å‘å åœ¨æœ¬è¡Œçš„{å­—ç¬¦} , / ; ç”¨äºå¯¼èˆªåŒ¹é… æœç´¢: /{æ­£åˆ™è¡¨è¾¾å¼}, n / N ç”¨äºå¯¼èˆªåŒ¹é… é€‰æ‹© å¯è§†åŒ–æ¨¡å¼:\nå¯è§†åŒ– å¯è§†åŒ–è¡Œ å¯è§†åŒ–å— å¯ä»¥ç”¨ç§»åŠ¨å‘½ä»¤æ¥é€‰ä¸­ã€‚\nç¼–è¾‘ æ‰€æœ‰ä½ éœ€è¦ç”¨é¼ æ ‡åšçš„äº‹ï¼Œ ä½ ç°åœ¨éƒ½å¯ä»¥ç”¨é”®ç›˜ï¼šé‡‡ç”¨ç¼–è¾‘å‘½ä»¤å’Œç§»åŠ¨å‘½ä»¤çš„ç»„åˆæ¥å®Œæˆã€‚ è¿™å°±æ˜¯ Vim çš„ç•Œé¢å¼€å§‹çœ‹èµ·æ¥åƒä¸€ä¸ªç¨‹åºè¯­è¨€çš„æ—¶å€™ã€‚Vim çš„ç¼–è¾‘å‘½ä»¤ä¹Ÿè¢«ç§°ä¸º â€œåŠ¨è¯â€ï¼Œ å› ä¸ºåŠ¨è¯å¯ä»¥æ–½åŠ¨äºåè¯ã€‚\ni è¿›å…¥æ’å…¥æ¨¡å¼ ä½†æ˜¯å¯¹äºæ“çºµ/ç¼–è¾‘æ–‡æœ¬ï¼Œä¸å•æƒ³ç”¨é€€æ ¼é”®å®Œæˆ O / o åœ¨ä¹‹ä¸Š/ä¹‹ä¸‹æ’å…¥è¡Œ d{ç§»åŠ¨å‘½ä»¤} åˆ é™¤ {ç§»åŠ¨å‘½ä»¤} ä¾‹å¦‚ï¼Œ dw åˆ é™¤è¯, d$ åˆ é™¤åˆ°è¡Œå°¾, d0 åˆ é™¤åˆ°è¡Œå¤´ã€‚ c{ç§»åŠ¨å‘½ä»¤} æ”¹å˜ {ç§»åŠ¨å‘½ä»¤} ä¾‹å¦‚ï¼Œ cw æ”¹å˜è¯ æ¯”å¦‚ d{ç§»åŠ¨å‘½ä»¤} å† i x åˆ é™¤å­—ç¬¦ ï¼ˆç­‰åŒäº dlï¼‰ s æ›¿æ¢å­—ç¬¦ ï¼ˆç­‰åŒäº xiï¼‰ å¯è§†åŒ–æ¨¡å¼ + æ“ä½œ é€‰ä¸­æ–‡å­—, d åˆ é™¤ æˆ–è€… c æ”¹å˜ u æ’¤é”€, \u0026lt;C-r\u0026gt; é‡åš y å¤åˆ¶ / â€œyankâ€ ï¼ˆå…¶ä»–ä¸€äº›å‘½ä»¤æ¯”å¦‚ d ä¹Ÿä¼šå¤åˆ¶ï¼‰ p ç²˜è´´ æ›´å¤šå€¼å¾—å­¦ä¹ çš„: æ¯”å¦‚ ~ æ”¹å˜å­—ç¬¦çš„å¤§å°å†™ è®¡æ•° ä½ å¯ä»¥ç”¨ä¸€ä¸ªè®¡æ•°æ¥ç»“åˆâ€œåè¯â€ å’Œ â€œåŠ¨è¯â€ï¼Œ è¿™ä¼šæ‰§è¡ŒæŒ‡å®šæ“ä½œè‹¥å¹²æ¬¡ã€‚\n3w å‘å‰ç§»åŠ¨ä¸‰ä¸ªè¯ 5j å‘ä¸‹ç§»åŠ¨5è¡Œ 7dw åˆ é™¤7ä¸ªè¯ ä¿®é¥°è¯­ ä½ å¯ä»¥ç”¨ä¿®é¥°è¯­æ”¹å˜ â€œåè¯â€ çš„æ„ä¹‰ã€‚ä¿®é¥°è¯­æœ‰ iï¼Œ è¡¨ç¤º â€œå†…éƒ¨â€ æˆ–è€… â€œåœ¨å†…â€œï¼Œ å’Œ aï¼Œ è¡¨ç¤º â€å‘¨å›´â€œã€‚\nci( æ”¹å˜å½“å‰æ‹¬å·å†…çš„å†…å®¹ ci[ æ”¹å˜å½“å‰æ–¹æ‹¬å·å†…çš„å†…å®¹ da' åˆ é™¤ä¸€ä¸ªå•å¼•å·å­—ç¬¦çª—ï¼Œ åŒ…æ‹¬å‘¨å›´çš„å•å¼•å· è‡ªå®šä¹‰ Vim Vim ç”±ä¸€ä¸ªä½äº ~/.vimrc çš„æ–‡æœ¬é…ç½®æ–‡ä»¶ ï¼ˆåŒ…å« Vim è„šæœ¬å‘½ä»¤ï¼‰ã€‚ ä½ å¯èƒ½ä¼šå¯ç”¨å¾ˆå¤šåŸºæœ¬ è®¾ç½®ã€‚\næˆ‘ä»¬æä¾›ä¸€ä¸ªæ–‡æ¡£è¯¦ç»†çš„åŸºæœ¬è®¾ç½®ï¼Œ ä½ å¯ä»¥ç”¨å®ƒå½“ä½œä½ çš„åˆå§‹è®¾ç½®ã€‚ æˆ‘ä»¬æ¨èä½¿ç”¨è¿™ä¸ªè®¾ç½®å› ä¸º å®ƒä¿®å¤äº†ä¸€äº› Vim é»˜è®¤è®¾ç½®å¥‡æ€ªè¡Œä¸ºã€‚ åœ¨ è¿™å„¿ ä¸‹è½½æˆ‘ä»¬çš„è®¾ç½®ï¼Œ ç„¶åå°†å®ƒä¿å­˜æˆ ~/.vimrc.\nVim èƒ½å¤Ÿè¢«é‡åº¦è‡ªå®šä¹‰ï¼Œ èŠ±æ—¶é—´æ¢ç´¢è‡ªå®šä¹‰é€‰é¡¹æ˜¯å€¼å¾—çš„ã€‚ ä½ å¯ä»¥å‚è€ƒå…¶ä»–äººçš„åœ¨ GitHub ä¸Šå…±äº«çš„è®¾ç½®æ–‡ä»¶ï¼Œ æ¯”å¦‚ï¼Œ ä½ çš„æˆè¯¾äººçš„ Vim è®¾ç½® (Anish, Jon (uses neovim), Jose)ã€‚ æœ‰å¾ˆå¤šå¥½çš„åšå®¢æ–‡ç« ä¹ŸèŠåˆ°äº†è¿™ä¸ªè¯é¢˜ã€‚ å°½é‡ä¸è¦å¤åˆ¶ç²˜è´´åˆ«äººçš„æ•´ä¸ªè®¾ç½®æ–‡ä»¶ï¼Œ è€Œæ˜¯é˜…è¯»å’Œç†è§£å®ƒï¼Œ ç„¶åé‡‡ç”¨å¯¹ä½ æœ‰ç”¨çš„éƒ¨åˆ†ã€‚\næ‰©å±• Vim Vim æœ‰å¾ˆå¤šæ‰©å±•æ’ä»¶ã€‚ è·Ÿå¾ˆå¤šäº’è”ç½‘ä¸Šå·²ç»è¿‡æ—¶çš„å»ºè®®ç›¸åï¼Œ ä½  ä¸ éœ€è¦åœ¨ Vim ä½¿ç”¨ä¸€ä¸ªæ’ä»¶ ç®¡ç†å™¨ï¼ˆä» Vim 8.0 å¼€å§‹ï¼‰ã€‚ ä½ å¯ä»¥ä½¿ç”¨å†…ç½®çš„æ’ä»¶ç®¡ç†ç³»ç»Ÿã€‚ åªéœ€è¦åˆ›å»ºä¸€ä¸ª ~/.vim/pack/vendor/start/ çš„æ–‡ä»¶å¤¹ï¼Œ ç„¶åæŠŠæ’ä»¶æ”¾åˆ°è¿™é‡Œ ï¼ˆæ¯”å¦‚é€šè¿‡ git cloneï¼‰ã€‚\nä»¥ä¸‹æ˜¯ä¸€äº›æˆ‘ä»¬æœ€çˆ±çš„æ’ä»¶ï¼š\nctrlp.vim: æ¨¡ç³Šæ–‡ä»¶æŸ¥æ‰¾ ack.vim: ä»£ç æœç´¢ nerdtree: æ–‡ä»¶æµè§ˆå™¨ vim-easymotion: é­”æœ¯æ“ä½œ æˆ‘ä»¬å°½é‡é¿å…åœ¨è¿™é‡Œæä¾›ä¸€ä»½å†—é•¿çš„æ’ä»¶åˆ—è¡¨ã€‚ ä½ å¯ä»¥æŸ¥çœ‹è®²å¸ˆä»¬çš„å¼€æºçš„é…ç½®æ–‡ä»¶ (Anish, Jon, Jose) æ¥çœ‹çœ‹æˆ‘ä»¬ä½¿ç”¨çš„å…¶ä»–æ’ä»¶ã€‚ æµè§ˆ Vim Awesome æ¥äº†è§£ä¸€äº›å¾ˆæ£’çš„æ’ä»¶ã€‚ è¿™ä¸ªè¯é¢˜ä¹Ÿæœ‰å¾ˆå¤šåšå®¢æ–‡ç« ï¼š æœç´¢ â€œbest Vim pluginsâ€ã€‚\nVim è¿›é˜¶ è¿™é‡Œæˆ‘ä»¬æä¾›äº†ä¸€äº›å±•ç¤ºè¿™ä¸ªç¼–è¾‘å™¨èƒ½åŠ›çš„ä¾‹å­ã€‚æˆ‘ä»¬æ— æ³•æŠŠæ‰€æœ‰çš„è¿™æ ·çš„äº‹æƒ…éƒ½æ•™ç»™ä½ ï¼Œ ä½†æ˜¯ä½  å¯ä»¥åœ¨ä½¿ç”¨ä¸­å­¦ä¹ ã€‚ ä¸€ä¸ªå¥½çš„å¯¹ç­–æ˜¯: å½“ä½ åœ¨ä½¿ç”¨ä½ çš„ç¼–è¾‘å™¨çš„æ—¶å€™æ„Ÿè§‰ â€œä¸€å®šæœ‰æ›´å¥½çš„æ–¹æ³•æ¥åšè¿™ä¸ªâ€ï¼Œ é‚£ä¹ˆå¾ˆå¯èƒ½çœŸçš„æœ‰ï¼š ä¸Šç½‘æœå¯»ä¸€ä¸‹ã€‚\næœç´¢å’Œæ›¿æ¢ :s ï¼ˆæ›¿æ¢ï¼‰ å‘½ä»¤ ï¼ˆæ–‡æ¡£ï¼‰ã€‚\n%s/foo/bar/g åœ¨æ•´ä¸ªæ–‡ä»¶ä¸­å°† foo å…¨å±€æ›¿æ¢æˆ bar %s/\\[.*\\](\\(.*\\))/\\1/g å°†æœ‰å‘½åçš„ Markdown é“¾æ¥æ›¿æ¢æˆç®€å• URLs å¤šçª—å£ ç”¨ :sp / :vsp æ¥åˆ†å‰²çª—å£ åŒä¸€ä¸ªç¼“å­˜å¯ä»¥åœ¨å¤šä¸ªçª—å£ä¸­æ˜¾ç¤ºã€‚ å® q{å­—ç¬¦} æ¥å¼€å§‹åœ¨å¯„å­˜å™¨ {å­—ç¬¦} ä¸­å½•åˆ¶å® q åœæ­¢å½•åˆ¶ @{å­—ç¬¦} é‡æ”¾å® å®çš„æ‰§è¡Œé‡é”™è¯¯ä¼šåœæ­¢ {è®¡æ•°}@{å­—ç¬¦} æ‰§è¡Œä¸€ä¸ªå® {è®¡æ•°} æ¬¡ å®å¯ä»¥é€’å½’ é¦–å…ˆç”¨ q{å­—ç¬¦}q æ¸…é™¤å® å½•åˆ¶è¯¥å®ï¼Œ ç”¨ @{å­—ç¬¦} æ¥é€’å½’è°ƒç”¨è¯¥å® ï¼ˆåœ¨å½•åˆ¶å®Œæˆä¹‹å‰ä¸ä¼šæœ‰ä»»ä½•æ“ä½œï¼‰ ä¾‹å­ï¼š å°† xml è½¬æˆ json (file) ä¸€ä¸ªæœ‰ â€œnameâ€ / â€œemailâ€ é”®å¯¹è±¡çš„æ•°ç»„ ç”¨ä¸€ä¸ª Python ç¨‹åºï¼Ÿ ç”¨ sed / æ­£åˆ™è¡¨è¾¾å¼ g/people/d %s/\u0026lt;person\u0026gt;/{/g %s/\u0026lt;name\u0026gt;\\(.*\\)\u0026lt;\\/name\u0026gt;/\u0026quot;name\u0026quot;: \u0026quot;\\1\u0026quot;,/g â€¦ Vim å‘½ä»¤ / å® Gdd, ggdd åˆ é™¤ç¬¬ä¸€è¡Œå’Œæœ€åä¸€è¡Œ æ ¼å¼åŒ–æœ€åä¸€ä¸ªå…ƒç´ çš„å® ï¼ˆå¯„å­˜å™¨ eï¼‰ è·³è½¬åˆ°æœ‰ \u0026lt;name\u0026gt; çš„è¡Œ qe^r\u0026quot;f\u0026gt;s\u0026quot;: \u0026quot;\u0026lt;ESC\u0026gt;f\u0026lt;C\u0026quot;\u0026lt;ESC\u0026gt;q æ ¼å¼åŒ–ä¸€ä¸ªäººçš„å® è·³è½¬åˆ°æœ‰ \u0026lt;person\u0026gt; çš„è¡Œ qpS{\u0026lt;ESC\u0026gt;j@eA,\u0026lt;ESC\u0026gt;j@ejS},\u0026lt;ESC\u0026gt;q æ ¼å¼åŒ–ä¸€ä¸ªäººç„¶åè½¬åˆ°å¦å¤–ä¸€ä¸ªäººçš„å® è·³è½¬åˆ°æœ‰ \u0026lt;person\u0026gt; çš„è¡Œ qq@pjq æ‰§è¡Œå®åˆ°æ–‡ä»¶å°¾ 999@q æ‰‹åŠ¨ç§»é™¤æœ€åçš„ , ç„¶ååŠ ä¸Š [ å’Œ ] åˆ†éš”ç¬¦ æ‰©å±•èµ„æ–™ vimtutor æ˜¯ä¸€ä¸ª Vim å®‰è£…æ—¶è‡ªå¸¦çš„æ•™ç¨‹ Vim Adventures æ˜¯ä¸€ä¸ªå­¦ä¹ ä½¿ç”¨ Vim çš„æ¸¸æˆ Vim Tips Wiki Vim Advent Calendar æœ‰å¾ˆå¤š Vim å°æŠ€å·§ Vim Golf æ˜¯ç”¨ Vim çš„ç”¨æˆ·ç•Œé¢ä½œä¸ºç¨‹åºè¯­è¨€çš„ code golf Vi/Vim Stack Exchange Vim Screencasts Practical Vim ï¼ˆä¹¦ï¼‰ å‚è€ƒ è¯¾ç¨‹åˆ—è¡¨\n","permalink":"https://blog.niuhemoon.win/posts/tech/coding-tools-vim/","summary":"Vimç¼–è¾‘å™¨ ç¼–è¾‘æ¨¡å¼ Vimçš„è®¾è®¡ä»¥å¤§å¤šæ•°æ—¶é—´éƒ½èŠ±åœ¨é˜…è¯»ã€æµè§ˆå’Œè¿›è¡Œå°‘é‡ç¼–è¾‘æ”¹åŠ¨ä¸ºåŸºç¡€ï¼Œå› æ­¤å®ƒå…·æœ‰å¤šç§æ“ä½œæ¨¡å¼ï¼š æ­£å¸¸æ¨¡å¼ï¼šåœ¨æ–‡ä»¶ä¸­å››å¤„ç§»åŠ¨å…‰æ ‡è¿›è¡Œä¿®æ”¹ æ’å…¥æ¨¡å¼ï¼šæ’å…¥æ–‡æœ¬ æ›¿æ¢æ¨¡å¼ï¼šæ›¿æ¢æ–‡æœ¬ å¯è§†åŒ–ï¼ˆä¸€èˆ¬ï¼Œè¡Œï¼Œå—ï¼‰æ¨¡å¼ï¼šé€‰ä¸­æ–‡æœ¬å— å‘½ä»¤æ¨¡å¼ï¼šç”¨äºæ‰§è¡Œå‘½ä»¤ åœ¨ä¸åŒçš„æ“ä½œæ¨¡å¼ä¸‹ï¼Œ é”®ç›˜æ•²å‡»çš„å«ä¹‰ä¹Ÿ","title":"ç¼–ç¨‹å·¥å…·ä¹‹Vim"},{"content":"æœ€åä¸€èŠ‚è¯¾ï¼Œæˆ‘ä»¬å›ç­”å­¦ç”Ÿæå‡ºçš„é—®é¢˜:\nå­¦ä¹ æ“ä½œç³»ç»Ÿç›¸å…³å†…å®¹çš„æ¨èï¼Œæ¯”å¦‚è¿›ç¨‹ï¼Œè™šæ‹Ÿå†…å­˜ï¼Œä¸­æ–­ï¼Œå†…å­˜ç®¡ç†ç­‰ ä½ ä¼šä¼˜å…ˆå­¦ä¹ çš„å·¥å…·æœ‰é‚£äº›ï¼Ÿ ä½¿ç”¨ Python VS Bashè„šæœ¬ VS å…¶ä»–è¯­è¨€? source script.sh å’Œ ./script.sh æœ‰ä»€ä¹ˆåŒºåˆ«? å„ç§è½¯ä»¶åŒ…å’Œå·¥å…·å­˜å‚¨åœ¨å“ªé‡Œï¼Ÿå¼•ç”¨è¿‡ç¨‹æ˜¯æ€æ ·çš„? /bin æˆ– /lib æ˜¯ä»€ä¹ˆï¼Ÿ æˆ‘åº”è¯¥ç”¨ apt-get install è¿˜æ˜¯ pip install å»ä¸‹è½½è½¯ä»¶åŒ…å‘¢? ç”¨äºæé«˜ä»£ç æ€§èƒ½ï¼Œç®€å•å¥½ç”¨çš„æ€§èƒ½åˆ†æå·¥å…·æœ‰å“ªäº›? ä½ ä½¿ç”¨é‚£äº›æµè§ˆå™¨æ’ä»¶? æœ‰å“ªäº›æœ‰ç”¨çš„æ•°æ®æ•´ç†å·¥å…·ï¼Ÿ Dockerå’Œè™šæ‹Ÿæœºæœ‰ä»€ä¹ˆåŒºåˆ«? ä¸åŒæ“ä½œç³»ç»Ÿçš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¬å¦‚ä½•é€‰æ‹©ï¼ˆæ¯”å¦‚é€‰æ‹©æœ€é€‚ç”¨äºæˆ‘ä»¬éœ€æ±‚çš„Linuxå‘è¡Œç‰ˆ)? ä½¿ç”¨ Vim ç¼–è¾‘å™¨ VS Emacs ç¼–è¾‘å™¨? æœºå™¨å­¦ä¹ åº”ç”¨çš„æç¤ºæˆ–æŠ€å·§? è¿˜æœ‰æ›´å¤šçš„ Vim å°çªé—¨å—ï¼Ÿ 2FAæ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆæˆ‘éœ€è¦ä½¿ç”¨å®ƒ? å¯¹äºä¸åŒçš„ Web æµè§ˆå™¨æœ‰ä»€ä¹ˆè¯„ä»·? å‚è€ƒ å­¦ä¹ æ“ä½œç³»ç»Ÿç›¸å…³å†…å®¹çš„æ¨èï¼Œæ¯”å¦‚è¿›ç¨‹ï¼Œè™šæ‹Ÿå†…å­˜ï¼Œä¸­æ–­ï¼Œå†…å­˜ç®¡ç†ç­‰ é¦–å…ˆï¼Œä¸æ¸…æ¥šä½ æ˜¯ä¸æ˜¯çœŸçš„éœ€è¦äº†è§£è¿™äº›æ›´åº•å±‚çš„è¯é¢˜ã€‚ å½“ä½ å¼€å§‹ç¼–å†™æ›´åŠ åº•å±‚çš„ä»£ç ï¼Œæ¯”å¦‚å®ç°æˆ–ä¿®æ”¹å†…æ ¸çš„æ—¶å€™ï¼Œè¿™äº›å†…å®¹æ˜¯å¾ˆé‡è¦çš„ã€‚é™¤äº†å…¶ä»–è¯¾ç¨‹ä¸­ç®€è¦ä»‹ç»è¿‡çš„è¿›ç¨‹å’Œä¿¡å·é‡ä¹‹å¤–ï¼Œå¤§éƒ¨åˆ†è¯é¢˜éƒ½ä¸ç›¸å…³ã€‚\nå­¦ä¹ èµ„æºï¼š\nMIT\u0026rsquo;s 6.828 class - ç ”ç©¶ç”Ÿé˜¶æ®µçš„æ“ä½œç³»ç»Ÿè¯¾ç¨‹ï¼ˆè¯¾ç¨‹èµ„æ–™æ˜¯å…¬å¼€çš„ï¼‰ã€‚ ç°ä»£æ“ä½œç³»ç»Ÿ ç¬¬å››ç‰ˆï¼ˆModern Operating Systems 4th edï¼‰ - ä½œè€…æ˜¯Andrew S. Tanenbaum è¿™æœ¬ä¹¦å¯¹ä¸Šè¿°å¾ˆå¤šæ¦‚å¿µéƒ½æœ‰å¾ˆå¥½çš„æè¿°ã€‚ FreeBSDçš„è®¾è®¡ä¸å®ç°ï¼ˆThe Design and Implementation of the FreeBSD Operating Systemï¼‰ - å…³äºFreeBSD OS ä¸é”™çš„èµ„æº(æ³¨æ„ï¼ŒFreeBSD OS ä¸æ˜¯ Linux)ã€‚ å…¶ä»–çš„æŒ‡å—ä¾‹å¦‚ ç”¨ Rust å†™æ“ä½œç³»ç»Ÿ è¿™é‡Œç”¨ä¸åŒçš„è¯­è¨€é€æ­¥å®ç°äº†å†…æ ¸ï¼Œä¸»è¦ç”¨äºæ•™å­¦çš„ç›®çš„ã€‚ ä½ ä¼šä¼˜å…ˆå­¦ä¹ çš„å·¥å…·æœ‰é‚£äº›ï¼Ÿ å€¼å¾—ä¼˜å…ˆå­¦ä¹ çš„å†…å®¹ï¼š\nå¤šå»ä½¿ç”¨é”®ç›˜ï¼Œå°‘ä½¿ç”¨é¼ æ ‡ã€‚è¿™ä¸€ç›®æ ‡å¯ä»¥é€šè¿‡å¤šåŠ åˆ©ç”¨å¿«æ·é”®ï¼Œæ›´æ¢ç•Œé¢ç­‰æ¥å®ç°ã€‚ å­¦å¥½ç¼–è¾‘å™¨ã€‚ä½œä¸ºç¨‹åºå‘˜ä½ å¤§éƒ¨åˆ†æ—¶é—´éƒ½æ˜¯åœ¨ç¼–è¾‘æ–‡ä»¶ï¼Œå› æ­¤å€¼å¾—å­¦å¥½è¿™äº›æŠ€èƒ½ã€‚ å­¦ä¹ æ€æ ·å»è‡ªåŠ¨åŒ–æˆ–ç®€åŒ–å·¥ä½œæµç¨‹ä¸­çš„é‡å¤ä»»åŠ¡ã€‚å› ä¸ºè¿™ä¼šèŠ‚çœå¤§é‡çš„æ—¶é—´ã€‚ å­¦ä¹ åƒ Git ä¹‹ç±»çš„ç‰ˆæœ¬æ§åˆ¶å·¥å…·å¹¶ä¸”çŸ¥é“å¦‚ä½•ä¸ GitHub ç»“åˆï¼Œä»¥ä¾¿åœ¨ç°ä»£çš„è½¯ä»¶é¡¹ç›®ä¸­ååŒå·¥ä½œã€‚ ä½¿ç”¨ Python VS Bashè„šæœ¬ VS å…¶ä»–è¯­è¨€? é€šå¸¸æ¥è¯´ï¼ŒBash è„šæœ¬å¯¹äºç®€çŸ­çš„ä¸€æ¬¡æ€§è„šæœ¬æœ‰æ•ˆï¼Œæ¯”å¦‚å½“ä½ æƒ³è¦è¿è¡Œä¸€ç³»åˆ—çš„å‘½ä»¤çš„æ—¶å€™ã€‚ä½†æ˜¯Bash è„šæœ¬æœ‰ä¸€äº›æ¯”è¾ƒå¥‡æ€ªçš„åœ°æ–¹ï¼Œè¿™ä½¿å¾—å¤§å‹ç¨‹åºæˆ–è„šæœ¬éš¾ä»¥ç”¨ Bash å®ç°ï¼š\nBash å¯ä»¥è·å–ç®€å•çš„ç”¨ä¾‹ï¼Œä½†æ˜¯å¾ˆéš¾è·å¾—å…¨éƒ¨å¯èƒ½çš„è¾“å…¥ã€‚ä¾‹å¦‚ï¼Œè„šæœ¬å‚æ•°ä¸­çš„ç©ºæ ¼ä¼šå¯¼è‡´Bash è„šæœ¬å‡ºé”™ã€‚ Bash å¯¹äºä»£ç é‡ç”¨å¹¶ä¸å‹å¥½ã€‚å› æ­¤ï¼Œé‡ç”¨ä½ å…ˆå‰å·²ç»å†™å¥½çš„ä»£ç å¾ˆå›°éš¾ã€‚é€šå¸¸ Bash ä¸­æ²¡æœ‰è½¯ä»¶åº“çš„æ¦‚å¿µã€‚ Bash ä¾èµ–äºä¸€äº›åƒ $? æˆ– $@ çš„ç‰¹æ®Šå­—ç¬¦æŒ‡ä»£ç‰¹æ®Šçš„å€¼ã€‚å…¶ä»–çš„è¯­è¨€å´ä¼šæ˜¾å¼åœ°å¼•ç”¨ï¼Œæ¯”å¦‚ exitCode æˆ– sys.argsã€‚ å› æ­¤ï¼Œå¯¹äºå¤§å‹æˆ–è€…æ›´åŠ å¤æ‚çš„è„šæœ¬æˆ‘ä»¬æ¨èä½¿ç”¨æ›´åŠ æˆç†Ÿçš„è„šæœ¬è¯­è¨€ä¾‹å¦‚ Python å’Œ Rubyã€‚ ä½ å¯ä»¥æ‰¾åˆ°å¾ˆå¤šç”¨è¿™äº›è¯­è¨€ç¼–å†™çš„ï¼Œç”¨æ¥è§£å†³å¸¸è§é—®é¢˜çš„åœ¨çº¿åº“ã€‚ å¦‚æœä½ å‘ç°æŸç§è¯­è¨€å®ç°äº†ä½ æ‰€éœ€è¦çš„ç‰¹å®šåŠŸèƒ½åº“ï¼Œæœ€å¥½çš„æ–¹å¼å°±æ˜¯ç›´æ¥å»ä½¿ç”¨é‚£ç§è¯­è¨€ã€‚\nsource script.sh å’Œ ./script.sh æœ‰ä»€ä¹ˆåŒºåˆ«? è¿™ä¸¤ç§æƒ…å†µ script.sh éƒ½ä¼šåœ¨bashä¼šè¯ä¸­è¢«è¯»å–å’Œæ‰§è¡Œï¼Œä¸åŒç‚¹åœ¨äºé‚£ä¸ªä¼šè¯æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ã€‚ å¯¹äº source å‘½ä»¤æ¥è¯´ï¼Œå‘½ä»¤æ˜¯åœ¨å½“å‰çš„bashä¼šè¯ç§æ‰§è¡Œçš„ï¼Œå› æ­¤å½“ source æ‰§è¡Œå®Œæ¯•ï¼Œå¯¹å½“å‰ç¯å¢ƒçš„ä»»ä½•æ›´æ”¹ï¼ˆä¾‹å¦‚æ›´æ”¹ç›®å½•æˆ–æ˜¯å®šä¹‰å‡½æ•°ï¼‰éƒ½ä¼šç•™å­˜åœ¨å½“å‰ä¼šè¯ä¸­ã€‚ å•ç‹¬è¿è¡Œ ./script.sh æ—¶ï¼Œå½“å‰çš„bashä¼šè¯å°†å¯åŠ¨æ–°çš„bashä¼šè¯ï¼ˆå®ä¾‹ï¼‰ï¼Œå¹¶åœ¨æ–°å®ä¾‹ä¸­è¿è¡Œå‘½ä»¤ script.shã€‚ å› æ­¤ï¼Œå¦‚æœ script.sh æ›´æ”¹ç›®å½•ï¼Œæ–°çš„bashä¼šè¯ï¼ˆå®ä¾‹ï¼‰ä¼šæ›´æ”¹ç›®å½•ï¼Œä½†æ˜¯ä¸€æ—¦é€€å‡ºå¹¶å°†æ§åˆ¶æƒè¿”å›ç»™çˆ¶bashä¼šè¯ï¼Œçˆ¶ä¼šè¯ä»ç„¶ç•™åœ¨å…ˆå‰çš„ä½ç½®ï¼ˆä¸ä¼šæœ‰ç›®å½•çš„æ›´æ”¹ï¼‰ã€‚ åŒæ ·ï¼Œå¦‚æœ script.sh å®šä¹‰äº†è¦åœ¨ç»ˆç«¯ä¸­è®¿é—®çš„å‡½æ•°ï¼Œéœ€è¦ç”¨ source å‘½ä»¤åœ¨å½“å‰bashä¼šè¯ä¸­å®šä¹‰è¿™ä¸ªå‡½æ•°ã€‚å¦åˆ™ï¼Œå¦‚æœä½ è¿è¡Œ ./script.shï¼Œåªæœ‰æ–°çš„bashä¼šè¯ï¼ˆè¿›ç¨‹ï¼‰æ‰èƒ½æ‰§è¡Œå®šä¹‰çš„å‡½æ•°ï¼Œè€Œå½“å‰çš„shellä¸èƒ½ã€‚\nå„ç§è½¯ä»¶åŒ…å’Œå·¥å…·å­˜å‚¨åœ¨å“ªé‡Œï¼Ÿå¼•ç”¨è¿‡ç¨‹æ˜¯æ€æ ·çš„? /bin æˆ– /lib æ˜¯ä»€ä¹ˆï¼Ÿ æ ¹æ®ä½ åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œçš„ç¨‹åºï¼Œè¿™äº›åŒ…å’Œå·¥å…·ä¼šå…¨éƒ¨åœ¨ PATH ç¯å¢ƒå˜é‡æ‰€åˆ—å‡ºçš„ç›®å½•ä¸­æŸ¥æ‰¾åˆ°ï¼Œ ä½ å¯ä»¥ä½¿ç”¨ which å‘½ä»¤(æˆ–æ˜¯ type å‘½ä»¤)æ¥æ£€æŸ¥ä½ çš„shellåœ¨å“ªé‡Œå‘ç°äº†ç‰¹å®šçš„ç¨‹åºã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œç‰¹å®šç§ç±»çš„æ–‡ä»¶å­˜å‚¨æœ‰ä¸€å®šçš„è§„èŒƒï¼Œæ–‡ä»¶ç³»ç»Ÿï¼Œå±‚æ¬¡ç»“æ„æ ‡å‡†ï¼ˆFilesystem, Hierarchy Standardï¼‰å¯ä»¥æŸ¥åˆ°æˆ‘ä»¬è®¨è®ºå†…å®¹çš„è¯¦ç»†åˆ—è¡¨ã€‚\n/bin - åŸºæœ¬å‘½ä»¤äºŒè¿›åˆ¶æ–‡ä»¶ /sbin - åŸºæœ¬çš„ç³»ç»ŸäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œé€šå¸¸æ˜¯rootè¿è¡Œçš„ /dev - è®¾å¤‡æ–‡ä»¶ï¼Œé€šå¸¸æ˜¯ç¡¬ä»¶è®¾å¤‡æ¥å£æ–‡ä»¶ /etc - ä¸»æœºç‰¹å®šçš„ç³»ç»Ÿé…ç½®æ–‡ä»¶ /home - ç³»ç»Ÿç”¨æˆ·çš„å®¶ç›®å½• /lib - ç³»ç»Ÿè½¯ä»¶é€šç”¨åº“ /opt - å¯é€‰çš„åº”ç”¨è½¯ä»¶ /sys - åŒ…å«ç³»ç»Ÿçš„ä¿¡æ¯å’Œé…ç½®(ç¬¬ä¸€å ‚è¯¾ä»‹ç»çš„) /tmp - ä¸´æ—¶æ–‡ä»¶( /var/tmp ) é€šå¸¸åœ¨é‡å¯ä¹‹é—´åˆ é™¤ /usr/ - åªè¯»çš„ç”¨æˆ·æ•°æ® /usr/bin - éå¿…é¡»çš„å‘½ä»¤äºŒè¿›åˆ¶æ–‡ä»¶ /usr/sbin - éå¿…é¡»çš„ç³»ç»ŸäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œé€šå¸¸æ˜¯ç”±rootè¿è¡Œçš„ /usr/local/bin - ç”¨æˆ·ç¼–è¯‘ç¨‹åºçš„äºŒè¿›åˆ¶æ–‡ä»¶ /var -å˜é‡æ–‡ä»¶ åƒæ—¥å¿—æˆ–ç¼“å­˜ æˆ‘åº”è¯¥ç”¨ apt-get install è¿˜æ˜¯ pip install å»ä¸‹è½½è½¯ä»¶åŒ…å‘¢? è¿™ä¸ªé—®é¢˜æ²¡æœ‰æ™®éçš„ç­”æ¡ˆã€‚è¿™ä¸ä½¿ç”¨ç³»ç»Ÿç¨‹åºåŒ…ç®¡ç†å™¨è¿˜æ˜¯ç‰¹å®šè¯­è¨€çš„ç¨‹åºåŒ…ç®¡ç†å™¨æ¥å®‰è£…è½¯ä»¶è¿™ä¸€æ›´ç¬¼ç»Ÿçš„é—®é¢˜ç›¸å…³ã€‚éœ€è¦è€ƒè™‘çš„å‡ ä»¶äº‹ï¼š\nå¸¸è§çš„è½¯ä»¶åŒ…éƒ½å¯ä»¥é€šè¿‡è¿™ä¸¤ç§æ–¹æ³•è·å¾—ï¼Œä½†æ˜¯å°ä¼—çš„è½¯ä»¶åŒ…æˆ–è¾ƒæ–°çš„è½¯ä»¶åŒ…å¯èƒ½ä¸åœ¨ç³»ç»Ÿç¨‹åºåŒ…ç®¡ç†å™¨ä¸­ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿ç”¨ç‰¹å®šè¯­è¨€çš„ç¨‹åºåŒ…ç®¡ç†å™¨æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚ åŒæ ·ï¼Œç‰¹å®šè¯­è¨€çš„ç¨‹åºåŒ…ç®¡ç†å™¨ç›¸æ¯”ç³»ç»Ÿç¨‹åºåŒ…ç®¡ç†å™¨æœ‰æ›´å¤šçš„æœ€æ–°ç‰ˆæœ¬çš„ç¨‹åºåŒ…ã€‚ å½“ä½¿ç”¨ç³»ç»Ÿè½¯ä»¶åŒ…ç®¡ç†å™¨æ—¶ï¼Œå°†åœ¨ç³»ç»ŸèŒƒå›´å†…å®‰è£…åº“ã€‚å¦‚æœå‡ºäºå¼€å‘ç›®çš„éœ€è¦ä¸åŒç‰ˆæœ¬çš„åº“ï¼Œåˆ™ç³»ç»Ÿè½¯ä»¶åŒ…ç®¡ç†å™¨å¯èƒ½ä¸èƒ½æ»¡è¶³ä½ çš„éœ€è¦ã€‚å¯¹äºè¿™ç§æƒ…å†µï¼Œå¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€éƒ½æä¾›äº†éš”ç¦»æˆ–è™šæ‹Ÿç¯å¢ƒï¼Œå› æ­¤ä½ å¯ä»¥ç”¨ç‰¹å®šè¯­è¨€çš„ç¨‹åºåŒ…ç®¡ç†å™¨å®‰è£…ä¸åŒç‰ˆæœ¬çš„åº“è€Œä¸ä¼šå‘ç”Ÿå†²çªã€‚å¯¹äº Pythonï¼Œå¯ä»¥ä½¿ç”¨ virtualenvï¼Œå¯¹äº Rubyï¼Œä½¿ç”¨ RVM ã€‚ æ ¹æ®æ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶æ¶æ„ï¼Œå…¶ä¸­ä¸€äº›è½¯ä»¶åŒ…å¯èƒ½ä¼šé™„å¸¦äºŒè¿›åˆ¶æ–‡ä»¶æˆ–è€…è½¯ä»¶åŒ…éœ€è¦è¢«ç¼–è¯‘ã€‚ä¾‹å¦‚ï¼Œåœ¨æ ‘è“æ´¾ï¼ˆRaspberry Piï¼‰ä¹‹ç±»çš„ARMæ¶æ„è®¡ç®—æœºä¸­ï¼Œåœ¨è½¯ä»¶é™„å¸¦äºŒè¿›åˆ¶æ–‡ä»¶å’Œè½¯ä»¶åŒ…éœ€è¦è¢«ç¼–è¯‘çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨ç³»ç»ŸåŒ…ç®¡ç†å™¨æ¯”ç‰¹å®šè¯­è¨€åŒ…ç®¡ç†å™¨æ›´å¥½ã€‚è¿™åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºä½ çš„ç‰¹å®šè®¾ç½®ã€‚ ä½ åº”è¯¥ä»…ä½¿ç”¨ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œè€Œä¸åŒæ—¶ä½¿ç”¨ä¸¤ç§æ–¹æ³•ï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šå¯¼è‡´éš¾ä»¥è§£å†³çš„å†²çªã€‚æˆ‘ä»¬çš„å»ºè®®æ˜¯å°½å¯èƒ½ä½¿ç”¨ç‰¹å®šè¯­è¨€çš„ç¨‹åºåŒ…ç®¡ç†å™¨ï¼Œå¹¶ä½¿ç”¨éš”ç¦»çš„ç¯å¢ƒï¼ˆä¾‹å¦‚ Python çš„ virtualenvï¼‰ä»¥é¿å…å½±å“å…¨å±€ç¯å¢ƒã€‚ ç”¨äºæé«˜ä»£ç æ€§èƒ½ï¼Œç®€å•å¥½ç”¨çš„æ€§èƒ½åˆ†æå·¥å…·æœ‰å“ªäº›? æ€§èƒ½åˆ†ææ–¹é¢ç›¸å½“æœ‰ç”¨å’Œç®€å•å·¥å…·æ˜¯print timingã€‚ä½ åªéœ€æ‰‹åŠ¨è®¡ç®—ä»£ç ä¸åŒéƒ¨åˆ†ä¹‹é—´èŠ±è´¹çš„æ—¶é—´ã€‚é€šè¿‡é‡å¤æ‰§è¡Œæ­¤æ“ä½œï¼Œä½ å¯ä»¥æœ‰æ•ˆåœ°å¯¹ä»£ç è¿›è¡ŒäºŒåˆ†æ³•æœç´¢ï¼Œå¹¶æ‰¾åˆ°èŠ±è´¹æ—¶é—´æœ€é•¿çš„ä»£ç æ®µã€‚\nå¯¹äºæ›´é«˜çº§çš„å·¥å…·ï¼Œ Valgrind çš„ Callgrindå¯è®©ä½ è¿è¡Œç¨‹åºå¹¶è®¡ç®—æ‰€æœ‰çš„æ—¶é—´èŠ±è´¹ä»¥åŠæ‰€æœ‰è°ƒç”¨å †æ ˆï¼ˆå³å“ªä¸ªå‡½æ•°è°ƒç”¨äº†å¦ä¸€ä¸ªå‡½æ•°ï¼‰ã€‚ç„¶åï¼Œå®ƒä¼šç”Ÿæˆå¸¦æ³¨é‡Šçš„ä»£ç ç‰ˆæœ¬ï¼Œå…¶ä¸­åŒ…å«æ¯è¡ŒèŠ±è´¹çš„æ—¶é—´ã€‚ä½†æ˜¯ï¼Œå®ƒä¼šä½¿ç¨‹åºè¿è¡Œé€Ÿåº¦é™ä½ä¸€ä¸ªæ•°é‡çº§ï¼Œå¹¶ä¸”ä¸æ”¯æŒçº¿ç¨‹ã€‚å…¶ä»–çš„ï¼Œ perf å·¥å…·å’Œå…¶ä»–ç‰¹å®šè¯­è¨€çš„é‡‡æ ·æ€§èƒ½åˆ†æå™¨å¯ä»¥éå¸¸å¿«é€Ÿåœ°è¾“å‡ºæœ‰ç”¨çš„æ•°æ®ã€‚Flamegraphs æ˜¯å¯¹é‡‡æ ·åˆ†æå™¨ç»“æœçš„å¯è§†åŒ–å·¥å…·ã€‚ä½ è¿˜å¯ä»¥ä½¿ç”¨é’ˆå¯¹ç‰¹å®šç¼–ç¨‹è¯­è¨€æˆ–ä»»åŠ¡çš„å·¥å…·ã€‚ä¾‹å¦‚ï¼Œå¯¹äº Web å¼€å‘è€Œè¨€ï¼ŒChrome å’Œ Firefox å†…ç½®çš„å¼€å‘å·¥å…·å…·æœ‰å‡ºè‰²çš„æ€§èƒ½åˆ†æå™¨ã€‚\næœ‰æ—¶ï¼Œä»£ç ä¸­æœ€æ…¢çš„éƒ¨åˆ†æ˜¯ç³»ç»Ÿç­‰å¾…ç£ç›˜è¯»å–æˆ–ç½‘ç»œæ•°æ®åŒ…ä¹‹ç±»çš„äº‹ä»¶ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œéœ€è¦æ£€æŸ¥æ ¹æ®ç¡¬ä»¶æ€§èƒ½ä¼°ç®—çš„ç†è®ºé€Ÿåº¦æ˜¯å¦ä¸åç¦»å®é™…æ•°å€¼ï¼Œä¹Ÿæœ‰ä¸“é—¨çš„å·¥å…·æ¥åˆ†æç³»ç»Ÿè°ƒç”¨ä¸­çš„ç­‰å¾…æ—¶é—´ï¼ŒåŒ…æ‹¬ç”¨äºç”¨æˆ·ç¨‹åºå†…æ ¸è·Ÿè¸ªçš„eBPF ã€‚å¦‚æœéœ€è¦ä½çº§çš„æ€§èƒ½åˆ†æï¼Œ bpftrace å€¼å¾—ä¸€è¯•ã€‚\nä½ ä½¿ç”¨é‚£äº›æµè§ˆå™¨æ’ä»¶? æˆ‘ä»¬é’Ÿçˆ±çš„æ’ä»¶ä¸»è¦ä¸å®‰å…¨æ€§ä¸å¯ç”¨æ€§æœ‰å…³ï¼š\nuBlock Origin - æ˜¯ä¸€ä¸ªç”¨é€”å¹¿æ³›ï¼ˆwide-spectrumï¼‰çš„æ‹¦æˆªå™¨ï¼Œå®ƒä¸ä»…å¯ä»¥æ‹¦æˆªå¹¿å‘Šï¼Œè¿˜å¯ä»¥æ‹¦æˆªç¬¬ä¸‰æ–¹çš„é¡µé¢ï¼Œä¹Ÿå¯ä»¥æ‹¦æˆªå†…éƒ¨è„šæœ¬å’Œå…¶ä»–ç§ç±»èµ„æºçš„åŠ è½½ã€‚å¦‚æœä½ æ‰“ç®—èŠ±æ›´å¤šçš„æ—¶é—´å»é…ç½®ï¼Œå‰å¾€ä¸­ç­‰æ¨¡å¼ï¼ˆmedium modeï¼‰æˆ–è€… å¼ºåŠ›æ¨¡å¼ï¼ˆhard modeï¼‰ã€‚åœ¨ä½ è°ƒæ•´å¥½è®¾ç½®ä¹‹å‰ä¸€äº›ç½‘ç«™ä¼šåœæ­¢å·¥ä½œï¼Œä½†æ˜¯è¿™äº›é…ç½®ä¼šæ˜¾è‘—æé«˜ä½ çš„ç½‘ç»œå®‰å…¨æ°´å¹³ã€‚å¦å¤–ï¼Œ ç®€æ˜“æ¨¡å¼ï¼ˆeasy modeï¼‰ä½œä¸ºé»˜è®¤æ¨¡å¼å·²ç»ç›¸å½“ä¸é”™äº†ï¼Œå¯ä»¥æ‹¦æˆªå¤§éƒ¨åˆ†çš„å¹¿å‘Šå’Œè·Ÿè¸ªï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰è§„åˆ™æ¥æ‹¦æˆªç½‘ç«™å¯¹è±¡ã€‚ Stylus - æ˜¯Stylishçš„åˆ†æ”¯ï¼ˆä¸è¦ä½¿ç”¨Stylishï¼Œå®ƒä¼šçªƒå–æµè§ˆè®°å½•)ï¼‰ï¼Œè¿™ä¸ªæ’ä»¶å¯è®©ä½ å°†è‡ªå®šä¹‰CSSæ ·å¼åŠ è½½åˆ°ç½‘ç«™ã€‚ä½¿ç”¨Stylusï¼Œä½ å¯ä»¥è½»æ¾åœ°è‡ªå®šä¹‰å’Œä¿®æ”¹ç½‘ç«™çš„å¤–è§‚ã€‚å¯ä»¥åˆ é™¤ä¾§è¾¹æ¡†ï¼Œæ›´æ”¹èƒŒæ™¯é¢œè‰²ï¼Œæ›´æ”¹æ–‡å­—å¤§å°æˆ–å­—ä½“æ ·å¼ã€‚è¿™å¯ä»¥ä½¿ä½ ç»å¸¸è®¿é—®çš„ç½‘ç«™æ›´å…·å¯è¯»æ€§ã€‚æ­¤å¤–ï¼ŒStyluså¯ä»¥æ‰¾åˆ°å…¶ä»–ç”¨æˆ·ç¼–å†™å¹¶å‘å¸ƒåœ¨userstyles.orgä¸­çš„æ ·å¼ã€‚å¤§å¤šæ•°å¸¸ç”¨çš„ç½‘ç«™éƒ½æœ‰ä¸€ä¸ªæˆ–å‡ ä¸ªæ·±è‰²ä¸»é¢˜æ ·å¼ã€‚ å…¨é¡µå±å¹•æ•è· - å†…ç½®äº Firefox å’Œ Chrome æ‰©å±•ç¨‹åºä¸­ã€‚è¿™äº›æ’ä»¶æä¾›å®Œæ•´çš„ç½‘ç«™æˆªå›¾ï¼Œé€šå¸¸æ¯”æ‰“å°è¦å¥½ç”¨ã€‚ å¤šè´¦æˆ·å®¹å™¨ - è¯¥æ’ä»¶ä½¿ä½ å¯ä»¥å°†Cookieåˆ†ä¸ºâ€œå®¹å™¨â€ï¼Œä»è€Œå…è®¸ä½ ä»¥ä¸åŒçš„èº«ä»½æµè§ˆwebç½‘é¡µå¹¶ä¸”/æˆ–ç¡®ä¿ç½‘ç«™æ— æ³•åœ¨å®ƒä»¬ä¹‹é—´å…±äº«ä¿¡æ¯ã€‚ å¯†ç é›†æˆç®¡ç†å™¨ - å¤§å¤šæ•°å¯†ç ç®¡ç†å™¨éƒ½æœ‰æµè§ˆå™¨æ’ä»¶ï¼Œè¿™äº›æ’ä»¶å¸®ä½ å°†ç™»å½•å‡­æ®è¾“å…¥ç½‘ç«™çš„è¿‡ç¨‹ä¸ä»…æ–¹ä¾¿ï¼Œè€Œä¸”æ›´åŠ å®‰å…¨ã€‚ä¸ç®€å•å¤åˆ¶ç²˜è´´ç”¨æˆ·åå’Œå¯†ç ç›¸æ¯”ï¼Œè¿™äº›æ’ä»¶å°†é¦–å…ˆæ£€æŸ¥ç½‘ç«™åŸŸæ˜¯å¦ä¸åˆ—å‡ºçš„æ¡ç›®ç›¸åŒ¹é…ï¼Œä»¥é˜²æ­¢å†’å……ç½‘ç«™çš„ç½‘ç»œé’“é±¼çªƒå–ç™»å½•å‡­æ®ã€‚ æœ‰å“ªäº›æœ‰ç”¨çš„æ•°æ®æ•´ç†å·¥å…·ï¼Ÿ åœ¨æ•°æ®æ•´ç†é‚£ä¸€èŠ‚è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰æ—¶é—´è®¨è®ºä¸€äº›æ•°æ®æ•´ç†å·¥å…·ï¼ŒåŒ…æ‹¬åˆ†åˆ«ç”¨äºJSONå’ŒHTMLæ•°æ®çš„ä¸“ç”¨è§£æå™¨ï¼Œ jq å’Œ pupã€‚Perlè¯­è¨€æ˜¯å¦ä¸€ä¸ªæ›´é«˜çº§çš„å¯ä»¥ç”¨äºæ•°æ®æ•´ç†ç®¡é“çš„å·¥å…·ã€‚å¦ä¸€ä¸ªæŠ€å·§æ˜¯ä½¿ç”¨ column -t å‘½ä»¤ï¼Œå¯ä»¥å°†ç©ºæ ¼æ–‡æœ¬ï¼ˆä¸ä¸€å®šå¯¹é½ï¼‰è½¬æ¢ä¸ºå¯¹é½çš„æ–‡æœ¬ã€‚\nä¸€èˆ¬æ¥è¯´ï¼Œvimå’ŒPythonæ˜¯ä¸¤ä¸ªä¸å¸¸è§„çš„æ•°æ®æ•´ç†å·¥å…·ã€‚å¯¹äºæŸäº›å¤æ‚çš„å¤šè¡Œè½¬æ¢ï¼Œvimå®æ˜¯éå¸¸æœ‰ç”¨çš„å·¥å…·ã€‚ä½ å¯ä»¥è®°å½•ä¸€ç³»åˆ—æ“ä½œï¼Œå¹¶æ ¹æ®éœ€è¦é‡å¤æ‰§è¡Œå¤šæ¬¡ï¼Œä¾‹å¦‚ï¼Œåœ¨ç¼–è¾‘çš„è®²ä¹‰(å»å¹´ è§†é¢‘)ä¸­ï¼Œæœ‰ä¸€ä¸ªç¤ºä¾‹æ˜¯ä½¿ç”¨vimå®å°†XMLæ ¼å¼çš„æ–‡ä»¶è½¬æ¢ä¸ºJSONã€‚\nå¯¹äºé€šå¸¸ä»¥CSVæ ¼å¼æ˜¾ç¤ºçš„è¡¨æ ¼æ•°æ®ï¼Œ Python pandasåº“æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„å·¥å…·ã€‚ä¸ä»…å› ä¸ºå®ƒèƒ½è®©å¤æ‚æ“ä½œçš„å®šä¹‰ï¼ˆå¦‚åˆ†ç»„ä¾æ®ï¼Œè”æ¥æˆ–è¿‡æ»¤å™¨ï¼‰å˜å¾—éå¸¸å®¹æ˜“ï¼Œè€Œä¸”è¿˜ä¾¿äºæ ¹æ®ä¸åŒå±æ€§ç»˜åˆ¶æ•°æ®ã€‚å®ƒè¿˜æ”¯æŒå¯¼å‡ºå¤šç§è¡¨æ ¼æ ¼å¼ï¼ŒåŒ…æ‹¬ XLSï¼ŒHTML æˆ– LaTeXã€‚å¦å¤–ï¼ŒRè¯­è¨€(ä¸€ç§æœ‰äº‰è®®çš„ä¸å¥½çš„è¯­è¨€ï¼‰å…·æœ‰å¾ˆå¤šåŠŸèƒ½ï¼Œå¯ä»¥è®¡ç®—æ•°æ®çš„ç»Ÿè®¡æ•°å­—ï¼Œè¿™åœ¨ç®¡é“çš„æœ€åä¸€æ­¥ä¸­éå¸¸æœ‰ç”¨ã€‚ ggplot2æ˜¯Rä¸­å¾ˆæ£’çš„ç»˜å›¾åº“ã€‚\nDockerå’Œè™šæ‹Ÿæœºæœ‰ä»€ä¹ˆåŒºåˆ«? Docker åŸºäºå®¹å™¨è¿™ä¸ªæ›´ä¸ºæ¦‚æ‹¬çš„æ¦‚å¿µã€‚å…³äºå®¹å™¨å’Œè™šæ‹Ÿæœºä¹‹é—´æœ€å¤§çš„ä¸åŒæ˜¯ï¼Œè™šæ‹Ÿæœºä¼šæ‰§è¡Œæ•´ä¸ªçš„ OS æ ˆï¼ŒåŒ…æ‹¬å†…æ ¸ï¼ˆå³ä½¿è¿™ä¸ªå†…æ ¸å’Œä¸»æœºå†…æ ¸ç›¸åŒï¼‰ã€‚ä¸è™šæ‹Ÿæœºä¸åŒï¼Œå®¹å™¨é¿å…è¿è¡Œå…¶ä»–å†…æ ¸å®ä¾‹ï¼Œè€Œæ˜¯ä¸ä¸»æœºåˆ†äº«å†…æ ¸ã€‚åœ¨Linuxç¯å¢ƒä¸­ï¼Œæœ‰LXCæœºåˆ¶æ¥å®ç°ï¼Œå¹¶ä¸”è¿™èƒ½ä½¿ä¸€ç³»åˆ—åˆ†ç¦»çš„ä¸»æœºåƒæ˜¯åœ¨ä½¿ç”¨è‡ªå·±çš„ç¡¬ä»¶å¯åŠ¨ç¨‹åºï¼Œè€Œå®é™…ä¸Šæ˜¯å…±äº«ä¸»æœºçš„ç¡¬ä»¶å’Œå†…æ ¸ã€‚å› æ­¤å®¹å™¨çš„å¼€é”€å°äºå®Œæ•´çš„è™šæ‹Ÿæœºã€‚\nå¦ä¸€æ–¹é¢ï¼Œå®¹å™¨çš„éš”ç¦»æ€§è¾ƒå¼±è€Œä¸”åªæœ‰åœ¨ä¸»æœºè¿è¡Œç›¸åŒçš„å†…æ ¸æ—¶æ‰èƒ½æ­£å¸¸å·¥ä½œã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ åœ¨macOS ä¸Šè¿è¡Œ Dockerï¼ŒDocker éœ€è¦å¯åŠ¨ Linuxè™šæ‹Ÿæœºå»è·å–åˆå§‹çš„ Linuxå†…æ ¸ï¼Œè¿™æ ·çš„å¼€é”€ä»ç„¶å¾ˆå¤§ã€‚æœ€åï¼ŒDocker æ˜¯å®¹å™¨çš„ç‰¹å®šå®ç°ï¼Œå®ƒæ˜¯ä¸ºè½¯ä»¶éƒ¨ç½²è€Œå®šåˆ¶çš„ã€‚åŸºäºè¿™äº›ï¼Œå®ƒæœ‰ä¸€äº›å¥‡æ€ªä¹‹å¤„ï¼šä¾‹å¦‚ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒDocker å®¹å™¨åœ¨é‡å¯ä¹‹é—´ä¸ä¼šæœ‰ä»¥ä»»ä½•å½¢å¼çš„å­˜å‚¨ã€‚\nä¸åŒæ“ä½œç³»ç»Ÿçš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¬å¦‚ä½•é€‰æ‹©ï¼ˆæ¯”å¦‚é€‰æ‹©æœ€é€‚ç”¨äºæˆ‘ä»¬éœ€æ±‚çš„Linuxå‘è¡Œç‰ˆ)? å…³äºLinuxå‘è¡Œç‰ˆï¼Œå°½ç®¡æœ‰ç›¸å½“å¤šçš„ç‰ˆæœ¬ï¼Œä½†å¤§éƒ¨åˆ†å‘è¡Œç‰ˆåœ¨å¤§å¤šæ•°ä½¿ç”¨æƒ…å†µä¸‹çš„è¡¨ç°æ˜¯ç›¸åŒçš„ã€‚ å¯ä»¥ä½¿ç”¨ä»»ä½•å‘è¡Œç‰ˆå»å­¦ä¹  Linux ä¸ UNIX çš„ç‰¹æ€§å’Œå…¶å†…éƒ¨å·¥ä½œåŸç†ã€‚ å‘è¡Œç‰ˆä¹‹é—´çš„æ ¹æœ¬åŒºåˆ«æ˜¯å‘è¡Œç‰ˆå¦‚ä½•å¤„ç†è½¯ä»¶åŒ…æ›´æ–°ã€‚ æŸäº›ç‰ˆæœ¬ï¼Œä¾‹å¦‚ Arch Linux é‡‡ç”¨æ»šåŠ¨æ›´æ–°ç­–ç•¥ï¼Œç”¨äº†æœ€å‰æ²¿çš„è½¯ä»¶åŒ…ï¼ˆbleeding-edgeï¼‰ï¼Œä½†è½¯ä»¶å¯èƒ½å¹¶ä¸ç¨³å®šã€‚å¦å¤–ä¸€äº›å‘è¡Œç‰ˆï¼ˆå¦‚Debianï¼ŒCentOS æˆ– Ubuntu LTSï¼‰å…¶æ›´æ–°ç­–ç•¥è¦ä¿å®ˆå¾—å¤šï¼Œå› æ­¤æ›´æ–°çš„å†…å®¹ä¼šæ›´ç¨³å®šï¼Œä½†ä¼šç‰ºç‰²ä¸€äº›æ–°åŠŸèƒ½ã€‚æˆ‘ä»¬å»ºè®®ä½ ä½¿ç”¨ Debian æˆ– Ubuntu æ¥è·å¾—ç®€å•ç¨³å®šçš„å°å¼æœºå’ŒæœåŠ¡å™¨ä½“éªŒã€‚\nMac OS æ˜¯ä»‹äº Windows å’Œ Linux ä¹‹é—´çš„ä¸€ä¸ªæ“ä½œç³»ç»Ÿï¼Œå®ƒæœ‰å¾ˆæ¼‚äº®çš„ç•Œé¢ã€‚ä½†æ˜¯ï¼ŒMac OS æ˜¯åŸºäºBSD è€Œä¸æ˜¯ Linuxï¼Œå› æ­¤ç³»ç»Ÿçš„æŸäº›éƒ¨åˆ†å’Œå‘½ä»¤æ˜¯ä¸åŒçš„ã€‚ å¦ä¸€ç§å€¼å¾—ä½“éªŒçš„æ˜¯ FreeBSDã€‚è™½ç„¶æŸäº›ç¨‹åºä¸èƒ½åœ¨ FreeBSD ä¸Šè¿è¡Œï¼Œä½†ä¸ Linux ç›¸æ¯”ï¼ŒBSD ç”Ÿæ€ç³»ç»Ÿçš„ç¢ç‰‡åŒ–ç¨‹åº¦è¦ä½å¾—å¤šï¼Œå¹¶ä¸”è¯´æ˜æ–‡æ¡£æ›´åŠ å‹å¥½ã€‚ é™¤äº†å¼€å‘Windowsåº”ç”¨ç¨‹åºæˆ–éœ€è¦ä½¿ç”¨æŸäº›Windowsç³»ç»Ÿæ›´å¥½æ”¯æŒçš„åŠŸèƒ½ï¼ˆä¾‹å¦‚å¯¹æ¸¸æˆçš„é©±åŠ¨ç¨‹åºæ”¯æŒï¼‰å¤–ï¼Œæˆ‘ä»¬ä¸å»ºè®®ä½¿ç”¨ Windowsã€‚\nå¯¹äºåŒç³»ç»Ÿï¼Œæˆ‘ä»¬è®¤ä¸ºæœ€æœ‰æ•ˆçš„æ˜¯ macOS çš„ bootcampï¼Œé•¿æœŸæ¥çœ‹ï¼Œä»»ä½•å…¶ä»–ç»„åˆéƒ½å¯èƒ½ä¼šå‡ºç°é—®é¢˜ï¼Œå°¤å…¶æ˜¯å½“ä½ ç»“åˆäº†å…¶ä»–åŠŸèƒ½æ¯”å¦‚ç£ç›˜åŠ å¯†ã€‚\nä½¿ç”¨ Vim ç¼–è¾‘å™¨ VS Emacs ç¼–è¾‘å™¨? æˆ‘ä»¬ä¸‰ä¸ªéƒ½ä½¿ç”¨ vim ä½œä¸ºæˆ‘ä»¬çš„ä¸»è¦ç¼–è¾‘å™¨ã€‚ä½†æ˜¯ Emacs ä¹Ÿæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œä½ å¯ä»¥ä¸¤è€…éƒ½å°è¯•ï¼Œçœ‹çœ‹é‚£ä¸ªæ›´é€‚åˆä½ ã€‚Emacs ä¸ä½¿ç”¨ vim çš„æ¨¡å¼ç¼–è¾‘ï¼Œä½†æ˜¯è¿™äº›åŠŸèƒ½å¯ä»¥é€šè¿‡ Emacs æ’ä»¶åƒEvil æˆ– Doom Emacsæ¥å®ç°ã€‚ Emacsçš„ä¼˜ç‚¹æ˜¯å¯ä»¥ç”¨Lispè¯­è¨€è¿›è¡Œæ‰©å±•ï¼ˆLispæ¯”vimé»˜è®¤çš„è„šæœ¬è¯­è¨€vimscriptè¦æ›´å¥½ç”¨ï¼‰ã€‚\næœºå™¨å­¦ä¹ åº”ç”¨çš„æç¤ºæˆ–æŠ€å·§? è¯¾ç¨‹çš„ä¸€äº›ç»éªŒå¯ä»¥ç›´æ¥ç”¨äºæœºå™¨å­¦ä¹ ç¨‹åºã€‚ å°±åƒè®¸å¤šç§‘å­¦å­¦ç§‘ä¸€æ ·ï¼Œåœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œä½ éœ€è¦è¿›è¡Œä¸€ç³»åˆ—å®éªŒï¼Œå¹¶æ£€æŸ¥å“ªäº›æ•°æ®æœ‰æ•ˆï¼Œå“ªäº›æ— æ•ˆã€‚ ä½ å¯ä»¥ä½¿ç”¨ Shell è½»æ¾å¿«é€Ÿåœ°æœç´¢è¿™äº›å®éªŒç»“æœï¼Œå¹¶ä¸”ä»¥åˆç†çš„æ–¹å¼æ±‡æ€»ã€‚è¿™æ„å‘³ç€éœ€è¦åœ¨é™å®šæ—¶é—´å†…æˆ–ä½¿ç”¨ç‰¹å®šæ•°æ®é›†çš„æƒ…å†µä¸‹ï¼Œæ£€æŸ¥æ‰€æœ‰å®éªŒç»“æœã€‚é€šè¿‡ä½¿ç”¨JSONæ–‡ä»¶è®°å½•å®éªŒçš„æ‰€æœ‰ç›¸å…³å‚æ•°ï¼Œä½¿ç”¨æˆ‘ä»¬åœ¨æœ¬è¯¾ç¨‹ä¸­ä»‹ç»çš„å·¥å…·ï¼Œè¿™ä»¶äº‹æƒ…å¯ä»¥å˜å¾—æå…¶ç®€å•ã€‚ æœ€åï¼Œå¦‚æœä½ ä¸ä½¿ç”¨é›†ç¾¤æäº¤ä½ çš„ GPU ä½œä¸šï¼Œé‚£ä½ åº”è¯¥ç ”ç©¶å¦‚ä½•ä½¿è¯¥è¿‡ç¨‹è‡ªåŠ¨åŒ–ï¼Œå› ä¸ºè¿™æ˜¯ä¸€é¡¹éå¸¸è€—æ—¶çš„ä»»åŠ¡ï¼Œä¼šæ¶ˆè€—ä½ çš„ç²¾åŠ›ã€‚\nè¿˜æœ‰æ›´å¤šçš„ Vim å°çªé—¨å—ï¼Ÿ æ›´å¤šçš„çªé—¨ï¼š\næ’ä»¶ - èŠ±æ—¶é—´å»æ¢ç´¢æ’ä»¶ã€‚æœ‰å¾ˆå¤šä¸é”™çš„æ’ä»¶ä¿®å¤äº†vimçš„ç¼ºé™·æˆ–è€…å¢åŠ äº†èƒ½å¤Ÿä¸ç°æœ‰vimå·¥ä½œæµç»“åˆçš„æ–°åŠŸèƒ½ã€‚å…³äºè¿™éƒ¨åˆ†å†…å®¹ï¼Œèµ„æºæ˜¯VimAwesome å’Œå…¶ä»–ç¨‹åºå‘˜çš„dotfilesã€‚ æ ‡è®° - åœ¨vimé‡Œä½ å¯ä»¥ä½¿ç”¨ m\u0026lt;X\u0026gt; ä¸ºå­—æ¯ X åšæ ‡è®°ï¼Œä¹‹åä½ å¯ä»¥é€šè¿‡ '\u0026lt;X\u0026gt; å›åˆ°æ ‡è®°ä½ç½®ã€‚è¿™å¯ä»¥è®©ä½ å¿«é€Ÿå®šä½åˆ°æ–‡ä»¶å†…æˆ–æ–‡ä»¶é—´çš„ç‰¹å®šä½ç½®ã€‚ å¯¼èˆª - Ctrl+O å’Œ Ctrl+I å‘½ä»¤å¯ä»¥ä½¿ä½ åœ¨æœ€è¿‘è®¿é—®ä½ç½®å‰åç§»åŠ¨ã€‚ æ’¤é”€æ ‘ - vim æœ‰ä¸é”™çš„æ›´æ”¹è·Ÿè¸ªæœºåˆ¶ï¼Œä¸åŒäºå…¶ä»–çš„ç¼–è¾‘å™¨ï¼Œvimå­˜å‚¨å˜æ›´æ ‘ï¼Œå› æ­¤å³ä½¿ä½ æ’¤é”€ååšäº†ä¸€äº›ä¿®æ”¹ï¼Œä½ ä»ç„¶å¯ä»¥é€šè¿‡æ’¤é”€æ ‘çš„å¯¼èˆªå›åˆ°åˆå§‹çŠ¶æ€ã€‚ä¸€äº›æ’ä»¶æ¯”å¦‚ gundo.vim å’Œ undotree é€šè¿‡å›¾å½¢åŒ–æ¥å±•ç¤ºæ’¤é”€æ ‘ã€‚ æ—¶é—´æ’¤é”€ - :earlier å’Œ :later å‘½ä»¤ä½¿å¾—ä½ å¯ä»¥ç”¨æ—¶é—´è€ŒéæŸä¸€æ—¶åˆ»çš„æ›´æ”¹æ¥å®šä½æ–‡ä»¶ã€‚ æŒç»­æ’¤é”€ - æ˜¯ä¸€ä¸ªé»˜è®¤æœªè¢«å¼€å¯çš„vimçš„å†…ç½®åŠŸèƒ½ï¼Œå®ƒåœ¨vimå¯åŠ¨ä¹‹é—´ä¿å­˜æ’¤é”€å†å²ï¼Œéœ€è¦é…ç½®åœ¨ .vimrc ç›®å½•ä¸‹çš„undofile å’Œ undodirï¼Œvimä¼šä¿å­˜æ¯ä¸ªæ–‡ä»¶çš„ä¿®æ”¹å†å²ã€‚ çƒ­é”®ï¼ˆLeader Keyï¼‰ - çƒ­é”®æ˜¯ä¸€ä¸ªç”¨äºç”¨æˆ·è‡ªå®šä¹‰é…ç½®å‘½ä»¤çš„ç‰¹æ®ŠæŒ‰é”®ã€‚è¿™ç§æ¨¡å¼é€šå¸¸æ˜¯æŒ‰ä¸‹åé‡Šæ”¾è¿™ä¸ªæŒ‰é”®ï¼ˆé€šå¸¸æ˜¯ç©ºæ ¼é”®ï¼‰å¹¶ä¸å…¶ä»–çš„æŒ‰é”®ç»„åˆå»å®ç°ä¸€ä¸ªç‰¹æ®Šçš„å‘½ä»¤ã€‚æ’ä»¶ä¹Ÿä¼šç”¨è¿™äº›æŒ‰é”®å¢åŠ å®ƒä»¬çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼Œæ’ä»¶UndoTreeä½¿ç”¨ \u0026lt;Leader\u0026gt; U å»æ‰“å¼€æ’¤é”€æ ‘ã€‚ é«˜çº§æ–‡æœ¬å¯¹è±¡ - æ–‡æœ¬å¯¹è±¡æ¯”å¦‚æœç´¢ä¹Ÿå¯ä»¥ç”¨vimå‘½ä»¤æ„æˆã€‚ä¾‹å¦‚ï¼Œd/\u0026lt;pattern\u0026gt; ä¼šåˆ é™¤ä¸‹ä¸€å¤„åŒ¹é… pattern çš„å­—ç¬¦ä¸²ï¼Œcgn å¯ä»¥ç”¨äºæ›´æ”¹ä¸Šæ¬¡æœç´¢çš„å…³é”®å­—ã€‚ 2FAæ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆæˆ‘éœ€è¦ä½¿ç”¨å®ƒ? åŒå› å­éªŒè¯ï¼ˆTwo Factor Authentication 2FAï¼‰åœ¨å¯†ç ä¹‹ä¸Šä¸ºå¸æˆ·å¢åŠ äº†ä¸€å±‚é¢å¤–çš„ä¿æŠ¤ã€‚ä¸ºäº†ç™»å½•ï¼Œä½ ä¸ä»…éœ€è¦çŸ¥é“å¯†ç ï¼Œè¿˜å¿…é¡»ä»¥æŸç§æ–¹å¼â€œè¯æ˜â€å¯ä»¥è®¿é—®æŸäº›ç¡¬ä»¶è®¾å¤‡ã€‚æœ€ç®€å•çš„æƒ…å½¢æ˜¯å¯ä»¥é€šè¿‡æ¥æ”¶æ‰‹æœºçš„ SMS æ¥å®ç°ï¼ˆå°½ç®¡ SMS 2FA å­˜åœ¨ å·²çŸ¥é—®é¢˜ï¼‰ã€‚æˆ‘ä»¬æ¨èä½¿ç”¨YubiKeyä¹‹ç±»çš„U2Fæ–¹æ¡ˆã€‚\nå¯¹äºä¸åŒçš„ Web æµè§ˆå™¨æœ‰ä»€ä¹ˆè¯„ä»·? 2020çš„æµè§ˆå™¨ç°çŠ¶æ˜¯ï¼Œå¤§éƒ¨åˆ†çš„æµè§ˆå™¨éƒ½ä¸ Chrome ç±»ä¼¼ï¼Œå› ä¸ºå®ƒä»¬éƒ½ä½¿ç”¨åŒæ ·çš„å¼•æ“(Blink)ã€‚ Microsoft Edge åŒæ ·åŸºäº Blinkï¼Œè‡³äº Safari åŸºäº WebKit(ä¸Blinkç±»ä¼¼çš„å¼•æ“)ï¼Œè¿™äº›æµè§ˆå™¨ä»…ä»…æ˜¯æ›´ç³Ÿç³•çš„ Chorme ç‰ˆæœ¬ã€‚ä¸ç®¡æ˜¯åœ¨æ€§èƒ½è¿˜æ˜¯å¯ç”¨æ€§ä¸Šï¼ŒChorme éƒ½æ˜¯ä¸€æ¬¾å¾ˆä¸é”™çš„æµè§ˆå™¨ã€‚å¦‚æœä½ æƒ³è¦æ›¿ä»£å“ï¼Œæˆ‘ä»¬æ¨è Firefoxã€‚Firefox ä¸ Chorme çš„åœ¨å„æ–¹é¢ä¸ç›¸ä¸Šä¸‹ï¼Œå¹¶ä¸”åœ¨éšç§æ–¹é¢æ›´åŠ å‡ºè‰²ã€‚ æœ‰ä¸€æ¬¾ç›®å‰è¿˜æ²¡æœ‰å®Œæˆçš„å« Flow çš„æµè§ˆå™¨ï¼Œå®ƒå®ç°äº†å…¨æ–°çš„æ¸²æŸ“å¼•æ“ï¼Œæœ‰æœ›æ¯”ç°æœ‰å¼•æ“é€Ÿåº¦æ›´å¿«ã€‚\nå‚è€ƒ è¯¾ç¨‹åˆ—è¡¨\n","permalink":"https://blog.niuhemoon.win/posts/tech/coding-tools-qa/","summary":"æœ€åä¸€èŠ‚è¯¾ï¼Œæˆ‘ä»¬å›ç­”å­¦ç”Ÿæå‡ºçš„é—®é¢˜: å­¦ä¹ æ“ä½œç³»ç»Ÿç›¸å…³å†…å®¹çš„æ¨èï¼Œæ¯”å¦‚è¿›ç¨‹ï¼Œè™šæ‹Ÿå†…å­˜ï¼Œä¸­æ–­ï¼Œå†…å­˜ç®¡ç†ç­‰ ä½ ä¼šä¼˜å…ˆå­¦ä¹ çš„å·¥å…·æœ‰é‚£äº›ï¼Ÿ ä½¿ç”¨ Python VS Bashè„šæœ¬ VS å…¶ä»–è¯­è¨€? source script.sh å’Œ ./script.sh æœ‰ä»€ä¹ˆåŒºåˆ«? å„ç§è½¯ä»¶åŒ…å’Œå·¥å…·å­˜å‚¨åœ¨å“ªé‡Œï¼Ÿå¼•ç”¨è¿‡ç¨‹æ˜¯æ€æ ·çš„? /bin æˆ– /lib æ˜¯ä»€ä¹ˆï¼Ÿ æˆ‘åº”è¯¥ç”¨ apt-get install è¿˜æ˜¯ pip install å»ä¸‹è½½è½¯ä»¶åŒ…å‘¢? ç”¨äºæ","title":"ç¼–ç¨‹å·¥å…·ä¹‹é—®ç­”"},{"content":"å®‰å…¨å’Œå¯†ç  ç†µ(Entropy) åº¦é‡äº†ä¸ç¡®å®šæ€§å¹¶å¯ä»¥ç”¨æ¥å†³å®šå¯†ç çš„å¼ºåº¦ã€‚\nç†µçš„å•ä½æ˜¯ æ¯”ç‰¹ã€‚å¯¹äºä¸€ä¸ªå‡åŒ€åˆ†å¸ƒçš„éšæœºç¦»æ•£å˜é‡ï¼Œç†µç­‰äºlog_2(æ‰€æœ‰å¯èƒ½çš„ä¸ªæ•°ï¼Œå³n)ã€‚ æ‰”ä¸€æ¬¡ç¡¬å¸çš„ç†µæ˜¯1æ¯”ç‰¹ã€‚æ·ä¸€æ¬¡ï¼ˆå…­é¢ï¼‰éª°å­çš„ç†µå¤§çº¦ä¸º2.58æ¯”ç‰¹ã€‚\nå¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯†\nå½“ä½ è¿è¡Œssh-keygenå‘½ä»¤ï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªéå¯¹ç§°å¯†é’¥å¯¹ï¼šå…¬é’¥å’Œç§é’¥(public_key, private_key)ã€‚ ç”Ÿæˆè¿‡ç¨‹ä¸­ä½¿ç”¨çš„éšæœºæ•°ç”±ç³»ç»Ÿæä¾›çš„ç†µå†³å®šã€‚è¿™äº›ç†µå¯ä»¥æ¥æºäºç¡¬ä»¶äº‹ä»¶(hardware events)ç­‰ã€‚ å…¬é’¥æœ€ç»ˆä¼šè¢«åˆ†å‘ï¼Œå®ƒå¯ä»¥ç›´æ¥æ˜æ–‡å­˜å‚¨ã€‚ ä½†æ˜¯ä¸ºäº†é˜²æ­¢æ³„éœ²ï¼Œç§é’¥å¿…é¡»åŠ å¯†å­˜å‚¨ã€‚ssh-keygenå‘½ä»¤ä¼šæç¤ºç”¨æˆ·è¾“å…¥ä¸€ä¸ªå¯†ç ï¼Œå¹¶å°†å®ƒè¾“å…¥å¯†é’¥ç”Ÿæˆå‡½æ•° äº§ç”Ÿä¸€ä¸ªå¯†é’¥ã€‚æœ€ç»ˆï¼Œssh-keygenä½¿ç”¨å¯¹ç§°åŠ å¯†ç®—æ³•å’Œè¿™ä¸ªå¯†é’¥åŠ å¯†ç§é’¥ã€‚\nåœ¨å®é™…è¿ç”¨ä¸­ï¼Œå½“æœåŠ¡å™¨å·²çŸ¥ç”¨æˆ·çš„å…¬é’¥ï¼ˆå­˜å‚¨åœ¨.ssh/authorized_keysæ–‡ä»¶ä¸­ï¼Œä¸€èˆ¬åœ¨ç”¨æˆ·HOMEç›®å½•ä¸‹ï¼‰ï¼Œå°è¯•è¿æ¥çš„å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨éå¯¹ç§°ç­¾åæ¥è¯æ˜ç”¨æˆ·çš„èº«ä»½â€”â€”è¿™ä¾¿æ˜¯æŒ‘æˆ˜åº”ç­”æ–¹å¼ã€‚ ç®€å•æ¥è¯´ï¼ŒæœåŠ¡å™¨é€‰æ‹©ä¸€ä¸ªéšæœºæ•°å­—å‘é€ç»™å®¢æˆ·ç«¯ã€‚å®¢æˆ·ç«¯ä½¿ç”¨ç”¨æˆ·ç§é’¥å¯¹è¿™ä¸ªæ•°å­—ä¿¡æ¯ç­¾ååè¿”å›æœåŠ¡å™¨ã€‚ æœåŠ¡å™¨éšåä½¿ç”¨.ssh/authorized_keysæ–‡ä»¶ä¸­å­˜å‚¨çš„ç”¨æˆ·å…¬é’¥æ¥éªŒè¯è¿”å›çš„ä¿¡æ¯æ˜¯å¦ç”±æ‰€å¯¹åº”çš„ç§é’¥æ‰€ç­¾åã€‚è¿™ç§éªŒè¯æ–¹å¼å¯ä»¥æœ‰æ•ˆè¯æ˜è¯•å›¾ç™»å½•çš„ç”¨æˆ·æŒæœ‰æ‰€éœ€çš„ç§é’¥ã€‚\nå¤§æ‚çƒ© ä¿®æ”¹é”®ä½æ˜ å°„ ä½œä¸ºä¸€åç¨‹åºå‘˜ï¼Œé”®ç›˜æ˜¯ä½ çš„ä¸»è¦è¾“å…¥å·¥å…·ã€‚å®ƒåƒè®¡ç®—æœºé‡Œçš„å…¶ä»–éƒ¨ä»¶ä¸€æ ·æ˜¯å¯é…ç½®çš„ï¼Œè€Œä¸”å€¼å¾—ä½ åœ¨è¿™ä¸Šé¢èŠ±æ—¶é—´ã€‚\nä¸€ä¸ªå¾ˆå¸¸è§çš„é…ç½®æ˜¯ä¿®æ”¹é”®ä½æ˜ å°„ã€‚é€šå¸¸è¿™ä¸ªåŠŸèƒ½ç”±åœ¨è®¡ç®—æœºä¸Šè¿è¡Œçš„è½¯ä»¶å®ç°ã€‚å½“æŸä¸€ä¸ªæŒ‰é”®è¢«æŒ‰ä¸‹ï¼Œè½¯ä»¶æˆªè·é”®ç›˜å‘å‡ºçš„æŒ‰é”®äº‹ä»¶ï¼ˆkeypress eventï¼‰å¹¶ä½¿ç”¨å¦å¤–ä¸€ä¸ªäº‹ä»¶å–ä»£ã€‚æ¯”å¦‚ï¼š\nå°† Caps Lock æ˜ å°„ä¸º Ctrl æˆ–è€… Escapeï¼šCaps Lock ä½¿ç”¨äº†é”®ç›˜ä¸Šä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„ä½ç½®è€Œå®ƒçš„åŠŸèƒ½å´å¾ˆå°‘è¢«ç”¨åˆ°ï¼Œæ‰€ä»¥æˆ‘ä»¬ï¼ˆè®²å¸ˆï¼‰éå¸¸æ¨èè¿™ä¸ªä¿®æ”¹ï¼› å°† PrtSc æ˜ å°„ä¸ºæ’­æ”¾/æš‚åœï¼šå¤§éƒ¨åˆ†æ“ä½œç³»ç»Ÿæ”¯æŒæ’­æ”¾/æš‚åœé”®ï¼› äº¤æ¢ Ctrl å’Œ Meta é”®ï¼ˆWindows çš„å¾½æ ‡é”®æˆ–è€… Mac çš„ Command é”®ï¼‰ã€‚ ä½ ä¹Ÿå¯ä»¥å°†é”®ä½æ˜ å°„ä¸ºä»»æ„å¸¸ç”¨çš„æŒ‡ä»¤ã€‚è½¯ä»¶ç›‘å¬åˆ°ç‰¹å®šçš„æŒ‰é”®ç»„åˆåä¼šè¿è¡Œè®¾å®šçš„è„šæœ¬ã€‚\næ‰“å¼€ä¸€ä¸ªæ–°çš„ç»ˆç«¯æˆ–è€…æµè§ˆå™¨çª—å£ï¼› è¾“å‡ºç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ï¼šä¸€ä¸ªè¶…é•¿é‚®ä»¶åœ°å€æˆ–è€… MIT IDï¼› ä½¿è®¡ç®—æœºæˆ–è€…æ˜¾ç¤ºå™¨è¿›å…¥ç¡çœ æ¨¡å¼ã€‚ ç”šè‡³æ›´å¤æ‚çš„ä¿®æ”¹ä¹Ÿå¯ä»¥é€šè¿‡è½¯ä»¶å®ç°ï¼š\næ˜ å°„æŒ‰é”®é¡ºåºï¼Œæ¯”å¦‚ï¼šæŒ‰ Shift é”®äº”ä¸‹åˆ‡æ¢å¤§å°å†™é”å®šï¼› åŒºåˆ«æ˜ å°„å•ç‚¹å’Œé•¿æŒ‰ï¼Œæ¯”å¦‚ï¼šå•ç‚¹ Caps Lock æ˜ å°„ä¸º Escapeï¼Œè€Œé•¿æŒ‰ Caps Lock æ˜ å°„ä¸º Ctrlï¼› å¯¹ä¸åŒçš„é”®ç›˜æˆ–è½¯ä»¶ä¿å­˜ä¸“ç”¨çš„æ˜ å°„é…ç½®ã€‚ ä¸‹é¢æ˜¯ä¸€äº›ä¿®æ”¹é”®ä½æ˜ å°„çš„è½¯ä»¶ï¼š\nmacOS - karabiner-elements, skhd æˆ–è€… BetterTouchTool Linux - xmodmap æˆ–è€… Autokey Windows - æ§åˆ¶é¢æ¿ï¼ŒAutoHotkey æˆ–è€… SharpKeys QMK - å¦‚æœä½ çš„é”®ç›˜æ”¯æŒå®šåˆ¶å›ºä»¶ï¼ŒQMK å¯ä»¥ç›´æ¥åœ¨é”®ç›˜çš„ç¡¬ä»¶ä¸Šä¿®æ”¹é”®ä½æ˜ å°„ã€‚ä¿ç•™åœ¨é”®ç›˜é‡Œçš„æ˜ å°„å…é™¤äº†åœ¨åˆ«çš„æœºå™¨ä¸Šçš„é‡å¤é…ç½®ã€‚ å®ˆæŠ¤è¿›ç¨‹ å³ä¾¿å®ˆæŠ¤è¿›ç¨‹ï¼ˆdaemonï¼‰è¿™ä¸ªè¯çœ‹ä¸Šå»æœ‰äº›é™Œç”Ÿï¼Œä½ åº”è¯¥å·²ç»å¤§çº¦æ˜ç™½å®ƒçš„æ¦‚å¿µã€‚å¤§éƒ¨åˆ†è®¡ç®—æœºéƒ½æœ‰ä¸€ç³»åˆ—åœ¨åå°ä¿æŒè¿è¡Œï¼Œä¸éœ€è¦ç”¨æˆ·æ‰‹åŠ¨è¿è¡Œæˆ–è€…äº¤äº’çš„è¿›ç¨‹ã€‚è¿™äº›è¿›ç¨‹å°±æ˜¯å®ˆæŠ¤è¿›ç¨‹ã€‚ä»¥å®ˆæŠ¤è¿›ç¨‹è¿è¡Œçš„ç¨‹åºåä¸€èˆ¬ä»¥ d ç»“å°¾ï¼Œæ¯”å¦‚ SSH æœåŠ¡ç«¯ sshdï¼Œç”¨æ¥ç›‘å¬ä¼ å…¥çš„ SSH è¿æ¥è¯·æ±‚å¹¶å¯¹ç”¨æˆ·è¿›è¡Œé‰´æƒã€‚\nLinux ä¸­çš„ systemdï¼ˆthe system daemonï¼‰æ˜¯æœ€å¸¸ç”¨çš„é…ç½®å’Œè¿è¡Œå®ˆæŠ¤è¿›ç¨‹çš„æ–¹æ³•ã€‚è¿è¡Œ systemctl status å‘½ä»¤å¯ä»¥çœ‹åˆ°æ­£åœ¨è¿è¡Œçš„æ‰€æœ‰å®ˆæŠ¤è¿›ç¨‹ã€‚è¿™é‡Œé¢æœ‰å¾ˆå¤šå¯èƒ½ä½ æ²¡æœ‰è§è¿‡ï¼Œä½†æ˜¯æŒç®¡äº†ç³»ç»Ÿçš„æ ¸å¿ƒéƒ¨åˆ†çš„è¿›ç¨‹ï¼šç®¡ç†ç½‘ç»œã€DNSè§£æã€æ˜¾ç¤ºç³»ç»Ÿçš„å›¾å½¢ç•Œé¢ç­‰ç­‰ã€‚ç”¨æˆ·ä½¿ç”¨ systemctl å‘½ä»¤å’Œ systemd äº¤äº’æ¥enableï¼ˆå¯ç”¨ï¼‰ã€disableï¼ˆç¦ç”¨ï¼‰ã€startï¼ˆå¯åŠ¨ï¼‰ã€stopï¼ˆåœæ­¢ï¼‰ã€restartï¼ˆé‡å¯ï¼‰ã€æˆ–è€…statusï¼ˆæ£€æŸ¥ï¼‰é…ç½®å¥½çš„å®ˆæŠ¤è¿›ç¨‹åŠç³»ç»ŸæœåŠ¡ã€‚\nsystemd æä¾›äº†ä¸€ä¸ªå¾ˆæ–¹ä¾¿çš„ç•Œé¢ç”¨äºé…ç½®å’Œå¯ç”¨æ–°çš„å®ˆæŠ¤è¿›ç¨‹æˆ–ç³»ç»ŸæœåŠ¡ã€‚ä¸‹é¢çš„é…ç½®æ–‡ä»¶ä½¿ç”¨äº†å®ˆæŠ¤è¿›ç¨‹æ¥è¿è¡Œä¸€ä¸ªç®€å•çš„ Python ç¨‹åºã€‚æ–‡ä»¶çš„å†…å®¹éå¸¸ç›´æ¥æ‰€ä»¥æˆ‘ä»¬ä¸å¯¹å®ƒè¯¦ç»†é˜è¿°ã€‚systemd é…ç½®æ–‡ä»¶çš„è¯¦ç»†æŒ‡å—å¯å‚è§ freedesktop.orgã€‚\n## /etc/systemd/system/myapp.service [Unit] ## é…ç½®æ–‡ä»¶æè¿° Description=My Custom App ## åœ¨ç½‘ç»œæœåŠ¡å¯åŠ¨åå¯åŠ¨è¯¥è¿›ç¨‹ After=network.target [Service] ## è¿è¡Œè¯¥è¿›ç¨‹çš„ç”¨æˆ· User=foo ## è¿è¡Œè¯¥è¿›ç¨‹çš„ç”¨æˆ·ç»„ Group=foo ## è¿è¡Œè¯¥è¿›ç¨‹çš„æ ¹ç›®å½• WorkingDirectory=/home/foo/projects/mydaemon ## å¼€å§‹è¯¥è¿›ç¨‹çš„å‘½ä»¤ ExecStart=/usr/bin/local/python3.7 app.py ## åœ¨å‡ºç°é”™è¯¯æ—¶é‡å¯è¯¥è¿›ç¨‹ Restart=on-failure [Install] ## ç›¸å½“äºWindowsçš„å¼€æœºå¯åŠ¨ã€‚å³ä½¿GUIæ²¡æœ‰å¯åŠ¨ï¼Œè¯¥è¿›ç¨‹ä¹Ÿä¼šåŠ è½½å¹¶è¿è¡Œ WantedBy=multi-user.target ## å¦‚æœè¯¥è¿›ç¨‹ä»…éœ€è¦åœ¨GUIæ´»åŠ¨æ—¶è¿è¡Œï¼Œè¿™é‡Œåº”å†™ä½œï¼š # WantedBy=graphical.target # graphical.targetåœ¨multi-user.targetçš„åŸºç¡€ä¸Šè¿è¡Œå’ŒGUIç›¸å…³çš„æœåŠ¡ å¦‚æœä½ åªæ˜¯æƒ³å®šæœŸè¿è¡Œä¸€äº›ç¨‹åºï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ cronã€‚å®ƒæ˜¯ä¸€ä¸ªç³»ç»Ÿå†…ç½®çš„ï¼Œç”¨æ¥æ‰§è¡Œå®šæœŸä»»åŠ¡çš„å®ˆæŠ¤è¿›ç¨‹ã€‚\nFUSE ç°åœ¨çš„è½¯ä»¶ç³»ç»Ÿä¸€èˆ¬ç”±å¾ˆå¤šæ¨¡å—åŒ–çš„ç»„ä»¶æ„å»ºè€Œæˆã€‚ä½ ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿå¯ä»¥é€šè¿‡ä¸€ç³»åˆ—å…±åŒçš„æ–¹å¼ä½¿ç”¨ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ç›¸ä¼¼åŠŸèƒ½ã€‚æ¯”å¦‚å½“ä½ ä½¿ç”¨ touch å‘½ä»¤åˆ›å»ºæ–‡ä»¶çš„æ—¶å€™ï¼Œtouch ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨ï¼ˆsystem callï¼‰å‘å†…æ ¸å‘å‡ºè¯·æ±‚ã€‚å†…æ ¸å†æ ¹æ®æ–‡ä»¶ç³»ç»Ÿï¼Œè°ƒç”¨ç‰¹æœ‰çš„æ–¹æ³•æ¥åˆ›å»ºæ–‡ä»¶ã€‚è¿™é‡Œçš„é—®é¢˜æ˜¯ï¼ŒUNIX æ–‡ä»¶ç³»ç»Ÿåœ¨ä¼ ç»Ÿä¸Šæ˜¯ä»¥å†…æ ¸æ¨¡å—çš„å½¢å¼å®ç°ï¼Œå¯¼è‡´åªæœ‰å†…æ ¸å¯ä»¥è¿›è¡Œæ–‡ä»¶ç³»ç»Ÿç›¸å…³çš„è°ƒç”¨ã€‚\nFUSEï¼ˆç”¨æˆ·ç©ºé—´æ–‡ä»¶ç³»ç»Ÿï¼‰å…è®¸è¿è¡Œåœ¨ç”¨æˆ·ç©ºé—´ä¸Šçš„ç¨‹åºå®ç°æ–‡ä»¶ç³»ç»Ÿè°ƒç”¨ï¼Œå¹¶å°†è¿™äº›è°ƒç”¨ä¸å†…æ ¸æ¥å£è”ç³»èµ·æ¥ã€‚åœ¨å®è·µä¸­ï¼Œè¿™æ„å‘³ç€ç”¨æˆ·å¯ä»¥åœ¨æ–‡ä»¶ç³»ç»Ÿè°ƒç”¨ä¸­å®ç°ä»»æ„åŠŸèƒ½ã€‚\nFUSE å¯ä»¥ç”¨äºå®ç°å¦‚ï¼šä¸€ä¸ªå°†æ‰€æœ‰æ–‡ä»¶ç³»ç»Ÿæ“ä½œéƒ½ä½¿ç”¨ SSH è½¬å‘åˆ°è¿œç¨‹ä¸»æœºï¼Œç”±è¿œç¨‹ä¸»æœºå¤„ç†åè¿”å›ç»“æœåˆ°æœ¬åœ°è®¡ç®—æœºçš„è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿã€‚è¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿé‡Œçš„æ–‡ä»¶è™½ç„¶å­˜å‚¨åœ¨è¿œç¨‹ä¸»æœºï¼Œå¯¹äºæœ¬åœ°è®¡ç®—æœºä¸Šçš„è½¯ä»¶è€Œè¨€å’Œå­˜å‚¨åœ¨æœ¬åœ°åˆ«æ— äºŒè‡´ã€‚sshfså°±æ˜¯ä¸€ä¸ªå®ç°äº†è¿™ç§åŠŸèƒ½çš„ FUSE æ–‡ä»¶ç³»ç»Ÿã€‚\nä¸€äº›æœ‰è¶£çš„ FUSE æ–‡ä»¶ç³»ç»ŸåŒ…æ‹¬ï¼š\nsshfsï¼šä½¿ç”¨ SSH è¿æ¥åœ¨æœ¬åœ°æ‰“å¼€è¿œç¨‹ä¸»æœºä¸Šçš„æ–‡ä»¶ rcloneï¼šå°† Dropboxã€Google Driveã€Amazon S3ã€æˆ–è€… Google Cloud Storage ä¸€ç±»çš„äº‘å­˜å‚¨æœåŠ¡æŒ‚è½½ä¸ºæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ gocryptfsï¼šè¦†ç›–åœ¨åŠ å¯†æ–‡ä»¶ä¸Šçš„æ–‡ä»¶ç³»ç»Ÿã€‚æ–‡ä»¶ä»¥åŠ å¯†å½¢å¼ä¿å­˜åœ¨ç£ç›˜é‡Œï¼Œä½†è¯¥æ–‡ä»¶ç³»ç»ŸæŒ‚è½½åç”¨æˆ·å¯ä»¥ç›´æ¥ä»æŒ‚è½½ç‚¹è®¿é—®æ–‡ä»¶çš„æ˜æ–‡ kbfsï¼šåˆ†å¸ƒå¼ç«¯åˆ°ç«¯åŠ å¯†æ–‡ä»¶ç³»ç»Ÿã€‚åœ¨è¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿé‡Œæœ‰ç§å¯†ï¼ˆprivateï¼‰ï¼Œå…±äº«ï¼ˆsharedï¼‰ï¼Œä»¥åŠå…¬å¼€ï¼ˆpublicï¼‰ä¸‰ç§ç±»å‹çš„æ–‡ä»¶å¤¹ borgbackupï¼šæ–¹ä¾¿ç”¨æˆ·æµè§ˆåˆ é™¤é‡å¤æ•°æ®åçš„å‹ç¼©åŠ å¯†å¤‡ä»½ å¤‡ä»½ ä»»ä½•æ²¡æœ‰å¤‡ä»½çš„æ•°æ®éƒ½å¯èƒ½åœ¨ä¸€ä¸ªç¬é—´æ°¸è¿œæ¶ˆå¤±ã€‚å¤åˆ¶æ•°æ®å¾ˆç®€å•ï¼Œä½†æ˜¯å¯é åœ°å¤‡ä»½æ•°æ®å¾ˆéš¾ã€‚ä¸‹é¢åˆ—ä¸¾äº†ä¸€äº›å…³äºå¤‡ä»½çš„åŸºç¡€çŸ¥è¯†ï¼Œä»¥åŠä¸€äº›å¸¸è§åšæ³•å®¹æ˜“æ‰è¿›çš„é™·é˜±ã€‚\né¦–å…ˆï¼Œå¤åˆ¶å­˜å‚¨åœ¨åŒä¸€ä¸ªç£ç›˜ä¸Šçš„æ•°æ®ä¸æ˜¯å¤‡ä»½ï¼Œå› ä¸ºè¿™ä¸ªç£ç›˜æ˜¯ä¸€ä¸ªå•ç‚¹æ•…éšœï¼ˆsingle point of failureï¼‰ã€‚è¿™ä¸ªç£ç›˜ä¸€æ—¦å‡ºç°é—®é¢˜ï¼Œæ‰€æœ‰çš„æ•°æ®éƒ½å¯èƒ½ä¸¢å¤±ã€‚æ”¾åœ¨å®¶é‡Œçš„å¤–ç½®ç£ç›˜å› ä¸ºç«ç¾ã€æŠ¢åŠ«ç­‰åŸå› å¯èƒ½ä¼šå’Œæºæ•°æ®ä¸€èµ·ä¸¢å¤±ï¼Œæ‰€ä»¥æ˜¯ä¸€ä¸ªå¼±å¤‡ä»½ã€‚æ¨èçš„åšæ³•æ˜¯å°†æ•°æ®å¤‡ä»½åˆ°ä¸åŒçš„åœ°ç‚¹å­˜å‚¨ã€‚\nåŒæ­¥æ–¹æ¡ˆä¹Ÿä¸æ˜¯å¤‡ä»½ã€‚å³ä½¿æ–¹ä¾¿å¦‚ Dropbox æˆ–è€… Google Driveï¼Œå½“æ•°æ®åœ¨æœ¬åœ°è¢«æŠ¹é™¤æˆ–è€…æŸåï¼ŒåŒæ­¥æ–¹æ¡ˆå¯èƒ½ä¼šæŠŠè¿™äº›â€œæ›´æ”¹â€åŒæ­¥åˆ°äº‘ç«¯ã€‚åŒç†ï¼Œåƒ RAID è¿™æ ·çš„ç£ç›˜é•œåƒæ–¹æ¡ˆä¹Ÿä¸æ˜¯å¤‡ä»½ã€‚å®ƒä¸èƒ½é˜²æ­¢æ–‡ä»¶è¢«æ„å¤–åˆ é™¤ã€æŸåã€æˆ–è€…è¢«å‹’ç´¢è½¯ä»¶åŠ å¯†ã€‚\næœ‰æ•ˆå¤‡ä»½æ–¹æ¡ˆçš„å‡ ä¸ªæ ¸å¿ƒç‰¹æ€§æ˜¯ï¼šç‰ˆæœ¬æ§åˆ¶ï¼Œåˆ é™¤é‡å¤æ•°æ®ï¼Œä»¥åŠå®‰å…¨æ€§ã€‚å¯¹å¤‡ä»½çš„æ•°æ®å®æ–½ç‰ˆæœ¬æ§åˆ¶ä¿è¯äº†ç”¨æˆ·å¯ä»¥ä»ä»»ä½•è®°å½•è¿‡çš„å†å²ç‰ˆæœ¬ä¸­æ¢å¤æ•°æ®ã€‚åœ¨å¤‡ä»½ä¸­æ£€æµ‹å¹¶åˆ é™¤é‡å¤æ•°æ®ï¼Œä½¿å…¶ä»…å¤‡ä»½å¢é‡å˜åŒ–å¯ä»¥å‡å°‘å­˜å‚¨å¼€é”€ã€‚åœ¨å®‰å…¨æ€§æ–¹é¢ï¼Œä½œä¸ºç”¨æˆ·ï¼Œä½ åº”è¯¥è€ƒè™‘åˆ«äººéœ€è¦æœ‰ä»€ä¹ˆä¿¡æ¯æˆ–è€…å·¥å…·æ‰å¯ä»¥è®¿é—®æˆ–è€…å®Œå…¨åˆ é™¤ä½ çš„æ•°æ®åŠå¤‡ä»½ã€‚æœ€åä¸€ç‚¹ï¼Œä¸è¦ç›²ç›®ä¿¡ä»»å¤‡ä»½æ–¹æ¡ˆã€‚ç”¨æˆ·åº”è¯¥ç»å¸¸æ£€æŸ¥å¤‡ä»½æ˜¯å¦å¯ä»¥ç”¨æ¥æ¢å¤æ•°æ®ã€‚\nå¤‡ä»½ä¸é™åˆ¶äºå¤‡ä»½åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šçš„æ–‡ä»¶ã€‚äº‘ç«¯åº”ç”¨çš„é‡å¤§å‘å±•ä½¿å¾—æˆ‘ä»¬å¾ˆå¤šçš„æ•°æ®åªå­˜å‚¨åœ¨äº‘ç«¯ã€‚å½“æˆ‘ä»¬æ— æ³•ç™»å½•è¿™äº›åº”ç”¨ï¼Œåœ¨äº‘ç«¯å­˜å‚¨çš„ç½‘ç»œé‚®ä»¶ï¼Œç¤¾äº¤ç½‘ç»œä¸Šçš„ç…§ç‰‡ï¼Œæµåª’ä½“éŸ³ä¹æ’­æ”¾åˆ—è¡¨ï¼Œä»¥åŠåœ¨çº¿æ–‡æ¡£ç­‰ç­‰éƒ½ä¼šéšä¹‹ä¸¢å¤±ã€‚ç”¨æˆ·åº”è¯¥æœ‰è¿™äº›æ•°æ®çš„ç¦»çº¿å¤‡ä»½ï¼Œè€Œä¸”å·²ç»æœ‰é¡¹ç›®å¯ä»¥å¸®åŠ©ä¸‹è½½å¹¶å­˜å‚¨å®ƒä»¬ã€‚\nå¦‚æœæƒ³è¦äº†è§£æ›´å¤šå…·ä½“å†…å®¹ï¼Œè¯·å‚è€ƒæœ¬è¯¾ç¨‹2019å¹´å…³äºå¤‡ä»½çš„è¯¾å ‚ç¬”è®°ã€‚\nAPIï¼ˆåº”ç”¨ç¨‹åºæ¥å£ï¼‰ å…³äºå¦‚ä½•ä½¿ç”¨è®¡ç®—æœºæœ‰æ•ˆç‡åœ°å®Œæˆ æœ¬åœ° ä»»åŠ¡ï¼Œæˆ‘ä»¬è¿™å ‚è¯¾å·²ç»ä»‹ç»äº†å¾ˆå¤šæ–¹æ³•ã€‚è¿™äº›æ–¹æ³•åœ¨äº’è”ç½‘ä¸Šå…¶å®ä¹Ÿé€‚ç”¨ã€‚å¤§å¤šæ•°çº¿ä¸ŠæœåŠ¡æä¾›çš„ APIï¼ˆåº”ç”¨ç¨‹åºæ¥å£ï¼‰è®©ä½ å¯ä»¥é€šè¿‡ç¼–ç¨‹æ–¹å¼æ¥è®¿é—®è¿™äº›æœåŠ¡çš„æ•°æ®ã€‚æ¯”å¦‚ï¼Œç¾å›½å›½å®¶æ°”è±¡å±€å°±æä¾›äº†ä¸€ä¸ªå¯ä»¥ä» shell ä¸­è·å–å¤©æ°”é¢„æŠ¥çš„ APIã€‚\nè¿™äº› API å¤§å¤šå…·æœ‰ç±»ä¼¼çš„æ ¼å¼ã€‚å®ƒä»¬çš„ç»“æ„åŒ– URL é€šå¸¸ä½¿ç”¨ api.service.com ä½œä¸ºæ ¹è·¯å¾„ï¼Œç”¨æˆ·å¯ä»¥è®¿é—®ä¸åŒçš„å­è·¯å¾„æ¥è®¿é—®éœ€è¦è°ƒç”¨çš„æ“ä½œï¼Œä»¥åŠæ·»åŠ æŸ¥è¯¢å‚æ•°ä½¿ API è¿”å›ç¬¦åˆæŸ¥è¯¢å‚æ•°æ¡ä»¶çš„ç»“æœã€‚\nä»¥ç¾å›½å¤©æ°”æ•°æ®ä¸ºä¾‹ï¼Œä¸ºäº†è·å¾—æŸä¸ªåœ°ç‚¹çš„å¤©æ°”æ•°æ®ï¼Œä½ å¯ä»¥å‘é€ä¸€ä¸ª GET è¯·æ±‚ï¼ˆæ¯”å¦‚ä½¿ç”¨curlï¼‰åˆ°https://api.weather.gov/points/42.3604,-71.094ã€‚è¿”å›ä¸­ä¼šåŒ…æ‹¬ä¸€ç³»åˆ—ç”¨äºè·å–ç‰¹å®šä¿¡æ¯ï¼ˆæ¯”å¦‚å°æ—¶é¢„æŠ¥ã€æ°”è±¡è§‚å¯Ÿç«™ä¿¡æ¯ç­‰ï¼‰çš„ URLã€‚é€šå¸¸è¿™äº›è¿”å›éƒ½æ˜¯JSONæ ¼å¼ï¼Œä½ å¯ä»¥ä½¿ç”¨jqç­‰å·¥å…·æ¥é€‰å–éœ€è¦çš„éƒ¨åˆ†ã€‚\næœ‰äº›éœ€è¦è®¤è¯çš„ API é€šå¸¸è¦æ±‚ç”¨æˆ·åœ¨è¯·æ±‚ä¸­åŠ å…¥æŸç§ç§å¯†ä»¤ç‰Œï¼ˆsecret tokenï¼‰æ¥å®Œæˆè®¤è¯ã€‚è¯·é˜…è¯»ä½ æƒ³è®¿é—®çš„ API æ‰€æä¾›çš„æ–‡æ¡£æ¥ç¡®å®šå®ƒè¯·æ±‚çš„è®¤è¯æ–¹å¼ï¼Œä½†æ˜¯å…¶å®å¤§å¤šæ•° API éƒ½ä¼šä½¿ç”¨ OAuthã€‚OAuth é€šè¿‡å‘ç”¨æˆ·æä¾›ä¸€ç³»åˆ—ä»…å¯ç”¨äºè¯¥ API ç‰¹å®šåŠŸèƒ½çš„ç§å¯†ä»¤ç‰Œè¿›è¡Œæ ¡éªŒã€‚å› ä¸ºä½¿ç”¨äº†æœ‰æ•ˆ OAuth ä»¤ç‰Œçš„è¯·æ±‚åœ¨ API çœ‹æ¥å°±æ˜¯ç”¨æˆ·æœ¬äººå‘å‡ºçš„è¯·æ±‚ï¼Œæ‰€ä»¥è¯·ä¸€å®šä¿ç®¡å¥½è¿™äº›ç§å¯†ä»¤ç‰Œã€‚å¦åˆ™å…¶ä»–äººå°±å¯ä»¥å†’ç”¨ä½ çš„èº«ä»½è¿›è¡Œä»»ä½•ä½ å¯ä»¥åœ¨è¿™ä¸ª API ä¸Šè¿›è¡Œçš„æ“ä½œã€‚\nIFTTT è¿™ä¸ªç½‘ç«™å¯ä»¥å°†å¾ˆå¤š API æ•´åˆåœ¨ä¸€èµ·ï¼Œè®©æŸ API å‘ç”Ÿçš„ç‰¹å®šäº‹ä»¶è§¦å‘åœ¨å…¶ä»– API ä¸Šæ‰§è¡Œçš„ä»»åŠ¡ã€‚IFTTT çš„å…¨ç§°If This Then That è¶³ä»¥è¯´æ˜å®ƒçš„ç”¨æ³•ï¼Œæ¯”å¦‚åœ¨æ£€æµ‹åˆ°ç”¨æˆ·çš„æ–°æ¨æ–‡åï¼Œè‡ªåŠ¨å‘å¸ƒåœ¨å…¶ä»–å¹³å°ã€‚ä½†æ˜¯ä½ å¯ä»¥å¯¹å®ƒæ”¯æŒçš„ API è¿›è¡Œä»»æ„æ•´åˆï¼Œæ‰€ä»¥è¯•ç€æ¥è®¾ç½®ä¸€ä¸‹ä»»ä½•ä½ éœ€è¦çš„åŠŸèƒ½å§ï¼\nå¸¸è§å‘½ä»¤è¡Œæ ‡å¿—å‚æ•°åŠæ¨¡å¼ å‘½ä»¤è¡Œå·¥å…·çš„ç”¨æ³•åƒå·®ä¸‡åˆ«ï¼Œé˜…è¯» man é¡µé¢å¯ä»¥å¸®åŠ©ä½ ç†è§£æ¯ç§å·¥å…·çš„ç”¨æ³•ã€‚å³ä¾¿å¦‚æ­¤ï¼Œä¸‹é¢æˆ‘ä»¬å°†ä»‹ç»ä¸€ä¸‹å‘½ä»¤è¡Œå·¥å…·ä¸€äº›å¸¸è§çš„å…±åŒåŠŸèƒ½ã€‚\nå¤§éƒ¨åˆ†å·¥å…·æ”¯æŒ --help æˆ–è€…ç±»ä¼¼çš„æ ‡å¿—å‚æ•°ï¼ˆflagï¼‰æ¥æ˜¾ç¤ºå®ƒä»¬çš„ç®€ç•¥ç”¨æ³•ã€‚\nä¼šé€ æˆä¸å¯æ’¤å›æ“ä½œçš„å·¥å…·ä¸€èˆ¬ä¼šæä¾›â€œç©ºè¿è¡Œâ€ï¼ˆdry runï¼‰æ ‡å¿—å‚æ•°ï¼Œè¿™æ ·ç”¨æˆ·å¯ä»¥ç¡®è®¤å·¥å…·çœŸå®è¿è¡Œæ—¶ä¼šè¿›è¡Œçš„æ“ä½œã€‚è¿™äº›å·¥å…·é€šå¸¸ä¹Ÿä¼šæœ‰â€œäº¤äº’å¼â€ï¼ˆinteractiveï¼‰æ ‡å¿—å‚æ•°ï¼Œåœ¨æ‰§è¡Œæ¯ä¸ªä¸å¯æ’¤å›çš„æ“ä½œå‰æç¤ºç”¨æˆ·ç¡®è®¤ã€‚\n--version æˆ–è€… -V æ ‡å¿—å‚æ•°å¯ä»¥è®©å·¥å…·æ˜¾ç¤ºå®ƒçš„ç‰ˆæœ¬ä¿¡æ¯ï¼ˆå¯¹äºæäº¤è½¯ä»¶é—®é¢˜æŠ¥å‘Šéå¸¸é‡è¦ï¼‰ã€‚\nåŸºæœ¬æ‰€æœ‰çš„å·¥å…·æ”¯æŒä½¿ç”¨ --verbose æˆ–è€… -v æ ‡å¿—å‚æ•°æ¥è¾“å‡ºè¯¦ç»†çš„è¿è¡Œä¿¡æ¯ã€‚å¤šæ¬¡ä½¿ç”¨è¿™ä¸ªæ ‡å¿—å‚æ•°ï¼Œæ¯”å¦‚ -vvvï¼Œå¯ä»¥è®©å·¥å…·è¾“å‡ºæ›´è¯¦ç»†çš„ä¿¡æ¯ï¼ˆç»å¸¸ç”¨äºè°ƒè¯•ï¼‰ã€‚åŒæ ·ï¼Œå¾ˆå¤šå·¥å…·æ”¯æŒ --quiet æ ‡å¿—å‚æ•°æ¥æŠ‘åˆ¶é™¤é”™è¯¯æç¤ºä¹‹å¤–çš„å…¶ä»–è¾“å‡ºã€‚\nå¤§å¤šæ•°å·¥å…·ä¸­ï¼Œä½¿ç”¨ - ä»£æ›¿è¾“å…¥æˆ–è€…è¾“å‡ºæ–‡ä»¶åæ„å‘³ç€å·¥å…·å°†ä»æ ‡å‡†è¾“å…¥ï¼ˆstandard inputï¼‰è·å–æ‰€éœ€å†…å®¹ï¼Œæˆ–è€…å‘æ ‡å‡†è¾“å‡ºï¼ˆstandard outputï¼‰è¾“å‡ºç»“æœã€‚\nä¼šé€ æˆç ´åæ€§ç»“æœçš„å·¥å…·ä¸€èˆ¬é»˜è®¤è¿›è¡Œéé€’å½’çš„æ“ä½œï¼Œä½†æ˜¯æ”¯æŒä½¿ç”¨â€œé€’å½’â€ï¼ˆrecursiveï¼‰æ ‡å¿—å‡½æ•°ï¼ˆé€šå¸¸æ˜¯ -rï¼‰ã€‚\næœ‰çš„æ—¶å€™ä½ å¯èƒ½éœ€è¦å‘å·¥å…·ä¼ å…¥ä¸€ä¸ª çœ‹ä¸Šå» åƒæ ‡å¿—å‚æ•°çš„æ™®é€šå‚æ•°ï¼Œæ¯”å¦‚ï¼š\nä½¿ç”¨ rm åˆ é™¤ä¸€ä¸ªå« -r çš„æ–‡ä»¶ï¼› åœ¨é€šè¿‡ä¸€ä¸ªç¨‹åºè¿è¡Œå¦ä¸€ä¸ªç¨‹åºçš„æ—¶å€™ï¼ˆssh machine fooï¼‰ï¼Œå‘å†…å±‚çš„ç¨‹åºï¼ˆfooï¼‰ä¼ é€’ä¸€ä¸ªæ ‡å¿—å‚æ•°ã€‚ è¿™æ—¶å€™ä½ å¯ä»¥ä½¿ç”¨ç‰¹æ®Šå‚æ•° -- è®©æŸä¸ªç¨‹åº åœæ­¢å¤„ç† -- åé¢å‡ºç°çš„æ ‡å¿—å‚æ•°ä»¥åŠé€‰é¡¹ï¼ˆä»¥ - å¼€å¤´çš„å†…å®¹ï¼‰ï¼š\nrm -- -r ä¼šè®© rm å°† -r å½“ä½œæ–‡ä»¶åï¼› ssh machine --for-ssh -- foo --for-foo çš„ -- ä¼šè®© ssh çŸ¥é“ --for-foo ä¸æ˜¯ ssh çš„æ ‡å¿—å‚æ•°ã€‚ çª—å£ç®¡ç†å™¨ å¤§éƒ¨åˆ†äººé€‚åº”äº† Windowsã€macOSã€ä»¥åŠ Ubuntu é»˜è®¤çš„â€œæ‹–æ‹½â€å¼çª—å£ç®¡ç†å™¨ã€‚è¿™äº›çª—å£ç®¡ç†å™¨çš„çª—å£ä¸€èˆ¬å°±å †åœ¨å±å¹•ä¸Šï¼Œä½ å¯ä»¥æ‹–æ‹½æ”¹å˜çª—å£çš„ä½ç½®ã€ç¼©æ”¾çª—å£ã€ä»¥åŠè®©çª—å£å †å åœ¨ä¸€èµ·ã€‚è¿™ç§å †å å¼ï¼ˆfloating/stackingï¼‰ç®¡ç†å™¨åªæ˜¯çª—å£ç®¡ç†å™¨ä¸­çš„ä¸€ç§ã€‚ç‰¹åˆ«åœ¨ Linux ä¸­ï¼Œæœ‰å¾ˆå¤šç§å…¶ä»–çš„ç®¡ç†å™¨ã€‚\nå¹³é“ºå¼ï¼ˆtilingï¼‰ç®¡ç†å™¨å°±æ˜¯ä¸€ä¸ªå¸¸è§çš„æ›¿ä»£ã€‚é¡¾åæ€ä¹‰ï¼Œå¹³é“ºå¼ç®¡ç†å™¨ä¼šæŠŠä¸åŒçš„çª—å£åƒè´´ç“·ç –ä¸€æ ·å¹³é“ºåœ¨ä¸€èµ·è€Œä¸å’Œå…¶ä»–çª—å£é‡å ã€‚è¿™å’Œ tmux ç®¡ç†ç»ˆç«¯çª—å£çš„æ–¹å¼ç±»ä¼¼ã€‚å¹³é“ºå¼ç®¡ç†å™¨æŒ‰ç…§å†™å¥½çš„å¸ƒå±€æ˜¾ç¤ºæ‰“å¼€çš„çª—å£ã€‚å¦‚æœåªæ‰“å¼€ä¸€ä¸ªçª—å£ï¼Œå®ƒä¼šå¡«æ»¡æ•´ä¸ªå±å¹•ã€‚æ–°å¼€ä¸€ä¸ªçª—å£çš„æ—¶å€™ï¼ŒåŸæ¥çš„çª—å£ä¼šç¼©å°åˆ°æ¯”å¦‚ä¸‰åˆ†ä¹‹äºŒæˆ–è€…ä¸‰åˆ†ä¹‹ä¸€çš„å¤§å°æ¥è…¾å‡ºç©ºé—´ã€‚æ‰“å¼€æ›´å¤šçš„çª—å£ä¼šè®©å·²æœ‰çš„çª—å£è¿›ä¸€æ­¥è°ƒæ•´ã€‚\nå°±åƒ tmux é‚£æ ·ï¼Œå¹³é“ºå¼ç®¡ç†å™¨å¯ä»¥è®©ä½ åœ¨å®Œå…¨ä¸ä½¿ç”¨é¼ æ ‡çš„æƒ…å†µä¸‹ä½¿ç”¨é”®ç›˜åˆ‡æ¢ã€ç¼©æ”¾ã€ä»¥åŠç§»åŠ¨çª—å£ã€‚å®ƒä»¬å€¼å¾—ä¸€è¯•ï¼\nVPN VPN ç°åœ¨éå¸¸ç«ï¼Œä½†æˆ‘ä»¬ä¸æ¸…æ¥šè¿™æ˜¯ä¸æ˜¯å› ä¸ºä¸€äº›å¥½çš„ç†ç”±ã€‚ä½ åº”è¯¥äº†è§£ VPN èƒ½æä¾›çš„åŠŸèƒ½å’Œå®ƒçš„é™åˆ¶ã€‚ä½¿ç”¨äº† VPN çš„ä½ å¯¹äºäº’è”ç½‘è€Œè¨€ï¼Œæœ€å¥½çš„æƒ…å†µä¸‹ä¹Ÿå°±æ˜¯æ¢äº†ä¸€ä¸ªç½‘ç»œä¾›åº”å•†ï¼ˆISPï¼‰ã€‚æ‰€æœ‰ä½ å‘å‡ºçš„æµé‡çœ‹ä¸Šå»æ¥æºäº VPN ä¾›åº”å•†çš„ç½‘ç»œè€Œä¸æ˜¯ä½ çš„â€œçœŸå®â€åœ°å€ï¼Œè€Œä½ å®é™…æ¥å…¥çš„ç½‘ç»œåªèƒ½çœ‹åˆ°åŠ å¯†çš„æµé‡ã€‚\nè™½ç„¶è¿™å¬ä¸Šå»éå¸¸è¯±äººï¼Œä½†æ˜¯ä½ åº”è¯¥çŸ¥é“ä½¿ç”¨ VPN åªæ˜¯æŠŠåŸæœ¬å¯¹ç½‘ç»œä¾›åº”å•†çš„ä¿¡ä»»æ”¾åœ¨äº† VPN ä¾›åº”å•†é‚£é‡Œâ€”â€”ç½‘ç»œä¾›åº”å•† èƒ½çœ‹åˆ°çš„ï¼ŒVPN ä¾›åº”å•† ä¹Ÿéƒ½èƒ½çœ‹åˆ°ã€‚å¦‚æœç›¸æ¯”ç½‘ç»œä¾›åº”å•†ä½ æ›´ä¿¡ä»» VPN ä¾›åº”å•†ï¼Œé‚£å½“ç„¶å¾ˆå¥½ã€‚åä¹‹ï¼Œåˆ™è¿æ¥VPNçš„ä»·å€¼ä¸æ˜ç¡®ã€‚æœºåœºçš„ä¸åŠ å¯†å…¬å…±çƒ­ç‚¹ç¡®å®ä¸å¯ä»¥ä¿¡ä»»ï¼Œä½†æ˜¯åœ¨å®¶åº­ç½‘ç»œç¯å¢ƒé‡Œï¼Œè¿™ä¸ªå·®å¼‚å°±æ²¡æœ‰é‚£ä¹ˆæ˜æ˜¾ã€‚\nä½ ä¹Ÿåº”è¯¥äº†è§£ç°åœ¨å¤§éƒ¨åˆ†åŒ…å«ç”¨æˆ·æ•æ„Ÿä¿¡æ¯çš„æµé‡å·²ç»è¢« HTTPS æˆ–è€… TLS åŠ å¯†ã€‚è¿™ç§æƒ…å†µä¸‹ä½ æ‰€å¤„çš„ç½‘ç»œç¯å¢ƒæ˜¯å¦â€œå®‰å…¨â€ä¸å¤ªé‡è¦ï¼šä¾›åº”å•†åªèƒ½çœ‹åˆ°ä½ å’Œå“ªäº›æœåŠ¡å™¨åœ¨äº¤è°ˆï¼Œå´ä¸èƒ½çœ‹åˆ°ä½ ä»¬äº¤è°ˆçš„å†…å®¹ã€‚\nè¿™ä¸€åˆ‡çš„å¤§å‰æéƒ½æ˜¯â€œæœ€å¥½çš„æƒ…å†µâ€ã€‚æ›¾ç»å‘ç”Ÿè¿‡ VPN æä¾›å•†é”™è¯¯ä½¿ç”¨å¼±åŠ å¯†æˆ–è€…ç›´æ¥ç¦ç”¨åŠ å¯†çš„å…ˆä¾‹ã€‚å¦å¤–ï¼Œæœ‰äº›æ¶æ„çš„æˆ–è€…å¸¦æœ‰æŠ•æœºå¿ƒæ€çš„ä¾›åº”å•†ä¼šè®°å½•å’Œä½ æœ‰å…³çš„æ‰€æœ‰æµé‡ï¼Œå¹¶å¾ˆå¯èƒ½ä¼šå°†è¿™äº›ä¿¡æ¯å–ç»™ç¬¬ä¸‰æ–¹ã€‚æ‰¾é”™ä¸€å®¶ VPN ç»å¸¸æ¯”ä¸€å¼€å§‹å°±ä¸ç”¨ VPN æ›´å±é™©ã€‚\nMIT å‘æœ‰è®¿é—®æ ¡å†…èµ„æºéœ€æ±‚çš„æˆå‘˜å¼€æ”¾è‡ªå·±è¿è¥çš„ VPNã€‚å¦‚æœä½ ä¹Ÿæƒ³è‡ªå·±é…ç½®ä¸€ä¸ª VPNï¼Œå¯ä»¥äº†è§£ä¸€ä¸‹ WireGuard ä»¥åŠ Algoã€‚\nMarkdown ä½ åœ¨èŒä¸šç”Ÿæ¶¯ä¸­å¤§æ¦‚ç‡ä¼šç¼–å†™å„ç§å„æ ·çš„æ–‡æ¡£ã€‚åœ¨å¾ˆå¤šæƒ…å†µä¸‹è¿™äº›æ–‡æ¡£éœ€è¦ä½¿ç”¨æ ‡è®°æ¥å¢åŠ å¯è¯»æ€§ï¼Œæ¯”å¦‚ï¼šæ’å…¥ç²—ä½“æˆ–è€…æ–œä½“å†…å®¹ï¼Œå¢åŠ é¡µçœ‰ã€è¶…é“¾æ¥ã€ä»¥åŠä»£ç ç‰‡æ®µã€‚\nåœ¨ä¸ä½¿ç”¨ Word æˆ–è€… LaTeX ç­‰å¤æ‚å·¥å…·çš„æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥è€ƒè™‘ä½¿ç”¨ Markdown è¿™ä¸ªè½»é‡åŒ–çš„æ ‡è®°è¯­è¨€ï¼ˆmarkup languageï¼‰ã€‚ä½ å¯èƒ½å·²ç»è§è¿‡ Markdown æˆ–è€…å®ƒçš„ä¸€ä¸ªå˜ç§ã€‚å¾ˆå¤šç¯å¢ƒéƒ½æ”¯æŒå¹¶ä½¿ç”¨ Markdown çš„ä¸€äº›å­åŠŸèƒ½ã€‚\nMarkdown è‡´åŠ›äºå°†äººä»¬ç¼–å†™çº¯æ–‡æœ¬æ—¶çš„ä¸€äº›ä¹ æƒ¯æ ‡å‡†åŒ–ã€‚æ¯”å¦‚ï¼š\nç”¨*åŒ…å›´çš„æ–‡å­—è¡¨ç¤ºå¼ºè°ƒï¼ˆæ–œä½“ï¼‰ï¼Œæˆ–è€…ç”¨**è¡¨ç¤ºç‰¹åˆ«å¼ºè°ƒï¼ˆç²—ä½“ï¼‰ï¼›\nä»¥#å¼€å¤´çš„è¡Œæ˜¯æ ‡é¢˜ï¼Œ#çš„æ•°é‡è¡¨ç¤ºæ ‡é¢˜çš„çº§åˆ«ï¼Œæ¯”å¦‚ï¼š##äºŒçº§æ ‡é¢˜ï¼›\nä»¥-å¼€å¤´ä»£è¡¨ä¸€ä¸ªæ— åºåˆ—è¡¨çš„å…ƒç´ ã€‚ä¸€ä¸ªæ•°å­—åŠ .ï¼ˆæ¯”å¦‚1.ï¼‰ä»£è¡¨ä¸€ä¸ªæœ‰åºåˆ—è¡¨å…ƒç´ ï¼›\nåå¼•å· `ï¼ˆbacktickï¼‰åŒ…å›´çš„æ–‡å­—ä¼šä»¥ä»£ç å­—ä½“æ˜¾ç¤ºã€‚å¦‚æœè¦æ˜¾ç¤ºä¸€æ®µä»£ç ï¼Œå¯ä»¥åœ¨æ¯ä¸€è¡Œå‰åŠ å››ä¸ªç©ºæ ¼ç¼©è¿›ï¼Œæˆ–è€…ä½¿ç”¨ä¸‰ä¸ªåå¼•å·åŒ…å›´æ•´ä¸ªä»£ç ç‰‡æ®µï¼š\nå°±åƒè¿™æ · å¦‚æœè¦æ·»åŠ è¶…é“¾æ¥ï¼Œå°† éœ€è¦æ˜¾ç¤º çš„æ–‡å­—ç”¨æ–¹æ‹¬å·åŒ…å›´ï¼Œå¹¶åœ¨åé¢ç´§æ¥ç€ç”¨åœ†æ‹¬å·åŒ…å›´é“¾æ¥ï¼š[æ˜¾ç¤ºæ–‡å­—](æŒ‡å‘çš„é“¾æ¥)ã€‚\nMarkdown ä¸ä»…å®¹æ˜“ä¸Šæ‰‹ï¼Œè€Œä¸”åº”ç”¨éå¸¸å¹¿æ³›ã€‚å®é™…ä¸Šæœ¬è¯¾ç¨‹çš„è¯¾å ‚ç¬”è®°å’Œå…¶ä»–èµ„æ–™éƒ½æ˜¯ä½¿ç”¨ Markdown ç¼–å†™çš„ã€‚ç‚¹å‡»è¿™ä¸ªé“¾æ¥å¯ä»¥çœ‹åˆ°æœ¬é¡µé¢çš„åŸå§‹ Markdown å†…å®¹ã€‚\nHammerspoon (macOS æ¡Œé¢è‡ªåŠ¨åŒ–) Hammerspoon æ˜¯é¢å‘ macOS çš„ä¸€ä¸ªæ¡Œé¢è‡ªåŠ¨åŒ–æ¡†æ¶ã€‚å®ƒå…è®¸ç”¨æˆ·ç¼–å†™å’Œæ“ä½œç³»ç»ŸåŠŸèƒ½æŒ‚é’©çš„ Lua è„šæœ¬ï¼Œä»è€Œä¸é”®ç›˜ã€é¼ æ ‡ã€çª—å£ã€æ–‡ä»¶ç³»ç»Ÿç­‰äº¤äº’ã€‚\nä¸‹é¢æ˜¯ Hammerspoon çš„ä¸€äº›ç¤ºä¾‹åº”ç”¨ï¼š\nç»‘å®šç§»åŠ¨çª—å£åˆ°çš„ç‰¹å®šä½ç½®çš„å¿«æ·é”® åˆ›å»ºå¯ä»¥è‡ªåŠ¨å°†çª—å£æ•´ç†æˆç‰¹å®šå¸ƒå±€çš„èœå•æ æŒ‰é’® åœ¨ä½ åˆ°å®éªŒå®¤ä»¥åï¼Œé€šè¿‡æ£€æµ‹æ‰€è¿æ¥çš„ WiFi ç½‘ç»œè‡ªåŠ¨é™éŸ³æ‰¬å£°å™¨ åœ¨ä½ ä¸å°å¿ƒæ‹¿äº†æœ‹å‹çš„å……ç”µå™¨æ—¶å¼¹å‡ºè­¦å‘Š ä»ç”¨æˆ·çš„è§’åº¦ï¼ŒHammerspoon å¯ä»¥è¿è¡Œä»»æ„ Lua ä»£ç ï¼Œç»‘å®šèœå•æ æŒ‰é’®ã€æŒ‰é”®ã€æˆ–è€…äº‹ä»¶ã€‚Hammerspoon æä¾›äº†ä¸€ä¸ªå…¨é¢çš„ç”¨äºå’Œç³»ç»Ÿäº¤äº’çš„åº“ï¼Œå› æ­¤å®ƒèƒ½æ²¡æœ‰é™åˆ¶åœ°å®ç°ä»»ä½•åŠŸèƒ½ã€‚ä½ å¯ä»¥ä»å¤´ç¼–å†™è‡ªå·±çš„ Hammerspoon é…ç½®ï¼Œä¹Ÿå¯ä»¥ç»“åˆåˆ«äººå…¬å¸ƒçš„é…ç½®æ¥æ»¡è¶³è‡ªå·±çš„éœ€æ±‚ã€‚\nèµ„æº Getting Started with Hammerspoonï¼šHammerspoon å®˜æ–¹æ•™ç¨‹ Sample configurationsï¼šHammerspoon å®˜æ–¹ç¤ºä¾‹é…ç½® Anish\u0026rsquo;s Hammerspoon configï¼šAnish çš„ Hammerspoon é…ç½® å¼€æœºå¼•å¯¼ä»¥åŠ Live USB åœ¨ä½ çš„è®¡ç®—æœºå¯åŠ¨æ—¶ï¼ŒBIOS æˆ–è€… UEFI ä¼šåœ¨åŠ è½½æ“ä½œç³»ç»Ÿä¹‹å‰å¯¹ç¡¬ä»¶ç³»ç»Ÿè¿›è¡Œåˆå§‹åŒ–ï¼Œè¿™è¢«ç§°ä¸ºå¼•å¯¼ï¼ˆbootingï¼‰ã€‚ä½ å¯ä»¥é€šè¿‡æŒ‰ä¸‹è®¡ç®—æœºæç¤ºçš„é”®ä½ç»„åˆæ¥é…ç½®å¼•å¯¼ï¼Œæ¯”å¦‚ Press F9 to configure BIOS. Press F12 to enter boot menuã€‚åœ¨ BIOS èœå•ä¸­ä½ å¯ä»¥å¯¹ç¡¬ä»¶ç›¸å…³çš„è®¾ç½®è¿›è¡Œæ›´æ”¹ï¼Œä¹Ÿå¯ä»¥åœ¨å¼•å¯¼èœå•ä¸­é€‰æ‹©ä»ç¡¬ç›˜ä»¥å¤–çš„å…¶ä»–è®¾å¤‡åŠ è½½æ“ä½œç³»ç»Ÿâ€”â€”æ¯”å¦‚ Live USBã€‚\nLive USB æ˜¯åŒ…å«äº†å®Œæ•´æ“ä½œç³»ç»Ÿçš„é—ªå­˜ç›˜ã€‚Live USB çš„ç”¨é€”éå¸¸å¹¿æ³›ï¼ŒåŒ…æ‹¬ï¼š\nä½œä¸ºå®‰è£…æ“ä½œç³»ç»Ÿçš„å¯åŠ¨ç›˜ï¼› åœ¨ä¸å°†æ“ä½œç³»ç»Ÿå®‰è£…åˆ°ç¡¬ç›˜çš„æƒ…å†µä¸‹ï¼Œç›´æ¥è¿è¡Œ Live USB ä¸Šçš„æ“ä½œç³»ç»Ÿï¼› å¯¹ç¡¬ç›˜ä¸Šçš„ç›¸åŒæ“ä½œç³»ç»Ÿè¿›è¡Œä¿®å¤ï¼› æ¢å¤ç¡¬ç›˜ä¸Šçš„æ•°æ®ã€‚ Live USB é€šè¿‡åœ¨é—ªå­˜ç›˜ä¸Š å†™å…¥ æ“ä½œç³»ç»Ÿçš„é•œåƒåˆ¶ä½œï¼Œè€Œå†™å…¥ä¸æ˜¯å•çº¯çš„å¾€é—ªå­˜ç›˜ä¸Šå¤åˆ¶ .iso æ–‡ä»¶ã€‚ä½ å¯ä»¥ä½¿ç”¨ UNetbootin ã€Rufus ç­‰ Live USB å†™å…¥å·¥å…·åˆ¶ä½œã€‚\nDocker, Vagrant, VMs, Cloud, OpenStack è™šæ‹Ÿæœºï¼ˆVirtual Machineï¼‰ä»¥åŠå¦‚å®¹å™¨åŒ–ï¼ˆcontainerizationï¼‰ç­‰å·¥å…·å¯ä»¥å¸®åŠ©ä½ æ¨¡æ‹Ÿä¸€ä¸ªåŒ…æ‹¬æ“ä½œç³»ç»Ÿçš„å®Œæ•´è®¡ç®—æœºç³»ç»Ÿã€‚è™šæ‹Ÿæœºå¯ä»¥ç”¨äºåˆ›å»ºç‹¬ç«‹çš„æµ‹è¯•æˆ–è€…å¼€å‘ç¯å¢ƒï¼Œä»¥åŠç”¨ä½œå®‰å…¨æµ‹è¯•çš„æ²™ç›’ã€‚\nVagrant æ˜¯ä¸€ä¸ªæ„å»ºå’Œé…ç½®è™šæ‹Ÿå¼€å‘ç¯å¢ƒçš„å·¥å…·ã€‚å®ƒæ”¯æŒç”¨æˆ·åœ¨é…ç½®æ–‡ä»¶ä¸­å†™å…¥æ¯”å¦‚æ“ä½œç³»ç»Ÿã€ç³»ç»ŸæœåŠ¡ã€éœ€è¦å®‰è£…çš„è½¯ä»¶åŒ…ç­‰æè¿°ï¼Œç„¶åä½¿ç”¨ vagrant up å‘½ä»¤åœ¨å„ç§ç¯å¢ƒï¼ˆVirtualBoxï¼ŒKVMï¼ŒHyper-Vç­‰ï¼‰ä¸­å¯åŠ¨ä¸€ä¸ªè™šæ‹Ÿæœºã€‚Docker æ˜¯ä¸€ä¸ªä½¿ç”¨å®¹å™¨åŒ–æ¦‚å¿µçš„ç±»ä¼¼å·¥å…·ã€‚\nç§Ÿç”¨äº‘ç«¯è™šæ‹Ÿæœºå¯ä»¥äº«å—ä»¥ä¸‹èµ„æºçš„å³æ—¶è®¿é—®ï¼š\nä¾¿å®œã€å¸¸å¼€ã€ä¸”æœ‰å…¬å…±IPåœ°å€çš„è™šæ‹Ÿæœºç”¨æ¥æ‰˜ç®¡ç½‘ç«™ç­‰æœåŠ¡ æœ‰å¤§é‡ CPUã€ç£ç›˜ã€å†…å­˜ã€ä»¥åŠ GPU èµ„æºçš„è™šæ‹Ÿæœº è¶…å‡ºç”¨æˆ·å¯ä»¥ä½¿ç”¨çš„ç‰©ç†ä¸»æœºæ•°é‡çš„è™šæ‹Ÿæœº ç›¸æ¯”ç‰©ç†ä¸»æœºçš„å›ºå®šå¼€æ”¯ï¼Œè™šæ‹Ÿæœºçš„å¼€æ”¯ä¸€èˆ¬æŒ‰è¿è¡Œçš„æ—¶é—´è®¡ç®—ã€‚æ‰€ä»¥å¦‚æœç”¨æˆ·åªéœ€è¦åœ¨çŸ­æ—¶é—´å†…ä½¿ç”¨å¤§é‡ç®—åŠ›ï¼Œç§Ÿç”¨1000å°è™šæ‹Ÿæœºè¿è¡Œå‡ åˆ†é’Ÿæ˜æ˜¾æ›´åŠ åˆ’ç®—ã€‚ å—æ¬¢è¿çš„ VPS æœåŠ¡å•†æœ‰ Amazon AWSï¼ŒGoogle Cloudï¼Œä»¥åŠ DigitalOceanã€‚\nMIT CSAIL çš„æˆå‘˜å¯ä»¥ä½¿ç”¨ CSAIL OpenStack instance ç”³è¯·å…è´¹çš„è™šæ‹Ÿæœºç”¨äºç ”ç©¶ã€‚\näº¤äº’å¼è®°äº‹æœ¬ç¼–ç¨‹ äº¤äº’å¼è®°äº‹æœ¬å¯ä»¥å¸®åŠ©å¼€å‘è€…è¿›è¡Œä¸è¿è¡Œç»“æœäº¤äº’ç­‰æ¢ç´¢æ€§çš„ç¼–ç¨‹ã€‚ç°åœ¨æœ€å—æ¬¢è¿çš„äº¤äº’å¼è®°äº‹æœ¬ç¯å¢ƒå¤§æ¦‚æ˜¯ Jupyterã€‚å®ƒçš„åå­—æ¥æºäºæ‰€æ”¯æŒçš„ä¸‰ç§æ ¸å¿ƒè¯­è¨€ï¼šJuliaã€Pythonã€Rã€‚Wolfram Mathematica æ˜¯å¦å¤–ä¸€ä¸ªå¸¸ç”¨äºç§‘å­¦è®¡ç®—çš„ä¼˜ç§€ç¯å¢ƒã€‚\nGitHub GitHub æ˜¯æœ€å—æ¬¢è¿çš„å¼€æºè½¯ä»¶å¼€å‘å¹³å°ä¹‹ä¸€ã€‚æˆ‘ä»¬è¯¾ç¨‹ä¸­æåˆ°çš„å¾ˆå¤šå·¥å…·ï¼Œä» vim åˆ° Hammerspoonï¼Œéƒ½æ‰˜ç®¡åœ¨ Github ä¸Šã€‚å‘ä½ æ¯å¤©ä½¿ç”¨çš„å¼€æºå·¥å…·ä½œå‡ºè´¡çŒ®å…¶å®å¾ˆç®€å•ï¼Œä¸‹é¢æ˜¯ä¸¤ç§è´¡çŒ®è€…ä»¬ç»å¸¸ä½¿ç”¨çš„æ–¹æ³•ï¼š\nåˆ›å»ºä¸€ä¸ªè®®é¢˜ï¼ˆissueï¼‰ã€‚ è®®é¢˜å¯ä»¥ç”¨æ¥åæ˜ è½¯ä»¶è¿è¡Œçš„é—®é¢˜æˆ–è€…è¯·æ±‚æ–°çš„åŠŸèƒ½ã€‚åˆ›å»ºè®®é¢˜å¹¶ä¸éœ€è¦åˆ›å»ºè€…é˜…è¯»æˆ–è€…ç¼–å†™ä»£ç ï¼Œæ‰€ä»¥å®ƒæ˜¯ä¸€ä¸ªè½»é‡åŒ–çš„è´¡çŒ®æ–¹å¼ã€‚é«˜è´¨é‡çš„é—®é¢˜æŠ¥å‘Šå¯¹äºå¼€å‘è€…ååˆ†é‡è¦ã€‚åœ¨ç°æœ‰çš„è®®é¢˜å‘è¡¨è¯„è®ºä¹Ÿå¯ä»¥å¯¹é¡¹ç›®çš„å¼€å‘ä½œå‡ºè´¡çŒ®ã€‚ ä½¿ç”¨æ‹‰å–è¯·æ±‚ï¼ˆpull requestï¼‰æäº¤ä»£ç æ›´æ”¹ã€‚ç”±äºæ¶‰åŠåˆ°é˜…è¯»å’Œç¼–å†™ä»£ç ï¼Œæäº¤æ‹‰å–è¯·æ±‚æ€»çš„æ¥è¯´æ¯”åˆ›å»ºè®®é¢˜æ›´åŠ æ·±å…¥ã€‚æ‹‰å–è¯·æ±‚æ˜¯è¯·æ±‚åˆ«äººæŠŠä½ è‡ªå·±çš„ä»£ç æ‹‰å–ï¼ˆä¸”åˆå¹¶ï¼‰åˆ°ä»–ä»¬çš„ä»“åº“é‡Œã€‚å¾ˆå¤šå¼€æºé¡¹ç›®ä»…å…è®¸è®¤è¯çš„ç®¡ç†è€…ç®¡ç†é¡¹ç›®ä»£ç ï¼Œæ‰€ä»¥ä¸€èˆ¬éœ€è¦å¤åˆ»ï¼ˆforkï¼‰è¿™äº›é¡¹ç›®çš„ä¸Šæ¸¸ä»“åº“ï¼ˆupstream repositoryï¼‰ï¼Œåœ¨ä½ çš„ Github è´¦å·ä¸‹åˆ›å»ºä¸€ä¸ªå†…å®¹å®Œå…¨ç›¸åŒä½†æ˜¯ç”±ä½ æ§åˆ¶çš„å¤åˆ»ä»“åº“ã€‚è¿™æ ·ä½ å°±å¯ä»¥åœ¨è¿™ä¸ªå¤åˆ»ä»“åº“è‡ªç”±åˆ›å»ºæ–°çš„åˆ†æ”¯å¹¶æ¨é€ä¿®å¤é—®é¢˜æˆ–è€…å®ç°æ–°åŠŸèƒ½çš„ä»£ç ã€‚å®Œæˆä¿®æ”¹ä»¥åå†å›åˆ°å¼€æºé¡¹ç›®çš„ Github é¡µé¢åˆ›å»ºä¸€ä¸ªæ‹‰å–è¯·æ±‚ã€‚ æäº¤è¯·æ±‚åï¼Œé¡¹ç›®ç®¡ç†è€…ä¼šå’Œä½ äº¤æµæ‹‰å–è¯·æ±‚é‡Œçš„ä»£ç å¹¶ç»™å‡ºåé¦ˆã€‚å¦‚æœæ²¡æœ‰é—®é¢˜ï¼Œä½ çš„ä»£ç ä¼šå’Œä¸Šæ¸¸ä»“åº“ä¸­çš„ä»£ç åˆå¹¶ã€‚å¾ˆå¤šå¤§çš„å¼€æºé¡¹ç›®ä¼šæä¾›è´¡çŒ®æŒ‡å—ï¼Œå®¹æ˜“ä¸Šæ‰‹çš„è®®é¢˜ï¼Œç”šè‡³ä¸“é—¨çš„æŒ‡å¯¼é¡¹ç›®æ¥å¸®åŠ©å‚ä¸è€…ç†Ÿæ‚‰è¿™äº›é¡¹ç›®ã€‚\nå‚è€ƒ è¯¾ç¨‹åˆ—è¡¨\n","permalink":"https://blog.niuhemoon.win/posts/tech/coding-tools-foobar/","summary":"å®‰å…¨å’Œå¯†ç  ç†µ(Entropy) åº¦é‡äº†ä¸ç¡®å®šæ€§å¹¶å¯ä»¥ç”¨æ¥å†³å®šå¯†ç çš„å¼ºåº¦ã€‚ ç†µçš„å•ä½æ˜¯ æ¯”ç‰¹ã€‚å¯¹äºä¸€ä¸ªå‡åŒ€åˆ†å¸ƒçš„éšæœºç¦»æ•£å˜é‡ï¼Œç†µç­‰äºlog_2(æ‰€æœ‰å¯èƒ½çš„ä¸ªæ•°ï¼Œå³n)ã€‚ æ‰”ä¸€æ¬¡ç¡¬å¸çš„ç†µæ˜¯1æ¯”ç‰¹ã€‚æ·ä¸€æ¬¡ï¼ˆå…­é¢ï¼‰éª°å­çš„ç†µå¤§çº¦ä¸º2.58æ¯”ç‰¹ã€‚ å¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯† å½“ä½ è¿è¡Œssh-keygenå‘½ä»¤ï¼Œ","title":"ç¼–ç¨‹å·¥å…·ä¹‹æ‚çƒ©"},{"content":"ä»£ç ä¸èƒ½å®Œå…¨æŒ‰ç…§æ‚¨çš„æƒ³æ³•è¿è¡Œï¼Œå®ƒåªèƒ½å®Œå…¨æŒ‰ç…§æ‚¨çš„å†™æ³•è¿è¡Œï¼Œè¿™æ˜¯ç¼–ç¨‹ç•Œçš„ä¸€æ¡é‡‘ç§‘ç‰å¾‹ã€‚\nè®©æ‚¨çš„å†™æ³•ç¬¦åˆæ‚¨çš„æƒ³æ³•æ˜¯éå¸¸å›°éš¾çš„ã€‚åœ¨è¿™èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬ä¼šä¼ æˆç»™æ‚¨ä¸€äº›éå¸¸æœ‰ç”¨æŠ€æœ¯ï¼Œå¸®æ‚¨å¤„ç†ä»£ç ä¸­çš„ bug å’Œç¨‹åºæ€§èƒ½é—®é¢˜ã€‚\nè°ƒè¯•ä»£ç  æ‰“å°è°ƒè¯•æ³•ä¸æ—¥å¿— \u0026ldquo;æœ€æœ‰æ•ˆçš„ debug å·¥å…·å°±æ˜¯ç»†è‡´çš„åˆ†æï¼Œé…åˆæ°å½“ä½ç½®çš„æ‰“å°è¯­å¥\u0026rdquo; â€” Brian Kernighan, Unix æ–°æ‰‹å…¥é—¨ã€‚\nè°ƒè¯•ä»£ç çš„ç¬¬ä¸€ç§æ–¹æ³•å¾€å¾€æ˜¯åœ¨æ‚¨å‘ç°é—®é¢˜çš„åœ°æ–¹æ·»åŠ ä¸€äº›æ‰“å°è¯­å¥ï¼Œç„¶åä¸æ–­é‡å¤æ­¤è¿‡ç¨‹ç›´åˆ°æ‚¨è·å–äº†è¶³å¤Ÿçš„ä¿¡æ¯å¹¶æ‰¾åˆ°é—®é¢˜çš„æ ¹æœ¬åŸå› ã€‚\nå¦å¤–ä¸€ä¸ªæ–¹æ³•æ˜¯ä½¿ç”¨æ—¥å¿—ï¼Œè€Œä¸æ˜¯ä¸´æ—¶æ·»åŠ æ‰“å°è¯­å¥ã€‚æ—¥å¿—è¾ƒæ™®é€šçš„æ‰“å°è¯­å¥æœ‰å¦‚ä¸‹çš„ä¸€äº›ä¼˜åŠ¿ï¼š\næ‚¨å¯ä»¥å°†æ—¥å¿—å†™å…¥æ–‡ä»¶ã€socket æˆ–è€…ç”šè‡³æ˜¯å‘é€åˆ°è¿œç«¯æœåŠ¡å™¨è€Œä¸ä»…ä»…æ˜¯æ ‡å‡†è¾“å‡ºï¼› æ—¥å¿—å¯ä»¥æ”¯æŒä¸¥é‡ç­‰çº§ï¼ˆä¾‹å¦‚ INFO, DEBUG, WARN, ERRORç­‰)ï¼Œè¿™ä½¿æ‚¨å¯ä»¥æ ¹æ®éœ€è¦è¿‡æ»¤æ—¥å¿—ï¼› å¯¹äºæ–°å‘ç°çš„é—®é¢˜ï¼Œå¾ˆå¯èƒ½æ‚¨çš„æ—¥å¿—ä¸­å·²ç»åŒ…å«äº†å¯ä»¥å¸®åŠ©æ‚¨å®šä½é—®é¢˜çš„è¶³å¤Ÿçš„ä¿¡æ¯ã€‚ è¿™é‡Œ æ˜¯ä¸€ä¸ªåŒ…å«æ—¥å¿—çš„ä¾‹ç¨‹åºï¼š\n$ python logger.py # Raw output as with just prints $ python logger.py log # Log formatted output $ python logger.py log ERROR # Print only ERROR levels and above $ python logger.py color # Color formatted output æœ‰å¾ˆå¤šæŠ€å·§å¯ä»¥ä½¿æ—¥å¿—çš„å¯è¯»æ€§å˜å¾—æ›´å¥½ï¼Œæˆ‘æœ€å–œæ¬¢çš„ä¸€ä¸ªæ˜¯æŠ€å·§æ˜¯å¯¹å…¶è¿›è¡Œç€è‰²ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ‚¨åº”è¯¥å·²ç»çŸ¥é“ï¼Œä»¥å½©è‰²æ–‡æœ¬æ˜¾ç¤ºç»ˆç«¯ä¿¡æ¯æ—¶å¯è¯»æ€§æ›´å¥½ã€‚ä½†æ˜¯åº”è¯¥å¦‚ä½•è®¾ç½®å‘¢ï¼Ÿ\nls å’Œ grep è¿™æ ·çš„ç¨‹åºä¼šä½¿ç”¨ ANSI escape codesï¼Œå®ƒæ˜¯ä¸€ç³»åˆ—çš„ç‰¹æ®Šå­—ç¬¦ï¼Œå¯ä»¥ä½¿æ‚¨çš„ shell æ”¹å˜è¾“å‡ºç»“æœçš„é¢œè‰²ã€‚ä¾‹å¦‚ï¼Œæ‰§è¡Œ echo -e \u0026quot;\\e[38;2;255;0;0mThis is red\\e[0m\u0026quot; ä¼šæ‰“å°çº¢è‰²çš„å­—ç¬¦ä¸²ï¼šThis is red ã€‚ä¸‹é¢è¿™ä¸ªè„šæœ¬å‘æ‚¨å±•ç¤ºäº†å¦‚ä½•åœ¨ç»ˆç«¯ä¸­æ‰“å°å¤šç§é¢œè‰²ã€‚\n#!/usr/bin/env bash for R in $(seq 0 20 255); do for G in $(seq 0 20 255); do for B in $(seq 0 20 255); do printf \u0026#34;\\e[38;2;${R};${G};${B}mâ–ˆ\\e[0m\u0026#34;; done done done ç¬¬ä¸‰æ–¹æ—¥å¿—ç³»ç»Ÿ å¦‚æœæ‚¨æ­£åœ¨æ„å»ºå¤§å‹è½¯ä»¶ç³»ç»Ÿï¼Œæ‚¨å¾ˆå¯èƒ½ä¼šä½¿ç”¨åˆ°ä¸€äº›ä¾èµ–ï¼Œæœ‰äº›ä¾èµ–ä¼šä½œä¸ºç¨‹åºå•ç‹¬è¿è¡Œã€‚å¦‚ Web æœåŠ¡å™¨ã€æ•°æ®åº“æˆ–æ¶ˆæ¯ä»£ç†éƒ½æ˜¯æ­¤ç±»å¸¸è§çš„ç¬¬ä¸‰æ–¹ä¾èµ–ã€‚\nå’Œè¿™äº›ç³»ç»Ÿäº¤äº’çš„æ—¶å€™ï¼Œé˜…è¯»å®ƒä»¬çš„æ—¥å¿—æ˜¯éå¸¸å¿…è¦çš„ï¼Œå› ä¸ºä»…é å®¢æˆ·ç«¯ä¾§çš„é”™è¯¯ä¿¡æ¯å¯èƒ½å¹¶ä¸è¶³ä»¥å®šä½é—®é¢˜ã€‚\nå¹¸è¿çš„æ˜¯ï¼Œå¤§å¤šæ•°çš„ç¨‹åºéƒ½ä¼šå°†æ—¥å¿—ä¿å­˜åœ¨æ‚¨çš„ç³»ç»Ÿä¸­çš„æŸä¸ªåœ°æ–¹ã€‚å¯¹äº UNIX ç³»ç»Ÿæ¥è¯´ï¼Œç¨‹åºçš„æ—¥å¿—é€šå¸¸å­˜æ”¾åœ¨ /var/logã€‚ä¾‹å¦‚ï¼Œ NGINX web æœåŠ¡å™¨å°±å°†å…¶æ—¥å¿—å­˜æ”¾äº/var/log/nginxã€‚\nç›®å‰ï¼Œç³»ç»Ÿå¼€å§‹ä½¿ç”¨ system logï¼Œæ‚¨æ‰€æœ‰çš„æ—¥å¿—éƒ½ä¼šä¿å­˜åœ¨è¿™é‡Œã€‚å¤§å¤šæ•°çš„ï¼ˆä½†ä¸æ˜¯å…¨éƒ¨ï¼‰Linux ç³»ç»Ÿéƒ½ä¼šä½¿ç”¨ systemdï¼Œè¿™æ˜¯ä¸€ä¸ªç³»ç»Ÿå®ˆæŠ¤è¿›ç¨‹ï¼Œå®ƒä¼šæ§åˆ¶æ‚¨ç³»ç»Ÿä¸­çš„å¾ˆå¤šä¸œè¥¿ï¼Œä¾‹å¦‚å“ªäº›æœåŠ¡åº”è¯¥å¯åŠ¨å¹¶è¿è¡Œã€‚systemd ä¼šå°†æ—¥å¿—ä»¥æŸç§ç‰¹æ®Šæ ¼å¼å­˜æ”¾äº/var/log/journalï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ journalctl å‘½ä»¤æ˜¾ç¤ºè¿™äº›æ¶ˆæ¯ã€‚\nç±»ä¼¼åœ°ï¼Œåœ¨ macOS ç³»ç»Ÿä¸­æ˜¯ /var/log/system.logï¼Œä½†æ˜¯æœ‰æ›´å¤šçš„å·¥å…·ä¼šä½¿ç”¨ç³»ç»Ÿæ—¥å¿—ï¼Œå®ƒçš„å†…å®¹å¯ä»¥ä½¿ç”¨ log show æ˜¾ç¤ºã€‚\nå¯¹äºå¤§å¤šæ•°çš„ UNIX ç³»ç»Ÿï¼Œæ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨dmesg å‘½ä»¤æ¥è¯»å–å†…æ ¸çš„æ—¥å¿—ã€‚\nå¦‚æœæ‚¨å¸Œæœ›å°†æ—¥å¿—åŠ å…¥åˆ°ç³»ç»Ÿæ—¥å¿—ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ logger è¿™ä¸ª shell ç¨‹åºã€‚ä¸‹é¢è¿™ä¸ªä¾‹å­æ˜¾ç¤ºäº†å¦‚ä½•ä½¿ç”¨ loggerå¹¶ä¸”å¦‚ä½•æ‰¾åˆ°èƒ½å¤Ÿå°†å…¶å­˜å…¥ç³»ç»Ÿæ—¥å¿—çš„æ¡ç›®ã€‚\nä¸ä»…å¦‚æ­¤ï¼Œå¤§å¤šæ•°çš„ç¼–ç¨‹è¯­è¨€éƒ½æ”¯æŒå‘ç³»ç»Ÿæ—¥å¿—ä¸­å†™æ—¥å¿—ã€‚\nlogger \u0026#34;Hello Logs\u0026#34; # On macOS log show --last 1m | grep Hello # On Linux journalctl --since \u0026#34;1m ago\u0026#34; | grep Hello æ­£å¦‚æˆ‘ä»¬åœ¨æ•°æ®æ•´ç†é‚£èŠ‚è¯¾ä¸Šçœ‹åˆ°çš„é‚£æ ·ï¼Œæ—¥å¿—çš„å†…å®¹å¯ä»¥éå¸¸çš„å¤šï¼Œæˆ‘ä»¬éœ€è¦å¯¹å…¶è¿›è¡Œå¤„ç†å’Œè¿‡æ»¤æ‰èƒ½å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ã€‚\nå¦‚æœæ‚¨å‘ç°æ‚¨éœ€è¦å¯¹ journalctl å’Œ log show çš„ç»“æœè¿›è¡Œå¤§é‡çš„è¿‡æ»¤ï¼Œé‚£ä¹ˆæ­¤æ—¶å¯ä»¥è€ƒè™‘ä½¿ç”¨å®ƒä»¬è‡ªå¸¦çš„é€‰é¡¹å¯¹å…¶ç»“æœå…ˆè¿‡æ»¤ä¸€éå†è¾“å‡ºã€‚è¿˜æœ‰ä¸€äº›åƒ lnav è¿™æ ·çš„å·¥å…·ï¼Œå®ƒä¸ºæ—¥å¿—æ–‡ä»¶æä¾›äº†æ›´å¥½çš„å±•ç°å’Œæµè§ˆæ–¹å¼ã€‚\nè°ƒè¯•å™¨ å½“é€šè¿‡æ‰“å°å·²ç»ä¸èƒ½æ»¡è¶³æ‚¨çš„è°ƒè¯•éœ€æ±‚æ—¶ï¼Œæ‚¨åº”è¯¥ä½¿ç”¨è°ƒè¯•å™¨ã€‚\nè°ƒè¯•å™¨æ˜¯ä¸€ç§å¯ä»¥å…è®¸æˆ‘ä»¬å’Œæ­£åœ¨æ‰§è¡Œçš„ç¨‹åºè¿›è¡Œäº¤äº’çš„ç¨‹åºï¼Œå®ƒå¯ä»¥åšåˆ°ï¼š\nå½“åˆ°è¾¾æŸä¸€è¡Œæ—¶å°†ç¨‹åºæš‚åœï¼› ä¸€æ¬¡ä¸€æ¡æŒ‡ä»¤åœ°é€æ­¥æ‰§è¡Œç¨‹åºï¼› ç¨‹åºå´©æºƒåæŸ¥çœ‹å˜é‡çš„å€¼ï¼› æ»¡è¶³ç‰¹å®šæ¡ä»¶æ˜¯æš‚åœç¨‹åºï¼› å…¶ä»–é«˜çº§åŠŸèƒ½ã€‚ å¾ˆå¤šç¼–ç¨‹è¯­è¨€éƒ½æœ‰è‡ªå·±çš„è°ƒè¯•å™¨ã€‚Python çš„è°ƒè¯•å™¨æ˜¯pdb.\nä¸‹é¢å¯¹pdb æ”¯æŒå¯¹å‘½ä»¤è¿›è¡Œç®€å•å¯¹ä»‹ç»ï¼š\nl(ist) - æ˜¾ç¤ºå½“å‰è¡Œé™„è¿‘çš„11è¡Œæˆ–ç»§ç»­æ‰§è¡Œä¹‹å‰çš„æ˜¾ç¤ºï¼› s(tep) - æ‰§è¡Œå½“å‰è¡Œï¼Œå¹¶åœ¨ç¬¬ä¸€ä¸ªå¯èƒ½çš„åœ°æ–¹åœæ­¢ n(ext) - ç»§ç»­æ‰§è¡Œç›´åˆ°å½“å‰å‡½æ•°çš„ä¸‹ä¸€æ¡è¯­å¥æˆ–è€… return è¯­å¥ï¼› b(reak) - è®¾ç½®æ–­ç‚¹ï¼ˆåŸºäºä¼ å…¥å¯¹å‚æ•°ï¼‰ï¼› p(rint) - åœ¨å½“å‰ä¸Šä¸‹æ–‡å¯¹è¡¨è¾¾å¼æ±‚å€¼å¹¶æ‰“å°ç»“æœã€‚è¿˜æœ‰ä¸€ä¸ªå‘½ä»¤æ˜¯pp ï¼Œå®ƒä½¿ç”¨ pprint æ‰“å°ï¼› r(eturn) - ç»§ç»­æ‰§è¡Œç›´åˆ°å½“å‰å‡½æ•°è¿”å›ï¼› q(uit) - é€€å‡ºè°ƒè¯•å™¨ã€‚ è®©æˆ‘ä»¬ä½¿ç”¨pdb æ¥ä¿®å¤ä¸‹é¢çš„ Python ä»£ç ï¼ˆå‚è€ƒè®²åº§è§†é¢‘ï¼‰\ndef bubble_sort(arr): n = len(arr) for i in range(n): for j in range(n): if arr[j] \u0026gt; arr[j+1]: arr[j] = arr[j+1] arr[j+1] = arr[j] return arr print(bubble_sort([4, 2, 1, 8, 7, 6])) æ³¨æ„ï¼Œå› ä¸º Python æ˜¯ä¸€ç§è§£é‡Šå‹è¯­è¨€ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ pdb shell æ‰§è¡Œå‘½ä»¤ã€‚ ipdb æ˜¯ä¸€ç§å¢å¼ºå‹çš„ pdb ï¼Œå®ƒä½¿ç”¨IPython ä½œä¸º REPLå¹¶å¼€å¯äº† tab è¡¥å…¨ã€è¯­æ³•é«˜äº®ã€æ›´å¥½çš„å›æº¯å’Œæ›´å¥½çš„å†…çœï¼ŒåŒæ—¶è¿˜ä¿ç•™äº†pdb æ¨¡å—ç›¸åŒçš„æ¥å£ã€‚\nå¯¹äºæ›´åº•å±‚çš„ç¼–ç¨‹è¯­è¨€ï¼Œæ‚¨å¯èƒ½éœ€è¦äº†è§£ä¸€ä¸‹ gdb ( ä»¥åŠå®ƒçš„æ”¹è¿›ç‰ˆ pwndbg) å’Œ lldbã€‚\nå®ƒä»¬éƒ½å¯¹ç±» C è¯­è¨€çš„è°ƒè¯•è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå®ƒå…è®¸æ‚¨æ¢ç´¢ä»»æ„è¿›ç¨‹åŠå…¶æœºå™¨çŠ¶æ€ï¼šå¯„å­˜å™¨ã€å †æ ˆã€ç¨‹åºè®¡æ•°å™¨ç­‰ã€‚\nä¸“é—¨å·¥å…· å³ä½¿æ‚¨éœ€è¦è°ƒè¯•çš„ç¨‹åºæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶çš„é»‘ç›’ç¨‹åºï¼Œä»ç„¶æœ‰ä¸€äº›å·¥å…·å¯ä»¥å¸®åŠ©åˆ°æ‚¨ã€‚å½“æ‚¨çš„ç¨‹åºéœ€è¦æ‰§è¡Œä¸€äº›åªæœ‰æ“ä½œç³»ç»Ÿå†…æ ¸æ‰èƒ½å®Œæˆçš„æ“ä½œæ—¶ï¼Œå®ƒéœ€è¦ä½¿ç”¨ ç³»ç»Ÿè°ƒç”¨ã€‚æœ‰ä¸€äº›å‘½ä»¤å¯ä»¥å¸®åŠ©æ‚¨è¿½è¸ªæ‚¨çš„ç¨‹åºæ‰§è¡Œçš„ç³»ç»Ÿè°ƒç”¨ã€‚åœ¨ Linux ä¸­å¯ä»¥ä½¿ç”¨strace ï¼Œåœ¨ macOS å’Œ BSD ä¸­å¯ä»¥ä½¿ç”¨ dtraceã€‚dtrace ç”¨èµ·æ¥å¯èƒ½æœ‰äº›åˆ«æ‰­ï¼Œå› ä¸ºå®ƒä½¿ç”¨çš„æ˜¯å®ƒè‡ªæœ‰çš„ D è¯­è¨€ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå«åš dtruss çš„å°è£…ä½¿å…¶å…·æœ‰å’Œ strace (æ›´å¤šä¿¡æ¯å‚è€ƒ è¿™é‡Œ)ç±»ä¼¼çš„æ¥å£\nä¸‹é¢çš„ä¾‹å­å±•ç°æ¥å¦‚ä½•ä½¿ç”¨ strace æˆ– dtruss æ¥æ˜¾ç¤ºls æ‰§è¡Œæ—¶ï¼Œå¯¹stat ç³»ç»Ÿè°ƒç”¨è¿›è¡Œè¿½è¸ªå¯¹ç»“æœã€‚è‹¥éœ€è¦æ·±å…¥äº†è§£ straceï¼Œè¿™ç¯‡æ–‡ç«  å€¼å¾—ä¸€è¯»ã€‚\n# On Linux sudo strace -e lstat ls -l \u0026gt; /dev/null 4 # On macOS sudo dtruss -t lstat64_extended ls -l \u0026gt; /dev/null æœ‰äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦æŸ¥çœ‹ç½‘ç»œæ•°æ®åŒ…æ‰èƒ½å®šä½é—®é¢˜ã€‚åƒ tcpdump å’Œ Wireshark è¿™æ ·çš„ç½‘ç»œæ•°æ®åŒ…åˆ†æå·¥å…·å¯ä»¥å¸®åŠ©æ‚¨è·å–ç½‘ç»œæ•°æ®åŒ…çš„å†…å®¹å¹¶åŸºäºä¸åŒçš„æ¡ä»¶è¿›è¡Œè¿‡æ»¤ã€‚\nå¯¹äº web å¼€å‘ï¼Œ Chrome/Firefox çš„å¼€å‘è€…å·¥å…·éå¸¸æ–¹ä¾¿ï¼ŒåŠŸèƒ½ä¹Ÿå¾ˆå¼ºå¤§ï¼š\næºç  -æŸ¥çœ‹ä»»æ„ç«™ç‚¹çš„ HTML/CSS/JS æºç ï¼› å®æ—¶åœ°ä¿®æ”¹ HTML, CSS, JS ä»£ç  - ä¿®æ”¹ç½‘ç«™çš„å†…å®¹ã€æ ·å¼å’Œè¡Œä¸ºç”¨äºæµ‹è¯•ï¼ˆä»è¿™ä¸€ç‚¹æ‚¨ä¹Ÿèƒ½çœ‹å‡ºæ¥ï¼Œç½‘é¡µæˆªå›¾æ˜¯ä¸å¯é çš„ï¼‰ï¼› Javascript shell - åœ¨ JS REPLä¸­æ‰§è¡Œå‘½ä»¤ï¼› ç½‘ç»œ - åˆ†æè¯·æ±‚çš„æ—¶é—´çº¿ï¼› å­˜å‚¨ - æŸ¥çœ‹ Cookies å’Œæœ¬åœ°åº”ç”¨å­˜å‚¨ã€‚ é™æ€åˆ†æ æœ‰äº›é—®é¢˜æ˜¯æ‚¨ä¸éœ€è¦æ‰§è¡Œä»£ç å°±èƒ½å‘ç°çš„ã€‚ä¾‹å¦‚ï¼Œä»”ç»†è§‚å¯Ÿä¸€æ®µä»£ç ï¼Œæ‚¨å°±èƒ½å‘ç°æŸä¸ªå¾ªç¯å˜é‡è¦†ç›–äº†æŸä¸ªå·²ç»å­˜åœ¨çš„å˜é‡æˆ–å‡½æ•°åï¼›æˆ–æ˜¯æœ‰ä¸ªå˜é‡åœ¨è¢«è¯»å–ä¹‹å‰å¹¶æ²¡æœ‰è¢«å®šä¹‰ã€‚ è¿™ç§æƒ…å†µä¸‹ é™æ€åˆ†æ å·¥å…·å°±å¯ä»¥å¸®æˆ‘ä»¬æ‰¾åˆ°é—®é¢˜ã€‚é™æ€åˆ†æä¼šå°†ç¨‹åºçš„æºç ä½œä¸ºè¾“å…¥ç„¶ååŸºäºç¼–ç è§„åˆ™å¯¹å…¶è¿›è¡Œåˆ†æå¹¶å¯¹ä»£ç çš„æ­£ç¡®æ€§è¿›è¡Œæ¨ç†ã€‚\nä¸‹é¢è¿™æ®µ Python ä»£ç ä¸­å­˜åœ¨å‡ ä¸ªé—®é¢˜ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬çš„å¾ªç¯å˜é‡foo è¦†ç›–äº†ä¹‹å‰å®šä¹‰çš„å‡½æ•°fooã€‚æœ€åä¸€è¡Œï¼Œæˆ‘ä»¬è¿˜æŠŠ bar é”™å†™æˆäº†bazï¼Œå› æ­¤å½“ç¨‹åºå®Œæˆsleep (ä¸€åˆ†é’Ÿå)åï¼Œæ‰§è¡Œåˆ°è¿™ä¸€è¡Œçš„æ—¶å€™ä¾¿ä¼šå´©æºƒã€‚\nimport time def foo(): return 42 for foo in range(5): print(foo) bar = 1 bar *= 0.2 time.sleep(60) print(baz) é™æ€åˆ†æå·¥å…·å¯ä»¥å‘ç°æ­¤ç±»çš„é—®é¢˜ã€‚å½“æˆ‘ä»¬ä½¿ç”¨pyflakes åˆ†æä»£ç çš„ä¼¼ä¹ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸è¿™ä¸¤å¤„ bug ç›¸å…³çš„é”™è¯¯ä¿¡æ¯ã€‚mypy åˆ™æ˜¯å¦å¤–ä¸€ä¸ªå·¥å…·ï¼Œå®ƒå¯ä»¥å¯¹ä»£ç è¿›è¡Œç±»å‹æ£€æŸ¥ã€‚è¿™é‡Œï¼Œmypy ä¼šç»è¿‡æˆ‘ä»¬bar èµ·åˆæ˜¯ä¸€ä¸ª int ï¼Œç„¶åå˜æˆäº† floatã€‚è¿™äº›é—®é¢˜éƒ½å¯ä»¥åœ¨ä¸å…è®¸ä»£ç çš„æƒ…å†µä¸‹è¢«å‘ç°ã€‚\nåœ¨ shell å·¥å…·é‚£ä¸€èŠ‚è¯¾çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä»‹ç»äº† shellcheckï¼Œè¿™æ˜¯ä¸€ä¸ªç±»ä¼¼çš„å·¥å…·ï¼Œä½†å®ƒæ˜¯åº”ç”¨äº shell è„šæœ¬çš„ã€‚\n$ pyflakes foobar.py foobar.py:6: redefinition of unused \u0026#39;foo\u0026#39; from line 3 foobar.py:11: undefined name \u0026#39;baz\u0026#39; $ mypy foobar.py foobar.py:6: error: Incompatible types in assignment (expression has type \u0026#34;int\u0026#34;, variable has type \u0026#34;Callable[[], Any]\u0026#34;) foobar.py:9: error: Incompatible types in assignment (expression has type \u0026#34;float\u0026#34;, variable has type \u0026#34;int\u0026#34;) foobar.py:11: error: Name \u0026#39;baz\u0026#39; is not defined Found 3 errors in 1 file (checked 1 source file) å¤§å¤šæ•°çš„ç¼–è¾‘å™¨å’Œ IDE éƒ½æ”¯æŒåœ¨ç¼–è¾‘ç•Œé¢æ˜¾ç¤ºè¿™äº›å·¥å…·çš„åˆ†æç»“æœã€é«˜äº®æœ‰è­¦å‘Šå’Œé”™è¯¯çš„ä½ç½®ã€‚ è¿™ä¸ªè¿‡ç¨‹é€šå¸¸æˆä¸º code linting ã€‚é£æ ¼æ£€æŸ¥æˆ–å®‰å…¨æ£€æŸ¥çš„ç»“æœåŒæ ·ä¹Ÿå¯ä»¥è¿›è¡Œç›¸åº”çš„æ˜¾ç¤ºã€‚\nåœ¨ vim ä¸­ï¼Œæœ‰ ale æˆ– syntastic å¯ä»¥å¸®åŠ©æ‚¨åšåŒæ ·çš„äº‹æƒ…ã€‚ åœ¨ Python ä¸­ï¼Œ pylint å’Œ pep8 æ˜¯ä¸¤ç§ç”¨äºè¿›è¡Œé£æ ¼æ£€æŸ¥çš„å·¥å…·ï¼Œè€Œ bandit å·¥å…·åˆ™ç”¨äºæ£€æŸ¥å®‰å…¨ç›¸å…³çš„é—®é¢˜ã€‚\nå¯¹äºå…¶ä»–è¯­è¨€çš„å¼€å‘è€…æ¥è¯´ï¼Œé™æ€åˆ†æå·¥å…·å¯ä»¥å‚è€ƒè¿™ä¸ªåˆ—è¡¨ï¼šAwesome Static Analysis (æ‚¨ä¹Ÿè®¸ä¼šå¯¹ Writing ä¸€èŠ‚æ„Ÿå…´è¶£) ã€‚å¯¹äº linters åˆ™å¯ä»¥å‚è€ƒè¿™ä¸ªåˆ—è¡¨ï¼š Awesome Lintersã€‚\nå¯¹äºé£æ ¼æ£€æŸ¥å’Œä»£ç æ ¼å¼åŒ–ï¼Œè¿˜æœ‰ä»¥ä¸‹ä¸€äº›å·¥å…·å¯ä»¥ä½œä¸ºè¡¥å……ï¼šç”¨äº Python çš„ blackã€ç”¨äº Go è¯­è¨€çš„ gofmtã€ç”¨äº Rust çš„ rustfmt æˆ–æ˜¯ç”¨äº JavaScript, HTML å’Œ CSS çš„ prettier ã€‚è¿™äº›å·¥å…·å¯ä»¥è‡ªåŠ¨æ ¼å¼åŒ–æ‚¨çš„ä»£ç ï¼Œè¿™æ ·ä»£ç é£æ ¼å°±å¯ä»¥ä¸å¸¸è§çš„é£æ ¼ä¿æŒä¸€è‡´ã€‚ å°½ç®¡æ‚¨å¯èƒ½å¹¶ä¸æƒ³å¯¹ä»£ç è¿›è¡Œé£æ ¼æ§åˆ¶ï¼Œæ ‡å‡†çš„ä»£ç é£æ ¼æœ‰åŠ©äºæ–¹ä¾¿åˆ«äººé˜…è¯»æ‚¨çš„ä»£ç ï¼Œä¹Ÿå¯ä»¥æ–¹ä¾¿æ‚¨é˜…è¯»å®ƒçš„ä»£ç ã€‚\næ€§èƒ½åˆ†æ å³ä½¿æ‚¨çš„ä»£ç èƒ½å¤Ÿå‘æ‚¨æœŸæœ›çš„ä¸€æ ·è¿è¡Œï¼Œä½†æ˜¯å¦‚æœå®ƒæ¶ˆè€—äº†æ‚¨å…¨éƒ¨çš„ CPU å’Œå†…å­˜ï¼Œé‚£ä¹ˆå®ƒæ˜¾ç„¶ä¹Ÿä¸æ˜¯ä¸ªå¥½ç¨‹åºã€‚ç®—æ³•è¯¾ä¸Šæˆ‘ä»¬é€šå¸¸ä¼šä»‹ç»å¤§Oæ ‡è®°æ³•ï¼Œä½†å´æ²¡äº¤ç»™æˆ‘ä»¬å¦‚ä½•æ‰¾åˆ°ç¨‹åºä¸­çš„çƒ­ç‚¹ã€‚ é‰´äº è¿‡æ—©çš„ä¼˜åŒ–æ˜¯ä¸‡æ¶ä¹‹æºï¼Œæ‚¨éœ€è¦å­¦ä¹ æ€§èƒ½åˆ†æå’Œç›‘æ§å·¥å…·ï¼Œå®ƒä»¬ä¼šå¸®åŠ©æ‚¨æ‰¾åˆ°ç¨‹åºä¸­æœ€è€—æ—¶ã€æœ€è€—èµ„æºçš„éƒ¨åˆ†ï¼Œè¿™æ ·æ‚¨å°±å¯ä»¥æœ‰é’ˆå¯¹æ€§çš„è¿›è¡Œæ€§èƒ½ä¼˜åŒ–ã€‚\nè®¡æ—¶ å’Œè°ƒè¯•ä»£ç ç±»ä¼¼ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬åªéœ€è¦æ‰“å°ä¸¤å¤„ä»£ç ä¹‹é—´çš„æ—¶é—´å³å¯å‘ç°é—®é¢˜ã€‚ä¸‹é¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† Python çš„ timeæ¨¡å—ã€‚\nimport time, random n = random.randint(1, 10) * 100 ### è·å–å½“å‰æ—¶é—´ start = time.time() ### æ‰§è¡Œä¸€äº›æ“ä½œ print(\u0026#34;Sleeping for {} ms\u0026#34;.format(n)) time.sleep(n/1000) ### æ¯”è¾ƒå½“å‰æ—¶é—´å’Œèµ·å§‹æ—¶é—´ print(time.time() - start) # Output # Sleeping for 500 ms ### 0.5713930130004883 ä¸è¿‡ï¼Œæ‰§è¡Œæ—¶é—´ï¼ˆwall clock timeï¼‰ä¹Ÿå¯èƒ½ä¼šè¯¯å¯¼æ‚¨ï¼Œå› ä¸ºæ‚¨çš„ç”µè„‘å¯èƒ½ä¹Ÿåœ¨åŒæ—¶è¿è¡Œå…¶ä»–è¿›ç¨‹ï¼Œä¹Ÿå¯èƒ½åœ¨æ­¤æœŸé—´å‘ç”Ÿäº†ç­‰å¾…ã€‚ å¯¹äºå·¥å…·æ¥è¯´ï¼Œéœ€è¦åŒºåˆ†çœŸå®æ—¶é—´ã€ç”¨æˆ·æ—¶é—´å’Œç³»ç»Ÿæ—¶é—´ã€‚é€šå¸¸æ¥è¯´ï¼Œç”¨æˆ·æ—¶é—´+ç³»ç»Ÿæ—¶é—´ä»£è¡¨äº†æ‚¨çš„è¿›ç¨‹æ‰€æ¶ˆè€—çš„å®é™… CPU ï¼ˆæ›´è¯¦ç»†çš„è§£é‡Šå¯ä»¥å‚ç…§è¿™ç¯‡æ–‡ç« ï¼‰ã€‚\nçœŸå®æ—¶é—´ - ä»ç¨‹åºå¼€å§‹åˆ°ç»“æŸæµå¤±æ‰åˆ°çœŸå®æ—¶é—´ï¼ŒåŒ…æ‹¬å…¶ä»–è¿›ç¨‹åˆ°æ‰§è¡Œæ—¶é—´ä»¥åŠé˜»å¡æ¶ˆè€—çš„æ—¶é—´ï¼ˆä¾‹å¦‚ç­‰å¾… I/Oæˆ–ç½‘ç»œï¼‰ï¼› User - CPU æ‰§è¡Œç”¨æˆ·ä»£ç æ‰€èŠ±è´¹çš„æ—¶é—´ï¼› Sys - CPU æ‰§è¡Œç³»ç»Ÿå†…æ ¸ä»£ç æ‰€èŠ±è´¹çš„æ—¶é—´ã€‚ ä¾‹å¦‚ï¼Œè¯•ç€æ‰§è¡Œä¸€ä¸ªç”¨äºå‘èµ· HTTP è¯·æ±‚çš„å‘½ä»¤å¹¶åœ¨å…¶å‰é¢æ·»åŠ  time å‰ç¼€ã€‚ç½‘ç»œä¸å¥½çš„æƒ…å†µä¸‹æ‚¨å¯èƒ½ä¼šçœ‹åˆ°ä¸‹é¢çš„è¾“å‡ºç»“æœã€‚è¯·æ±‚èŠ±è´¹äº† 2s æ‰å®Œæˆï¼Œä½†æ˜¯è¿›ç¨‹ä»…èŠ±è´¹äº† 15ms çš„ CPU ç”¨æˆ·æ—¶é—´å’Œ 12ms çš„ CPU å†…æ ¸æ—¶é—´ã€‚\n$ time curl https://missing.csail.mit.edu \u0026amp;\u0026gt; /dev/null` real 0m2.561s user 0m0.015s sys 0m0.012s æ€§èƒ½åˆ†æå·¥å…·ï¼ˆprofilersï¼‰ CPU å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå½“äººä»¬æåŠæ€§èƒ½åˆ†æå·¥å…·çš„æ—¶å€™ï¼Œé€šå¸¸æŒ‡çš„æ˜¯ CPU æ€§èƒ½åˆ†æå·¥å…·ã€‚ CPU æ€§èƒ½åˆ†æå·¥å…·æœ‰ä¸¤ç§ï¼š è¿½è¸ªåˆ†æå™¨ï¼ˆtracingï¼‰åŠé‡‡æ ·åˆ†æå™¨ï¼ˆsamplingï¼‰ã€‚ è¿½è¸ªåˆ†æå™¨ ä¼šè®°å½•ç¨‹åºçš„æ¯ä¸€æ¬¡å‡½æ•°è°ƒç”¨ï¼Œè€Œé‡‡æ ·åˆ†æå™¨åˆ™åªä¼šå‘¨æœŸæ€§çš„ç›‘æµ‹ï¼ˆé€šå¸¸ä¸ºæ¯æ¯«ç§’ï¼‰æ‚¨çš„ç¨‹åºå¹¶è®°å½•ç¨‹åºå †æ ˆã€‚å®ƒä»¬ä½¿ç”¨è¿™äº›è®°å½•æ¥ç”Ÿæˆç»Ÿè®¡ä¿¡æ¯ï¼Œæ˜¾ç¤ºç¨‹åºåœ¨å“ªäº›äº‹æƒ…ä¸ŠèŠ±è´¹äº†æœ€å¤šçš„æ—¶é—´ã€‚å¦‚æœæ‚¨å¸Œæœ›äº†è§£æ›´å¤šç›¸å…³ä¿¡æ¯ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡ ä»‹ç»æ€§çš„æ–‡ç« ã€‚\nå¤§å¤šæ•°çš„ç¼–ç¨‹è¯­è¨€éƒ½æœ‰ä¸€äº›åŸºäºå‘½ä»¤è¡Œéƒ½åˆ†æå™¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒä»¬æ¥åˆ†æä»£ç ã€‚å®ƒä»¬é€šå¸¸å¯ä»¥é›†æˆåœ¨ IDE ä¸­ï¼Œä½†æ˜¯æœ¬èŠ‚è¯¾æˆ‘ä»¬ä¼šä¸“æ³¨äºè¿™äº›å‘½ä»¤è¡Œå·¥å…·æœ¬èº«ã€‚\nåœ¨ Python ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ cProfile æ¨¡å—æ¥åˆ†ææ¯æ¬¡å‡½æ•°è°ƒç”¨æ‰€æ¶ˆè€—éƒ½æ—¶é—´ã€‚ åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ªåŸºç¡€çš„ grep å‘½ä»¤ï¼š\n#!/usr/bin/env python import sys, re def grep(pattern, file): with open(file, \u0026#39;r\u0026#39;) as f: print(file) for i, line in enumerate(f.readlines()): pattern = re.compile(pattern) match = pattern.search(line) if match is not None: print(\u0026#34;{}: {}\u0026#34;.format(i, line), end=\u0026#34;\u0026#34;) if __name__ == \u0026#39;__main__\u0026#39;: times = int(sys.argv[1]) pattern = sys.argv[2] for i in range(times): for file in sys.argv[3:]: grep(pattern, file) æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥å¯¹è¿™æ®µä»£ç è¿›è¡Œåˆ†æã€‚é€šè¿‡å®ƒçš„è¾“å‡ºæˆ‘ä»¬å¯ä»¥ç›´åˆ°ï¼ŒIO æ¶ˆè€—äº†å¤§é‡çš„æ—¶é—´ï¼Œç¼–è¯‘æ­£åˆ™è¡¨è¾¾å¼ä¹Ÿæ¯”è¾ƒè€—è´¹æ—¶é—´ã€‚å› ä¸ºæ­£åˆ™è¡¨è¾¾å¼åªéœ€è¦ç¼–è¯‘ä¸€æ¬¡ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ç§»åŠ¨åˆ° for å¾ªç¯å¤–é¢æ¥æ”¹è¿›æ€§èƒ½ã€‚\n$ python -m cProfile -s tottime grep.py 1000 \u0026#39;^(import|\\s*def)[^,]*$\u0026#39; *.py [omitted program output] ncalls tottime percall cumtime percall filename:lineno(function) 8000 0.266 0.000 0.292 0.000 {built-in method io.open} 8000 0.153 0.000 0.894 0.000 grep.py:5(grep) 17000 0.101 0.000 0.101 0.000 {built-in method builtins.print} 8000 0.100 0.000 0.129 0.000 {method \u0026#39;readlines\u0026#39; of \u0026#39;_io._IOBase\u0026#39; objects} 93000 0.097 0.000 0.111 0.000 re.py:286(_compile) 93000 0.069 0.000 0.069 0.000 {method \u0026#39;search\u0026#39; of \u0026#39;_sre.SRE_Pattern\u0026#39; objects} 93000 0.030 0.000 0.141 0.000 re.py:231(compile) 17000 0.019 0.000 0.029 0.000 codecs.py:318(decode) 1 0.017 0.017 0.911 0.911 grep.py:3(\u0026lt;module\u0026gt;) [omitted lines] å…³äº Python çš„ cProfile åˆ†æå™¨ï¼ˆä»¥åŠå…¶ä»–ä¸€äº›ç±»ä¼¼çš„ä¸€äº›åˆ†æå™¨ï¼‰ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å®ƒæ˜¾ç¤ºçš„æ˜¯æ¯æ¬¡å‡½æ•°è°ƒç”¨çš„æ—¶é—´ã€‚çœ‹ä¸Šå»å¯èƒ½å¿«åˆ°åç›´è§‰ï¼Œå°¤å…¶æ˜¯å¦‚æœæ‚¨åœ¨ä»£ç é‡Œé¢ä½¿ç”¨äº†ç¬¬ä¸‰æ–¹çš„å‡½æ•°åº“ï¼Œå› ä¸ºå†…éƒ¨å‡½æ•°è°ƒç”¨ä¹Ÿä¼šè¢«çœ‹ä½œå‡½æ•°è°ƒç”¨ã€‚\næ›´åŠ ç¬¦åˆç›´è§‰çš„æ˜¾ç¤ºåˆ†æä¿¡æ¯çš„æ–¹å¼æ˜¯åŒ…æ‹¬æ¯è¡Œä»£ç çš„æ‰§è¡Œæ—¶é—´ï¼Œè¿™ä¹Ÿæ˜¯è¡Œåˆ†æå™¨çš„å·¥ä½œã€‚ä¾‹å¦‚ï¼Œä¸‹é¢è¿™æ®µ Python ä»£ç ä¼šå‘æœ¬è¯¾ç¨‹çš„ç½‘ç«™å‘èµ·ä¸€ä¸ªè¯·æ±‚ï¼Œç„¶åè§£æå“åº”è¿”å›çš„é¡µé¢ä¸­çš„å…¨éƒ¨ URLï¼š\n#!/usr/bin/env python import requests from bs4 import BeautifulSoup ### è¿™ä¸ªè£…é¥°å™¨ä¼šå‘Šè¯‰è¡Œåˆ†æå™¨ ### æˆ‘ä»¬æƒ³è¦åˆ†æè¿™ä¸ªå‡½æ•° @profile def get_urls(): response = requests.get(\u0026#39;https://missing.csail.mit.edu\u0026#39;) s = BeautifulSoup(response.content, \u0026#39;lxml\u0026#39;) urls = [] for url in s.find_all(\u0026#39;a\u0026#39;): urls.append(url[\u0026#39;href\u0026#39;]) if __name__ == \u0026#39;__main__\u0026#39;: get_urls() å¦‚æœæˆ‘ä»¬ä½¿ç”¨ Python çš„ cProfile åˆ†æå™¨ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°è¶…è¿‡2500è¡Œçš„è¾“å‡ºç»“æœï¼Œå³ä½¿å¯¹å…¶è¿›è¡Œæ’åºï¼Œæˆ‘ä»ç„¶æä¸æ‡‚æ—¶é—´åˆ°åº•éƒ½èŠ±åœ¨å“ªäº†ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨ line_profilerï¼Œå®ƒä¼šåŸºäºè¡Œæ¥æ˜¾ç¤ºæ—¶é—´ï¼š\n$ kernprof -l -v a.py Wrote profile results to urls.py.lprof Timer unit: 1e-06 s Total time: 0.636188 s File: a.py Function: get_urls at line 5 Line ### Hits Time Per Hit % Time Line Contents ============================================================== 5 @profile 6 def get_urls(): 7 1 613909.0 613909.0 96.5 response = requests.get(\u0026#39;https://missing.csail.mit.edu\u0026#39;) 8 1 21559.0 21559.0 3.4 s = BeautifulSoup(response.content, \u0026#39;lxml\u0026#39;) 9 1 2.0 2.0 0.0 urls = [] 10 25 685.0 27.4 0.1 for url in s.find_all(\u0026#39;a\u0026#39;): 11 24 33.0 1.4 0.0 urls.append(url[\u0026#39;href\u0026#39;]) å†…å­˜ åƒ C æˆ–è€… C++ è¿™æ ·çš„è¯­è¨€ï¼Œå†…å­˜æ³„æ¼ä¼šå¯¼è‡´æ‚¨çš„ç¨‹åºåœ¨ä½¿ç”¨å®Œå†…å­˜åä¸å»é‡Šæ”¾å®ƒã€‚ä¸ºäº†åº”å¯¹å†…å­˜ç±»çš„ Bugï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç±»ä¼¼ Valgrind è¿™æ ·çš„å·¥å…·æ¥æ£€æŸ¥å†…å­˜æ³„æ¼é—®é¢˜ã€‚\nå¯¹äº Python è¿™ç±»å…·æœ‰åƒåœ¾å›æ”¶æœºåˆ¶çš„è¯­è¨€ï¼Œå†…å­˜åˆ†æå™¨ä¹Ÿæ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œå› ä¸ºå¯¹äºæŸä¸ªå¯¹è±¡æ¥è¯´ï¼Œåªè¦æœ‰æŒ‡é’ˆè¿˜æŒ‡å‘å®ƒï¼Œé‚£å®ƒå°±ä¸ä¼šè¢«å›æ”¶ã€‚\nä¸‹é¢è¿™ä¸ªä¾‹å­åŠå…¶è¾“å‡ºï¼Œå±•ç¤ºäº† memory-profiler æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼ˆæ³¨æ„è£…é¥°å™¨å’Œ line-profiler ç±»ä¼¼ï¼‰ã€‚\n@profile def my_func(): a = [1] * (10 ** 6) b = [2] * (2 * 10 ** 7) del b return a if __name__ == \u0026#39;__main__\u0026#39;: my_func() $ python -m memory_profiler example.py Line ### Mem usage Increment Line Contents ============================================== 3 @profile 4 5.97 MB 0.00 MB def my_func(): 5 13.61 MB 7.64 MB a = [1] * (10 ** 6) 6 166.20 MB 152.59 MB b = [2] * (2 * 10 ** 7) 7 13.61 MB -152.59 MB del b 8 13.61 MB 0.00 MB return a äº‹ä»¶åˆ†æ åœ¨æˆ‘ä»¬ä½¿ç”¨straceè°ƒè¯•ä»£ç çš„æ—¶å€™ï¼Œæ‚¨å¯èƒ½ä¼šå¸Œæœ›å¿½ç•¥ä¸€äº›ç‰¹æ®Šçš„ä»£ç å¹¶å¸Œæœ›åœ¨åˆ†ææ—¶å°†å…¶å½“ä½œé»‘ç›’å¤„ç†ã€‚perf å‘½ä»¤å°† CPU çš„åŒºåˆ«è¿›è¡Œäº†æŠ½è±¡ï¼Œå®ƒä¸ä¼šæŠ¥å‘Šæ—¶é—´å’Œå†…å­˜çš„æ¶ˆè€—ï¼Œè€Œæ˜¯æŠ¥å‘Šä¸æ‚¨çš„ç¨‹åºç›¸å…³çš„ç³»ç»Ÿäº‹ä»¶ã€‚\nä¾‹å¦‚ï¼Œperf å¯ä»¥æŠ¥å‘Šä¸ä½³çš„ç¼“å­˜å±€éƒ¨æ€§ï¼ˆpoor cache localityï¼‰ã€å¤§é‡çš„é¡µé”™è¯¯ï¼ˆpage faultsï¼‰æˆ–æ´»é”ï¼ˆlivelocksï¼‰ã€‚ä¸‹é¢æ˜¯å…³äºå¸¸è§å‘½ä»¤çš„ç®€ä»‹ï¼š\nperf list - åˆ—å‡ºå¯ä»¥è¢« pref è¿½è¸ªçš„äº‹ä»¶ï¼› perf stat COMMAND ARG1 ARG2 - æ”¶é›†ä¸æŸä¸ªè¿›ç¨‹æˆ–æŒ‡ä»¤ç›¸å…³çš„äº‹ä»¶ï¼› perf record COMMAND ARG1 ARG2 - è®°å½•å‘½ä»¤æ‰§è¡Œçš„é‡‡æ ·ä¿¡æ¯å¹¶å°†ç»Ÿè®¡æ•°æ®å‚¨å­˜åœ¨perf.dataä¸­ï¼› perf report - æ ¼å¼åŒ–å¹¶æ‰“å° perf.data ä¸­çš„æ•°æ®ã€‚ å¯è§†åŒ– ä½¿ç”¨åˆ†æå™¨æ¥åˆ†æçœŸå®çš„ç¨‹åºæ—¶ï¼Œç”±äºè½¯ä»¶çš„å¤æ‚æ€§ï¼Œå…¶è¾“å‡ºç»“æœä¸­å°†åŒ…å«å¤§é‡çš„ä¿¡æ¯ã€‚äººç±»æ˜¯ä¸€ç§è§†è§‰åŠ¨ç‰©ï¼Œéå¸¸ä¸å–„äºé˜…è¯»å¤§é‡çš„æ–‡å­—ã€‚å› æ­¤å¾ˆå¤šå·¥å…·éƒ½æä¾›äº†å¯è§†åŒ–åˆ†æå™¨è¾“å‡ºç»“æœçš„åŠŸèƒ½ã€‚\nå¯¹äºé‡‡æ ·åˆ†æå™¨æ¥è¯´ï¼Œå¸¸è§çš„æ˜¾ç¤º CPU åˆ†ææ•°æ®çš„å½¢å¼æ˜¯ ç«ç„°å›¾ï¼Œç«ç„°å›¾ä¼šåœ¨ Y è½´æ˜¾ç¤ºå‡½æ•°è°ƒç”¨å…³ç³»ï¼Œå¹¶åœ¨ X è½´æ˜¾ç¤ºå…¶è€—æ—¶çš„æ¯”ä¾‹ã€‚ç«ç„°å›¾åŒæ—¶è¿˜æ˜¯å¯äº¤äº’çš„ï¼Œæ‚¨å¯ä»¥æ·±å…¥ç¨‹åºçš„æŸä¸€å…·ä½“éƒ¨åˆ†ï¼Œå¹¶æŸ¥çœ‹å…¶æ ˆè¿½è¸ªï¼ˆæ‚¨å¯ä»¥å°è¯•ç‚¹å‡»ä¸‹é¢çš„å›¾ç‰‡ï¼‰ã€‚\nè°ƒç”¨å›¾å’Œæ§åˆ¶æµå›¾å¯ä»¥æ˜¾ç¤ºå­ç¨‹åºä¹‹é—´çš„å…³ç³»ï¼Œå®ƒå°†å‡½æ•°ä½œä¸ºèŠ‚ç‚¹å¹¶æŠŠå‡½æ•°è°ƒç”¨ä½œä¸ºè¾¹ã€‚å°†å®ƒä»¬å’Œåˆ†æå™¨çš„ä¿¡æ¯ï¼ˆä¾‹å¦‚è°ƒç”¨æ¬¡æ•°ã€è€—æ—¶ç­‰ï¼‰æ”¾åœ¨ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œè°ƒç”¨å›¾ä¼šå˜å¾—éå¸¸æœ‰ç”¨ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬åˆ†æç¨‹åºçš„æµç¨‹ã€‚ åœ¨ Python ä¸­æ‚¨å¯ä»¥ä½¿ç”¨ pycallgraph æ¥ç”Ÿæˆè¿™äº›å›¾ç‰‡ã€‚\nèµ„æºç›‘æ§ æœ‰æ—¶å€™ï¼Œåˆ†æç¨‹åºæ€§èƒ½çš„ç¬¬ä¸€æ­¥æ˜¯ææ¸…æ¥šå®ƒæ‰€æ¶ˆè€—çš„èµ„æºã€‚ç¨‹åºå˜æ…¢é€šå¸¸æ˜¯å› ä¸ºå®ƒæ‰€éœ€è¦çš„èµ„æºä¸å¤Ÿäº†ã€‚ä¾‹å¦‚ï¼Œæ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜æˆ–è€…ç½‘ç»œè¿æ¥å˜æ…¢çš„æ—¶å€™ã€‚\næœ‰å¾ˆå¤šå¾ˆå¤šçš„å·¥å…·å¯ä»¥è¢«ç”¨æ¥æ˜¾ç¤ºä¸åŒçš„ç³»ç»Ÿèµ„æºï¼Œä¾‹å¦‚ CPU å ç”¨ã€å†…å­˜ä½¿ç”¨ã€ç½‘ç»œã€ç£ç›˜ä½¿ç”¨ç­‰ã€‚\né€šç”¨ç›‘æ§ - æœ€æµè¡Œçš„å·¥å…·è¦æ•° htop,äº†ï¼Œå®ƒæ˜¯ topçš„æ”¹è¿›ç‰ˆã€‚htop å¯ä»¥æ˜¾ç¤ºå½“å‰è¿è¡Œè¿›ç¨‹çš„å¤šç§ç»Ÿè®¡ä¿¡æ¯ã€‚htop æœ‰å¾ˆå¤šé€‰é¡¹å’Œå¿«æ·é”®ï¼Œå¸¸è§çš„æœ‰ï¼š\u0026lt;F6\u0026gt; è¿›ç¨‹æ’åºã€ t æ˜¾ç¤ºæ ‘çŠ¶ç»“æ„å’Œ h æ‰“å¼€æˆ–æŠ˜å çº¿ç¨‹ã€‚ è¿˜å¯ä»¥ç•™æ„ä¸€ä¸‹ glances ï¼Œå®ƒçš„å®ç°ç±»ä¼¼ä½†æ˜¯ç”¨æˆ·ç•Œé¢æ›´å¥½ã€‚å¦‚æœéœ€è¦åˆå¹¶æµ‹é‡å…¨éƒ¨çš„è¿›ç¨‹ï¼Œ dstat æ˜¯ä¹Ÿæ˜¯ä¸€ä¸ªéå¸¸å¥½ç”¨çš„å·¥å…·ï¼Œå®ƒå¯ä»¥å®æ—¶åœ°è®¡ç®—ä¸åŒå­ç³»ç»Ÿèµ„æºçš„åº¦é‡æ•°æ®ï¼Œä¾‹å¦‚ I/Oã€ç½‘ç»œã€ CPU åˆ©ç”¨ç‡ã€ä¸Šä¸‹æ–‡åˆ‡æ¢ç­‰ç­‰ï¼› I/O æ“ä½œ - iotop å¯ä»¥æ˜¾ç¤ºå®æ—¶ I/O å ç”¨ä¿¡æ¯è€Œä¸”å¯ä»¥éå¸¸æ–¹ä¾¿åœ°æ£€æŸ¥æŸä¸ªè¿›ç¨‹æ˜¯å¦æ­£åœ¨æ‰§è¡Œå¤§é‡çš„ç£ç›˜è¯»å†™æ“ä½œï¼› ç£ç›˜ä½¿ç”¨ - df å¯ä»¥æ˜¾ç¤ºæ¯ä¸ªåˆ†åŒºçš„ä¿¡æ¯ï¼Œè€Œ du åˆ™å¯ä»¥æ˜¾ç¤ºå½“å‰ç›®å½•ä¸‹æ¯ä¸ªæ–‡ä»¶çš„ç£ç›˜ä½¿ç”¨æƒ…å†µï¼ˆ disk usageï¼‰ã€‚-h é€‰é¡¹å¯ä»¥ä½¿å‘½ä»¤ä½¿ç”¨å¯¹äººç±»ï¼ˆhumanï¼‰æ›´åŠ å‹å¥½çš„æ ¼å¼æ˜¾ç¤ºæ•°æ®ï¼›ncduæ˜¯ä¸€ä¸ªäº¤äº’æ€§æ›´å¥½çš„ du ï¼Œå®ƒå¯ä»¥è®©æ‚¨åœ¨ä¸åŒç›®å½•ä¸‹å¯¼èˆªã€åˆ é™¤æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼› å†…å­˜ä½¿ç”¨ - free å¯ä»¥æ˜¾ç¤ºç³»ç»Ÿå½“å‰ç©ºé—²çš„å†…å­˜ã€‚å†…å­˜ä¹Ÿå¯ä»¥ä½¿ç”¨ htop è¿™æ ·çš„å·¥å…·æ¥æ˜¾ç¤ºï¼› æ‰“å¼€æ–‡ä»¶ - lsof å¯ä»¥åˆ—å‡ºè¢«è¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶ä¿¡æ¯ã€‚ å½“æˆ‘ä»¬éœ€è¦æŸ¥çœ‹æŸä¸ªæ–‡ä»¶æ˜¯è¢«å“ªä¸ªè¿›ç¨‹æ‰“å¼€çš„æ—¶å€™ï¼Œè¿™ä¸ªå‘½ä»¤éå¸¸æœ‰ç”¨ï¼›. ç½‘ç»œè¿æ¥å’Œé…ç½® - ss leå¸®åŠ©æˆ‘ä»¬ç›‘æ§ç½‘ç»œåŒ…çš„æ”¶å‘æƒ…å†µä»¥åŠç½‘ç»œæ¥å£çš„æ˜¾ç¤ºä¿¡æ¯ã€‚ss å¸¸è§çš„ä¸€ä¸ªä½¿ç”¨åœºæ™¯æ˜¯æ‰¾åˆ°ç«¯å£è¢«è¿›ç¨‹å ç”¨çš„ä¿¡æ¯ã€‚å¦‚æœè¦æ˜¾ç¤ºè·¯ç”±ã€ç½‘ç»œè®¾å¤‡å’Œæ¥å£ä¿¡æ¯ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ ip å‘½ä»¤ã€‚æ³¨æ„ï¼Œnetstat å’Œ ifconfig è¿™ä¸¤ä¸ªå‘½ä»¤å·²ç»è¢«å‰é¢é‚£äº›å·¥å…·æ‰€ä»£æ›¿äº†ã€‚ ç½‘ç»œä½¿ç”¨ - nethogs å’Œ iftop æ˜¯éå¸¸å¥½çš„ç”¨äºå¯¹ç½‘ç»œå ç”¨è¿›è¡Œç›‘æ§çš„äº¤äº’å¼å‘½ä»¤è¡Œå·¥å…·ã€‚ å¦‚æœæ‚¨å¸Œæœ›æµ‹è¯•ä¸€ä¸‹è¿™äº›å·¥å…·ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ stress å‘½ä»¤æ¥ä¸ºç³»ç»Ÿäººä¸ºåœ°å¢åŠ è´Ÿè½½ã€‚\nä¸“ç”¨å·¥å…· æœ‰æ—¶å€™ï¼Œæ‚¨åªéœ€è¦å¯¹é»‘ç›’ç¨‹åºè¿›è¡ŒåŸºå‡†æµ‹è¯•ï¼Œå¹¶ä¾æ­¤å¯¹è½¯ä»¶é€‰æ‹©è¿›è¡Œè¯„ä¼°ã€‚ ç±»ä¼¼ hyperfine è¿™æ ·çš„å‘½ä»¤è¡Œå¯ä»¥å¸®æ‚¨å¿«é€Ÿè¿›è¡ŒåŸºå‡†æµ‹è¯•ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬åœ¨ shell å·¥å…·å’Œè„šæœ¬é‚£ä¸€èŠ‚è¯¾ä¸­æˆ‘ä»¬æ¨èä½¿ç”¨ fd æ¥ä»£æ›¿ findã€‚æˆ‘ä»¬è¿™é‡Œå¯ä»¥ç”¨hyperfineæ¥æ¯”è¾ƒä¸€ä¸‹å®ƒä»¬ã€‚\nä¾‹å¦‚ï¼Œä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°fd æ¯” find è¦å¿«20å€ã€‚\n$ hyperfine --warmup 3 \u0026#39;fd -e jpg\u0026#39; \u0026#39;find . -iname \u0026#34;*.jpg\u0026#34;\u0026#39; Benchmark #1: fd -e jpg Time (mean Â± Ïƒ): 51.4 ms Â± 2.9 ms [User: 121.0 ms, System: 160.5 ms] Range (min â€¦ max): 44.2 ms â€¦ 60.1 ms 56 runs Benchmark #2: find . -iname \u0026#34;*.jpg\u0026#34; Time (mean Â± Ïƒ): 1.126 s Â± 0.101 s [User: 141.1 ms, System: 956.1 ms] Range (min â€¦ max): 0.975 s â€¦ 1.287 s 10 runs Summary \u0026#39;fd -e jpg\u0026#39; ran 21.89 Â± 2.33 times faster than \u0026#39;find . -iname \u0026#34;*.jpg\u0026#34;\u0026#39; å’Œ debug ä¸€æ ·ï¼Œæµè§ˆå™¨ä¹ŸåŒ…å«äº†å¾ˆå¤šä¸é”™çš„æ€§èƒ½åˆ†æå·¥å…·ï¼Œå¯ä»¥ç”¨æ¥åˆ†æé¡µé¢åŠ è½½ï¼Œè®©æˆ‘ä»¬å¯ä»¥ææ¸…æ¥šæ—¶é—´éƒ½æ¶ˆè€—åœ¨ä»€ä¹ˆåœ°æ–¹ï¼ˆåŠ è½½ã€æ¸²æŸ“ã€è„šæœ¬ç­‰ç­‰ï¼‰ã€‚ æ›´å¤šå…³äº Firefox å’Œ Chromeçš„ä¿¡æ¯å¯ä»¥ç‚¹å‡»é“¾æ¥ã€‚\nè¯¾åç»ƒä¹  è°ƒè¯• ä½¿ç”¨ Linux ä¸Šçš„ journalctl æˆ– macOS ä¸Šçš„ log show å‘½ä»¤æ¥è·å–æœ€è¿‘ä¸€å¤©ä¸­è¶…çº§ç”¨æˆ·çš„ç™»é™†ä¿¡æ¯åŠå…¶æ‰€æ‰§è¡Œçš„æŒ‡ä»¤ã€‚å¦‚æœæ‰¾ä¸åˆ°ç›¸å…³ä¿¡æ¯ï¼Œæ‚¨å¯ä»¥æ‰§è¡Œä¸€äº›æ— å®³çš„å‘½ä»¤ï¼Œä¾‹å¦‚sudo ls ç„¶åå†æ¬¡æŸ¥çœ‹ã€‚\nå­¦ä¹  è¿™ä»½ pdb å®è·µæ•™ç¨‹å¹¶ç†Ÿæ‚‰ç›¸å…³çš„å‘½ä»¤ã€‚æ›´æ·±å…¥çš„ä¿¡æ¯æ‚¨å¯ä»¥å‚è€ƒè¿™ä»½æ•™ç¨‹ã€‚\nå®‰è£… shellcheck å¹¶å°è¯•å¯¹ä¸‹é¢çš„è„šæœ¬è¿›è¡Œæ£€æŸ¥ã€‚è¿™æ®µä»£ç æœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿè¯·ä¿®å¤ç›¸å…³é—®é¢˜ã€‚åœ¨æ‚¨çš„ç¼–è¾‘å™¨ä¸­å®‰è£…ä¸€ä¸ªlinteræ’ä»¶ï¼Œè¿™æ ·å®ƒå°±å¯ä»¥è‡ªåŠ¨åœ°æ˜¾ç¤ºç›¸å…³è­¦å‘Šä¿¡æ¯ã€‚\n#!/bin/sh ## Example: a typical script with several problems for f in $(ls *.m3u) do grep -qi hq.*mp3 $f \\ \u0026amp;\u0026amp; echo -e \u0026#39;Playlist $f contains a HQ file in mp3 format\u0026#39; done (è¿›é˜¶é¢˜) è¯·é˜…è¯» å¯é€†è°ƒè¯• å¹¶å°è¯•åˆ›å»ºä¸€ä¸ªå¯ä»¥å·¥ä½œçš„ä¾‹å­ï¼ˆä½¿ç”¨ rr æˆ– RevPDBï¼‰ã€‚\næ€§èƒ½åˆ†æ è¿™é‡Œ æœ‰ä¸€äº›æ’åºç®—æ³•çš„å®ç°ã€‚è¯·ä½¿ç”¨ cProfile å’Œ line_profiler æ¥æ¯”è¾ƒæ’å…¥æ’åºå’Œå¿«é€Ÿæ’åºçš„æ€§èƒ½ã€‚ä¸¤ç§ç®—æ³•çš„ç“¶é¢ˆåˆ†åˆ«åœ¨å“ªé‡Œï¼Ÿç„¶åä½¿ç”¨ memory_profiler æ¥æ£€æŸ¥å†…å­˜æ¶ˆè€—ï¼Œä¸ºä»€ä¹ˆæ’å…¥æ’åºæ›´å¥½ä¸€äº›ï¼Ÿç„¶ååœ¨çœ‹çœ‹åŸåœ°æ’åºç‰ˆæœ¬çš„å¿«æ’ã€‚é™„åŠ é¢˜ï¼šä½¿ç”¨ perf æ¥æŸ¥çœ‹ä¸åŒç®—æ³•çš„å¾ªç¯æ¬¡æ•°åŠç¼“å­˜å‘½ä¸­åŠä¸¢å¤±æƒ…å†µã€‚\nè¿™é‡Œæœ‰ä¸€äº›ç”¨äºè®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ— Python ä»£ç ï¼Œå®ƒä¸ºè®¡ç®—æ¯ä¸ªæ•°å­—éƒ½å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°ï¼š\n#!/usr/bin/env python def fib0(): return 0 def fib1(): return 1 s = \u0026#34;\u0026#34;\u0026#34;def fib{}(): return fib{}() + fib{}()\u0026#34;\u0026#34;\u0026#34; if __name__ == \u0026#39;__main__\u0026#39;: for n in range(2, 10): exec(s.format(n, n-1, n-2)) # from functools import lru_cache # for n in range(10): ### exec(\u0026#34;fib{} = lru_cache(1)(fib{})\u0026#34;.format(n, n)) print(eval(\u0026#34;fib9()\u0026#34;)) å°†ä»£ç æ‹·è´åˆ°æ–‡ä»¶ä¸­ä½¿å…¶å˜ä¸ºä¸€ä¸ªå¯æ‰§è¡Œçš„ç¨‹åºã€‚å®‰è£… pycallgraphã€‚å¹¶ä½¿ç”¨ pycallgraph graphviz -- ./fib.py æ¥æ‰§è¡Œä»£ç å¹¶æŸ¥çœ‹pycallgraph.png è¿™ä¸ªæ–‡ä»¶ã€‚fib0 è¢«è°ƒç”¨äº†å¤šå°‘æ¬¡ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡è®°å¿†æ³•æ¥å¯¹å…¶è¿›è¡Œä¼˜åŒ–ã€‚å°†æ³¨é‡Šæ‰çš„éƒ¨åˆ†æ”¾å¼€ï¼Œç„¶åé‡æ–°ç”Ÿæˆå›¾ç‰‡ã€‚è¿™å›æ¯ä¸ªfibN å‡½æ•°è¢«è°ƒç”¨äº†å¤šå°‘æ¬¡ï¼Ÿ\næˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°çš„æƒ…å†µæ˜¯æŸä¸ªæˆ‘ä»¬å¸Œæœ›å»ç›‘å¬çš„ç«¯å£å·²ç»è¢«å…¶ä»–è¿›ç¨‹å ç”¨äº†ã€‚è®©æˆ‘ä»¬é€šè¿‡è¿›ç¨‹çš„PIDæŸ¥æ‰¾ç›¸åº”çš„è¿›ç¨‹ã€‚é¦–å…ˆæ‰§è¡Œ python -m http.server 4444 å¯åŠ¨ä¸€ä¸ªæœ€ç®€å•çš„ web æœåŠ¡å™¨æ¥ç›‘å¬ 4444 ç«¯å£ã€‚åœ¨å¦å¤–ä¸€ä¸ªç»ˆç«¯ä¸­ï¼Œæ‰§è¡Œ lsof | grep LISTEN æ‰“å°å‡ºæ‰€æœ‰ç›‘å¬ç«¯å£çš„è¿›ç¨‹åŠç›¸åº”çš„ç«¯å£ã€‚æ‰¾åˆ°å¯¹åº”çš„ PID ç„¶åä½¿ç”¨ kill \u0026lt;PID\u0026gt; åœæ­¢è¯¥è¿›ç¨‹ã€‚\né™åˆ¶è¿›ç¨‹èµ„æºä¹Ÿæ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æŠ€æœ¯ã€‚æ‰§è¡Œ stress -c 3 å¹¶ä½¿ç”¨htop å¯¹ CPU æ¶ˆè€—è¿›è¡Œå¯è§†åŒ–ã€‚ç°åœ¨ï¼Œæ‰§è¡Œtaskset --cpu-list 0,2 stress -c 3 å¹¶å¯è§†åŒ–ã€‚stress å ç”¨äº†3ä¸ª CPU å—ï¼Ÿä¸ºä»€ä¹ˆæ²¡æœ‰ï¼Ÿé˜…è¯»man tasksetæ¥å¯»æ‰¾ç­”æ¡ˆã€‚é™„åŠ é¢˜ï¼šä½¿ç”¨ cgroupsæ¥å®ç°ç›¸åŒçš„æ“ä½œï¼Œå°è¯•ä½¿ç”¨stress -mæ¥é™åˆ¶å†…å­˜ä½¿ç”¨\n(è¿›é˜¶é¢˜) curl ipinfo.io å‘½ä»¤æˆ–æ‰§è¡Œ HTTP è¯·æ±‚å¹¶è·å–å…³äºæ‚¨ IP çš„ä¿¡æ¯ã€‚æ‰“å¼€ Wireshark å¹¶æŠ“å– curl å‘èµ·çš„è¯·æ±‚å’Œæ”¶åˆ°çš„å›å¤æŠ¥æ–‡ã€‚ï¼ˆæç¤ºï¼šå¯ä»¥ä½¿ç”¨httpè¿›è¡Œè¿‡æ»¤ï¼Œåªæ˜¾ç¤º HTTP æŠ¥æ–‡ï¼‰\nå‚è€ƒ è¯¾ç¨‹åˆ—è¡¨\n","permalink":"https://blog.niuhemoon.win/posts/tech/coding-tools-profile/","summary":"ä»£ç ä¸èƒ½å®Œå…¨æŒ‰ç…§æ‚¨çš„æƒ³æ³•è¿è¡Œï¼Œå®ƒåªèƒ½å®Œå…¨æŒ‰ç…§æ‚¨çš„å†™æ³•è¿è¡Œï¼Œè¿™æ˜¯ç¼–ç¨‹ç•Œçš„ä¸€æ¡é‡‘ç§‘ç‰å¾‹ã€‚ è®©æ‚¨çš„å†™æ³•ç¬¦åˆæ‚¨çš„æƒ³æ³•æ˜¯éå¸¸å›°éš¾çš„ã€‚åœ¨è¿™èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬ä¼šä¼ æˆç»™æ‚¨ä¸€äº›éå¸¸æœ‰ç”¨æŠ€æœ¯ï¼Œå¸®æ‚¨å¤„ç†ä»£ç ä¸­çš„ bug å’Œç¨‹åºæ€§èƒ½é—®é¢˜ã€‚ è°ƒè¯•ä»£ç  æ‰“å°è°ƒè¯•æ³•ä¸æ—¥å¿— \u0026ldquo;æœ€æœ‰æ•ˆçš„ debug å·¥å…·å°±æ˜¯ç»†è‡´çš„åˆ†æï¼Œé…åˆæ°å½“ä½ç½®çš„","title":"ç¼–ç¨‹å·¥å…·ä¹‹è°ƒè¯•å’Œæ€§èƒ½åˆ†æ"},{"content":"Angular å¼€å‘ç¯å¢ƒ Angular ä¾èµ–äº Nodejsï¼Œéœ€è¦é¦–å…ˆå®‰è£… node å’Œ npm,å®‰è£…å®Œæˆåå¯ä»¥æŸ¥çœ‹ node å’Œ npm çš„ç‰ˆæœ¬ ç„¶åå†å®‰è£… angular ä¾èµ–\nnode -v npm -v # npmæ¢æº npm config set registry https://registry.npm.taobao.org # æŸ¥çœ‹npmçš„æº npm config get registry # å®‰è£…angular npm install -g @angular/cli # æ›´æ–°æ‰€æœ‰å¥—ä»¶åˆ°æœ€æ–°ç‰ˆ ng update --all --force # åˆ›å»ºä¸€ä¸ªangularé¡¹ç›® ng new testng StackBlitzæ˜¯ä¸€ä¸ªåœ¨çº¿å¼€å‘ç¯å¢ƒï¼Œå¯ä»¥å¿«é€Ÿä¸Šæ‰‹å¼€å‘ï¼\nè¿›å…¥ testng é¡¹ç›®ï¼Œå…¶ç›®å½•ç»“æ„å¦‚ä¸‹\nâ”œâ”€â”€ angular.json\t# angularé…ç½®æ–‡ä»¶ â”œâ”€â”€ e2e â”‚Â â”œâ”€â”€ protractor.conf.js â”‚Â â”œâ”€â”€ src â”‚Â â”‚Â â”œâ”€â”€ app.e2e-spec.ts\t# e2e ç«¯å¯¹ç«¯æµ‹è¯•ç›®å½• â”‚Â â”‚Â â””â”€â”€ app.po.ts â”‚Â â””â”€â”€ tsconfig.json â”œâ”€â”€ karma.conf.js\t# æ‰§è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•çš„ â”œâ”€â”€ node_modules\t# npmåŒ…å®‰è£…ç›®å½•ï¼Œä½¿ç”¨npm installå®‰è£… â”œâ”€â”€ package.json\t# npm å·¥å…·çš„é…ç½®æ–‡ä»¶ï¼ŒæŒ‡æ˜äº†å½“å‰è¿™ä¸ªåº”ç”¨æ‰€è¦ç”¨åˆ°çš„æ¨¡å—ï¼ŒAngular çš„ä¾èµ–åŒ… â”œâ”€â”€ README.md â”œâ”€â”€ src â”‚Â â”œâ”€â”€ app â”‚Â â”‚Â â”œâ”€â”€ app.component.css\t# é¡¹ç›®ä¸»æ ·å¼ â”‚Â â”‚Â â”œâ”€â”€ app.component.html\t# é¡¹ç›®çš„ä¸»æ¨¡æ¿ â”‚Â â”‚Â â”œâ”€â”€ app.component.spec.ts\t# é¡¹ç›®å•å…ƒæµ‹è¯• â”‚Â â”‚Â â”œâ”€â”€ app.component.ts\t# é¡¹ç›®çš„ä¸»ç»„ä»¶ï¼Œå®šä¹‰AppModuleï¼Œè¿™ä¸ªæ ¹æ¨¡å—ä¼šå‘Šè¯‰Angularå¦‚ä½•ç»„è£…è¯¥åº”ç”¨ â”‚Â â”‚Â â”œâ”€â”€ app.module.ts\t# é¡¹ç›®ä¸»æ¨¡å— â”‚Â â”‚Â â””â”€â”€ app-routing.module.ts â”‚Â â”œâ”€â”€ assets\t# é™æ€èµ„æºå¦‚å›¾ç‰‡ã€ç¿»è¯‘è¯­è¨€ï¼Œæ„å»ºæ—¶è‡ªåŠ¨æ‰“åŒ… â”‚Â â”œâ”€â”€ environments â”‚Â â”‚Â â”œâ”€â”€ environment.prod.ts\t# ç”Ÿäº§ç¯å¢ƒé…ç½® â”‚Â â”‚Â â””â”€â”€ environment.ts\t# å¼€å‘ç¯å¢ƒé…ç½®ï¼Œé»˜è®¤ â”‚Â â”œâ”€â”€ favicon.ico\t# å›¾æ ‡ â”‚Â â”œâ”€â”€ index.html\t# å®¿ä¸»é¡µé¢ â”‚Â â”œâ”€â”€ main.ts\t# æ•´ä¸ªwebåº”ç”¨çš„å…¥å£ç‚¹ï¼Œangularé€šè¿‡è¯¥é¡¹ç›®æ¥å¯åŠ¨æ•´ä¸ªé¡¹ç›® â”‚Â â”œâ”€â”€ polyfills.ts\t# å¯¼å…¥ä¸€äº›å¿…è¦çš„åº“,ä½¿å¾—angularå¯ä»¥åœ¨ä¸€äº›è€ç‰ˆæœ¬çš„æµè§ˆå™¨ä¸­è¿è¡Œ â”‚Â â”œâ”€â”€ styles.css\t# å…¬å…±æ ·å¼ â”‚Â â””â”€â”€ test.ts\t# å•å…ƒæµ‹è¯•å…¥å£ç‚¹ â”œâ”€â”€ tsconfig.app.json â”œâ”€â”€ tsconfig.json\t# TypeScript ç¼–è¯‘å™¨çš„å‚æ•° â”œâ”€â”€ tsconfig.spec.json â”œâ”€â”€ typings.json\t# ä¸ºé‚£äº› TypeScript ç¼–è¯‘å™¨æ— æ³•è¯†åˆ«çš„åº“æä¾›äº†é¢å¤–çš„å®šä¹‰æ–‡ä»¶ã€‚ â””â”€â”€ tslint.json\t# å®šä¹‰ ts æ–‡ä»¶è´¨é‡æ£€æŸ¥çš„ä¸€äº›è§„åˆ™ å‚è€ƒ Angular çš„ 8 ä¸ªæ ¸å¿ƒæ¦‚å¿µ\nAngular4 æ•™ç¨‹\n","permalink":"https://blog.niuhemoon.win/posts/tech/angular-devenv/","summary":"Angular å¼€å‘ç¯å¢ƒ Angular ä¾èµ–äº Nodejsï¼Œéœ€è¦é¦–å…ˆå®‰è£… node å’Œ npm,å®‰è£…å®Œæˆåå¯ä»¥æŸ¥çœ‹ node å’Œ npm çš„ç‰ˆæœ¬ ç„¶åå†å®‰è£… angular ä¾èµ– node -v npm -v # npmæ¢æº npm config set registry https://registry.npm.taobao.org # æŸ¥çœ‹npmçš„æº npm config get registry # å®‰è£…angular npm install -g @angular/cli # æ›´æ–°æ‰€æœ‰å¥—ä»¶åˆ°æœ€æ–°ç‰ˆ ng update --all --force # åˆ›å»ºä¸€ä¸ªangularé¡¹ç›® ng new testng StackBlitzæ˜¯ä¸€ä¸ªåœ¨çº¿å¼€","title":"Angularå¼€å‘ç¯å¢ƒæ­å»º"},{"content":"Pythonç§åŸºæœ¬ç±»å‹çš„æ¯”è¾ƒï¼š\nList is a collection which is ordered and mutable. Allows duplicate members. Tuple is a collection which is ordered and immutable. Allows duplicate members. Set is a collection which is unordered and unindexed. No duplicate members. Dictionary is a collection which is unordered, mutable and indexed. No duplicate members. Strings are immutable sequences of Unicode code points. List Pythonä¸­çš„listæ˜¯ä¸€ä¸ªæœ‰åºå®¹å™¨ï¼Œå®¹çº³ä¸åŒç±»å‹çš„æ•°æ®ï¼ˆä½†æ¨èåˆ—è¡¨å†…æ•°æ®ç±»å‹ç›¸åŒ)ï¼ŒåŒæ—¶å…¶æ˜¯å¯å˜ç±»å‹çš„ï¼\nåˆ›å»ºåˆ—è¡¨ list_1 = [\u0026#34;banana\u0026#34;, \u0026#34;cherry\u0026#34;, \u0026#34;apple\u0026#34;] print(list_1) # Or create an empty list with the list function list_2 = list() print(list_2) # Lists allow different data types list_3 = [5, True, \u0026#34;apple\u0026#34;] print(list_3) # Lists allow duplicates list_4 = [0, 0, 1, 1] print(list_4) å†…ç½®æ–¹æ³• ä¿®æ”¹åˆ—è¡¨çš„æ–¹æ³•å°½é‡ä½¿ç”¨å†…ç½®æ–¹æ³•ï¼Œå†…ç½®æ–¹æ³•æ•ˆç‡è¾ƒé«˜\nmy_list = [\u0026#34;banana\u0026#34;, \u0026#34;cherry\u0026#34;, \u0026#34;apple\u0026#34;] # len() : get the number of elements in a list print(\u0026#34;Length:\u0026#34;, len(my_list)) # append() : adds an element to the end of the list my_list.append(\u0026#34;orange\u0026#34;) # insert() : adds an element at the specified position my_list.insert(1, \u0026#34;blueberry\u0026#34;) print(my_list) # pop() : removes and returns the item at the given position, default is the last item item = my_list.pop() print(\u0026#34;Popped item: \u0026#34;, item) # remove() : removes an item from the list my_list.remove(\u0026#34;cherry\u0026#34;) # Value error if not in the list print(my_list) # clear() : removes all items from the list my_list.clear() print(my_list) # reverse() : reverse the items my_list = [\u0026#34;banana\u0026#34;, \u0026#34;cherry\u0026#34;, \u0026#34;apple\u0026#34;] my_list.reverse() print(\u0026#39;Reversed: \u0026#39;, my_list) # sort() : sort items in ascending order my_list.sort() print(\u0026#39;Sorted: \u0026#39;, my_list) # use sorted() to get a new list, and leave the original unaffected. # sorted() works on any iterable type, not just lists my_list = [\u0026#34;banana\u0026#34;, \u0026#34;cherry\u0026#34;, \u0026#34;apple\u0026#34;] new_list = sorted(my_list) # create list with repeated elements list_with_zeros = [0] * 5 print(list_with_zeros) # concatenation list_concat = list_with_zeros + my_list print(list_concat) # convert string to list string_to_list = list(\u0026#39;Hello\u0026#39;) print(string_to_list) å¤åˆ¶åˆ—è¡¨ æ³¨æ„æ‹·è´åˆ—è¡¨å†…å®¹è¿˜æ˜¯æ‹·è´å¼•ç”¨\nlist_org = [\u0026#34;banana\u0026#34;, \u0026#34;cherry\u0026#34;, \u0026#34;apple\u0026#34;] # this just copies the reference to the list, so be careful list_copy = list_org # now modifying the copy also affects the original list_copy.append(True) print(list_copy) print(list_org) # use copy(), or list(x) to actually copy the list # slicing also works: list_copy = list_org[:] list_org = [\u0026#34;banana\u0026#34;, \u0026#34;cherry\u0026#34;, \u0026#34;apple\u0026#34;] list_copy = list_org.copy() # list_copy = list(list_org) # list_copy = list_org[:] # now modifying the copy does not affect the original list_copy.append(True) print(list_copy) print(list_org) åˆ—è¡¨åˆ‡ç‰‡ # a[start:stop:step], default step is 1 a = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] b = a[1:3] # Note that the last index is not included print(b) b = a[2:] # until the end print(b) b = a[:3] # from beginning print(b) a[0:3] = [0] # replace sub-parts, you need an iterable here print(a) b = a[::2] # start to end with every second item print(b) a = a[::-1] # reverse the list with a negative step: print(a) b = a[:] # copy a list with slicing print(b) Tuple Tupleåˆç§°ä¸ºå…ƒç»„ï¼Œå’ŒListåˆ—è¡¨ç±»ä¼¼ï¼Œä¸»è¦åŒºåˆ«åœ¨äºå…ƒç»„æ˜¯ä¸å¯å˜ç±»å‹ï¼ä¸å¯å˜æ„å‘³ç€å…ƒç»„ä¸­çš„å…ƒç´ æ— æ³•è¢«é‡æ–°èµ‹å€¼ï¼ä½¿ç”¨å…ƒç»„è€Œéåˆ—è¡¨çš„æœ‰å¦‚ä¸‹åŸå› ï¼š\nGenerally used for objects that belong together. Use tuple for heterogeneous (different) datatypes and list for homogeneous (similar) datatypes. Since tuple are immutable, iterating through tuple is slightly faster than with list. Tuples with their immutable elements can be used as key for a dictionary. This is not possible with lists. If you have data that doesn\u0026rsquo;t change, implementing it as tuple will guarantee that it remains write-protected. åˆ›å»ºå…ƒç»„ tuple_1 = (\u0026#34;Max\u0026#34;, 28, \u0026#34;New York\u0026#34;) tuple_2 = \u0026#34;Linda\u0026#34;, 25, \u0026#34;Miami\u0026#34; # Parentheses are optional # Special case: a tuple with only one element needs to have a comma at the end, # otherwise it is not recognized as tuple tuple_3 = (25,) print(tuple_1) print(tuple_2) print(tuple_3) # Or convert an iterable (list, dict, string) with the built-in tuple function tuple_4 = tuple([1,2,3]) print(tuple_4) ä¸å¯å˜è§£é‡Š å…ƒç»„ä¸æä¾›ä¿®æ”¹å…ƒç´ çš„æ–¹æ³•ï¼Œå…¶ä¸­çš„itemæœ¬èº«æ— æ³•è¢«èµ‹å€¼ï¼Œå³å…¶æŒ‡å‘çš„å¯¹è±¡idï¼ˆç±»ä¼¼å†…å­˜åœ°å€)æ— æ³•æ”¹å˜ï¼Œä½†æ˜¯è‹¥å…ƒç»„ä¸­å…ƒç´ itemè‡ªèº«æ˜¯å¯å˜ç±»å‹çš„ï¼Œå…ƒç´ æœ¬èº«å¯ä»¥æ”¹å˜ï¼\nPythonä¸­å¯å˜ç±»å‹çš„è§£é‡Šï¼š\npythonä¸­å¯¹å¯å˜æ•°æ®ç±»å‹çš„å®šä¹‰ä¸ºï¼šå½“è¯¥æ•°æ®ç±»å‹çš„å¯¹åº”å˜é‡çš„å€¼å‘ç”Ÿäº†æ”¹å˜ï¼Œé‚£ä¹ˆå®ƒå¯¹åº”çš„å†…å­˜åœ°å€ä¸å‘ç”Ÿæ”¹å˜ï¼Œå°±ç§°å¯å˜æ•°æ®ç±»å‹ã€‚åŒ…æ‹¬ï¼šsetï¼ˆé›†åˆï¼‰ã€listï¼ˆåˆ—è¡¨ï¼‰ã€dictï¼ˆå­—å…¸ï¼‰\nIn [7]: a = (1,[2,3]) In [8]: a[1] Out[8]: [2, 3] In [9]: a[1] = [1,2,3] --------------------------------------------------------------------------- TypeError Traceback (most recent call last) \u0026lt;ipython-input-9-f8fa7e0d45e2\u0026gt; in \u0026lt;module\u0026gt; ----\u0026gt; 1 a[1] = [1,2,3] TypeError: \u0026#39;tuple\u0026#39; object does not support item assignment In [10]: a[1].append(3) In [11]: a Out[11]: (1, [2, 3, 3]) ä»¥æ­¤æ‰§è¡Œä¸‹é¢æŒ‡ä»¤ï¼Œå¯ä»¥ç†è§£ä¸€ä¸‹æµ…æ‹·è´å’Œæ·±æ‹·è´\na = [1] # shadow copy b = a b is aã€€# True,has same address id(a) id(b) # deep copy,a point to another memory address a = a+[2] a id(a) # b\u0026#39;s address doesn\u0026#39;t change id(b) å†…ç½®æ–¹æ³• my_tuple = (\u0026#39;a\u0026#39;,\u0026#39;p\u0026#39;,\u0026#39;p\u0026#39;,\u0026#39;l\u0026#39;,\u0026#39;e\u0026#39;,) # len() : get the number of elements in a tuple print(len(my_tuple)) # count(x) : Return the number of items that is equal to x print(my_tuple.count(\u0026#39;p\u0026#39;)) # index(x) : Return index of first item that is equal to x print(my_tuple.index(\u0026#39;l\u0026#39;)) # repetition my_tuple = (\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;) * 5 print(my_tuple) # concatenation my_tuple = (1,2,3) + (4,5,6) print(my_tuple) # convert list to a tuple and vice versa my_list = [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;] list_to_tuple = tuple(my_list) print(list_to_tuple) tuple_to_list = list(list_to_tuple) print(tuple_to_list) # convert string to tuple string_to_tuple = tuple(\u0026#39;Hello\u0026#39;) print(string_to_tuple) # Result \u0026#34;\u0026#34;\u0026#34; 5 2 3 (\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;) (1, 2, 3, 4, 5, 6) (\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;) [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;] (\u0026#39;H\u0026#39;, \u0026#39;e\u0026#39;, \u0026#39;l\u0026#39;, \u0026#39;l\u0026#39;, \u0026#39;o\u0026#39;) \u0026#34;\u0026#34;\u0026#34; å…ƒç»„åˆ‡ç‰‡ # a[start:stop:step], default step is 1 a = (1, 2, 3, 4, 5, 6, 7, 8, 9, 10) b = a[1:3] # Note that the last index is not included print(b) b = a[2:] # until the end print(b) b = a[:3] # from beginning print(b) b = a[::2] # start to end with every second item print(b) b = a[::-1] # reverse tuple # don\u0026#39;t change a ,create a new tuple and assign it to b print(b) # Result \u0026#34;\u0026#34;\u0026#34; (2, 3) (3, 4, 5, 6, 7, 8, 9, 10) (1, 2, 3) (1, 3, 5, 7, 9) (10, 9, 8, 7, 6, 5, 4, 3, 2, 1) \u0026#34;\u0026#34;\u0026#34; å…ƒç»„è§£åŒ… åœ¨Pythonä¸­äº’æ¢ä¸¤ä¸ªå˜é‡çš„å€¼ï¼Œå¦‚\na,b = b,a\nå°±æ˜¯ç­‰å·å³ä¾§å°†b,aè‡ªåŠ¨æ‰“åŒ…ä¸ºå…ƒç»„(b,a)ï¼Œèµ‹å€¼ç»™å·¦ä¾§åå†è‡ªåŠ¨è§£åŒ…ï¼ŒåŒæ ·çš„ï¼ŒPythonä¸­å‡½æ•°è¿”å›å¤šä¸ªå€¼ï¼Œä¹Ÿæ˜¯éšå¼çš„å°†å¤šä¸ªå€¼æ‰“åŒ…ä¸ºå…ƒç»„ï¼Œå¹¶è¿”å›ä¸€ä¸ªå…ƒç»„ï¼\n# number of variables have to match number of tuple elements tuple_1 = (\u0026#34;Max\u0026#34;, 28, \u0026#34;New York\u0026#34;) name, age, city = tuple_1 print(name) print(age) print(city) # tip: unpack multiple elements to a list with * my_tuple = (0, 1, 2, 3, 4, 5) item_first, *items_between, item_last = my_tuple print(item_first) print(items_between) print(item_last) # Result \u0026#34;\u0026#34;\u0026#34; Max 28 New York 0 [1, 2, 3, 4] 5 \u0026#34;\u0026#34;\u0026#34; å…ƒç»„åˆ—è¡¨å¯¹æ¯” å®¹çº³åŒæ ·çš„æ•°æ®ï¼Œå…ƒç»„çš„å ç”¨ç©ºé—´å’Œè¿­ä»£é€Ÿåº¦æ›´é«˜\n# compare the size import sys my_list = [0, 1, 2, \u0026#34;hello\u0026#34;, True] my_tuple = (0, 1, 2, \u0026#34;hello\u0026#34;, True) print(sys.getsizeof(my_list), \u0026#34;bytes\u0026#34;) print(sys.getsizeof(my_tuple), \u0026#34;bytes\u0026#34;) # compare the execution time of a list vs. tuple creation statement import timeit print(timeit.timeit(stmt=\u0026#34;[0, 1, 2, 3, 4, 5]\u0026#34;, number=1000000)) print(timeit.timeit(stmt=\u0026#34;(0, 1, 2, 3, 4, 5)\u0026#34;, number=1000000)) # Result \u0026#34;\u0026#34;\u0026#34; 104 bytes 88 bytes 0.12474981700000853 0.014836141000017733 \u0026#34;\u0026#34;\u0026#34; Dictionary å­—å…¸æ˜¯æ— åºçš„ã€å¯å˜çš„ã€å¯ç´¢å¼•çš„ä¸€ç§æ•°æ®ç±»å‹ã€‚\nå­—å…¸åˆ›å»º my_dict = {\u0026#34;name\u0026#34;:\u0026#34;Max\u0026#34;, \u0026#34;age\u0026#34;:28, \u0026#34;city\u0026#34;:\u0026#34;New York\u0026#34;} print(my_dict) # or use the dict constructor, note: no quotes necessary for keys my_dict_2 = dict(name=\u0026#34;Lisa\u0026#34;, age=27, city=\u0026#34;Boston\u0026#34;) print(my_dict_2) å¸¸ç”¨æ–¹æ³• åˆ é™¤å­—å…¸å…ƒç´  my_dict = {\u0026#34;name\u0026#34;:\u0026#34;Max\u0026#34;, \u0026#34;age\u0026#34;:28, \u0026#34;city\u0026#34;:\u0026#34;New York\u0026#34;} # delete a key-value pair del my_dict[\u0026#34;email\u0026#34;] # this returns the value and removes the key-value pair print(\u0026#34;popped value:\u0026#34;, my_dict.pop(\u0026#34;age\u0026#34;)) # return and removes the last inserted key-value pair # (in versions before Python 3.7 it removes an arbitrary pair) print(\u0026#34;popped item:\u0026#34;, my_dict.popitem()) print(my_dict) # clear() : remove all pairs # my_dict.clear() æ£€æŸ¥keyæ˜¯å¦å­˜åœ¨ my_dict = {\u0026#34;name\u0026#34;:\u0026#34;Max\u0026#34;, \u0026#34;age\u0026#34;:28, \u0026#34;city\u0026#34;:\u0026#34;New York\u0026#34;} # use if .. in .. if \u0026#34;name\u0026#34; in my_dict: print(my_dict[\u0026#34;name\u0026#34;]) # use try except try: print(my_dict[\u0026#34;firstname\u0026#34;]) except KeyError: print(\u0026#34;No key found\u0026#34;) è¿­ä»£å­—å…¸å…ƒç´  # loop over keys for key in my_dict: print(key, my_dict[key]) # loop over keys for key in my_dict.keys(): print(key) # loop over values for value in my_dict.values(): print(value) # loop over keys and values for key, value in my_dict.items(): print(key, value) å¤åˆ¶å­—å…¸ dict_org = {\u0026#34;name\u0026#34;:\u0026#34;Max\u0026#34;, \u0026#34;age\u0026#34;:28, \u0026#34;city\u0026#34;:\u0026#34;New York\u0026#34;} # this just copies the reference to the dict, so be careful dict_copy = dict_org # now modifying the copy also affects the original dict_copy[\u0026#34;name\u0026#34;] = \u0026#34;Lisa\u0026#34; print(dict_copy) print(dict_org) # use copy(), or dict(x) to actually copy the dict dict_org = {\u0026#34;name\u0026#34;:\u0026#34;Max\u0026#34;, \u0026#34;age\u0026#34;:28, \u0026#34;city\u0026#34;:\u0026#34;New York\u0026#34;} dict_copy = dict_org.copy() # dict_copy = dict(dict_org) # now modifying the copy does not affect the original dict_copy[\u0026#34;name\u0026#34;] = \u0026#34;Lisa\u0026#34; print(dict_copy) print(dict_org) åˆå¹¶ä¸¤ä¸ªå­—å…¸ # Use the update() method to merge 2 dicts # existing keys are overwritten, new keys are added my_dict = {\u0026#34;name\u0026#34;:\u0026#34;Max\u0026#34;, \u0026#34;age\u0026#34;:28, \u0026#34;email\u0026#34;:\u0026#34;max@xyz.com\u0026#34;} my_dict_2 = dict(name=\u0026#34;Lisa\u0026#34;, age=27, city=\u0026#34;Boston\u0026#34;) my_dict.update(my_dict_2) print(my_dict) å¯èƒ½çš„Keyç±»å‹ ä»»ä½•ä¸å¯å˜ç±»å‹éƒ½å¯ä»¥ä½œä¸ºå­—å…¸çš„keyï¼ŒåŒ…æ‹¬æ•°å­—ã€å­—ç¬¦ä¸²ã€‚å…ƒç»„å¦‚æœæ‰€æœ‰å…ƒç´ éƒ½æ˜¯ä¸å¯å˜çš„ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºkeyã€‚\n# use numbers as key, but be careful my_dict = {3: 9, 6: 36, 9:81} # do not mistake the keys as indices of a list, e.g my_dict[0] is not possible here print(my_dict[3], my_dict[6], my_dict[9]) # use a tuple with immutable elements (e.g. number, string) my_tuple = (8, 7) my_dict = {my_tuple: 15} print(my_dict[my_tuple]) # print(my_dict[8, 7]) # a list is not possible because it is not immutable # this will raise an Error: # my_list = [8, 7] # my_dict = {my_list: 15} Sets A Set is an unordered collection data type that is unindexed, mutable, and has no duplicate elements.\nåˆ›å»ºé›†åˆ my_set = {\u0026#34;apple\u0026#34;, \u0026#34;banana\u0026#34;, \u0026#34;cherry\u0026#34;} print(my_set) # or use the set function and create from an iterable, e.g. list, tuple, string my_set_2 = set([\u0026#34;one\u0026#34;, \u0026#34;two\u0026#34;, \u0026#34;three\u0026#34;]) my_set_2 = set((\u0026#34;one\u0026#34;, \u0026#34;two\u0026#34;, \u0026#34;three\u0026#34;)) print(my_set_2) my_set_3 = set(\u0026#34;aaabbbcccdddeeeeeffff\u0026#34;) print(my_set_3) # careful: an empty set cannot be created with {}, as this is interpreted as dict # use set() instead a = {} print(type(a)) a = set() print(type(a)) å¸¸ç”¨æ–¹æ³• æ·»åŠ å…ƒç´  my_set = set() # use the add() method to add elements my_set.add(42) my_set.add(True) my_set.add(\u0026#34;Hello\u0026#34;) # note: the order does not matter, and might differ when printed print(my_set) # nothing happens when the element is already present: my_set.add(42) print(my_set) ç§»é™¤å…ƒç´  # remove(x): removes x, raises a KeyError if element is not present my_set = {\u0026#34;apple\u0026#34;, \u0026#34;banana\u0026#34;, \u0026#34;cherry\u0026#34;} my_set.remove(\u0026#34;apple\u0026#34;) print(my_set) # KeyError: # my_set.remove(\u0026#34;orange\u0026#34;) # discard(x): removes x, does nothing if element is not present my_set.discard(\u0026#34;cherry\u0026#34;) my_set.discard(\u0026#34;blueberry\u0026#34;) print(my_set) # clear() : remove all elements my_set.clear() print(my_set) # pop() : return and remove a random element a = {True, 2, False, \u0026#34;hi\u0026#34;, \u0026#34;hello\u0026#34;} print(a.pop()) print(a) äº¤é›†å’Œå¹¶é›† ä¸æ”¹å˜åŸæœ‰é›†åˆï¼Œåªæ˜¯ä¼šäº§ç”Ÿæ–°çš„é›†åˆ\nodds = {1, 3, 5, 7, 9} evens = {0, 2, 4, 6, 8} primes = {2, 3, 5, 7} # union() : combine elements from both sets, no duplication # note that this does not change the two sets u = odds.union(evens) print(u) # intersection(): take elements that are in both sets i = odds.intersection(evens) print(i) i = odds.intersection(primes) print(i) i = evens.intersection(primes) print(i) å·®é›† setB = {1, 2, 3, 10, 11, 12} # difference() : returns a set with all the elements from the setA that are not in setB. diff_set = setA.difference(setB) print(diff_set) # A.difference(B) is not the same as B.difference(A) diff_set = setB.difference(setA) print(diff_set) # symmetric_difference() : returns a set with all the elements that are in setA and setB but not in both diff_set = setA.symmetric_difference(setB) print(diff_set) # A.symmetric_difference(B) = B.symmetric_difference(A) diff_set = setB.symmetric_difference(setA) print(diff_set) æ›´æ–°é›†åˆï¼ˆäº¤/å¹¶/å·®ï¼‰ setA = {1, 2, 3, 4, 5, 6, 7, 8, 9} setB = {1, 2, 3, 10, 11, 12} # update() : Update the set by adding elements from another set. setA.update(setB) print(setA) # intersection_update() : Update the set by keeping only the elements found in both setA = {1, 2, 3, 4, 5, 6, 7, 8, 9} setA.intersection_update(setB) print(setA) # difference_update() : Update the set by removing elements found in another set. setA = {1, 2, 3, 4, 5, 6, 7, 8, 9} setA.difference_update(setB) print(setA) # symmetric_difference_update() : Update the set by only keeping the elements found in either set, but not in both setA = {1, 2, 3, 4, 5, 6, 7, 8, 9} setA.symmetric_difference_update(setB) print(setA) # Note: all update methods also work with other iterables as argument, e.g lists, tuples # setA.update([1, 2, 3, 4, 5, 6]) å¤åˆ¶é›†åˆ set_org = {1, 2, 3, 4, 5} # this just copies the reference to the set, so be careful set_copy = set_org # now modifying the copy also affects the original set_copy.update([3, 4, 5, 6, 7]) print(set_copy) print(set_org) # use copy() to actually copy the set set_org = {1, 2, 3, 4, 5} set_copy = set_org.copy() # now modifying the copy does not affect the original set_copy.update([3, 4, 5, 6, 7]) print(set_copy) print(set_org) å­é›†/ä¸ç›¸äº¤ setA = {1, 2, 3, 4, 5, 6} setB = {1, 2, 3} # issubset(setX): Returns True if setX contains the set print(setA.issubset(setB)) print(setB.issubset(setA)) # True # issuperset(setX): Returns True if the set contains setX print(setA.issuperset(setB)) # True print(setB.issuperset(setA)) # isdisjoint(setX) : Return True if both sets have a null intersection, i.e. no same elements setC = {7, 8, 9} print(setA.isdisjoint(setB)) print(setA.isdisjoint(setC)) Frozensetä¸å¯å˜é›†åˆ Frozen setæ˜¯ä¸€ç§ä¸å¯å˜çš„é›†åˆï¼Œå…¶åœ¨åˆ›å»ºä»¥åï¼Œé›†åˆä¸­çš„å…ƒç´ idä¸å¯å˜\na = frozenset([0, 1, 2, 3, 4]) # The following is not allowed: # a.add(5) # a.remove(1) # a.discard(1) # a.clear() # Also no update methods are allowed: # a.update([1,2,3]) # Other set operations work odds = frozenset({1, 3, 5, 7, 9}) evens = frozenset({0, 2, 4, 6, 8}) print(odds.union(evens)) print(odds.intersection(evens)) print(odds.difference(evens)) Strings å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªå­—ç¬¦åºåˆ—ï¼Œæ˜¯ä¸å¯å˜ç±»å‹ï¼Œå¯¹äºåŒä¸€ä¸ªidä¸‹çš„å­—ç¬¦ä¸²ä¸å¯å˜ã€‚\nå­—ç¬¦ä¸²åˆ›å»º # use singe or double quotes my_string = \u0026#39;Hello\u0026#39; my_string = \u0026#34;Hello\u0026#34; my_string = \u0026#34;I\u0026#39; m a \u0026#39;Geek\u0026#39;\u0026#34; # escaping backslash my_string = \u0026#39;I\\\u0026#39; m a \u0026#34;Geek\u0026#34;\u0026#39; my_string = \u0026#39;I\\\u0026#39; m a \\\u0026#39;Geek\\\u0026#39;\u0026#39; print(my_string) # triple quotes for multiline strings my_string = \u0026#34;\u0026#34;\u0026#34;Hello World\u0026#34;\u0026#34;\u0026#34; print(my_string) # backslash if you want to continue in the next line my_string = \u0026#34;Hello \\ World\u0026#34; print(my_string) è®¿é—®å­—ç¬¦æˆ–è€…å­ä¸² my_string = \u0026#34;Hello World\u0026#34; # get character by referring to index b = my_string[0] print(b) # Substrings with slicing b = my_string[1:3] # Note that the last index is not included print(b) b = my_string[:5] # from beginning print(b) b = my_string[6:] # until the end print(b) b = my_string[::2] # start to end with every second item print(b) b = my_string[::-1] # reverse the string with a negative step: print(b) å¸¸ç”¨æ–¹æ³• my_string = \u0026#34; Hello World \u0026#34; # remove white space my_string = my_string.strip() print(my_string) # number of characters print(len(my_string)) # Upper and lower cases print(my_string.upper()) print(my_string.lower()) # startswith and endswith print(\u0026#34;hello\u0026#34;.startswith(\u0026#34;he\u0026#34;)) print(\u0026#34;hello\u0026#34;.endswith(\u0026#34;llo\u0026#34;)) # find first index of a given substring, -1 otherwise print(\u0026#34;Hello\u0026#34;.find(\u0026#34;o\u0026#34;)) # count number of characters/substrings print(\u0026#34;Hello\u0026#34;.count(\u0026#34;e\u0026#34;)) # replace a substring with another string (only if the substring is found) # Note: The original string stays the same message = \u0026#34;Hello World\u0026#34; new_message = message.replace(\u0026#34;World\u0026#34;, \u0026#34;Universe\u0026#34;) print(new_message) # split the string into a list my_string = \u0026#34;how are you doing\u0026#34; a = my_string.split() # default argument is \u0026#34; \u0026#34; print(a) my_string = \u0026#34;one,two,three\u0026#34; a = my_string.split(\u0026#34;,\u0026#34;) print(a) # join elements of a list into a string my_list = [\u0026#39;How\u0026#39;, \u0026#39;are\u0026#39;, \u0026#39;you\u0026#39;, \u0026#39;doing\u0026#39;] a = \u0026#39; \u0026#39;.join(my_list) # the given string is the separator, e.g. \u0026#39; \u0026#39; between each argument print(a) æ ¼å¼åŒ–å­—ç¬¦ä¸² # use braces as placeholders a = \u0026#34;Hello {0} and {1}\u0026#34;.format(\u0026#34;Bob\u0026#34;, \u0026#34;Tom\u0026#34;) print(a) # the positions are optional for the default order a = \u0026#34;Hello {} and {}\u0026#34;.format(\u0026#34;Bob\u0026#34;, \u0026#34;Tom\u0026#34;) print(a) a = \u0026#34;The integer value is {}\u0026#34;.format(2) print(a) # some special format rules for numbers a = \u0026#34;The float value is {0:.3f}\u0026#34;.format(2.1234) print(a) a = \u0026#34;The float value is {0:e}\u0026#34;.format(2.1234) print(a) a = \u0026#34;The binary value is {0:b}\u0026#34;.format(2) print(a) # old style formatting by using % operator print(\u0026#34;Hello %s and %s\u0026#34; % (\u0026#34;Bob\u0026#34;, \u0026#34;Tom\u0026#34;)) # must be a tuple for multiple arguments val = 3.14159265359 print(\u0026#34;The decimal value is %d\u0026#34; % val) print(\u0026#34;The float value is %f\u0026#34; % val) print(\u0026#34;The float value is %.2f\u0026#34; % val) # since python3.6 # Use the variables directly inside the braces. name = \u0026#34;Eric\u0026#34; age = 25 a = f\u0026#34;Hello, {name}. You are {age}.\u0026#34; print(a) pi = 3.14159 a = f\u0026#34;Pi is {pi:.3f}\u0026#34; print(a) # f-Strings are evaluated at runtime, which allows expressions a = f\u0026#34;The value is {2*60}\u0026#34; print(a) More on immutability and concatenation # since a string is immutable, adding strings with +, or += always # creates a new string, and therefore is expensive for multiple operations # --\u0026gt; join method is much faster from timeit import default_timer as timer my_list = [\u0026#34;a\u0026#34;] * 1000000 # bad start = timer() a = \u0026#34;\u0026#34; for i in my_list: a += i end = timer() print(\u0026#34;concatenate string with + : %.5f\u0026#34; % (end - start)) # good start = timer() a = \u0026#34;\u0026#34;.join(my_list) end = timer() print(\u0026#34;concatenate string with join(): %.5f\u0026#34; % (end - start)) å‚è€ƒ Python-Notebook\n","permalink":"https://blog.niuhemoon.win/posts/tech/python-advanced-1/","summary":"Pythonç§åŸºæœ¬ç±»å‹çš„æ¯”è¾ƒï¼š List is a collection which is ordered and mutable. Allows duplicate members. Tuple is a collection which is ordered and immutable. Allows duplicate members. Set is a collection which is unordered and unindexed. No duplicate members. Dictionary is a collection which is unordered, mutable and indexed. No duplicate members. Strings are immutable sequences of Unicode code points. List Pythonä¸­çš„listæ˜¯ä¸€ä¸ªæœ‰åºå®¹å™¨ï¼Œå®¹çº³ä¸åŒç±»å‹çš„æ•°æ®ï¼ˆä½†æ¨èåˆ—è¡¨å†…æ•°æ®ç±»å‹ç›¸åŒ)ï¼ŒåŒæ—¶å…¶æ˜¯å¯å˜ç±»å‹çš„ï¼ åˆ›å»ºåˆ—è¡¨ list_1 = [\u0026#34;banana\u0026#34;, \u0026#34;cherry\u0026#34;, \u0026#34;apple\u0026#34;] print(list_1) # Or create","title":"Pythonè¿›é˜¶ä¸Š"},{"content":"Microstack ç®€ä»‹ Microstack æ˜¯åœ¨ ubuntu å¹³å°ä¸Šå¿«é€Ÿéƒ¨ç½² Openstack ç¯å¢ƒçš„å·¥å…·ï¼Œå…¶é€šè¿‡ snap æ„å»ºï¼Œè€Œ snap å®‰è£…ç›®å½•æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„åªè¯»æ–‡ä»¶ç³»ç»Ÿï¼Œè¿™å°±å¯¼è‡´éš¾ä»¥æ”¹åŠ¨ä»£ç è¿›è¡Œè°ƒè¯•ã€‚ å› æ­¤ï¼ŒMicrostack ç¯å¢ƒåªé€‚ç”¨äº Openstack åˆå­¦è€…å­¦ä¹ å‘½ä»¤è¡Œå’Œæ•°æ®åº“ç­‰ç­‰ï¼Œè°ƒè¯•çš„è¯å¯ä»¥é€šå‘Š gdb è°ƒè¯•ï¼Œè€Œä¸ä¾¿äºé€šè¿‡ pdb è°ƒè¯•ï¼Œå› ä¸ºæ— æ³•ä¿®æ”¹æºæ–‡ä»¶ï¼Œå¹¶åœ¨æ–‡ä»¶è¿˜ä¸­åŠ æ–­ç‚¹ã€‚ Microstack æ˜¯ç›®å‰ Ubuntu ä¸Šæœ€ç®€æ´çš„ Openstack é…ç½®å·¥å…·ï¼Œå¯ä»¥åœ¨ç¬”è®°æœ¬ä¸Šéƒ¨ç½²å•èŠ‚ç‚¹ç¯å¢ƒç”¨äºå­¦ä¹ ï¼Œä¹Ÿå¯ä»¥åœ¨å¤šå°è®¾å¤‡ä¸Šéƒ¨ç½²å¤šèŠ‚ç‚¹ç¯å¢ƒã€‚\nMicrostack å®‰è£… éœ€è¦åœ¨ç»ˆç«¯ç§‘å­¦ä¸Šç½‘ï¼Œå¦åˆ™ snap é•œåƒå¾ˆæ…¢,ç›®å‰æ”¯æŒåˆ° Openstack ä¸Šæ¸¸çš„ stein ç‰ˆæœ¬ï¼\n# é…ç½®ä»£ç† export https_proxy=http://127.0.0.1:port\u0026amp;\u0026amp; export http_proxy=http://127.0.0.1:port\u0026#34; # å®‰è£…snapåŒ… sudo snap install --classic --beta microstack # åˆå§‹åŒ–microstackç¯å¢ƒ sudo microstack.init --auto # åˆå§‹åŒ–å®Œæˆåä¼šè‡ªåŠ¨å¯åŠ¨Openstackè¿›ç¨‹ # æŸ¥çœ‹ç›¸å…³è¿›ç¨‹ systemctl list-units | grep microstack # å¯ä»¥çœ‹åˆ°microstackè¿›ç¨‹çš„çŠ¶æ€ # å¦‚æœå…¨éƒ¨æ˜¯loaded active runningï¼Œè¡¨ç¤ºæœåŠ¡æ­£å¸¸å¯åŠ¨ Microstack åŸºæœ¬ä½¿ç”¨ Microstack ç”±äºæ˜¯ Snap é•œåƒï¼Œå¯ä»¥æ‰‹åŠ¨å…³é—­å’Œå¼€å¯ å…¶æºä»£ç åœ¨/snap/microstack/196/lib/python3.6/site-packages ä½†ç”±äº snap åªè¯»æ–‡ä»¶ç³»ç»Ÿï¼Œä»£ç æ— æ³•ä¿®æ”¹ æ­¤å¤–ï¼Œå…¶å‘½ä»¤è¡Œ Client éƒ½åŠ ä¸Šäº† Microstack å‰ç¼€\nä¸€äº›å¸¸ç”¨çš„å‘½ä»¤è¡Œ\n# åœ¨.bashrcæ–‡ä»¶ä¸­é…ç½®åˆ«å alias openstack=\u0026#34;microstack.openstack\u0026#34; source ~/.bashrc # æŸ¥çœ‹å¸®åŠ© openstack --help # æ•°æ®åº“æ“ä½œï¼ŒæŸ¥çœ‹novaåº“ sudo microstack.mysql nova # å‡ ä¸ªæ•°æ®åº“åŒ…æ‹¬: # |cinder | # | glance | # | keystone | # | mysql | # | neutron | # | nova | # | nova_api | # | nova_cell0 # æŸ¥çœ‹é…ç½®æ–‡ä»¶å’Œæ•°æ®åº“åœ°å€ cd /var/snap/microstack # é…ç½®æ–‡ä»¶ï¼Œå¯ä¿®æ”¹é…ç½®æ–‡ä»¶é‡å¯è¿›ç¨‹ cd /var/snap/microstack/common/etc ä¹Ÿå¯ä»¥åœ¨æµè§ˆå™¨è®¿é—® web ç•Œé¢http://10.20.20.1/ é»˜è®¤ç”¨æˆ·åå¯†ç æ˜¯ admin å’Œ keystone\næ€»ç»“\nMicrostack ç›®å‰ä¸é€‚ç”¨äºå¼€å‘è€…ç¼–è¾‘è°ƒè¯•ä»£ç ï¼Œåªé€‚ç”¨äºå­¦ä¹ è€…ç†Ÿæ‚‰ç¯å¢ƒï¼Œç”¨äºåœ¨è‡ªå·±çš„ç”µè„‘ä¸Šå¿«é€Ÿéƒ¨ç½²ï¼\nå‚è€ƒ Microstack æ–‡æ¡£\n","permalink":"https://blog.niuhemoon.win/posts/tech/microstack-usage/","summary":"Microstack ç®€ä»‹ Microstack æ˜¯åœ¨ ubuntu å¹³å°ä¸Šå¿«é€Ÿéƒ¨ç½² Openstack ç¯å¢ƒçš„å·¥å…·ï¼Œå…¶é€šè¿‡ snap æ„å»ºï¼Œè€Œ snap å®‰è£…ç›®å½•æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„åªè¯»æ–‡ä»¶ç³»ç»Ÿï¼Œè¿™å°±å¯¼è‡´éš¾ä»¥æ”¹åŠ¨ä»£ç è¿›è¡Œè°ƒè¯•ã€‚ å› æ­¤ï¼ŒMicrostack ç¯å¢ƒåªé€‚ç”¨äº Openstack åˆå­¦è€…å­¦ä¹ å‘½ä»¤è¡Œå’Œæ•°æ®åº“ç­‰ç­‰ï¼Œè°ƒè¯•çš„è¯å¯ä»¥é€šå‘Š gdb è°ƒè¯•ï¼Œè€Œä¸ä¾¿äºé€šè¿‡ pdb è°ƒè¯•ï¼Œå› ä¸ºæ— æ³•ä¿®æ”¹æºæ–‡ä»¶ï¼Œå¹¶åœ¨æ–‡ä»¶è¿˜ä¸­åŠ æ–­ç‚¹ã€‚ Microstack","title":"Microstack åŸºæœ¬ä½¿ç”¨"},{"content":"python3ä¸­å¦‚ä½•å¯¹äºŒç»´ç QRcodeè¿›è¡Œç¼–ç è§£ç \né€šå¸¸å¯¹äºäºŒç»´ç ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œä¸¤ç§æ“ä½œï¼š\nå°†äºŒç»´ç å›¾ç‰‡æ‰«æåè§£ææˆå­—ç¬¦ä¸² å°†å­—ç¬¦ä¸²ç¼–ç ç”ŸæˆäºŒç»´ç å›¾ç‰‡ è¿™æ˜¯ä¸¤ä¸ªé€†è¿‡ç¨‹ï¼Œåœ¨python2ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡zbarè¿™ä¸ªç¬¬ä¸‰æ–¹åº“å®ç°ä¸¤ä¸ªåŠŸèƒ½ã€‚å¯ä»¥zbarå¹¶ä¸æ”¯æŒpython3ï¼Œè€Œä¸”ï¼Œzbaråœ¨windowå¹³å°ä¸Šçš„å®‰è£…æå…¶ç¹çï¼Œæœ‰å¾ˆå¤šå‘ã€‚\næ‰€ä»¥æƒ³é€šè¿‡python3å¤„ç†äºŒç»´ç çš„è¿‡ç¨‹ä¸­ï¼ŒæŸ¥äº†å¾ˆå¤šèµ„æ–™ã€‚ç›®å‰æ¯”è¾ƒå¥½çš„è§£å†³åŠæ³•å¦‚ä¸‹ï¼š\nç”¨pyzbarä»£æ›¿zbarè§£æäºŒç»´ç  å®‰è£…ï¼š\npip install pyzbar è¿™æ˜¯å¯èƒ½çš„ï¼Œå› ä¸ºpyzbaræ˜¯ä¸€ä¸ªå›´ç»•zbaråº“çš„åŸºäºctypesçš„åŒ…è£…å™¨ï¼Œå®ƒåŒ…å«åœ¨dllå’ŒWindows Pythonçš„è½®å­ä¸­ã€‚\nä½¿ç”¨ï¼š\nç½‘ç»œä¸ŠäºŒç»´ç å›¾ç‰‡è§£æ import requests import array from PIL import Image from io import BytesIO from pyzbar.pyzbar import decode # decode_resultçš„æ ¼å¼æ˜¯[Decoded(data=\u0026#39;****\u0026#39;,â€¦â€¦)]ï¼Œåˆ—è¡¨é‡ŒåŒ…å«ä¸€ä¸ªnametuple def decode_qrcode(url) decode_result = decode(Image.open(BytesIO(requests.get(urls, headers=HEADERS).content)) return str(decode_result[0].data, encoding=\u0026#39;utf-8\u0026#39;) æœ¬åœ°äºŒç»´ç å›¾ç‰‡è§£æ from PIL import Image from pyzbar.pyzbar import decode def decode_qrcode(url) decode_result = decode(Image.open(\u0026#39;filename\u0026#39;)) return str(decode_result[0].data, encoding=\u0026#39;utf-8\u0026#39;) æ›´è¯¦ç»†ç”¨æ³•å‚è§releaseé¡µé¢\nä¸‹è½½zbar.exeæ–‡ä»¶å¹¶å®‰è£…ï¼Œé€šè¿‡ç³»ç»Ÿå‘½ä»¤è¡Œè°ƒç”¨æ¥è§£ç  ä¸‹è½½åœ°å€ï¼šzbar-0.10-setup.exe\nè¯´æ˜ï¼š\nä½¿ç”¨ï¼š\nimport os os.system(r\u0026#39;C:\\zbarimg.exe -d d:\\Winapps\\Zbar\\Examples\\barcode.png\u0026#39;) Linuxå¹³å°ä¸Šqrtoolsè§£ç  æ³¨ï¼šè¿™ä¸ªæ–¹æ³•æˆ‘æ²¡ç”¨è¿‡ã€‚\nå®‰è£…ï¼š\nsudo apt-get install python-qrtools ä½¿ç”¨ï¼š\nimport qrtools qr = qrtools.QR() qr.decode(\u0026#34;horn.png\u0026#34;) print qr.data ç”¨PyQRCodeæ¥ç”ŸæˆäºŒç»´ç  å®‰è£…ï¼š\npip install pyqrcode ç”¨æ³•ï¼š\nimport pyqrcode url = pyqrcode.create(\u0026#39;http://uca.edu\u0026#39;) url.svg(\u0026#39;uca-url.svg\u0026#39;, scale=8) è¯´æ˜ï¼š pyqrcodeå…·æœ‰å®Œå–„çš„å¸®åŠ©æ–‡æ¡£å’Œå¼ºå¤§çš„åŠŸèƒ½ï¼Œå¯ä»¥å¿«é€Ÿç”Ÿäº§äºŒç»´ç å›¾ç‰‡,ç»†èŠ‚å‚è€ƒï¼š\nReleaseé¡µé¢ å¸®åŠ©æ–‡æ¡£ å…¶ä»–å€¼å¾—å…³æ³¨çš„å†…å®¹ qreaderæ˜¯ä¸€ä¸ªæ­£åœ¨å¼€å‘ä¸­çš„é¡¹ç›®ï¼Œä½¿ç”¨çº¯Pythonç¼–å†™çš„äºŒç»´ç è§£æåº“ï¼Œä¸ä¾èµ–zbarã€‚æ„Ÿå…´è¶£çš„å¯ä»¥å»æäº¤PRã€‚\nå…è´¹çš„äºŒç»´ç ç¼–ç è§£ç APIæ¥å£ http://api.qrserver.com/ Send a GET request of following form to our system to decode a QR code graphic (=to read a QR code from the web): http(s)://api.qrserver.com/v1/read-qr-code/?fileurl=[URL-encoded-webaddress-url-to-qrcode-image-file]\nhttp://www.7xiwang.com/Tools/Index è§£ç apiï¼šhttp://www.7xiwang.com/WebService/QRCodeDecode apiå‚æ•°ï¼šbase64img apiè¯·æ±‚ç±»å‹ï¼šHttpPost å‚æ•°æ•°æ®æ ¼å¼ï¼ˆJSONï¼‰ï¼š{\u0026#34;base64img\u0026#34;:\u0026#34;\u0026#34;} apiè¿”å›æ•°æ®æ ¼å¼ï¼ˆJSONï¼‰ï¼š è¯·æ±‚æˆåŠŸï¼š{\u0026#34;status\u0026#34;:\u0026#34;1\u0026#34;,\u0026#34;text\u0026#34;:\u0026#34;\u0026#34;} è¯·æ±‚å¤±è´¥ï¼š{\u0026#34;status\u0026#34;:\u0026#34;0\u0026#34;,\u0026#34;Msg\u0026#34;:\u0026#34;é”™è¯¯ä¿¡æ¯\u0026#34;} ","permalink":"https://blog.niuhemoon.win/posts/tech/python3-qrcode/","summary":"python3ä¸­å¦‚ä½•å¯¹äºŒç»´ç QRcodeè¿›è¡Œç¼–ç è§£ç  é€šå¸¸å¯¹äºäºŒç»´ç ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œä¸¤ç§æ“ä½œï¼š å°†äºŒç»´ç å›¾ç‰‡æ‰«æåè§£ææˆå­—ç¬¦ä¸² å°†å­—ç¬¦ä¸²ç¼–ç ç”ŸæˆäºŒç»´ç å›¾ç‰‡ è¿™æ˜¯ä¸¤ä¸ªé€†è¿‡ç¨‹ï¼Œåœ¨python2ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡zbarè¿™ä¸ªç¬¬ä¸‰æ–¹åº“å®ç°ä¸¤ä¸ªåŠŸèƒ½ã€‚å¯ä»¥zbarå¹¶ä¸æ”¯æŒpython3ï¼Œè€Œä¸”ï¼Œzbaråœ¨","title":"Python3æ“ä½œäºŒç»´ç å›¾ç‰‡"},{"content":" Linuxå†…æ ¸æ”¯æŒç”¨æˆ·è¿›ç¨‹å’Œå†…æ ¸è¿›ç¨‹ä¸¤ç§è¿›ç¨‹ã€‚å†…æ ¸è¿›ç¨‹æŒ‡å®Œå…¨è¿è¡Œåœ¨å†…æ ¸ç©ºé—´çš„è¿›ç¨‹ï¼Œè¿™ç§è¿›ç¨‹ä¸»è¦å¤„ç†å†…æ ¸äº‹åŠ¡ï¼›ç”¨æˆ·è¿›ç¨‹ä¸€èˆ¬è¿è¡Œåœ¨ç”¨æˆ·æ€ï¼Œéœ€è¦ä½¿ç”¨å†…æ ¸èµ„æºæ—¶ï¼Œé€šè¿‡ç³»ç»Ÿè°ƒç”¨è¿›å…¥å†…æ ¸æ€ï¼Œç³»ç»Ÿè°ƒç”¨ç»“æŸåï¼Œé‡æ–°è¿”å›ç”¨æˆ·æ€ã€‚\n###åˆ›å»ºè¿›ç¨‹\nå¯é€šè¿‡forkå‡½æ•°åˆ›å»ºå­è¿›ç¨‹ï¼Œç†è®ºä¸Šï¼Œçˆ¶å­è¿›ç¨‹æ‹¥æœ‰å„è‡ªç‹¬ç«‹çš„ç”¨æˆ·ç©ºé—´ã€‚ä½†Linuxä¸ºäº†æé«˜æ•ˆç‡ï¼Œé‡‡ç”¨COW(copy on write)ç®—æ³•ã€‚\nforkå‡½æ•°åŸå‹å¦‚ä¸‹:\n/* æˆåŠŸï¼šå­è¿›ç¨‹pidè¿”å›ç»™çˆ¶è¿›ç¨‹ï¼Œ0è¿”å›ç»™å­è¿›ç¨‹ å¤±è´¥ï¼š\t-1è¿”å›ç»™çˆ¶è¿›ç¨‹ï¼Œè®¾ç½®errno */ pid_t fork(); æ¡ˆä¾‹ï¼šåˆ›å»ºå­è¿›ç¨‹\n#include \u0026lt;unistd.h\u0026gt; #include \u0026lt;stdio.h\u0026gt; int glob = 10; int main() { int local; pid_t pid; local = 8; //å‘å­è¿›ç¨‹çš„pidä¼ å€¼0 if((pid = fork()) == 0) {\t//å­è¿›ç¨‹ sleep(1); printf(\u0026#34;i am in child process,%d\\n\u0026#34;,getpid()); }zijc else {\t//çˆ¶è¿›ç¨‹ printf(\u0026#34;i am in father process,%d\\n\u0026#34;,getpid()); glob++; local--; sleep(5); } printf(\u0026#34;pid = %d,glob = %d,localar = %d\\n\u0026#34;,getpid(),glob,local); return 0; } /*è¾“å‡ºä¸ºï¼š i am in father process,13023 i am in child process,13024 pid = 13024,glob = 10,localar = 8 pid = 13023,glob = 11,localar = 7 */ å½“ç”¨fork()å‡½æ•°åˆ›å»ºå­è¿›ç¨‹æ—¶ï¼ŒLinuxå†…æ ¸ä¸ºå­è¿›ç¨‹åˆ†é…ä¸€ä¸ªè¿›ç¨‹æ§åˆ¶å—task_structã€‚å­è¿›ç¨‹çš„è¿›ç¨‹æ§åˆ¶å—ç”¨æ¥å­˜æ”¾å­è¿›ç¨‹æ‹¥æœ‰çš„èµ„æºã€ç®¡ç†ä¿¡æ¯å’Œè¿›ç¨‹çŠ¶æ€ç­‰ã€‚\næ­¤æ—¶ï¼Œåœ¨çˆ¶å­è¿›ç¨‹æ²¡æœ‰å¯¹æ•°æ®è¿›è¡Œè¯»å†™æ“ä½œä¹‹å‰ï¼Œçˆ¶å­è¿›ç¨‹å…±äº«ç”¨æˆ·åœ°å€ç©ºé—´ã€‚å½“çˆ¶è¿›ç¨‹æ‰§è¡Œglob++ï¼ŒLinuxå†…æ ¸é‡‡ç”¨COWç®—æ³•ï¼Œé¦–å…ˆä¸ºå­è¿›ç¨‹åˆ›å»ºç›¸åº”çš„æ•°æ®åŒºï¼Œæ¥ç€å†…æ ¸å°†çˆ¶è¿›ç¨‹åœ°å€ç©ºé—´ä¸­çš„æ•°æ®åŒºç›¸å…³é¡µå¤åˆ¶åˆ°å­è¿›ç¨‹åœ°å€ç©ºé—´ä¸­æ•°æ®åŒºçš„ç›¸å…³é¡µ,æ­¤æ—¶ï¼Œçˆ¶å­è¿›ç¨‹å„è‡ªæ‹¥æœ‰ç‹¬ç«‹çš„å…¨å±€å˜é‡globã€‚å½“æ‰§è¡Œlocal\u0026ndash;è¯­å¥ï¼Œå†…æ ¸ä»¥åŒæ ·æ–¹æ³•åœ¨å­è¿›ç¨‹ç”¨æˆ·åœ°å€ç©ºé—´çš„æ ˆåŒºçš„ç›¸åº”é¡µå»ºç«‹å¤åˆ¶ã€‚è€Œä»£ç åŒºæ˜¯åªè¯»çš„ï¼Œæ‰€ä»¥çˆ¶å­è¿›ç¨‹å…±äº«ä»£ç åŒºï¼Œç›´æ¥å»ºç«‹æ˜ å°„ï¼Œä¸è¿›è¡Œå¤åˆ¶ã€‚\n###ç¨‹åºå¯åŠ¨å’Œç»“æŸ åˆå§‹åŒ–ç¨‹åº\nåœ¨åŠ è½½å¯æ‰§è¡Œæ–‡ä»¶åï¼Œé¦–å…ˆè¿è¡Œçš„æ˜¯ç§°ä¸ºstart-upçš„ä»£ç ï¼Œæ­¤éƒ¨åˆ†ä»£ç åœ¨ç¨‹åºé“¾æ¥ä¸ºå¯æ‰§è¡Œç¨‹åºæ—¶ï¼Œç”±é“¾æ¥å™¨åŠ å…¥ï¼Œä½œç”¨æ˜¯ä»å†…æ ¸è¯»å–è¿›ç¨‹è¿è¡Œçš„ç¯å¢ƒä¿¡æ¯ï¼Œå¦‚ç¯å¢ƒå˜é‡ã€å‘½ä»¤è¡Œå‚æ•°ç­‰ã€‚\nstart-upå®Œæˆåˆå§‹åŒ–å·¥ä½œåï¼Œè°ƒç”¨mainå‡½æ•°ï¼Œæ‰§è¡Œå®Œè¿›ç¨‹åï¼Œé€šè¿‡exitå‡½æ•°ç»“æŸè¿›ç¨‹ã€‚\nç»“æŸè¿›ç¨‹\næ¯ä¸ªè¿›ç¨‹éƒ½æœ‰çˆ¶è¿›ç¨‹ï¼Œå½“å­è¿›ç¨‹è¿è¡Œç»“æŸåï¼Œå­è¿›ç¨‹è¿›ç¨‹åƒµå°¸çŠ¶æ€ï¼Œå¹¶å‘çˆ¶è¿›ç¨‹å‘é€SIGCHLDä¿¡å·ï¼Œé€šçŸ¥å­è¿›ç¨‹å·²ç»ç»ˆæ­¢ã€‚åœ¨è¯¥çŠ¶æ€ä¸‹å­è¿›ç¨‹å‡ ä¹é‡Šæ”¾äº†æ‰€æœ‰å†…å­˜èµ„æºï¼Œä¸èƒ½è¢«é‡æ–°è°ƒåº¦ï¼Œä»…åœ¨è¿›ç¨‹åˆ—è¡¨ä¸­ä¿ç•™ä¸€ä¸ªä½ç½®ï¼Œåªä¿ç•™è¿›ç¨‹å¦‚ä½•ç»ˆæ­¢çš„ä¸€äº›çŠ¶æ€ä¿¡æ¯ï¼Œä»¥ä¾›å›æ”¶è€…ä½¿ç”¨ã€‚çˆ¶è¿›ç¨‹å¯ä»¥é€šè¿‡è°ƒç”¨waitæˆ–waitpidå‡½æ•°è·å–å­è¿›ç¨‹çš„é€€å‡ºç ï¼Œä»¥ä¾¿åˆ¤æ–­å­è¿›ç¨‹ç»“æŸçš„åŸå› ã€‚ç”±çˆ¶è¿›ç¨‹é‡Šæ”¾å­è¿›ç¨‹ä½™ä¸‹çš„æ‰€æœ‰èµ„æºã€‚\nä½†å½“çˆ¶è¿›ç¨‹åœ¨å­è¿›ç¨‹ä¹‹å‰ç»ˆæ­¢ï¼Œå­è¿›ç¨‹çš„çˆ¶è¿›ç¨‹å°†æ›´æ”¹ä¸ºinitè¿›ç¨‹ï¼Œç”±initè¿›ç¨‹è´Ÿè´£å­è¿›ç¨‹çš„å–„åå¤„ç†å·¥ä½œã€‚\n//ç»ˆæ­¢è¿›ç¨‹,statusè¿”å›å€¼ void exit(int status); /* ç™»è®°ç»ˆæ­¢å¤„ç†å‡½æ•°ï¼ŒANSI Cè§„å®šï¼Œä¸€ä¸ªè¿›ç¨‹å¯ä»¥ç™»è®°æœ€å¤š32ä¸ªç»ˆæ­¢å¤„ç†å‡½æ•°ï¼Œè¿™äº›å‡½æ•°ç”±exitè‡ªåŠ¨è°ƒç”¨ã€‚exitä»¥å…ˆè¿›åå‡ºçš„æ–¹å¼è°ƒç”¨atexitç™»è®°çš„å‡½æ•°ï¼ŒåŒä¸€å‡½æ•°ç™»è®°å¤šæ¬¡ï¼Œä¹Ÿè¢«è°ƒç”¨å¤šæ¬¡ã€‚ æ ¹æ®ANSI Cï¼Œexité¦–å…ˆè°ƒç”¨ç»ˆæ­¢å¤„ç†å‡½æ•°ï¼Œç„¶åæŒ‰éœ€è°ƒç”¨fcloseï¼Œå…³é—­æ‰€æœ‰æ‰“å¼€çš„æ–‡ä»¶æµï¼Œä¿è¯åŸºäºç¼“å†²åŒºçš„æ–‡ä»¶I/Oæ“ä½œå®Œæ•´æ€§ã€‚ è¿™æ ·ï¼Œåœ¨è¿›ç¨‹ç»“æŸå‰ï¼Œå°†æœªå†™å…¥æ–‡ä»¶çš„ç¼“å†²åŒºæ•°æ®ï¼Œé€šè¿‡exitå‡½æ•°è¿›è¡Œä¿å­˜ã€‚ funcç»ˆæ­¢å¤„ç†å‡½æ•° æˆåŠŸè¿”å›0ï¼Œå¦åˆ™é0 */ int atexit(void(*func)(void)); //ç›´æ¥ç»“æŸè¿›ç¨‹ï¼Œä¸è¿›è¡Œä»»ä½•å…¶ä»–å¤„ç† void _exit(int status); æ¡ˆä¾‹ï¼šç›´æ¥é€€å‡ºè¿›ç¨‹\n#include \u0026lt;unistd.h\u0026gt; #include \u0026lt;stdio.h\u0026gt; int main() { printf(\u0026#34;output begin\\n\u0026#34;); printf(\u0026#34;content in buffer\u0026#34;); printf(\u0026#34;drop the buffer\u0026#34;); _exit(0); } æ¡ˆä¾‹ï¼šç™»è®°ç»ˆæ­¢å¤„ç†å‡½æ•°\n#include \u0026lt;stdio.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; static void my_exit1(void) { printf(\u0026#34;first exit handler\\n\u0026#34;); } static void my_exit2(void) { printf(\u0026#34;second exit handler\\n\u0026#34;); } int main(void) { if(atexit(my_exit2) != 0) printf(\u0026#34;can\u0026#39;t register my_exit2\u0026#34;); if(atexit(my_exit1) != 0) printf(\u0026#34;can\u0026#39;t register my_exit1\u0026#34;); if(atexit(my_exit1) != 0) printf(\u0026#34;can\u0026#39;t register my_exit1\u0026#34;); printf(\u0026#34;main is done\\n\u0026#34;); return 0; } ###è¿›ç¨‹åŒæ­¥æ§åˆ¶\nå½“åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹åï¼Œçˆ¶å­è¿›ç¨‹çš„æ‰§è¡Œé¡ºåºæ— æ³•æ§åˆ¶ã€‚å½“çˆ¶å­è¿›ç¨‹åŒäº‹æ“ä½œå…±äº«èµ„æºï¼Œä¸åŒçš„æ‰§è¡Œæ¬¡åºæœ‰å¯èƒ½å¯¼è‡´ä¸åŒçš„è¿è¡Œç»“æœï¼Œä»è€Œå‡ºç°æ•°æ®ä¸ä¸€è‡´æ€§ã€‚ä¸ºè§£å†³è¿™ä¸€é—®é¢˜ï¼Œå¿…é¡»æä¾›è¿›ç¨‹é—´çš„åŒæ­¥æ§åˆ¶æœºåˆ¶ã€‚\nwaitå’Œwaitpidå¯ç”¨æ¥å®ç°çˆ¶å­è¿›ç¨‹åŒæ­¥ï¼Œç”¨æ¥ç­‰å¾…å­è¿›ç¨‹ç»“æŸã€‚ waitå‡½æ•°çš„åŠŸèƒ½æ˜¯è·å–å­è¿›ç¨‹å¦‚ä½•ç»ˆæ­¢çš„ä¿¡æ¯ï¼Œæ¸…é™¤å­è¿›ç¨‹çš„å‰©ä½™èµ„æºã€‚çˆ¶è¿›ç¨‹è°ƒç”¨waitå‡½æ•°ï¼Œè¿›å…¥é˜»å¡é˜Ÿåˆ—ï¼Œç­‰å¾…æŸä¸ªå­è¿›ç¨‹çš„ç»“æŸã€‚å½“å­è¿›ç¨‹ç»“æŸï¼Œä¼šäº§ç”Ÿç»“æŸçŠ¶æ€å­—status,å¹¶å‘çˆ¶è¿›ç¨‹å‘é€SIGCHLDä¿¡å·ã€‚ çˆ¶è¿›ç¨‹æ”¶åˆ°SIGCHLDä¿¡å·ï¼Œè‹¥å¸Œæœ›çŸ¥é“å­è¿›ç¨‹ç»“æŸçŠ¶æ€ï¼Œè°ƒç”¨wait,å¦åˆ™å¿½ç•¥è¯¥ä¿¡å·ã€‚\n/* æš‚åœæ‰§è¡Œï¼Œå°†å­è¿›ç¨‹ç»“æŸçŠ¶æ€å†™å…¥statusä¸­ï¼Œå¹¶ç¡®è®¤å­è¿›ç¨‹å·²ç»ç»“æŸ status å­è¿›ç¨‹çŠ¶æ€ æˆåŠŸè¿”å›å­è¿›ç¨‹PIDï¼Œå¦åˆ™è¿”å›-1 */ pid_t wait(int *status); /* ç­‰å¾…æŒ‡å®šå­è¿›ç¨‹ç»“æŸ pid æŒ‡å®šç­‰å¾…çš„å­è¿›ç¨‹ \u0026lt;-1 pidæ‰€ä»£è¡¨è¿›ç¨‹ç»„ä¸­è¿›ç¨‹ -1 ä»»ä½•å­è¿›ç¨‹ 0 ä¸è¯¥è¿›ç¨‹åŒç»„çš„è¿›ç¨‹ \u0026gt;0 è¿›ç¨‹æ ‡è¯†ç¬¦ä¸ºpidçš„è¿›ç¨‹ status ä¿å­˜å­è¿›ç¨‹çŠ¶æ€ options ç­‰å¾…æ–¹å¼ WNOHANG\tè¿›ç¨‹ä¸é˜»å¡ WUNTRACED å½“æœ‰å­è¿›ç¨‹ç»“æŸæ—¶è¿”å› */ pid_t waitpid(pid_t pid,int *status,int options); æ¡ˆä¾‹ï¼šä¾æ¬¡ç­‰å¾…å¤šä¸ªå­è¿›ç¨‹ç»“æŸï¼Œå¹¶æ˜¾ç¤ºç»“æŸçŠ¶æ€\n#include \u0026lt;unistd.h\u0026gt; #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;sys/wait.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; int main(void) { pid_t pid[10],wpid; int child_status,i; //åˆ›å»º5ä¸ªå­è¿›ç¨‹ for(i=0;i\u0026lt;5;i++) { if((pid[i]=fork()) == 0) exit(100+i); } //ç­‰å¾…å­è¿›ç¨‹ç»“æŸï¼Œè¾“å‡ºstatus for(i=0;i\u0026lt;5;i++) { wpid = waitpid(pid[i],\u0026amp;child_status,0); if(WIFEXITED(child_status)) printf(\u0026#34;Child %d exit with status %d\\n\u0026#34;, wpid,WEXITSTATUS(child_status)); else printf(\u0026#34;Child %d terminated abnormally\\n\u0026#34;,wpid); } return 0; } ","permalink":"https://blog.niuhemoon.win/posts/tech/linux-c-process-2/","summary":"Linuxå†…æ ¸æ”¯æŒç”¨æˆ·è¿›ç¨‹å’Œå†…æ ¸è¿›ç¨‹ä¸¤ç§è¿›ç¨‹ã€‚å†…æ ¸è¿›ç¨‹æŒ‡å®Œå…¨è¿è¡Œåœ¨å†…æ ¸ç©ºé—´çš„è¿›ç¨‹ï¼Œè¿™ç§è¿›ç¨‹ä¸»è¦å¤„ç†å†…æ ¸äº‹åŠ¡ï¼›ç”¨æˆ·è¿›ç¨‹ä¸€èˆ¬è¿è¡Œåœ¨ç”¨æˆ·æ€ï¼Œéœ€è¦ä½¿ç”¨å†…æ ¸èµ„æºæ—¶ï¼Œé€šè¿‡ç³»ç»Ÿè°ƒç”¨è¿›å…¥å†…æ ¸æ€ï¼Œç³»ç»Ÿè°ƒç”¨ç»“æŸåï¼Œé‡æ–°è¿”å›ç”¨æˆ·æ€ã€‚ ###åˆ›å»ºè¿›ç¨‹ å¯é€šè¿‡forkå‡½æ•°åˆ›å»ºå­è¿›ç¨‹ï¼Œç†è®ºä¸Šï¼Œçˆ¶å­è¿›ç¨‹æ‹¥æœ‰å„è‡ªç‹¬","title":"Linuxè¿›ç¨‹â€”â€”è¿›ç¨‹åˆ›å»ºå’ŒåŒæ­¥æ§åˆ¶"},{"content":" è¿›ç¨‹æ˜¯ç¨‹åºçš„ä¸€æ¬¡è¿è¡Œè¿‡ç¨‹ï¼Œé™¤äº†è¿›ç¨‹è™šæ‹Ÿåœ°å€ç©ºé—´å’Œæ–‡ä»¶æè¿°ç¬¦ç­‰ï¼Œè¿›ç¨‹æ§åˆ¶å—ä¸­è¿˜å­˜æ”¾äº†è¿›ç¨‹è¿è¡Œçš„ç¯å¢ƒä¿¡æ¯ï¼ŒåŒ…æ‹¬ç”¨æˆ·ã€ç”¨æˆ·ç»„ã€çˆ¶è¿›ç¨‹ã€è¿›ç¨‹ç»„å’Œä¼šè¯ç­‰ã€‚\n###ç”¨æˆ·å’Œç”¨æˆ·ç»„\n//è·å¾—å½“å‰è¿›ç¨‹å®é™…ç”¨æˆ·ID pid_t getuid(void); //è·å¾—å½“å‰è¿›ç¨‹æœ‰æ•ˆç”¨æˆ·ID pid_t geteuid(void); //è·å¾—å½“å‰è¿›ç¨‹å®é™…ç”¨æˆ·ç»„ID pid_t getgid(void); //è·å¾—å½“å‰è¿›ç¨‹æœ‰æ•ˆç”¨æˆ·ç»„ID pid_t getegid(void); ###è¿›ç¨‹å’Œè¿›ç¨‹ç»„ è·å¾—çˆ¶å­è¿›ç¨‹ID\n//è·å¾—å½“å‰è¿›ç¨‹ID pid_t getpid(void); //è·å¾—çˆ¶è¿›ç¨‹ID pid_t getppid(void); è¿›ç¨‹ç»„\næœ‰æ—¶ï¼Œä¸ºäº†å®ŒæˆæŸä¸ªå·¥ä½œï¼Œéœ€å¤šä¸ªè¿›ç¨‹å‚ä¸åä½œï¼Œä¸ºä¾¿äºç®¡ç†ï¼Œå¯ä»¥å°†å¤šä¸ªè¿›ç¨‹å®šä¹‰ä¸ºä¸€ä¸ªè¿›ç¨‹ç»„ã€‚ä¸€ä¸ªè¿›ç¨‹ç»„åŒ…å«ä¸€ä¸ªä»¥ä¸Šçš„è¿›ç¨‹ï¼Œé¢†å¤´è¿›ç¨‹çš„è¿›ç¨‹IDç­‰äºè¿›ç¨‹ç»„IDï¼Œè¿›ç¨‹ç»„ä¸­ä¸åŒ…å«è¿›ç¨‹æ—¶ï¼Œè¿›ç¨‹ç»„è‡ªåŠ¨æ¶ˆå¤±ã€‚\nä¼šè¯\nä¼šè¯ç”¨äºæ ‡è¯†ç”¨æˆ·ç™»å½•çš„æ¯ä¸€ä¸ªç»ˆç«¯ï¼Œæ¯ä¸ªç™»å½•ç»ˆç«¯éƒ½æœ‰ä¸€ä¸ªä¼šè¯IDä¸å…¶å¯¹åº”ï¼› ä¼šè¯åŒ…æ‹¬æ§åˆ¶è¿›ç¨‹ï¼ˆä¸ç»ˆç«¯å»ºç«‹è¿æ¥çš„é¢†å¤´è¿›ç¨‹ï¼‰ã€ä¸€ä¸ªå‰å°è¿›ç¨‹ç»„å’Œä»»æ„åå°è¿›ç¨‹ç»„ã€‚ä¸€ä¸ªä¼šè¯åªèƒ½æœ‰ä¸€ä¸ªæ§åˆ¶ç»ˆç«¯ï¼Œé€šå¸¸æ˜¯ç™»å½•åˆ°å…¶ä¸Šçš„ç»ˆç«¯è®¾å¤‡æˆ–ä¼ªç»ˆç«¯è®¾å¤‡ï¼Œäº§ç”Ÿåœ¨æ§åˆ¶ç»ˆç«¯ä¸Šçš„è¾“å…¥å’Œä¿¡å·å°†å‘é€ç»™ä¼šè¯çš„å‰å°è¿›ç¨‹ç»„ä¸­çš„æ‰€æœ‰è¿›ç¨‹ã€‚\nå¦‚æœè°ƒç”¨setsidå‡½æ•°çš„è¿›ç¨‹ä¸æ˜¯è¿›ç¨‹ç»„ä¸­çš„é¢†å¤´è¿›ç¨‹ï¼Œåˆ™å¯å»ºç«‹æ–°çš„ä¼šè¯ï¼Œï¼ˆå¯åœ¨å­è¿›ç¨‹ä¸­å»ºç«‹æ–°çš„ä¼šè¯ï¼‰ï¼Œè¯¥è¿›ç¨‹æˆä¸ºé¢†å¤´ä¼šè¯ï¼ŒåŒæ—¶äº§ç”Ÿä¸€ä¸ªæ–°çš„è¿›ç¨‹ç»„ï¼Œä¸”è¯¥è¿›ç¨‹ä¸ºæ–°è¿›ç¨‹ç»„çš„é¢†å¤´è¿›ç¨‹ï¼Œä½†ä¸æ‹¥æœ‰ç»ˆç«¯ã€‚\n/* è·å¾—è¿›ç¨‹æ‰€å±ä¼šè¯ID æˆåŠŸè¿”å›ä¼šè¯IDï¼Œé”™è¯¯è¿”å›-1 */ pid_t getsid(pid_t pid); /* åˆ›å»ºä¸€ä¸ªæ–°çš„ä¼šè¯ï¼Œä½¿è¿›ç¨‹ç»„IDç­‰äºè¯¥ä¼šè¯ID æˆåŠŸè¿”å›æ–°çš„è¿›ç¨‹ç»„IDï¼Œå¦åˆ™-1 */ pid_t setsid(void); æ¡ˆä¾‹ï¼šåœ¨å­è¿›ç¨‹ä¸­åˆ›å»ºæ–°çš„é¢†å¤´ä¼šè¯\n#include \u0026lt;unistd.h\u0026gt; #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; int main(void) { int p,pid; printf(\u0026#34;now session id %d\\n\\n\u0026#34;,getsid(getpid())); p = fork(); if(p) //çˆ¶è¿›ç¨‹é€€å‡º exit(0); pid = setsid(); printf(\u0026#34;new session id %d\\n\u0026#34;,pid); return pid; } ###å®ˆæŠ¤è¿›ç¨‹\nå®ˆæŠ¤è¿›ç¨‹æ˜¯ä¸€ç§è¿è¡Œåœ¨åå°ï¼Œä¸”ä¸å—ä»»ä½•ç»ˆç«¯å½±å“çš„è¿›ç¨‹ï¼Œå› æ­¤ï¼Œéœ€è¦å…³é—­æ ‡å‡†è¾“å…¥ã€æ ‡å‡†è¾“å‡ºã€æ ‡å‡†é”™è¯¯è¾“å‡ºçš„æ–‡ä»¶æè¿°ç¬¦.é€šå¸¸å®ˆæŠ¤è¿›ç¨‹ä»¥æœåŠ¡è¿›ç¨‹çš„å½¢å¼å­˜åœ¨ï¼Œä¾‹å¦‚webæœåŠ¡å™¨ã€‚\nåŒæ—¶è¦ä½¿å®ˆæŠ¤è¿›ç¨‹è„±ç¦»ç”¨æˆ·ç¯å¢ƒï¼Œæ‰€ä»¥è¦å°†å·¥ä½œç›®å½•ä¿®æ”¹ä¸ºç³»ç»Ÿå·¥ä½œç›®å½•ã€‚ åˆ›å»ºå®ˆæŠ¤è¿›ç¨‹æ­¥éª¤ï¼š\nåˆ›å»ºå­è¿›ç¨‹åç»“æŸçˆ¶è¿›ç¨‹ åœ¨å­è¿›ç¨‹ä¸­å»ºç«‹æ–°çš„é¢†å¤´ä¼šè¯ ä¿®æ”¹å·¥ä½œç›®å½•å’Œæƒé™æ©ç ä¿¡æ¯ å…³é—­æ–‡ä»¶æè¿°ç¬¦0,1,2 æ¡ˆä¾‹ï¼šåˆ›å»ºä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹\n#include \u0026lt;unistd.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;sys/stat.h\u0026gt; int daemon_init() { pid_t pid; char buf[80]; FILE * fout; if((pid = fork()) \u0026lt; 0) return -1; else if(pid != 0) exit(0); //ç»“æŸçˆ¶è¿›ç¨‹ setsid(); //åˆ›å»ºé¢†å¤´ä¼šè¯ system(\u0026#34;cd /\u0026#34;); //æ”¹å˜å·¥ä½œç›®å½• umask(0); //æ¸…é™¤æƒé™æ©ç  close(0); //å…³é—­æ–‡ä»¶æè¿°ç¬¦ close(1); close(2); getcwd(buf,sizeof(buf)); fout = fopen(\u0026#34;/tmp/result.txt\u0026#34;,\u0026#34;w\u0026#34;); fprintf(fout,\u0026#34;work dirctory is %s\\n\u0026#34;,buf); fprintf(fout,\u0026#34;daemon pid is %d\\n\u0026#34;,getpid()); fprintf(fout,\u0026#34;daemon parent pid is %d\\n\u0026#34;,getppid()); fclose(fout); return 0; } int main() { FILE * fout; printf(\u0026#34;start init daemon ...\u0026#34;); daemon_init(); while(1) { fout = fopen(\u0026#34;/tmp/result.txt\u0026#34;,\u0026#34;a\u0026#34;); fputs(\u0026#34;i am still alive\\n\u0026#34;,fout); fflush(fout); sleep(1); } } ###åŠ è½½å¯æ‰§è¡Œæ˜ åƒ\nå¯æ‰§è¡Œæ˜ åƒæ˜¯é“¾æ¥å¥½çš„å¯æ‰§è¡Œçš„ä»£ç ã€‚\né€šå¸¸ï¼Œå­è¿›ç¨‹åˆ›å»ºæ—¶ï¼Œç»§æ‰¿äº†çˆ¶è¿›ç¨‹çš„èµ„æºï¼Œçˆ¶å­è¿›ç¨‹å¯ä»¥å¹¶å‘è¿è¡Œï¼Œå®ƒä»¬ç”±åŒä¸€ä»£ç æµç¨‹æ§åˆ¶ï¼Œå…·æœ‰ç›¸ä¼¼è¡Œä¸ºã€‚æœ‰æ—¶ï¼Œå¸Œæœ›å­è¿›ç¨‹æ‹¥æœ‰ç‹¬ç«‹ä»£ç æµç¨‹ï¼Œå¯ä»¥é€šè¿‡åŠ è½½å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ˜ åƒæ–‡ä»¶æ¥å®ç°ã€‚å†…æ ¸é€šè¿‡execç³»ç»Ÿè°ƒç”¨åœ¨è¿›ç¨‹ä¸­å»ºç«‹æ–°çš„è¿è¡Œç¯å¢ƒã€‚\nELFæ ¼å¼\nLinuxç³»ç»Ÿä¸­ï¼Œé‡‡ç”¨ELF(Excutable and Linkable Format)ï¼ŒELFæœ‰3ä¸­åŸºæœ¬æ ¼å¼\nå¯æ‰§è¡Œæ ¼å¼ ç›®æ ‡æ–‡ä»¶(.oæ–‡ä»¶) å…±äº«åº“ï¼ˆ.soæ–‡ä»¶) åŠ è½½å¯æ‰§è¡Œæ–‡ä»¶\nELFçš„å¯æ‰§è¡Œæ–‡ä»¶çš„åŠ è½½æ˜¯é€šè¿‡ç³»ç»Ÿè°ƒç”¨execå®Œæˆçš„ï¼Œå½“è¿›ç¨‹è°ƒç”¨execå‡½æ•°åŠ è½½ELFå¯æ‰§è¡Œæ–‡ä»¶æ—¶ï¼Œexecå°†ä»¥æ–°åŠ è½½ç¨‹åºçš„æ®µæ›¿æ¢å½“å‰è¿›ç¨‹çš„ç›¸åº”çš„æ­£æ–‡ã€æ•°æ®ã€å †å’Œæ ˆæ®µï¼›åŒæ—¶ä¿ç•™å¤§éƒ¨åˆ†çš„è¿›ç¨‹å±æ€§ã€‚ä¾‹å¦‚è¿›ç¨‹IDã€çˆ¶è¿›ç¨‹IDã€è¿›ç¨‹ç»„IDã€å®é™…ç”¨æˆ·IDã€ä¼šè¯IDã€å½“å‰ç›®å½•ã€æ–‡ä»¶æè¿°ç¬¦ç­‰ã€‚\nä½†å½“åŠ è½½å¯æ‰§è¡Œæ–‡ä»¶çš„SETUIDæˆ–SETGIDä½è¢«è®¾ç½®ï¼Œè¿›ç¨‹çš„æœ‰æ•ˆç”¨æˆ·IDå’Œæœ‰æ•ˆç”¨æˆ·ç»„IDè¢«è®¾ç½®ä¸ºè¯¥æ–‡ä»¶çš„å±ä¸»IDå’Œå±ä¸»ç”¨æˆ·ç»„IDã€‚ execç›¸å…³å‡½æ•°åŸå‹ï¼š\n#include \u0026lt;unistd.h\u0026gt; int execl(const char *path,const char *arg,...) int execv(.........)......... int execle(........) int execve(.........) int execlp(.........) int execvp(.........) ","permalink":"https://blog.niuhemoon.win/posts/tech/linux-c-process-3/","summary":"è¿›ç¨‹æ˜¯ç¨‹åºçš„ä¸€æ¬¡è¿è¡Œè¿‡ç¨‹ï¼Œé™¤äº†è¿›ç¨‹è™šæ‹Ÿåœ°å€ç©ºé—´å’Œæ–‡ä»¶æè¿°ç¬¦ç­‰ï¼Œè¿›ç¨‹æ§åˆ¶å—ä¸­è¿˜å­˜æ”¾äº†è¿›ç¨‹è¿è¡Œçš„ç¯å¢ƒä¿¡æ¯ï¼ŒåŒ…æ‹¬ç”¨æˆ·ã€ç”¨æˆ·ç»„ã€çˆ¶è¿›ç¨‹ã€è¿›ç¨‹ç»„å’Œä¼šè¯ç­‰ã€‚ ###ç”¨æˆ·å’Œç”¨æˆ·ç»„ //è·å¾—å½“å‰è¿›ç¨‹å®é™…ç”¨æˆ·ID pid_t getuid(void); //è·å¾—å½“å‰è¿›ç¨‹æœ‰æ•ˆç”¨æˆ·ID pid_t geteuid(void); //è·å¾—å½“å‰è¿›ç¨‹å®é™…ç”¨æˆ·ç»„ID pid_t getgid(void); //è·å¾—å½“å‰è¿›ç¨‹æœ‰æ•ˆ","title":"Linuxè¿›ç¨‹â€”â€”è¿›ç¨‹ç¯å¢ƒä¸åŠ è½½å¯æ‰§è¡Œæ˜ åƒ"},{"content":" å¯æ‰§è¡Œç¨‹åºæ˜¯å­˜å‚¨åœ¨ç£ç›˜è®¾å¤‡ä¸Šç”±ä»£ç å’Œæ•°æ®æŒ‰æŸç§æ ¼å¼ç»„ç»‡çš„é™æ€å®ä½“ï¼Œè€Œè¿›ç¨‹æ˜¯å¯è¢«è°ƒåº¦çš„ä»£ç çš„åŠ¨æ€è¿è¡Œã€‚åœ¨Linuxç³»ç»Ÿä¸­ï¼Œåœ¨ä¸€ä¸ªè¿›ç¨‹çš„ç”Ÿå‘½å‘¨æœŸé‡Œï¼Œéƒ½æœ‰å„è‡ªçš„è¿è¡Œç¯å¢ƒå’Œæ‰€éœ€çš„èµ„æºï¼Œè¿™äº›ä¿¡æ¯å‚¨å­˜åœ¨å„è‡ªçš„è¿›ç¨‹æ§åˆ¶å—ä¸­ã€‚\nè¿›ç¨‹æ§åˆ¶å—ä¸»è¦ç»“æ„å¦‚ä¸‹:\nç”¨æˆ·æ ‡è¯† è¿›ç¨‹å’Œä¼šè¯æ ‡è¯† è™šæ‹Ÿåœ°å€ç®¡ç† æ–‡ä»¶æè¿°ç¬¦è¡¨ ä¿¡å· ###è¿›ç¨‹åœ°å€ç©ºé—´\nåœ¨32ä½åœ°å€æ€»çº¿çš„è®¡ç®—æœºä¸Šï¼Œæ¯ä¸ªè¿›ç¨‹æ‹¥æœ‰4GBçš„è™šæ‹Ÿåœ°å€ç©ºé—´ã€‚\nå¯æ‰§è¡Œç¨‹åºè¢«åŠ è½½è‡³è¿›ç¨‹çš„ç”¨æˆ·è™šæ‹Ÿåœ°å€ç©ºé˜¿é‡‘ï¼Œå³å°†å¯æ‰§è¡Œç¨‹åºä¸­çš„ä»£ç æ®µå’Œæ•°æ®æ®µçš„å†…å®¹å¤åˆ¶åˆ°ç”¨æˆ·åœ°å€ç©ºé—´ã€‚ä¸ºäº†æ‰§è¡Œç¨‹åºï¼Œå†…æ ¸éœ€åœ¨ç”¨æˆ·è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­å»ºç«‹ä¸€äº›è¾…åŠ©åŒºåŸŸï¼Œä¾‹å¦‚å †åŒºå’Œæ ˆåŒºç­‰ï¼Œä»è€Œå°†ç”¨æˆ·è™šæ‹Ÿåœ°å€ç©ºé—´åˆ’åˆ†ä¸ºè‹¥å¹²åŒºåŸŸï¼Œåˆ†åˆ«ä¸ºä»£ç åŒºã€æœªåˆå§‹åŒ–æ•°æ®åŒºã€åˆå§‹åŒ–æ•°æ®åŒºã€ç¯å¢ƒå˜é‡å’Œå‘½ä»¤è¡Œå‚æ•°åŒºã€å †åŒºã€æ ˆåŒºã€‚ä¸åŒåŒºåŸŸä¸­å­˜å‚¨äº†ä¸åŒçš„ä¿¡æ¯ï¼Œæœ‰å„è‡ªä¸åŒçš„å±æ€§ã€‚\nä»£ç åŒº\nåŒ…å«æŒ‡ä»¤åºåˆ—å’Œåªè¯»æ•°æ®ï¼Œæ²¡å’Œåœ¨åˆ›å»ºè¿›ç¨‹åŠ è½½å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ˜ åƒæ–‡ä»¶æ—¶ï¼Œå°†è¿™éƒ¨åˆ†å†…å®¹æ˜ å°„åˆ°è¿›ç¨‹çš„ç”¨æˆ·åœ°å€ç©ºé—´å½¢æˆä»£ç åŒºã€‚è¿›ç¨‹è¿è¡ŒæœŸé—´ï¼Œä»£ç åŒºå†…å®¹ä¸ä¼šæ”¹å˜ã€‚\nå› æ­¤ï¼Œä¸€ä¸ªå¯æ‰§è¡Œæ˜ åƒçš„å¤šä¸ªè¿›ç¨‹å¯å…±äº«ä»£ç åŒºï¼Œåªéœ€ä¿æŒä¸€ä¸ªå¤åˆ¶ã€‚\nåœ¨å¯æ‰§è¡Œæ˜ åƒæ–‡ä»¶ä¸­ï¼Œä»£ç åŒºçš„å†…å®¹è¢«ä¿å­˜åœ¨æ–‡æœ¬æ®µä¸­ï¼Œæ–‡æœ¬æ®µåˆç§°ä»£ç æ®µã€‚\næœªåˆå§‹åŒ–æ•°æ®åŒº\nåœ¨å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ˜ åƒæ–‡ä»¶ä¸­ï¼Œæœªåˆå§‹åŒ–æ•°æ®åŒ…æ‹¬æ²¡æœ‰åˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œé™æ€å±€éƒ¨å˜é‡ï¼Œå®ƒä»¬åœ¨æ˜ åƒæ–‡ä»¶ä¸­ä¸å ç”¨å‚¨å­˜ç©ºé—´ï¼Œåªä¿ç•™å…¶åœ°å€å’Œå¤§å°ä¿¡æ¯ã€‚\nè‹¥æ˜ åƒæ–‡ä»¶ä¸­å­˜åœ¨æœªåˆå§‹åŒ–æ•°æ®æ®µï¼Œå†…æ ¸åˆ›å»ºè¿›ç¨‹æ—¶ï¼Œåœ¨è¿›ç¨‹çš„ç”¨æˆ·åœ°å€ç©ºé—´ä¸­ä¸ºå…¶åˆ†é…ä¸€å—åŒºåŸŸï¼Œç”¨äºè¿›ç¨‹è¿è¡Œè¿‡ç¨‹ä¸­å¯¹æœªåˆå§‹åŒ–æ•°æ®çš„å­˜å–ï¼Œæˆä¸ºæœªåˆå§‹åŒ–æ•°æ®åŒºã€‚\nåˆå§‹åŒ–æ•°æ®åŒº\nåˆå§‹åŒ–æ•°æ®åŒºåŒ…æ‹¬å·²åˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œé™æ€å±€éƒ¨å˜é‡ã€‚åœ¨æ˜ åƒæ–‡ä»¶ä¸­ï¼Œåˆå§‹åŒ–æ•°æ®è¢«ç»„ç»‡åœ¨æ•°æ®æ®µä¸­ï¼Œå†…æ ¸å°†åˆå§‹åŒ–æ•°æ®æ®µæ˜ å°„è‡³ç”¨æˆ·åœ°å€ç©ºé—´å½¢æˆåˆå§‹åŒ–æ•°æ®åŒºã€‚è¯¥åŒºå†…å®¹è¿è¡Œè¿‡ç¨‹ä¸­ä¼šå‘ç”Ÿå˜åŒ–ï¼Œä¸€ä¸ªç¨‹åºçš„å¤šä¸ªè¿›ç¨‹å®ä½“æ‹¥æœ‰å„è‡ªçš„æ•°æ®åŒºã€‚\nå †heap\nå †ä½äºæ•°æ®åŒºå’Œæ ˆä¹‹é—´ï¼Œç”¨äºåº”ç”¨ç¨‹åºçš„åŠ¨æ€å†…å­˜ç®¡ç†ã€‚Linuxå°†åŠ¨æ€å†…å­˜çš„ç®¡ç†é€šè¿‡glibcå®ç°ã€‚Linuxçš„è¿›ç¨‹æ§åˆ¶å—ä¸­è®°å½•äº†è™šæ‹Ÿå†…å­˜å„åŒºåŸŸçš„åœ°å€ä¿¡æ¯ï¼Œå®ƒä»¬åœ¨è¿›ç¨‹åˆå§‹åŒ–æ—¶ç”±ç³»ç»Ÿè®¾ç½®ï¼Œå…¶ä¸­åŒ…å«å †çš„èµ·å§‹åœ°å€å’Œç»“æŸåœ°å€ã€‚\nåœ¨åˆå§‹çŠ¶æ€ä¸‹ï¼ŒbrkæŒ‡é’ˆæŒ‡å‘å †çš„é¡¶éƒ¨ã€‚å †åŒºå¤§å°å¯ä»¥é€šè¿‡brkå’Œsbrkå‡½æ•°è°ƒæ•´ã€‚\næ ˆstack\næ ˆç”¨æ¥å­˜æ”¾è¿›ç¨‹è¿è¡Œè¿‡ç¨‹ä¸­çš„å±€éƒ¨å˜é‡ã€å‡½æ•°è¿”å›åœ°å€ã€å‚æ•°å’Œè¿›ç¨‹ä¸Šä¸‹æ–‡ç¯å¢ƒã€‚\nç¯å¢ƒå˜é‡å’Œå‘½ä»¤è¡Œ\nç¯å¢ƒå˜é‡ç»§æ‰¿è‡ªçˆ¶è¿›ç¨‹ï¼Œä½œç”¨èŒƒå›´æ˜¯è¿›ç¨‹æœ¬èº«åŠå…¶å­å­™è¿›ç¨‹ã€‚å‘½ä»¤è¡Œä¿å­˜æ‰§è¡Œç¨‹åºæ—¶çš„è¾“å…¥å‚æ•°ï¼Œå®ƒä»¬éƒ½è¢«ä¿å­˜åœ¨æ ˆåŒºåŸŸã€‚\nè‡ªç”±ç©ºé—´\nå †æ ˆä¹‹é—´çš„è‡ªç”±ç©ºé—´ï¼Œå†…æ ¸å¯ä¸ºè¿›ç¨‹åˆ›å»ºæ–°çš„åŒºåŸŸç”¨äºåŠ è½½å…±äº«åº“ã€æ˜ å°„å…±äº«å†…å­˜å’Œæ˜ å°„æ–‡ä»¶I/Oç­‰ï¼Œå¯ä»¥é€šè¿‡mmapå’Œmunmapå‡½æ•°ç”³è¯·å’Œé‡Šæ”¾ã€‚\n###ç¯å¢ƒå˜é‡/å‘½ä»¤è¡Œå‚æ•°\næ¯ä¸ªè¿›ç¨‹çš„ç¯å¢ƒå˜é‡ä»¥å­—ç¬¦ä¸²çš„å½¢å¼å­˜æ”¾åœ¨æ•°ç»„ä¸­ï¼Œæ•°ç»„åœ°å€å­˜æ”¾åœ¨å…¨å±€å˜é‡environä¸­ï¼Œå¯é€šè¿‡getenvå’Œputenvå¯¹ç¯å¢ƒå˜é‡è¿›è¡Œå­˜å–ã€‚\nå‘½ä»¤è¡Œå‚æ•°ä¿å­˜åœ¨ç”¨æˆ·åœ°å€ç©ºé—´çš„æ ˆåŒºåŸŸã€‚\næ¡ˆä¾‹ï¼šæ˜¾ç¤ºå½“å‰è¿›ç¨‹æ‰€æœ‰ç¯å¢ƒå˜é‡\n#include \u0026lt;stdio.h\u0026gt; int main(int argc,char *argv[]) { int i; char **ptr; extern char **environ; for (ptr = environ;*ptr != NULL;ptr++) printf(\u0026#34;%s\\n\u0026#34;,*ptr); return 0; } æ¡ˆä¾‹:ä½¿ç”¨getenvå’Œputenvå­˜å–ç¯å¢ƒå˜é‡\n#include \u0026lt;stdio.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; int main(int argc,char *argv[],char *envp[]) { int i; extern char **environ; printf(\u0026#34;form argument envp\\n\u0026#34;); for(i=0;envp[i];i++) puts(envp[i]); putenv(\u0026#34;HONE=/\u0026#34;); printf(\u0026#34;\\nFrom global variable environ\\n\u0026#34;); for(i=0;environ[i];i++) puts(environ[i]); return 0; } æ¡ˆä¾‹:æ˜¾ç¤ºæ‰€æœ‰å‘½ä»¤è¡Œå‚æ•°\n#include \u0026lt;stdio.h\u0026gt; int main(int argc,char *argv[]) { int i; for(i=0;i\u0026lt;argc;i++) printf(\u0026#34;argv[%d}:%s\\n\u0026#34;,i,argv[i]); return 0; } ###åŠ¨æ€å†…å­˜ç®¡ç†\nå †ä»‹äºæ ˆå’Œå…¨å±€æ•°æ®åŒºä¹‹é—´ï¼Œè¿™éƒ¨åˆ†ç©ºé—´ç”¨äºè¿›ç¨‹çš„åŠ¨æ€å†…å­˜åˆ†é…ï¼Œå †é‡‡ç”¨è‡ªä¸‹å‘ä¸Šç”Ÿé•¿ã€‚ç›¸å…³APIå‡½æ•°å¦‚ä¸‹ï¼š\nvoid *malloc(size_t size); void free(void *ptr); /* è®¾ç½®å †åŒºåŸŸçš„å¤§å° pendè®¾ç½®æ•°æ®åŒºåŸŸçš„è¾¹ç•Œ incræ‰©å±•å †åŒºåŸŸçš„å­—èŠ‚æ•° å¯¹brk,æˆåŠŸè¿”å›0ï¼Œå¦åˆ™-1 å¯¹sbrkæˆåŠŸè¿”å›åŸæ¥çš„brk,å¦åˆ™-1 */ int brk(void *pend); void *sbrk(int incr); æ¡ˆä¾‹:ä½¿ç”¨brkå’Œsbrkè°ƒæ•´heapå¤§å°\n#include \u0026lt;stdio.h\u0026gt; #include \u0026lt;unistd.h\u0026gt; extern int etext,edata,end; void foo(int); int main() { int ret; void *bv; printf(\u0026#34;text ends at %10p\\n\u0026#34;,\u0026amp;etext);\tprintf(\u0026#34;initailized data ends at %10p\\n\u0026#34;,\u0026amp;edata); printf(\u0026#34;uninitialized data ends at %10p\\n\u0026#34;,\u0026amp;end); bv = sbrk(0); //å½“å‰å †åŒºè¾¹ç•Œåœ°å€ printf(\u0026#34;Current break value is %10p \\n\\n\u0026#34;,bv); ret = brk(bv+512); puts(\u0026#34;heap incresed 512bytes\u0026#34;); printf(\u0026#34;brk returned ....%d\\n\u0026#34;,ret); bv = sbrk(0); //å½“å‰å †åŒºè¾¹ç•Œåœ°å€ printf(\u0026#34;Current break value is %10p \\n\\n\u0026#34;,bv); foo(64); foo(-1024); return 0; } void foo(int size) { void *bv; bv = sbrk(size); printf(\u0026#34;heap increased %dbytes\\n\u0026#34;,size); printf(\u0026#34;sbrk returned %10p\\n\u0026#34;,bv); bv = sbrk(0); //å½“å‰å †åŒºè¾¹ç•Œåœ°å€ printf(\u0026#34;Current break value is %10p \\n\\n\u0026#34;,bv); } æ³¨\né€šè¿‡brkã€sbrkã€mmapç³»ç»Ÿè°ƒç”¨ä¼šé¢‘ç¹çš„è§¦å‘è½¯ä¸­æ–­ï¼Œä½¿ç¨‹åºé™·å…¥å†…æ ¸æ€ï¼Œæ¯”è¾ƒæ¶ˆè€—èµ„æºã€‚ä¸ºäº†è¾ƒå°‘ç³»ç»Ÿè°ƒç”¨äº§ç”Ÿçš„æŸè€—ï¼Œglibcé‡‡ç”¨å†…å­˜æ± çš„è®¾è®¡ï¼Œå¢åŠ ä¸€ä¸ªä»£ç†å±‚ï¼Œæ¯æ¬¡å†…å­˜åˆ†é…ï¼Œä¼˜å…ˆä»å†…å­˜æ± ä¸­å¯»æ‰¾ä¸€ä¸ªå¤§å°ç›¸è¿‘çš„å†…å­˜å—(chunk),è‹¥å†…å­˜æ± ä¸­æ— æ³•æä¾›ï¼Œå†å‘å†…æ ¸ç”³è¯·ã€‚\nå…·ä½“å‚è€ƒglibcå†…å­˜ç®¡ç†\n","permalink":"https://blog.niuhemoon.win/posts/tech/linux-c-process-1/","summary":"å¯æ‰§è¡Œç¨‹åºæ˜¯å­˜å‚¨åœ¨ç£ç›˜è®¾å¤‡ä¸Šç”±ä»£ç å’Œæ•°æ®æŒ‰æŸç§æ ¼å¼ç»„ç»‡çš„é™æ€å®ä½“ï¼Œè€Œè¿›ç¨‹æ˜¯å¯è¢«è°ƒåº¦çš„ä»£ç çš„åŠ¨æ€è¿è¡Œã€‚åœ¨Linuxç³»ç»Ÿä¸­ï¼Œåœ¨ä¸€ä¸ªè¿›ç¨‹çš„ç”Ÿå‘½å‘¨æœŸé‡Œï¼Œéƒ½æœ‰å„è‡ªçš„è¿è¡Œç¯å¢ƒå’Œæ‰€éœ€çš„èµ„æºï¼Œè¿™äº›ä¿¡æ¯å‚¨å­˜åœ¨å„è‡ªçš„è¿›ç¨‹æ§åˆ¶å—ä¸­ã€‚ è¿›ç¨‹æ§åˆ¶å—ä¸»è¦ç»“æ„å¦‚ä¸‹: ç”¨æˆ·æ ‡è¯† è¿›ç¨‹å’Œä¼šè¯æ ‡è¯† è™šæ‹Ÿåœ°å€ç®¡ç† æ–‡ä»¶æè¿°ç¬¦è¡¨","title":"Linuxè¿›ç¨‹â€”â€”åœ°å€ç©ºé—´"},{"content":" Linuxæä¾›äº†åº”ç”¨ç¼–ç¨‹æ¥å£ï¼Œé€šè¿‡è¿™äº›æ¥å£ï¼Œè¿›ç¨‹å¯ä»¥å‘å…¶ä»–è¿›ç¨‹æˆ–è¿›ç¨‹ç»„å‘é€ä¿¡å·ã€‚rootæƒé™çš„è¿›ç¨‹å¯ä»¥å‘ä»»ä½•è¿›ç¨‹å‘é€ä¿¡å·ï¼Œérootæƒé™çš„è¿›ç¨‹æ™ºèƒ½å‘å±äºåŒä¸€ä¸ªå›è¯æˆ–åŒä¸€ä¸ªç”¨æˆ·çš„è¿›ç¨‹å‘é€ä¿¡å·ã€‚\n###å‘é€ä¿¡å·\nå¸¸ç”¨çš„å‡½æ•°åŸå‹å¦‚ä¸‹\n/* å‘è¿›ç¨‹å‘é€ä¿¡å· pid\u0026gt;0 è¿›ç¨‹IDä¸ºpidçš„è¿›ç¨‹ pid=0 åŒä¸€è¿›ç¨‹ç»„çš„è¿›ç¨‹ pid\u0026lt;0 \u0026amp;\u0026amp; pid!=-1 è¿›ç¨‹ç»„IDä¸º-pidçš„æ‰€æœ‰è¿›ç¨‹ pid=-1 é™¤å‘é€ç»™è¿›ç¨‹è‡ªèº«å¤–ï¼Œè¿˜å‘é€ç»™æ‰€æœ‰è¿›ç¨‹ID\u0026gt;1çš„è¿›ç¨‹ æˆåŠŸè¿”å›0ï¼Œå¦åˆ™-1 */ int kill(pid_t pid,int signo); /*å‘è¿›ç¨‹æœ¬èº«å‘é€ä¿¡å·ï¼Œç­‰ä»·äºkill(getpid(),sig),æˆåŠŸè¿”å›0ï¼Œå¦åˆ™-1*/ int raise(int signo); /*å‘è¿›ç¨‹å‘é€SIGABORTä¿¡å·,é»˜è®¤æƒ…å†µä¸‹è¿›ç¨‹ä¼šé€€å‡º*/ void abort(void); /* å‘è¿›ç¨‹å‘é€å®æ—¶ä¿¡å· pid æ¥æ”¶ä¿¡å·çš„è¿›ç¨‹IDï¼Œåªèƒ½å‘ä¸€ä¸ªè¿›ç¨‹å‘é€ä¿¡å· sig æŒ‡å®šå³å°†å‘é€çš„ä¿¡å· valæŒ‡å®šä¿¡å·ä¼ é€’çš„å‚æ•° æˆåŠŸè¿”å›0ï¼Œå¦åˆ™-1 */ int sigqueue(pid_t pid,int sig,const union sigval val); union sigval { int sival_int;\t//ä¼ é€ä¸€ä¸ªæ•´å½¢æ•° void *sival_ptr;\t//ä¼ é€ä»»ä½•æ•°æ®ç»“æ„çš„æŒ‡é’ˆ }; typedef struct { int si_signo; int si_code; union sigval si_value; int si_errno; pid_t si_pid; uid_t si_uid; void *si_addr; int si_status; int si_band; } siginfo_t; æ¡ˆä¾‹:ä½¿ç”¨sigqueueå‘é€å¸¦å‚æ•°çš„ä¿¡å·\n#include \u0026lt;signal.h\u0026gt; #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;unistd.h\u0026gt; void SigHandler(int signo,siginfo_t *info,void *context) { printf(\u0026#34;%s\\n\u0026#34;,(char *)info-\u0026gt;si_value.sival_ptr); } int main() { struct sigaction sigAct; sigval_t val; char *pMsg = \u0026#34;i still believe\u0026#34;; sigAct.sa_flags = SA_SIGINFO; sigAct.sa_sigaction=SigHandler; if(sigaction(SIGUSR1,\u0026amp;sigAct,NULL)==-1) { printf(\u0026#34;fail set sig_handler\u0026#34;); return 1; } val.sival_ptr=pMsg; if(sigqueue(getpid(),SIGUSR1,val)==-1) { printf(\u0026#34;fail send sigqueue\u0026#34;); return 2; } sleep(3); } ###sleepç¡çœ å»¶æ—¶\nå¯ä»¥ä½¿ç”¨sleepå‡½æ•°å°†ç¨‹åºå»¶è¿Ÿä¸€æ®µæ—¶é—´åç»§ç»­æ‰§è¡Œï¼Œå…¶å®ç°æœºåˆ¶æ˜¯ï¼š\nè°ƒç”¨alarmå‡½æ•°è®¾ç½®å»¶è¿Ÿæ—¶é—´ è°ƒç”¨pauseå‡½æ•°æŒ‚èµ·è¿›ç¨‹ï¼Œç­‰å¾…ç³»ç»Ÿå‘é€SIGALARMä¿¡å·ï¼Œå½“SIGALARMä¿¡å·åˆ°è¾¾è¿›ç¨‹æ—¶ï¼Œè¿›ç¨‹è¢«å”¤é†’ã€‚ /* è®¾ç½®æ—¶é—´é—¹é’Ÿ secondsè¡¨ç¤ºé—¹é’Ÿé—´éš”æ—¶é—´ï¼ŒåŸæœ‰é—¹é’Ÿæ— æ•ˆ è‹¥è°ƒç”¨alarmå‡½æ•°å‰ï¼Œè¿›ç¨‹å·²ç»è®¾ç½®äº†é—¹é’Ÿï¼Œåˆ™è¿”å›ä¸Šä¸€ä¸ªé—¹é’Ÿå‰©ä½™æ—¶é—´ï¼Œå¦åˆ™è¿”å›0 */ unsigned int alarm(unsigned int seconds); //ç­‰å¾…ä¿¡å·,è¿›ç¨‹æ”¶åˆ°ä¿¡å·åï¼Œæ‰§è¡Œä¿¡å·å¤„ç†å‡½æ•°ï¼Œpauseå‡½æ•°è¿”å›ï¼ŒåŸè¿›ç¨‹ç»§ç»­æ‰§è¡Œ void pause(); æ¡ˆä¾‹ï¼šå®ç°sleepå‡½æ•°\n#include \u0026lt;stdio.h\u0026gt; #include \u0026lt;signal.h\u0026gt; #include \u0026lt;unistd.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; void alarmhandler(int signum) { printf(\u0026#34;Alarm received from kernel\\n\u0026#34;); } int mysleep(unsigned int time) { printf(\u0026#34;about to sleep for %d seconds\\n\u0026#34;,time); signal(SIGALRM,alarmhandler); alarm(time); pause(); printf(\u0026#34;continue from alarm \\n\u0026#34;); return 0; } int main(int argc,char *argv[]) { printf(\u0026#34;start run the program.\\n\u0026#34;); unsigned int time = atoi(argv[1]); mysleep(time); printf(\u0026#34;i am awake,haha\\n\u0026#34;); return 0; } é—´éš”è®¡æ—¶å™¨ alarmå‡½æ•°è®¡æ—¶å•ä½æ˜¯ç§’ï¼Œå½“å»¶è¿Ÿæ—¶é—´åˆ°æ¥ï¼Œåªèƒ½è§¦å‘ä¸€æ¬¡ã€‚ä¸èƒ½æ»¡è¶³éœ€è¦é«˜ç²¾åº¦æ—¶é—´ã€æœ‰å‘¨æœŸæ€§å®šæ—¶éœ€æ±‚çš„éœ€æ±‚ã€‚ä¸ºæ­¤ï¼Œå¼•å…¥é—´éš”è®¡æ—¶å™¨ï¼Œå…¶åŸç†æ˜¯ï¼š\nå½“ç­‰å¾…æ—¶é—´æ¥åˆ°ï¼Œå†…æ ¸å‘å¤„äºç­‰å¾…çŠ¶æ€çš„è¿›ç¨‹å‘é€ä¿¡å·ï¼ŒåŒæ—¶ï¼Œå†æ¬¡è®¾ç½®æ—¶é—´é—´éš”ã€‚é—´éš”è®¡æ—¶å™¨å±äºé¢å‘è¿›ç¨‹çš„è®¡æ—¶å™¨ã€‚\nè¿›ç¨‹è¿è¡Œæ—¶é—´\né€šå¸¸ï¼ŒLInuxç³»ç»Ÿæœ€å°æ—¶é’Ÿé—´éš”æ˜¯10msï¼Œæ„å‘³ç€æ¯ç§’äº§ç”Ÿ100ä¸ªæ—¶é’Ÿä¸­æ–­ã€‚è¿›ç¨‹ä»¥æ—¶é—´ç‰‡çš„å½¢å¼åˆ†äº«CPUï¼Œè¿›ç¨‹çš„æ‰§è¡Œæœ‰ä¸¤ç§æ¨¡å¼ï¼šç”¨æˆ·æ€å’Œå†…æ ¸æ€ã€‚å½“è¿›ç¨‹æ‰§è¡Œçš„æ˜¯ç”¨æˆ·åœ°å€ç©ºé—´çš„ä»£ç ï¼Œç§°è¿›ç¨‹è¿è¡Œåœ¨ç”¨æˆ·æ€ï¼›å½“è¿›ç¨‹è¿›å…¥ç³»ç»Ÿè°ƒç”¨æˆ–ç¡¬ä»¶ä¸­æ–­ï¼Œç§°è¿›ç¨‹è¿è¡Œåœ¨å†…æ ¸æ€ã€‚æ­¤å¤–ï¼Œè¿›ç¨‹è¿˜æœ‰ä¼‘çœ æ€ï¼Œå³å°†CPUäº¤ç»™å…¶ä»–è¿›ç¨‹ã€‚æ‰€ä»¥è¿›ç¨‹å¹¶éæ—¶åˆ»éƒ½åœ¨è¿è¡Œï¼Œè€Œæ˜¯åœ¨ç”¨æˆ·æ€ã€å†…æ ¸æ€ã€ä¼‘çœ æ€ä¹‹é—´åˆ‡æ¢ã€‚\nç”±æ­¤å†…æ ¸æä¾›ä¸‰ç§è®¡æ—¶å™¨ï¼š\nçœŸå®æ—¶é—´\tç”¨æˆ·æ€+å†…æ ¸æ€+ä¼‘çœ æ€æ—¶é—´ è™šæ‹Ÿæ—¶é—´\tç”¨æˆ·æ€æ—¶é—´ å®ç”¨æ—¶é—´\tç”¨æˆ·æ€+å†…æ ¸æ€æ—¶é—´ /* è·å¾—å½“å‰è¿›ç¨‹ä¸­æŒ‡å®šç±»å‹é—´éš”è®¡æ—¶å™¨çš„å€¼ which è®¡æ—¶å™¨ç±»å‹ ITIMER_REAL\tçœŸå®æ—¶é—´ï¼Œç»è¿‡æŒ‡å®šæ—¶é—´ï¼Œå†…æ ¸å‘é€SIGALRMé™å· ITIMER_VIRTUAL\tç”¨æˆ·æ€æ—¶é—´ï¼Œç»è¿‡æŒ‡å®šæ—¶é—´ï¼Œå†…æ ¸å‘é€SIGVTALRMä¿¡å· ITIMER_PROF\tå®ç”¨æ—¶é—´ï¼Œç»è¿‡æŒ‡å®šæ—¶é—´ï¼Œå†…æ ¸å‘é€SIGPRTä¿¡å· value å­˜å‚¨è·å¾—çš„é—´éš”è®¡æ—¶å™¨çš„å€¼ */ int getitimer(int which,struct itmerval *value); struct itimerval { struct timeval it_interval;\t//ä¸‹ä¸€ä¸ªå€¼ struct timeval it_value\t//å½“å‰å€¼ }; struct timeval { long tv_sec;\t//ç§’ long tv_usec;\t//å¾®ç§’ }; /* è®¾ç½®é—´éš”è®¡æ—¶å™¨ which æŒ‡å®šå®šæ—¶å™¨ç±»å‹ newvalæŒ‡å‘è¢«è®¾ç½®å€¼ oldvalæŒ‡å‘è¢«æ›¿æ¢è®¾ç½®å€¼ æˆåŠŸè¿”å›0ï¼Œå¦åˆ™-1 è‹¥oldvalä¸ä¸ºNULLï¼Œä¹‹å‰è®¡æ—¶å™¨çš„å€¼å°†è¢«å¤åˆ¶åˆ°oldval */ int setitimer(int which,const struct itimerval *newval,struct itimerval *oldval); ","permalink":"https://blog.niuhemoon.win/posts/tech/linux-c-signal-2/","summary":"Linuxæä¾›äº†åº”ç”¨ç¼–ç¨‹æ¥å£ï¼Œé€šè¿‡è¿™äº›æ¥å£ï¼Œè¿›ç¨‹å¯ä»¥å‘å…¶ä»–è¿›ç¨‹æˆ–è¿›ç¨‹ç»„å‘é€ä¿¡å·ã€‚rootæƒé™çš„è¿›ç¨‹å¯ä»¥å‘ä»»ä½•è¿›ç¨‹å‘é€ä¿¡å·ï¼Œérootæƒé™çš„è¿›ç¨‹æ™ºèƒ½å‘å±äºåŒä¸€ä¸ªå›è¯æˆ–åŒä¸€ä¸ªç”¨æˆ·çš„è¿›ç¨‹å‘é€ä¿¡å·ã€‚ ###å‘é€ä¿¡å· å¸¸ç”¨çš„å‡½æ•°åŸå‹å¦‚ä¸‹ /* å‘è¿›ç¨‹å‘é€ä¿¡å· pid\u0026gt;0 è¿›ç¨‹IDä¸ºpidçš„è¿›ç¨‹ pid=0 åŒä¸€è¿›ç¨‹ç»„çš„è¿›ç¨‹","title":"Linuxä¿¡å·å¤„ç†â€”â€”å‘é€ä¿¡å·"},{"content":"æ–‡ä»¶ç³»ç»Ÿæ¦‚è¿° Linuxå†…æ ¸çš„å„ç§çœŸå®æ–‡ä»¶ç³»ç»Ÿã€å—è®¾å¤‡å’Œå­—ç¬¦è®¾å¤‡ç»Ÿä¸€åœ¨è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿçš„æ¡†æ¶ä¸­ï¼Œè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿä¸ºåº”ç”¨æä¾›äº†ä¸€ç»„æŠ½è±¡çš„æ–‡ä»¶è¾“å…¥è¾“å‡ºæ¥å£ã€‚\nè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿæ˜¯å¯¹å„ç§çœŸå®æ–‡ä»¶ç³»ç»Ÿçš„æŠ½è±¡ï¼Œåœ¨è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿä¸­å®šä¹‰äº†æŠ½è±¡çš„è¶…çº§å—ã€ièŠ‚ç‚¹å’Œç›®å½•ï¼Œå®ƒä¸ºçœŸå®æ–‡ä»¶ç³»ç»Ÿæä¾›äº†ä¸€ç§ç»Ÿä¸€çš„æ¡†æ¶æ¥å£ã€‚çœŸå®æ–‡ä»¶ç³»ç»Ÿé€šè¿‡è¿™äº›æ¥å£ä¸è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿç›¸è¿æ¥ï¼ŒçœŸå®æ–‡ä»¶ç³»ç»Ÿæ˜¯è¿™äº›æŠ½è±¡æ¥å£çš„å…·ä½“å®ç°ã€‚\nè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿå­˜åœ¨äºå†…å­˜ä¸­ï¼Œåœ¨ç³»ç»Ÿå¯åŠ¨æ—¶äº§ç”Ÿï¼Œéšç€ç³»ç»Ÿå…³é—­è€Œæ¶ˆå¤±ã€‚\næ–‡ä»¶æ“ä½œå¸¸ç”¨çš„å¤´æ–‡ä»¶ C POSIX libraryæ˜¯Cè¯­è¨€çš„POSIXç³»ç»Ÿä¸‹çš„æ ‡å‡†åº“ã€‚åŒ…å«äº†ä¸€äº›åœ¨Cè¯­è¨€æ ‡å‡†åº“ä¹‹å¤–çš„å‡½æ•°ã€‚\n#include \u0026lt;unistd.h\u0026gt; //å¤šç§å¿…è¦çš„POSIXå‡½æ•°ä¸å¸¸é‡ #include \u0026lt;fcntl.h\u0026gt; //æ–‡ä»¶æ‰“å¼€ã€åˆ›å»ºã€åŠ é”ç­‰æ“ä½œ #include \u0026lt;sys/stat.h\u0026gt;//æ–‡ä»¶ä¿¡æ¯(stat (Unix)ç­‰) #include \u0026lt;sys/types.h\u0026gt;//ä¸åŒçš„æ•°æ®ç±»å‹ #include \u0026lt;dirent.h\u0026gt; //æ‰“å¼€ä¸åˆ—å‡ºç›®å½•å†…å®¹ //æ­¤å¤–ï¼Œè¿˜æœ‰Cæ ‡æ³¨åº“ä¸­çš„ #include \u0026lt;stdio.h\u0026gt;\t//æ ‡å‡†ç¼“å­˜è¾“å…¥è¾“å‡º æ–‡ä»¶åŸºæœ¬è¾“å…¥è¾“å‡º æ–‡ä»¶è¾“å…¥è¾“å‡ºæ¶‰åŠåˆ°ä»¥ä¸‹å‡½æ•°ï¼š\nopenã€creat åœ¨\u0026lt;fcntl.h\u0026gt;ä¸­ readã€writeã€lseekã€close åœ¨\u0026lt;unistd.h\u0026gt;ä¸­ æ¡ˆä¾‹:å¤åˆ¶æ–‡ä»¶\n//cp.c #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;unistd.h\u0026gt; #include \u0026lt;fcntl.h\u0026gt; #define PMODE 0644\t//æƒé™å®šä¹‰ä¸ºrw-r--r-- #define BUFSIZE 200 int main(int argc,char *argv[]) { int fdin,fdout,n; char buf[BUFSIZ]; if(argc !=3) { fprintf(stderr,\u0026#34;Usage:%s filein fileout\\n\u0026#34;,argv[0]); return 1; } if((fdin = open(argv[1],O_RDONLY)) == -1) { perror(argv[1]); return 2; } if((fdout = open(argv[2],O_WRONLY|O_CREAT|O_TRUNC,PMODE)) == -1) { perror(argv[2]); return 3; } while((n = read(fdin,buf,BUFSIZE)) \u0026gt; 0) write(fdout,buf,n); close(fdin); close(fdout); return 0; } ###æ–‡ä»¶å±æ€§æ“ä½œ æ–‡ä»¶çš„å±æ€§ä¿¡æ¯å­˜æ”¾åœ¨æ–‡ä»¶å¯¹åº”çš„ièŠ‚ç‚¹ä¸­ï¼Œå¯¹äºä¸åŒç±»å‹çš„ç‰©ç†æ–‡ä»¶ç³»ç»Ÿï¼Œæ–‡ä»¶å±æ€§çš„ç»„ç»‡å½¢å¼ä¸å°½ç›¸åŒï¼Œä¸ºäº†è·å¾—ç»Ÿä¸€çš„æ–‡ä»¶å±æ€§æ ¼å¼ï¼ŒLinuxå®šä¹‰äº†struct statè¿™ä¸ªæ•°æ®ç»“æ„ï¼Œç±»å‹å®šä¹‰å¦‚ä¸‹ï¼š\nstruct stat { dev_t st_dev; /* æ–‡ä»¶è®¾å¤‡ç¼–å·*/ ino_t st_ino; /* ièŠ‚ç‚¹å· */ mode_t st_mode; /* æ–‡ä»¶ç±»å‹å’Œå­˜å‚¨æƒé™ */ nlink_t st_nlink; /* ç¡¬é“¾æ¥ */ uid_t st_uid; /* ç”¨æˆ·ID */ gid_t st_gid; /* ç”¨æˆ·ç»„ID */ dev_t st_rdev; /* Device ID (if special file)*/ off_t st_size; /* æ–‡ä»¶å­—èŠ‚æ•°bytes */ blksize_t st_blksize; /* å—å¤§å° */ blkcnt_t st_blocks; /* ä»¥512bytesä¸ºå•ä½çš„å—æ•° */ struct timespec st_atim; /* æ–‡ä»¶æœ€åä¸€æ¬¡è®¿é—®æ—¶é—´ */ struct timespec st_mtim; /* æ–‡ä»¶æœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´ */ struct timespec st_ctim; /* æ–‡ä»¶å±æ€§æœ€åä¸€æ¬¡æ”¹å˜æ—¶é—´ */ }; ä»¥ä¹‹å‰çš„cp.cä¸ºä¾‹:\nå¯ä»¥çœ‹åˆ°cp.cæ–‡ä»¶å®é™…å¤§å°640bytesï¼Œåœ¨ç£ç›˜ä¸Šå ç”¨äº†ä¸€ä¸ª4096bytesçš„å—ï¼Œä¹Ÿå°±æ˜¯8ä¸ª512bytesçš„å—ã€‚`\næ–‡ä»¶å±æ€§æ“ä½œå¸¸ç”¨å‡½æ•°ï¼š\nstat è·å–æ–‡ä»¶å±æ€§ä¿¡æ¯ chmod è®¾ç½®æ–‡ä»¶æƒé™ chown è®¾ç½®æ–‡ä»¶å±ä¸» utime è·å–æ—¶é—´ æ¡ˆä¾‹ï¼šæ”¹å˜æ–‡ä»¶è¯»å†™æƒé™\n#include \u0026lt;stdio.h\u0026gt; #include \u0026lt;sys/stat.h\u0026gt; int main() { mode_t fdmode = (S_IRUSR|S_IWUSR|S_IRGRP|S_IROTH); if(chmod(\u0026#34;cp.c\u0026#34;,fdmode) == -1) { printf(\u0026#34;error\\n\u0026#34;); return 1; } return 0; } ç¼–è¯‘è¿è¡Œï¼Œç»“æœå¦‚ä¸‹ï¼Œå¯è§æ–‡ä»¶æƒé™å·²ç»è¢«ä¿®æ”¹ã€‚\nniuhe@niuhe-ubuntu:~/Linux$ gcc -o chmod chmod.c niuhe@niuhe-ubuntu:~/Linux$ ls chmod chmod.c cp cp.c niuhe@niuhe-ubuntu:~/Linux$ ll cp.c -rw-rw-r-- 1 niuhe niuhe 640 10æœˆ 6 16:55 cp.c niuhe@niuhe-ubuntu:~/Linux$ ./chmod niuhe@niuhe-ubuntu:~/Linux$ ll cp.c -rw-r--r-- 1 niuhe niuhe 640 10æœˆ 6 16:55 cp.c ###ç›®å½•æ“ä½œ ç›®å½•æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–‡ä»¶ï¼Œå…¶å†…å®¹ç”±è‹¥å¹²ç›®å½•é¡¹ç»„æˆï¼Œä¸€ä¸ªç›®å½•é¡¹åŒ…æ‹¬æ–‡ä»¶åå’ŒièŠ‚ç‚¹å·ã€‚ä¸ºäº†ä¾¿äºç®¡ç†ï¼Œæ¯ä¸ªç›®å½•ä¸­éƒ½åŒ…å«å½“å‰ç›®å½•\u0026quot;.\u0026ldquo;å’Œçˆ¶ç›®å½•\u0026rdquo;..\u0026quot;,å½“å‰ç›®å½•é¡¹æŒ‡å‘å½“å‰ç›®å½•çš„ièŠ‚ç‚¹ç¼–å·ï¼Œçˆ¶ç›®å½•é¡¹è®°å½•äº†çˆ¶ç›®å½•å¯¹åº”çš„ièŠ‚ç‚¹ç¼–å·ã€‚ å¸¸ç”¨åº“å‡½æ•°åŠå¤´æ–‡ä»¶å¦‚ä¸‹ï¼š\n#include \u0026lt;sys/stat.h\u0026gt; //åœ¨æŸç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªç›®å½•é¡¹ï¼Œåˆ†é…ä¸€ä¸ªièŠ‚ç‚¹å’Œç›®å½•é¡¹ç›¸é“¾æ¥ //åˆ†é…ä¸€ä¸ªé€»è¾‘å—ç”¨æ¥å­˜æ”¾ç›®å½•å†…å®¹ï¼Œå¹¶åœ¨å…¶ä¸­å»ºç«‹å½“å‰ç›®å½•å’Œçˆ¶ç›®å½•ä¸¤ä¸ªç›®å½•é¡¹ int mkdir(const char *pathname,mode_t mode); #include \u0026lt;unistd.h\u0026gt; //åˆ é™¤ç©ºç›®å½• int rmdir(const char *pathname); //æ”¹å˜å·¥ä½œç›®å½•ï¼›åœ¨æ¯ä¸ªè¿›ç¨‹çš„è¿›ç¨‹æ§åˆ¶å—ä¸­ä¿å­˜ç€å½“å‰å·¥ä½œç›®å½•çš„ièŠ‚ç‚¹ //åˆå§‹å·¥ä½œç›®å½•ç»§æ‰¿è‡ªçˆ¶è¿›ç¨‹ï¼Œè¿›ç¨‹è¿è¡Œè¿‡ç¨‹å¯ä»¥æ”¹å˜å·¥ä½œç›®å½• int chdir(const char *pathname); //è·å¾—è°ƒç”¨è€…è¿›ç¨‹çš„å½“å‰å·¥ä½œç›®å½•ï¼Œbufå­˜æ”¾è·¯å¾„ï¼Œsizeè·¯å¾„åŒ…å«å­—èŠ‚æ•° char *getcwd(char *buf, size_t size); #include \u0026lt;dirent.h\u0026gt; //æ‰“å¼€ç›®å½•,æˆåŠŸè¿”å›ç›®å½•æµï¼ˆå­—ç¬¦ä¸²ï¼‰ DIR *opendir(const char *pahtname); //è¯»ç›®å½•ï¼ŒæˆåŠŸè¿”å›ä¸‹ä¸€ä¸ªç›®å½•é¡¹ struct dirent *readdir(DIR *dp); //å…³é—­ç›®å½• int closedir(DIR *dp); ç›®å½•æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–‡ä»¶ï¼Œå­˜æ”¾ç€å¾ˆå¤šç›®å½•é¡¹ï¼Œæ¯ä¸€ä¸ªç›®å½•é¡¹æ˜¯ä¸€ä¸ªç»“æ„ä½“ã€‚\nstruct dirent { long d_ino;\t//ièŠ‚ç‚¹å· char d_name[NAME_MAX+1];\t//æ–‡ä»¶å off_t d_off;\t//åœ¨ç›®å½•æ–‡ä»¶ä¸­åç§»é‡ unsigned short d_reclen;\t//æ–‡ä»¶åé•¿åº¦ } æ¡ˆä¾‹ï¼šæ”¹å˜å½“å‰è¿›ç¨‹å·¥ä½œç›®å½•\n#include \u0026lt;unistd.h\u0026gt; #include \u0026lt;stdio.h\u0026gt; int main(void) { if(chdir(\u0026#34;/tmp\u0026#34;) \u0026lt; 0) printf(\u0026#34;chdir failed\u0026#34;); printf(\u0026#34;chdir to /tmp succeeded\\n\u0026#34;); return 0; } æ¡ˆä¾‹ï¼šæµè§ˆç›®å½•ä¸­æ‰€æœ‰æ–‡ä»¶å\n#include \u0026lt;stdio.h\u0026gt; #include \u0026lt;dirent.h\u0026gt; int main(int argc,char *argv[]) { DIR *dirp; struct dirent *direntp; if((dirp = opendir(argv[1])) == NULL) { printf(\u0026#34;cannot open the %s directory\u0026#34;,argv[1]); return 1; } while((direntp = readdir(dirp)) != NULL) printf(\u0026#34;%s\\n\u0026#34;,direntp-\u0026gt;d_name); closedir(dirp); return 0; } ###Cæ ‡å‡†I/Oåº“\nè¿ç”¨readã€writeç­‰ç³»ç»Ÿåº•å±‚å‡½æ•°è¿›è¡Œè¾“å…¥è¾“å‡ºæ—¶ï¼Œéœ€è¦åœ¨ç”¨æˆ·æ€å’Œå†…æ ¸æ€ä¹‹é—´æ¥å›åˆ‡æ¢ã€‚è‹¥æ¯æ¬¡è¯»å–æˆ–å†™å…¥æ•°æ®è¾ƒå°‘ï¼Œå°†å¯¼è‡´é¢‘ç¹çš„I/Oæ“ä½œï¼Œé™ä½äº†ç¨‹åºè¿è¡Œæ•ˆç‡ã€‚ æ ‡å‡†I/Oåº“å¯¹åº•å±‚I/Oç³»ç»Ÿè°ƒç”¨è¿›è¡Œäº†å°è£…ï¼Œæä¾›äº†å¸¦æ ¼å¼è½¬æ¢çš„I/Oæ“ä½œï¼Œå¹¶åœ¨ç”¨æˆ·ç©ºé—´å¢åŠ äº†ç¼“å†²ç®¡ç†ï¼Œå¯å‡å°‘ç¨‹åºå’Œè¾“å‡ºè®¾å¤‡ä¹‹é—´I/Oæ¬¡æ•°ã€‚å‡½æ•°åŸå‹å®šä¹‰åœ¨\u0026lt;stdio.h\u0026gt;ä¸­ã€‚ ç»†èŠ‚ç•¥\nI/Oé‡å®šå‘ æ–‡ä»¶æè¿°ç¬¦ Linuxç³»ç»Ÿä¸­ï¼Œè¿›ç¨‹æ‹¥æœ‰å„è‡ªæ‰“å¼€æ–‡ä»¶çš„æè¿°ç¬¦ã€‚æ–‡ä»¶æè¿°ç¬¦æŒ‰ç”Ÿæˆçš„é¡ºåºå­˜æ”¾åœ¨æ–‡ä»¶æè¿°ç¬¦è¡¨ä¸­ï¼ŒLinuxå†…æ ¸å°†æ–‡ä»¶æè¿°ç¬¦è¡¨ç”¨ä¸€ç»´æ•°ç»„è¡¨è¿°ï¼Œæ¯ä¸ªæ‰“å¼€çš„æ–‡ä»¶å ç”¨ä¸€ä¸ªå•å…ƒï¼Œç”¨æ¥å­˜æ”¾æ“ä½œæ–‡ä»¶çš„å¿…è¦ä¿¡æ¯ï¼Œå¦‚è¯»å†™æ“ä½œå½“å‰ä½ç½®ã€æ–‡ä»¶æ‰“å¼€æ–¹å¼ã€æ–‡ä»¶æ“ä½œé›†ç­‰ã€‚ è¿›ç¨‹åœ¨æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œè¿”å›çš„æ˜¯æ–‡ä»¶æè¿°ç¬¦æ‰€åœ¨æ•°ç»„çš„ä¸‹æ ‡ï¼Œç§°ä¸ºæ–‡ä»¶æè¿°ç¬¦ã€‚ é€šå¸¸ï¼Œåˆ›å»ºå­è¿›ç¨‹æ—¶ï¼Œå­è¿›ç¨‹ä»çˆ¶è¿›ç¨‹ç»§æ‰¿æ–‡ä»¶æè¿°ç¬¦è¡¨ï¼Œå‰3ä¸ªæè¿°ç¬¦0,1,2åˆ†åˆ«å¯¹åº”æ ‡å‡†è¾“å…¥ã€æ ‡å‡†è¾“å‡ºã€æ ‡å‡†é”™è¯¯è¾“å‡ºï¼Œä¸è¿›ç¨‹çš„æ§åˆ¶ç»ˆç«¯è®¾å¤‡å¯¹åº”ã€‚é€šå¸¸å·²ç»è¢«æ‰“å¼€ï¼Œè¿›è¡Œè¯»å†™æ“ä½œæ—¶æ— éœ€é‡æ–°æ‰“å¼€ã€‚ ä¸€ä¸ªæ–‡ä»¶å¯ä»¥åŒæ—¶è¢«å¤šä¸ªè¿›ç¨‹æ‰“å¼€ï¼Œå®ƒåœ¨ä¸åŒè¿›ç¨‹ä¸­å¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦ä»¥åŠæ“ä½œçŠ¶æ€ä¹Ÿæœªå¿…ç›¸åŒã€‚\n####I/Oé‡å®šå‘\nç¨‹åºæ ¹æ®æ‰“å¼€æ–‡ä»¶çš„æè¿°ç¬¦å¯¹æ–‡ä»¶è¿›è¡Œè¯»å†™æ“ä½œï¼ŒçœŸæ­£å®Œæˆè¯»å†™æ“ä½œçš„æ˜¯è¿›ç¨‹æè¿°ç¬¦è¡¨ç›¸åº”ä½ç½®ä¸­çš„å†…å®¹ã€‚ä»¥è¾“å‡ºé‡å®šå‘ä¸ºä¾‹ï¼Œè‹¥å°†è¿›ç¨‹æè¿°ç¬¦è¡¨ä¸­1å·å•å…ƒçš„å†…å®¹æ›¿æ¢ä¸ºæ‰“å¼€çš„æ–‡ä»¶testï¼Œåˆ™è¿›ç¨‹åœ¨å‘æ ‡å‡†è¾“å‡ºæ–‡ä»¶è¾“å‡ºä¿¡æ¯æ—¶ï¼ŒåŸæœ¬æ•°æ®åº”æ˜¾ç¤ºåœ¨ç»ˆç«¯æ˜¾ç¤ºå™¨ä¸Šï¼Œä½†ç°åœ¨è¿™äº›æ•°æ®å°†è¢«è¾“å‡ºè‡³æ–‡ä»¶testã€‚ å®ç°I/Oé‡å®šå‘å¯ä»¥é€šè¿‡:\nopen close openæ–¹æ³• ç³»ç»Ÿå‡½æ•°è°ƒç”¨ï¼šdupdup2 #####open close openæ–¹æ³•\nLinuxåœ¨ä¸ºè¿›ç¨‹æ–°æ‰“å¼€æ–‡ä»¶åˆ†é…æè¿°ç¬¦æ—¶ï¼Œä»ä¸‹è¡¨0å¼€å§‹æ‰«æè¿›ç¨‹æ–‡ä»¶æè¿°ç¬¦è¡¨ï¼Œå°†æ‰“å¼€çš„æ–‡ä»¶ä¿¡æ¯æ”¾åœ¨æ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªç©ºé—²å•å…ƒï¼Œå¹¶å°†è¯¥ä¸‹è¡¨ä½œä¸ºæ‰“å¼€æ–‡ä»¶çš„æè¿°ç¬¦ã€‚ ä»¥æ ‡å‡†è¾“å…¥0ä¸ºä¾‹ï¼Œå°†æ ‡å‡†è¾“å…¥å…³é—­ï¼Œä½¿å¾—æ–‡ä»¶æè¿°ç¬¦è¡¨ç¬¬0å·å•å…ƒæˆä¸ºç©ºé—²å•å…ƒï¼Œæ­¤æ—¶ï¼Œè¿›ç¨‹æ–°æ‰“å¼€å¦ä¸€ä¸ªæ–‡ä»¶ï¼Œå†…æ ¸å°†æ–‡ä»¶æè¿°ç¬¦è¡¨0å·å•å…ƒåˆ†é…ç»™æ–°æ‰“å¼€çš„æ–‡ä»¶ï¼Œå¹¶è¿”å›æè¿°ç¬¦0ï¼Œä¹Ÿå°±å®ç°äº†è¾“å…¥é‡å®šå‘ã€‚\n#####dupå’Œdup2å‡½æ•°\nä½¿ç”¨dupå’Œdup2å‡½æ•°ï¼Œåªæ˜¯å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦ï¼Œä½¿ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦æŒ‡å‘åŒä¸€ä¸ªfileç»“æ„ä½“ï¼Œå¹¶ä¸”fileç»“æ„ä½“å¼•ç”¨è®¡æ•°æ˜¯2ã€‚æ­¤æ—¶ï¼Œæ‰“å¼€æ–‡ä»¶çš„çŠ¶æ€ä¿å­˜åœ¨åŒä¸€ä¸ªfileç»“æ„ä½“ä¸­ã€‚è€Œä½¿ç”¨openå‡½æ•°ä¸¤æ¬¡æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ä¼šå­˜åœ¨ä¸¤ä»½fileç»“æ„ä½“ï¼Œåˆ†åˆ«æœ‰å„è‡ªçš„çŠ¶æ€ã€‚\n#include \u0026lt;unistd.h\u0026gt; //ä»è¿›ç¨‹æ–‡ä»¶æè¿°ç¬¦è¡¨ä¸­å¯»æ‰¾ä¸€ä¸ªå¯ç”¨çš„æœ€å°æè¿°ç¬¦,è¿”å›æ­¤æè¿°ç¬¦ //å¹¶å¤åˆ¶oldfdå¯¹åº”çš„Fileç»“æ„æŒ‡é’ˆåˆ°æ–°çš„æœ€å°æè¿°ç¬¦ int dup(int oldfd); //oldfdéœ€è¦å¤åˆ¶çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œnewfdæ˜¯å¤åˆ¶åoldfdåœ¨æ–‡ä»¶æè¿°ç¬¦è¡¨ä¸­æ–°çš„åºå·ã€‚ //æˆåŠŸè¿”å›ä¸€ä¸ªæ–°æè¿°ç¬¦ï¼Œå¦åˆ™è¿”å›-1 //è‹¥newfdå·²ç»æ‰“å¼€ï¼Œåˆ™å…ˆå…³é—­newfd,ç„¶åå¤åˆ¶oldfdåˆ°newfd,ä½¿newfdä¹ŸæŒ‡å‘oldfd,æ­¤æ—¶oldfdå’Œnewfdä¸¤ä¸ªæè¿°ç¬¦å…±äº«åŒä¸€ä¸ªæ–‡ä»¶ã€‚ int dump2(int oldfd, int newfd); æ¡ˆä¾‹:è¾“å‡ºé‡å®šå‘\n#include \u0026lt;stdio.h\u0026gt; #include \u0026lt;unistd.h\u0026gt; #include \u0026lt;fcntl.h\u0026gt; int main() { int fileID; fileID = creat(\u0026#34;ls.tst\u0026#34;,0640); if(fileID \u0026lt; 0) { fprintf(stderr,\u0026#34;error creating ls.tst\\n\u0026#34;); return 1; } dup2(fileID,1); close(fileID); execl(\u0026#34;/bin/ls\u0026#34;,\u0026#34;ls\u0026#34;,NULL); return 0; } å‚è€ƒ åº“å‡½æ•°åˆ—è¡¨ C POSIX LIB ","permalink":"https://blog.niuhemoon.win/posts/tech/linux-c-io/","summary":"æ–‡ä»¶ç³»ç»Ÿæ¦‚è¿° Linuxå†…æ ¸çš„å„ç§çœŸå®æ–‡ä»¶ç³»ç»Ÿã€å—è®¾å¤‡å’Œå­—ç¬¦è®¾å¤‡ç»Ÿä¸€åœ¨è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿçš„æ¡†æ¶ä¸­ï¼Œè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿä¸ºåº”ç”¨æä¾›äº†ä¸€ç»„æŠ½è±¡çš„æ–‡ä»¶è¾“å…¥è¾“å‡ºæ¥å£ã€‚ è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿæ˜¯å¯¹å„ç§çœŸå®æ–‡ä»¶ç³»ç»Ÿçš„æŠ½è±¡ï¼Œåœ¨è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿä¸­å®šä¹‰äº†æŠ½è±¡çš„è¶…çº§å—ã€ièŠ‚ç‚¹å’Œç›®å½•ï¼Œå®ƒä¸ºçœŸå®æ–‡ä»¶ç³»ç»Ÿæä¾›äº†ä¸€ç§ç»Ÿä¸€çš„æ¡†æ¶æ¥å£ã€‚çœŸå®æ–‡","title":"Linuxä¸‹glicåº“æ“ä½œæ–‡ä»¶å’Œç›®å½•"},{"content":" ä¿¡å·æ˜¯å†…æ ¸å’Œè¿›ç¨‹ä¹‹é—´é€šä¿¡çš„ä¸€ç§æ–¹å¼ï¼Œä¿¡å·æ˜¯ç”±å†…æ ¸äº§ç”Ÿï¼Œå¹¶å‘é€ç»™ä¸€ä¸ªæˆ–ä¸€ç»„è¿›ç¨‹çš„çŸ­æ¶ˆæ¯ï¼Œç”¨ä¸åŒç‰¹å®šçš„æ•°å­—è¡¨ç¤ºä¸åŒçš„ä¿¡å·ï¼Œä¿¡å·çš„ä½œç”¨æ˜¯è¡¨ç¤ºæŸç§äº‹ä»¶çš„å‘ç”Ÿã€‚\nä¿¡å·ç®€ä»‹ åˆ†ç±»\néå®æ—¶ä¸å¯é ä¿¡å·ï¼Œå€¼ä¸º1-31 å®æ—¶çš„å¯é ä¿¡å·ï¼Œå€¼ä¸º32-63 ä¿¡å·ç”±å†…æ ¸ç”Ÿæˆï¼Œä¿¡å·ç”Ÿæˆå’Œäº‹ä»¶çš„å‘ç”Ÿå¯†åˆ‡ç›¸å…³ï¼Œå¯å°†äº‹ä»¶å‘ç”Ÿæºåˆ†ä¸ºä»¥ä¸‹ä¸‰ç±»ï¼š\nä¿¡å·äº‹ä»¶å‘ç”Ÿæºï¼š\nç”¨æˆ·ï¼Œå¦‚é”®å…¥CTRL+Cï¼Œç»ˆç«¯é©±åŠ¨ç¨‹åºå°†é€šçŸ¥å†…æ ¸äº§ç”Ÿä¿¡å·å‘é€åˆ°ç›¸åº”çš„è¿›ç¨‹ å†…æ ¸ï¼Œå†…æ ¸æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œé‡åˆ°éæ³•æŒ‡ä»¤å’Œæµ®ç‚¹æ•°æº¢å‡ºç­‰æƒ…å†µ è¿›ç¨‹ï¼Œä¸€ä¸ªè¿›ç¨‹è°ƒç”¨killå‡½æ•°å‘å¦ä¸€ä¸ªè¿›ç¨‹å‘é€ä¿¡å·ï¼Œè¿›è¡Œè¿›ç¨‹é—´é€šä¿¡ é€šå¸¸ï¼ŒLInuxä¸ºæ¯ä¸ªä¿¡å·å®šä¹‰äº†ç¼ºçœçš„å¤„ç†æ–¹å¼ï¼Œä½†æ˜¯ç”¨æˆ·å¯æ ¹æ®éœ€è¦ï¼Œå¯¹ä¿¡å·çš„å¤„ç†æ–¹å¼è¿›è¡Œé‡æ–°å®šä¹‰ã€‚\nä¿¡å·çš„ç¼ºçœå¤„ç†æ–¹å¼åŒ…æ‹¬\nA ç»“æŸè¿›ç¨‹ B å¿½ç•¥ä¿¡å· C ç»“æŸè¿›ç¨‹å¹¶å†™å…¥å†…æ ¸æ–‡ä»¶ D åœæ­¢è¿›ç¨‹ E ä¿¡å·ä¸èƒ½è¢«æ•è· F ä¿¡å·ä¸èƒ½è¢«å¿½ç•¥ G éPOSIXä¿¡å· ###è‡ªå®šä¹‰ä¿¡å·å¤„ç†å‡½æ•°\nå¿…é¡»é‡æ–°å»ºç«‹ä¿¡å·å€¼å’Œå¤„ç†æ–¹å¼ä¹‹é—´çš„å¯¹åº”å…³ç³»ï¼Œæ‰èƒ½é‡æ–°å®šä¹‰ä¿¡å·çš„å¤„ç†æ–¹å¼ã€‚LInuxæä¾›signalå’Œsigactionå‡½æ•°æ¥å®ç°ä¿¡å·çš„è®¾ç½®ã€‚signalå’Œsigactionçš„åŒºåˆ«åœ¨äºsignalä¸æ”¯æŒé¡¹ä¿¡å·å¤„ç†å‡½æ•°ä¼ é€’æ•°æ®ã€‚\næ³¨ï¼šSIGKILLå’ŒSIGSTOPä¸èƒ½è¢«é‡å®šä¹‰æˆ–å¿½ç•¥ã€‚\nsignalå‡½æ•°åŸå‹:\n// __sigä¸ºéœ€è®¾ç½®çš„ä¿¡å·ï¼Œ__handlerä¸ºæ–°ä¿¡å·å¤„ç†å‡½æ•°ï¼›å¤±è´¥è¿”å›SIG_ERRï¼Œå¦åˆ™æˆåŠŸã€‚ //__handlerä¸ºSIG_IGNå¿½ç•¥ä¿¡å·ï¼ŒSIG_DELé»˜è®¤ä¿¡å·å¤„ç† extern __sighandler_t signal (int __sig, __sighandler_t __handler) __THROW; æ¡ˆä¾‹ï¼šä½¿ç”¨signalé‡å®šä¹‰SIGINTå¤„ç†å‡½æ•°\n#include \u0026lt;stdio.h\u0026gt; #include \u0026lt;signal.h\u0026gt; #include \u0026lt;unistd.h\u0026gt; int main() { void f(int); int i; signal(SIGINT,f); for(i=0;i\u0026lt;5;i++) { printf(\u0026#34;hello\\n\u0026#34;); sleep(1); } return 0; } void f(int signum) { printf(\u0026#34;hello Linux\\n\u0026#34;); } sigactionå‡½æ•°åŸå‹\n/* signoéœ€è¦å¤„ç†çš„ä¿¡å· actæŒ‡å‘æè¿°ä¿¡å·æ“ä½œçš„ç»“æ„ oactæŒ‡å‘è¢«æ›¿æ¢æ“ä½œçš„ç»“æ„ æˆåŠŸè¿”å›0ï¼Œå¦åˆ™è¿”å›-1 */ int sigaction(int signo,const struct sigaction *act,struct sigaction *oact); /* sa_maskæŒ‡å®šåœ¨ä¿¡å·å¤„ç†è¿‡ç¨‹ä¸­ï¼Œä½•ç§ä¿¡å·è¢«é˜»å¡ã€‚ç¼ºçœæƒ…å†µæ˜¯å½“å‰ä¿¡å·è¢«é˜»å¡ï¼Œä»¥å…ä¿¡å·å¤„ç†å‡½æ•°è¢«é€’å½’è°ƒç”¨ã€‚ */ struct sigaction { void(*sa_handler)(int);\t//ä¿¡å·å¤„ç†å‡½æ•° void(*sa_sigaction)(int,siginfo_t*,void *);\t//å¸¦å‚æ•°çš„ä¿¡å·å¤„ç†å‡½æ•° sigset_t sa_mask;\t//ä¿¡å·æ©ç  int sa_flags;\t//è®¾å®šä¿¡å·å¤„ç†ç›¸å…³è¡Œä¸º } æ¡ˆä¾‹ï¼šsigactionå®šä¹‰ä¿¡å·SIGINTå¤„ç†å‡½æ•°ï¼Œå¹¶å±è”½å…¶ä»–ä¿¡å·\n#include \u0026lt;stdio.h\u0026gt; #include \u0026lt;signal.h\u0026gt; #include \u0026lt;unistd.h\u0026gt; int num=0; void int_handle(int signum) { printf(\u0026#34;SIGINT:%d]n\u0026#34;,signum); printf(\u0026#34;int_handle called %d times\\n\u0026#34;,++num); } int main(void) { static struct sigaction act; void int_handle(int); act.sa_handler = int_handle; sigfillset(\u0026amp;(act.sa_mask)); sigaction(SIGINT,\u0026amp;act,NULL); while(1) { printf(\u0026#34;i am sleepy..\\n\u0026#34;); sleep(1); if(num \u0026gt;=3) { return 0; } } } ###ä¿¡å·é›†ã€ä¿¡å·å±è”½ä¸é˜»å¡\nä¿¡å·å±è”½å°±æ˜¯ä¸´æ—¶é˜»å¡ä¿¡å·è¢«å‘é€åˆ°æŸä¸ªè¿›ç¨‹ï¼Œå®ƒåŒ…å«ä¸€ä¸ªè¢«é˜»å¡çš„ä¿¡å·é›†ã€‚å½“è¿›ç¨‹å±è”½æŸä¸ªä¿¡å·æ—¶ï¼Œå†…æ ¸å°†ä¸å‘é€è¯¥ä¿¡å·è‡³å±è”½å®ƒçš„è¿›ç¨‹ï¼Œç›´è‡³è¯¥ä¿¡å·çš„å±è”½è¢«è§£é™¤ã€‚ ä¿¡å·é›†ç”¨äºæè¿°æ‰€æœ‰ä¿¡å·çš„é›†åˆã€‚å¯¹äºsigactionä¸­çš„sa_maskå­—æ®µï¼Œæ¯ä¸€ä½å¯¹åº”ä¸€ä¸ªä¿¡å·ï¼Œè‹¥æŸä¸€ä½è¢«è®¾ç½®ä¸º1ï¼Œè¡¨ç¤ºè¯¥ä½å¯¹åº”ä¿¡å·è¢«å±è”½ã€‚\nä¿¡å·é›†å®šä¹‰åŠå…¶æ“ä½œå‡½æ•°\ntypedef struct { unsigned long sig[2]; }sigset_t int sigemptyset(sigset_t *set);\t//æ¸…ç©ºä¿¡å·é›†ä¸­æ‰€æœ‰ä¿¡å· int sigfillset(sigset_t *set);\t//åœ¨setä¿¡å·é›†ä¸­åŠ å…¥linuxæ”¯æŒçš„æ‰€æœ‰ä¿¡å· int sigaddset(sigset_t *set,int signum);\t//å‘ä¿¡å·é›†ä¸­åŠ å…¥signumä¿¡å· int sigdelset(sigset_t *set,int signum);\t//ä»ä¿¡å·é›†ä¸­åˆ é™¤signumä¿¡å· int sigismember(const sigset_t *set, int signum)\t//åˆ¤æ–­signumä¿¡å·æ˜¯å¦åœ¨ä¿¡å·é›†setä¸­ æ¯ä¸ªè¿›ç¨‹å®šä¹‰ä¸€ä¸ªä¿¡å·æ©ç ï¼Œè¯¥æ©ç å¯¹åº”ä¸€ä¸ªä¿¡å·é›†ï¼Œè¯¥ä¿¡å·é›†ä¸­çš„æ‰€æœ‰ä¿¡å·åœ¨å‘é€è‡³è¿›ç¨‹åéƒ½å°†è¢«é˜»å¡ã€‚é€šè¿‡æ›´æ”¹è¿›ç¨‹çš„ä¿¡å·æ©ç æ¥é˜»å¡æˆ–è§£é™¤é˜»å¡æ‰€é€‰æ‹©çš„ä¿¡å·ã€‚ä»¥æ­¤æ¥ä¿æŠ¤ä¸å¸Œæœ›ç”±ä¿¡å·ä¸­æ–­çš„ä¸´ç•Œä»£ç ã€‚\nä¿¡å·é˜»å¡å‡½æ•°sigprocmask\n/* how å¦‚ä½•ä¿®æ”¹ä¿¡å·æ©ç  SIG_BLOCK æ·»åŠ ä¿¡å·åˆ°è¿›ç¨‹å±è”½ SIG_UNBLOCKå°†ä¿¡å·ä»è¿›ç¨‹å±è”½ä¸­åˆ é™¤ SIG_SETMASKå°†setçš„å€¼è®¾å®šä¸ºæ–°çš„ä¿¡å·æ©ç  set æŒ‡å‘è®¾ç½®ä¿¡å·åˆ—è¡¨ oldsetæŒ‡å‘ä¹‹å‰çš„ä¿¡å·æ©ç åˆ—è¡¨ */ int sigprocmask(int how,const sigset_t *set,sigset_t *oldset); æ¡ˆä¾‹:é˜»å¡SIGINTä¿¡å·3ç§’åæ¢å¤\n#include \u0026lt;signal.h\u0026gt; #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;unistd.h\u0026gt; int main(void) { sigset_t set; int count = 3; sigemptyset(\u0026amp;set); sigaddset(\u0026amp;set,SIGINT); sigprocmask(SIG_BLOCK,\u0026amp;set,NULL); while(count) { printf(\u0026#34;don\u0026#39;t disturb me (%d)\\n\u0026#34;,count--); sleep(1); } sigprocmask(SIG_UNBLOCK,\u0026amp;set,NULL); printf(\u0026#34;you did not disturb me!!\\n\u0026#34;); return 0; } ","permalink":"https://blog.niuhemoon.win/posts/tech/linux-c-signal-1/","summary":"ä¿¡å·æ˜¯å†…æ ¸å’Œè¿›ç¨‹ä¹‹é—´é€šä¿¡çš„ä¸€ç§æ–¹å¼ï¼Œä¿¡å·æ˜¯ç”±å†…æ ¸äº§ç”Ÿï¼Œå¹¶å‘é€ç»™ä¸€ä¸ªæˆ–ä¸€ç»„è¿›ç¨‹çš„çŸ­æ¶ˆæ¯ï¼Œç”¨ä¸åŒç‰¹å®šçš„æ•°å­—è¡¨ç¤ºä¸åŒçš„ä¿¡å·ï¼Œä¿¡å·çš„ä½œç”¨æ˜¯è¡¨ç¤ºæŸç§äº‹ä»¶çš„å‘ç”Ÿã€‚ ä¿¡å·ç®€ä»‹ åˆ†ç±» éå®æ—¶ä¸å¯é ä¿¡å·ï¼Œå€¼ä¸º1-31 å®æ—¶çš„å¯é ä¿¡å·ï¼Œå€¼ä¸º32-63 ä¿¡å·ç”±å†…æ ¸ç”Ÿæˆï¼Œä¿¡å·ç”Ÿæˆå’Œäº‹ä»¶çš„å‘ç”Ÿå¯†åˆ‡ç›¸å…³ï¼Œå¯å°†äº‹ä»¶å‘ç”Ÿ","title":"Linuxä¿¡å·å¤„ç†â€”â€”è‡ªå®šä¹‰ä¿¡å·å¤„ç†å‡½æ•°"},{"content":"å‡½æ•°åº“ä»‹ç» å‡½æ•°åº“åˆ†ä¸ºï¼š\né™æ€åº“ å…±äº«åº“ï¼ˆåŠ¨æ€åŠ è½½åº“ï¼‰ åº”ç”¨ç¨‹åºåœ¨é“¾æ¥é™æ€åº“æ—¶å€™ï¼Œå°†ä½¿ç”¨çš„é™æ€åº“å¯¹è±¡åµŒå…¥è‡³å¯æ‰§è¡Œæ˜ åƒæ–‡ä»¶ä¸­ï¼›è€Œåœ¨é“¾æ¥å…±äº«åº“æ—¶ï¼Œä»…åœ¨å¯æ‰§è¡Œæ˜ åƒæ–‡ä»¶ä¸­ä¿ç•™åŠ è½½ç›®æ ‡å¯¹è±¡æ‰€éœ€çš„ä¿¡æ¯ï¼Œåœ¨è°ƒç”¨æ—¶ï¼Œæ‰çœŸæ­£å°†ç›®æ ‡å¯¹è±¡åŠ è½½è‡³å†…å­˜ã€‚ é™æ€åº“ç‰¹ç‚¹ï¼š\nè¿è¡Œæ—¶æ— éœ€å¤–éƒ¨åº“çš„æ”¯æŒï¼Œå¯æ‰§è¡Œæ–‡ä»¶ä¸­å·²ç»åµŒå…¥äº†æ‰€éœ€çš„é™æ€åº“ç›®æ ‡å¯¹è±¡ï¼Œæ‰€ä»¥å¯æ‰§è¡Œæ–‡ä»¶å¯ä»¥è„±ç¦»é™æ€åº“ç‹¬ç«‹è¿è¡Œã€‚ è¾ƒé«˜çš„è¿è¡Œé€Ÿåº¦ï¼Œè¿è¡Œæ—¶ä¸éœ€è¦åŠ è½½å…¶ä»–ç›®æ ‡å¯¹è±¡ å¯æ‰§è¡Œæ–‡ä»¶ä½“ç§¯è¾ƒå¤§ ä¸å®¹æ˜“ç»´æŠ¤ï¼Œæ¯æ¬¡ä¿®æ”¹é™æ€åº“ï¼Œå¿…é¡»é‡æ–°é“¾æ¥ å…±äº«åº“ç‰¹ç‚¹ï¼š\nå¯æ‰§è¡Œæ–‡ä»¶ä½“ç§¯è¾ƒå° å®¹æ˜“ç»´æŠ¤ï¼Œå…±äº«åº“ä¸­å¯¹è±¡å‘ç”Ÿå˜åŒ–ï¼Œåº”ç”¨ç¨‹åºä¸éœ€è¦é‡æ–°ç¼–è¯‘ å¯æ‰§è¡Œæ–‡ä»¶ä¸­ä¸åŒ…å«å…±äº«åº“ä¸­è°ƒç”¨çš„ç›®æ ‡å¯¹è±¡ï¼Œå› æ­¤ä¸èƒ½ç¦»å¼€åŠ¨æ€åº“ç‹¬ç«‹è¿è¡Œ è¿è¡Œé€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œå› ä¸ºç¨‹åºå¯åŠ¨æ—¶éœ€è¦åŠ è½½å…±äº«åº“ é™æ€åº“ é™æ€åº“åˆ›å»º é™æ€åº“å‘½åè§„åˆ™æ˜¯libå¼€å¤´ï¼Œ.aä½œä¸ºæ–‡ä»¶ååç¼€ã€‚å¯ä»¥ä½¿ç”¨arå‘½ä»¤ä½œä¸ºé™æ€åº“ç®¡ç†å·¥å…·ã€‚arå¯ä»¥å°†å¤šä¸ª.oæ–‡ä»¶æ‰“åŒ…åœ¨ä¸€èµ·ï¼Œæ„æˆä¸€ä¸ªé™æ€åº“æ–‡ä»¶ã€‚\næ¡ˆä¾‹:\nå…ˆå‡†å¤‡ä¸¤ä¸ªCæºæ–‡ä»¶å¦‚ä¸‹ï¼š\n//exam1.c int add(int x, int y) { return x + y; } //exam2.c int func(int count) { int sum=0; int j; for(j=0; j\u0026lt;=count; j++) { sum=sum+j; } return sum; } ç¼–è¯‘ä¸¤ä¸ªæºæ–‡ä»¶,åä½¿ç”¨aråˆ›å»ºé™æ€åº“ï¼š\ngcc -c -Wall exam1.c gcc -c -Wall exam2.c ar -crq libdemo.a exam1.o exam2.o è¿™æ ·ï¼Œæˆ‘ä»¬å°±åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„é™æ€åº“ã€‚\n####é™æ€åº“ä½¿ç”¨ å®šä¹‰é™æ€åº“åº”ç”¨æ¥å£\n//exam.h extern int add(int x,int y); extern int func(int count); ä½¿ç”¨é™æ€åº“\n//testexam.c #include \u0026lt;stdio.h\u0026gt; #include \u0026#34;exam.h\u0026#34; int main(void) { int val; int x,y; x=12; y=18; val=add(x,y); printf(\u0026#34;the mult of x adn y is %d\\n\u0026#34;,val); val=func(100); printf(\u0026#34;the sum is %d \\n\u0026#34;,val); return 0; } ç¼–è¯‘è¿è¡Œ\ngcc -o testexam testexam.c -L ./ -ldemo è§£é‡Šï¼š -LæŒ‡å®šäº†é™æ€åº“æ‰€åœ¨çš„ç›®å½•ï¼Œ ./å°±æ˜¯å½“å‰ç›®å½•\n-ldemoæŒ‡å®šäº†é™æ€åº“çš„åç§°libdemo.a\nå…±äº«åº“ è‹¥åœ¨åŒä¸€ç›®å½•ä¸‹å­˜åœ¨åŒåçš„å…±äº«åº“å’Œé™æ€åº“ï¼Œgccä¼šä¼˜å…ˆä½¿ç”¨å…±äº«åº“ï¼Œé™¤éæŒ‡å®šäº†-static.\n####åˆ›å»ºå…±äº«åº“\ngcc -fPIC -c exam1.c gcc -fPIC -c exam2.c gcc -shared -o libdemo.so exam1.o exam2.o ä»¥ä¸Šä¸‰å¥æŒ‡ä»¤å°†exam1.cå’Œexam2.cç¼–è¯‘æˆäº†libdemo.soå…±äº«åº“æ–‡ä»¶ã€‚ -fPICå‘Šè¯‰gccåˆ›å»ºåœ°å€ç‹¬ç«‹çš„ç›®æ ‡æ–‡ä»¶ -sharedå‘Šè¯‰gccåˆ›å»ºä¸€ä¸ªå…±äº«åº“æ–‡ä»¶\nå…±äº«åº“ä½¿ç”¨ é“¾æ¥ç€å…±äº«åº“çš„åº”ç”¨å¯åŠ¨æ—¶ï¼Œä¸€ä¸ªç¨‹åºè£…è½½å™¨å°†è‡ªåŠ¨è¿è¡Œï¼Œè¯¥ç¨‹åºè£…è½½å™¨ä¸º/lib64/ld-linux.so.X,,å®ƒçš„ä½œç”¨æ˜¯æŸ¥æ‰¾å¹¶è£…è½½åº”ç”¨ç¨‹åºæ‰€ä¾èµ–çš„æ‰€æœ‰å…±äº«åº“çš„ä¸­çš„ç›®æ ‡å¯¹è±¡ã€‚\nå°†å…±äº«åº“libdemo.soæ”¾åœ¨/usr/local/lib/ç›®å½•ä¸‹ é“¾æ¥å…±äº«åº“\ngcc -o testexam testexam.c /usr/local/lib/libdemo.so æŸ¥çœ‹ç¨‹åºä½¿ç”¨å…±äº«åº“æƒ…å†µ\nldd testexam ###åŠ¨æ€é“¾æ¥åº“\nåŠ¨æ€é“¾æ¥åº“æ˜¯ä½¿ç”¨å…±äº«åº“çš„ä¸€ç§æ–¹å¼ï¼Œåœ¨è¿è¡Œçš„ä»»ä½•æ—¶åˆ»å¯ä»¥åŠ¨æ€åŠ è½½å…±äº«åº“ã€‚å’Œä¸€èˆ¬å…±äº«åº“ä¸åŒï¼Œé€šå¸¸åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶ï¼Œä¸ç«‹å³åŠ è½½å…±äº«åº“ï¼Œè€Œæ˜¯åœ¨éœ€è¦æ—¶ï¼ŒåŠ¨æ€åŠ è½½å…±äº«åº“ã€‚ ä»¥åŠ¨æ€é“¾æ¥çš„æ–¹å¼ä½¿ç”¨å…±äº«åº“åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼š\næ‰“å¼€å…±äº«åº“æ–‡ä»¶ æ¥ç€å–å¾—è¦è°ƒç”¨å‡½æ•°çš„åœ°å€ï¼Œæ ¹æ®åœ°å€ä½¿ç”¨å‡½æ•°æŒ‡é’ˆè¿›è¡Œè°ƒç”¨ å…³é—­å…±äº«åº“ Linuxç¯å¢ƒæä¾›äº†ä¸€ç»„APIå‡½æ•°å¯ä»¥åŠ¨æ€é“¾æ¥å…±äº«åº“ï¼Œå¤´æ–‡ä»¶å®šä¹‰åœ¨/usr/include/dlfcn.hä¸­ã€‚\næ¡ˆä¾‹\n//exam.c #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;dlfcn.h\u0026gt; #include \u0026#34;exam.h\u0026#34; #include \u0026lt;stdlib.h\u0026gt; int main(void) { int val; int (*add_d)(int,int); int (*func_d)(int); void *handle; char *err; int x,y; x = 12; y = 18; handle = dlopen(\u0026#34;/usr/local/lib/libdemo.so\u0026#34;,RTLD_LAZY); if (handle == (void *)0) { fputs(dlerror(),stderr); exit(-1); } add_d = dlsym(handle,\u0026#34;add\u0026#34;); err = dlerror(); if (err != NULL) { fputs(err,stderr); exit(-1); } func_d = dlsym(handle,\u0026#34;func\u0026#34;); err = dlerror(); if(err != NULL) { fputs(err,stderr); exit(-1); } val = (*add_d)(x,y); printf(\u0026#34;the mult of x and y is %d\\n\u0026#34;,val); val = (*func_d)(100); printf(\u0026#34;the sum of 1 to 100 is %d\\n\u0026#34;,val); dlclose(handle); return 0; } ç¼–è¯‘é“¾æ¥\ngcc -rdynamic exam.c -o exam -ldl æ‰§è¡Œ\nniuhe@niuhe-ubuntu:/tmp/exp$ ./exam the mult of x and y is 30 the sum of 1 to 100 is 5050 ###GUN Cå‡½æ•°åº“â€”â€”glibc\nglibcæ˜¯GNUå¼€å‘çš„ä¸€å¥—æ ‡å‡†Cè¯­è¨€æ ‡å‡†å‡½æ•°åº“çš„å®ç°ã€‚é€šå¸¸linuxå‘è¡Œç‰ˆéƒ½é»˜è®¤å®‰è£…å¥½äº†ï¼ŒæŸ¥çœ‹glicçš„ç‰ˆæœ¬å·ldd --version.\n","permalink":"https://blog.niuhemoon.win/posts/tech/linux-c-lib/","summary":"å‡½æ•°åº“ä»‹ç» å‡½æ•°åº“åˆ†ä¸ºï¼š é™æ€åº“ å…±äº«åº“ï¼ˆåŠ¨æ€åŠ è½½åº“ï¼‰ åº”ç”¨ç¨‹åºåœ¨é“¾æ¥é™æ€åº“æ—¶å€™ï¼Œå°†ä½¿ç”¨çš„é™æ€åº“å¯¹è±¡åµŒå…¥è‡³å¯æ‰§è¡Œæ˜ åƒæ–‡ä»¶ä¸­ï¼›è€Œåœ¨é“¾æ¥å…±äº«åº“æ—¶ï¼Œä»…åœ¨å¯æ‰§è¡Œæ˜ åƒæ–‡ä»¶ä¸­ä¿ç•™åŠ è½½ç›®æ ‡å¯¹è±¡æ‰€éœ€çš„ä¿¡æ¯ï¼Œåœ¨è°ƒç”¨æ—¶ï¼Œæ‰çœŸæ­£å°†ç›®æ ‡å¯¹è±¡åŠ è½½è‡³å†…å­˜ã€‚ é™æ€åº“ç‰¹ç‚¹ï¼š è¿è¡Œæ—¶æ— éœ€å¤–éƒ¨åº“çš„æ”¯æŒï¼Œå¯æ‰§è¡Œæ–‡ä»¶ä¸­å·²ç»åµŒå…¥äº†æ‰€","title":"Linuxä¸‹åˆ›å»ºå’Œä½¿ç”¨Cè¯­è¨€å‡½æ•°åº“"},{"content":" Shell æ˜¯ä¸€ç§å‘½ä»¤è¡Œè§£é‡Šå™¨ï¼Œç›®å‰ Linux ä¸‹æœ€å¸¸ç”¨çš„æ˜¯ bash è§£é‡Šå™¨ã€‚Shell ä¸ä»…å¯ä»¥è§£é‡Šç”¨æˆ·è¾“å…¥çš„å‘½ä»¤ï¼Œè¿˜å¯ä»¥è§£é‡Šæ‰§è¡ŒåŸºäºå‘½ä»¤çš„ Shell è„šæœ¬è¯­è¨€ã€‚ Shell è„šæœ¬æ˜¯ç”±å‘½ä»¤ã€Shell å˜é‡å’Œæ§åˆ¶è¯­å¥ç¯è¯­æ³•å…ƒç´ æ„æˆçš„æ–‡æœ¬æ–‡ä»¶ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒShell å¯¹è„šæœ¬ä¸­çš„å†…å®¹é€è¡Œåˆ†æï¼Œå¹¶ä¾æ¬¡åœ¨ä¸åŒçš„è¿›ç¨‹ä¸­è§£é‡Šæ‰§è¡Œã€‚é€šå¸¸ Shell è„šæœ¬ç»“æ„å¦‚ä¸‹ï¼š\n#!/bin/bash var1 = \u0026#34;hello,shell.\u0026#34; echo $var1 ###Shell å˜é‡\nShell å˜é‡åˆ†ä¸ºå››ç±»ï¼š\nç”¨æˆ·è‡ªå®šä¹‰å˜é‡ ç¯å¢ƒå˜é‡ ä½ç½®å˜é‡ é¢„å®šä¹‰å˜é‡ å˜é‡çš„å‡ ç§æ“ä½œ:\næ“ä½œæ•´æ•°èµ‹å€¼ï¼šå˜é‡å=å˜é‡å€¼ å¼•ç”¨ï¼š$å˜é‡å æ¸…é™¤ï¼šunset å˜é‡å æŸ¥çœ‹ï¼šset è¾“å‡ºä¸ºç¯å¢ƒå˜é‡ï¼šexport ç”¨æˆ·è‡ªå®šä¹‰å˜é‡ ä½ç½®å˜é‡:\n-ä½ç½®å˜é‡å’Œä¼ é€’å‚æ•°çš„ä½ç½®æœ‰å…³\n$0:è„šæœ¬ç¨‹åºåç§° $1ï¼Œ$2\u0026hellip;..:ä¼ é€’ç»™è„šæœ¬çš„å‚æ•°ï¼Œ$1 ä»£è¡¨ç¬¬ä¸€ä¸ªå‚æ•° é¢„å®šä¹‰å˜é‡:\né¢„å®šä¹‰å˜é‡ å«ä¹‰ $* ä¼ é€’åˆ°è„šæœ¬çš„æ‰€æœ‰å‚æ•°å†…å®¹ $? å‘½ä»¤æ‰§è¡Œåçš„è¿”å›çŠ¶æ€ï¼Œ0 æˆåŠŸï¼Œå…¶ä»–å€¼è¡¨ç¤ºé”™è¯¯ $$ å½“å‰è¿›ç¨‹çš„è¿›ç¨‹å· $! åå°è¿è¡Œçš„æœ€åä¸€ä¸ªè¿›ç¨‹å· $# ä¼ é€’åˆ°è„šæœ¬çš„å‚æ•°çš„æ•°é‡ å‘½ä»¤æ›¿æ¢ å‘½ä»¤æ›¿æ¢å¯ä»¥ä½¿å‘½ä»¤çš„è¾“å‡ºç»“æœèµ‹å€¼ç»™å˜é‡ï¼Œæ³¨æ„è¯­æ³•å½¢å¼ 2 ä¸­æ˜¯åå¼•å·`,ä¸æ˜¯å•å¼•å·'\nè¯­æ³•å½¢å¼ï¼š\nvar = $(command) var = `command` æ¡ˆä¾‹ï¼š\necho \u0026#34;today is\u0026#34; `date` è¾“å…¥è¾“å‡º read å‘½ä»¤ åŠŸèƒ½ï¼šä»é”®ç›˜è¯»å–è¾“å…¥ï¼Œå¹¶èµ‹å€¼ç»™å˜é‡\nè¯­æ³•ï¼š read [é€‰é¡¹] å˜é‡ååˆ—è¡¨\né€‰é¡¹åˆ—è¡¨ï¼š\né€‰é¡¹ å«ä¹‰ -p prompt è®¾ç½®æç¤ºä¿¡æ¯ -n num å½“ read è¯» n ä¸ªå­—ç¬¦åè¿”å› -s é”®ç›˜è¾“å…¥ä¸å›æ˜¾ -t timeout è®¾ç½®è¶…æ—¶æ—¶é—´ -r å–æ¶ˆè½¬ä¹‰å­—ç¬¦çš„è½¬ä¹‰ä½œç”¨ -d delim å®šä¹‰æ–°çš„æ¢è¡Œç¬¦ æ¡ˆä¾‹ï¼š\nread -s -n 1 -p \u0026#34;Yes(Y) or not(N)?\u0026#34; answer echo $answer echo å‘½ä»¤ åŠŸèƒ½ï¼šæ˜¾ç¤ºå­—ç¬¦ä¸²æˆ–å˜é‡çš„å€¼\nè¯­æ³•ï¼šecho [é€‰é¡¹] å­—ç¬¦ä¸²\né€‰é¡¹åˆ—è¡¨ï¼š\né€‰é¡¹ -å«ä¹‰ -n ä¸å†æœ€åè‡ªåŠ¨æ¢è¡Œ -e å¯ç”¨åæ–œçº¿æ§åˆ¶å­—ç¬¦çš„è½¬æ¢ -E ä¸å¤„ç†è½¬ä¹‰å­—ç¬¦ï¼Œç¼ºçœé€‰é¡¹ æ”¯æŒçš„è½¬ä¹‰ç¬¦åˆ—è¡¨ï¼š\\t\\n\\r\\\\b\\aç­‰\nå¼•å· åå¼•å·:å‘½ä»¤æ›¿æ¢\nå•å¼•å·:å•å¼•å·ä¸­æ‰€æœ‰å­—ç¬¦ä¿ç•™åŸæœ‰å­—ç¬¦å«ä¹‰ï¼Œä¸èƒ½åŒ…å«å•å¼•å·ã€‚ä¸æ”¯æŒå…ƒå­—ç¬¦ã€å˜é‡æ›¿æ¢ã€å‘½ä»¤æ›¿æ¢ã€‚\nåŒå¼•å·:ä¸æ”¯æŒå…ƒå­—ç¬¦ï¼Œæ”¯æŒå˜é‡æ›¿æ¢ã€å‘½ä»¤æ›¿æ¢ã€‚\næ¡ä»¶è¡¨è¾¾å¼ æ¡ä»¶è¡¨è¾¾å¼ç”¨åŠ›å•Šåˆ¤æ–­æ¡ä»¶æ˜¯å¦æ»¡è¶³\n#!/bin/bash hour=$(date +\u0026#34;%H\u0026#34;) case $hour in 0[1-9] | 1[01]) echo \u0026#34;Good morning!!\u0026#34; ;; 1[2-7]) echo \u0026#34;Good afternoon\u0026#34; ;; *) echo \u0026#34;Good evening\u0026#34; ;; esac æµ‹è¯•æ¡ä»¶è¡¨è¾¾å¼çœŸå‡æ–¹æ³•å¦‚ä¸‹ï¼ŒçœŸ 0 å‡ 1ï¼š\ntest æ¡ä»¶è¡¨è¾¾å¼\n[æ¡ä»¶è¡¨è¾¾å¼]\næ¡ä»¶è¡¨è¾¾å¼ä¸­å¸¸ç”¨äº”ç±»æ“ä½œç¬¦ï¼š\næ–‡ä»¶çŠ¶æ€æ“ä½œç¬¦ å­—ç¬¦ä¸²æ“ä½œç¬¦ æ•°å­—æ“ä½œç¬¦ é€»è¾‘æ“ä½œç¬¦ æ–‡ä»¶çŠ¶æ€æ“ä½œç¬¦ï¼ˆç•¥ï¼‰:\n-x filename æ–‡ä»¶å¯æ‰§è¡Œè¿”å›çœŸ å­—ç¬¦ä¸²æ“ä½œç¬¦:\næ“ä½œç¬¦ å«ä¹‰ string string éç©ºä¸ºçœŸ -n string string é•¿åº¦å¤§äº 0 ä¸ºçœŸ -z sring string é•¿åº¦ä¸º 0 ä¸ºçœŸ string1=string2 ç›¸ç­‰ä¸ºçœŸ string1 != string2 ä¸ç­‰ä¸ºçœŸ æ•°å­—æ“ä½œç¬¦:\næ“ä½œç¬¦ å«ä¹‰ n1 -eq n2 n1 å’Œ n2 ç›¸ç­‰è¿”å› 0ï¼Œå¦åˆ™ 1 n1 -ne n2 ä¸ç­‰ä¸ºçœŸ n1 -lt n2 n1 \u0026lt; n2 ä¸ºçœŸ n1 -gt n2 n1 \u0026gt; n2 ä¸ºçœŸ n1 -le n2 n1 \u0026lt;= n2 ä¸ºçœŸ n1 -ge n2 n1 \u0026gt;= n2 ä¸ºçœŸ é€»è¾‘æ“ä½œç¬¦:\næ“ä½œç¬¦ å«ä¹‰ e1 -a e2 e1 å’Œ e2 ä¸¤ä¸ªè¡¨è¾¾å¼åŒæ—¶ä¸ºçœŸè¿”å› 0ï¼Œå¦åˆ™ 1 e1 -o e2 e1,e2 æœ‰ä¸€ä¸ªä¸ºçœŸè¿”å› 0 !e1 e1 ä¸ä¸ºçœŸæ—¶è¿”å› 0 å‘½ä»¤åˆ†éš”ç¬¦ å‘½ä»¤åˆ†éš”ç¬¦å¯ä»¥åœ¨ä¸€è¡Œä¸­è¿è¡Œå¤šä¸ªå‘½ä»¤\nå‘½ä»¤åˆ†éš”ç¬¦ å«ä¹‰ cmd1;cmd2 ä»¥ç‹¬ç«‹è¿›ç¨‹ä¾æ¬¡è¿è¡Œ cmd1 å’Œ cmd2 (cmd1;cmd2) åœ¨åŒä¸€è¿›ç¨‹ä¸­ä¾æ¬¡è¿è¡Œ cmd1 å’Œ cmd2 cmd1 \u0026amp; cmd2 cmd1 å’Œ cmd2 åŒæ—¶è¿è¡Œï¼Œåˆ†å±ä¸åŒè¿›ç¨‹ç»„ cmd1 \u0026amp;\u0026amp; cmd2 å½“ cmd1 ä¸ºçœŸæ—¶ï¼Œæ‰æ‰§è¡Œ cmd2 cmd1 || cmd2 å½“ cmd1 ä¸ºå‡æ—¶ï¼Œæ‰æ‰§è¡Œ cmd2 cmd1 | cmd2 ç®¡é“ç¬¦å·ï¼Œcmd1 çš„è¾“å‡ºä½œä¸º cmd2 çš„è¾“å…¥ cmd1 \u0026amp; cmd1 åœ¨åå°è¿è¡Œ åˆ¤æ–­è¯­å¥ æ¡ˆä¾‹ 1ï¼šæ¯”è¾ƒä¸¤ä¸ªæ•°å­—å¤§å°\n#!/bin/bash echo \u0026#34;Enter the first interger:\u0026#34; read first echo \u0026#34;Enter the second interger:\u0026#34; read second if (( first \u0026gt; second )); then echo \u0026#34;$first is greater than $second\u0026#34; elif (( first \u0026lt; second ));then echo \u0026#34;$first is less than $second\u0026#34; else echo \u0026#34;$first is equal to $second\u0026#34; echo \u0026#34;Done\u0026#34; fi æ¡ˆä¾‹ 2ï¼šè·å–ç³»ç»Ÿæ—¶é—´ï¼Œåˆ¤æ–­ä¸Šåˆã€ä¸‹åˆã€æ™šä¸Š\n#!/bin/bash hour=$(date +\u0026#34;%H\u0026#34;) case $hour in 0[1-9] | 1[01]) echo \u0026#34;Good morning!!\u0026#34; ;; 1[2-7]) echo \u0026#34;Good afternoon\u0026#34; ;; *) echo \u0026#34;Good evening\u0026#34; ;; esac å¾ªç¯è¯­å¥ æ¡ˆä¾‹ 1ï¼šfor å¾ªç¯æ‰“å°æ‰€æœ‰å‘½ä»¤è¡Œå‚æ•°\n#!/bin/bash #you can write this in short:for arg for arg in $* do echo $arg done æ¡ˆä¾‹ 2ï¼šwhile è®¡ç®— 1-99 çš„å’Œ\n#!/bin/bash i=1 sum=0 while [ $i -lt 100 ] do sum=`expr $sum + $i` i=`expr $i + 1` done echo The sum is $sum æ¡ˆä¾‹ 3ï¼šæ˜¾ç¤º 1-100 ä¹‹é—´çš„æ•´æ•°\n#!/bin/bash i=1 until [ $i -gt 100 ] do echo $i i=`expr $i + 1` done break [n] è·³å‡º n é‡å¾ªç¯ï¼Œé»˜è®¤ä¸º 1\ncontinue [n]\nexit [n]\nå‡½æ•° è¯­æ³•ï¼š\nå‡½æ•°å() { å‘½ä»¤åˆ—è¡¨ return } `\nè°ƒç”¨æ–¹å¼:\nå‡½æ•°å å‚æ•°åˆ—è¡¨\næ³¨æ„ï¼š\nè°ƒç”¨å‰ï¼Œå¿…é¡»å…ˆå®šä¹‰ ä½¿ç”¨ shell ä½ç½®å˜é‡æ¥æ”¶å‚æ•°ä¼ é€’ï¼Œä¾‹å¦‚$0$1 è¿”å›å€¼å–è‡ªå‡½æ•°ä¸­ return è¯­å¥æˆ–å‡½æ•°ä¸­æœ€åä¸€æ¡å‘½ä»¤çš„è¿”å›çŠ¶æ€ï¼Œé€šè¿‡$?è·å¾— ä½¿ç”¨ local å£°æ˜çš„å±€éƒ¨å˜é‡ï¼Œä½œç”¨ä»…é™äºå‡½æ•°æœ¬èº« æ¡ˆä¾‹ï¼š\n#!/bin/bash #name:getsum.sh get_sum() { i=$1 sum=0 while [ $i -lt $2 ] do sum=`expr $sum + $i` i=`expr $i + 1` done return $sum } get_sum $2 $3 result=$? echo $1 echo sum of $2 to $3 is $result è¿è¡Œ:\n./getsum.sh \u0026#34;test\u0026#34; 5 7 æ³¨æ„äº‹é¡¹ å˜é‡èµ‹å€¼çš„=ä¸¤ä¾§ä¸èƒ½æœ‰ç©ºæ ¼ æ¡ä»¶è¡¨è¾¾å¼ å’Œè¡¨è¾¾å¼é—´å¿…é¡»æœ‰ç©ºæ ¼ expr ç®—å¼è¡¨è¾¾å¼ä¸­æ¯ä¸ªè¿ç®—ç¬¦ä¸¤ä¾§å¿…é¡»æœ‰ç©ºæ ¼ ","permalink":"https://blog.niuhemoon.win/posts/tech/basic-shell/","summary":"Shell æ˜¯ä¸€ç§å‘½ä»¤è¡Œè§£é‡Šå™¨ï¼Œç›®å‰ Linux ä¸‹æœ€å¸¸ç”¨çš„æ˜¯ bash è§£é‡Šå™¨ã€‚Shell ä¸ä»…å¯ä»¥è§£é‡Šç”¨æˆ·è¾“å…¥çš„å‘½ä»¤ï¼Œè¿˜å¯ä»¥è§£é‡Šæ‰§è¡ŒåŸºäºå‘½ä»¤çš„ Shell è„šæœ¬è¯­è¨€ã€‚ Shell è„šæœ¬æ˜¯ç”±å‘½ä»¤ã€Shell å˜é‡å’Œæ§åˆ¶è¯­å¥ç¯è¯­æ³•å…ƒç´ æ„æˆçš„æ–‡æœ¬æ–‡ä»¶ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒShell å¯¹è„šæœ¬ä¸­çš„å†…å®¹é€è¡Œåˆ†æï¼Œå¹¶ä¾æ¬¡åœ¨ä¸åŒçš„è¿›ç¨‹ä¸­è§£é‡Šæ‰§è¡Œã€‚é€šå¸¸ Shell è„šæœ¬ç»“æ„","title":"Shellç¼–ç¨‹åŸºç¡€"},{"content":" ç°åœ¨å¾ˆå¤šä¼ æ„Ÿå™¨éƒ½ä½¿ç”¨ä¸²å£è¿›è¡Œæ•°æ®ä¼ é€ï¼Œæˆ‘ä»¬å†windowä¸Šé€šå¸¸ä½¿ç”¨sscom33è¿™ç±»è°ƒè¯•å·¥å…·ï¼Œåœ¨linuxä¸‹é€šå¸¸ä½¿ç”¨å¸¦ç•Œé¢çš„cutecomæˆ–è€…å‘½ä»¤è¡Œç•Œé¢çš„minicomè¿›è¡Œè°ƒè¯•ã€‚ è€Œä½¿ç”¨Pythonå†™å‡ è¡Œç¨‹APIåºè¿›è¡Œè‡ªå®šä¹‰è°ƒè¯•ï¼Œå°±éå¸¸æœ‰ç”¨ã€‚å¹¶ä¸”å¯ä»¥å¿«é€Ÿçš„å¯¹ä¼ æ„Ÿå™¨è¿›è¡Œæµ‹è¯•ã€‚æœ¬æ–‡ä»‹ç»pythonçš„ä¸²å£è¯»å†™æ¨¡å—Pyserial\nå®‰è£… sudo pip install pyserial ä½¿ç”¨ ç¡®å®šä¸²å£è®¾å¤‡å Linuxä¸‹æŠŠä¸²å£è®¾å¤‡æŠ½è±¡æˆäº†æ–‡ä»¶ï¼Œé€šå¸¸æ”¾åœ¨/dev/ç›®å½•ä¸‹ï¼Œå…ˆæ‰¾å‡ºä¸²å£è®¾å¤‡çš„åç§°ã€‚\næ–­å¼€ä¸²å£è®¾å¤‡çš„è¿æ¥ï¼Œæ‰§è¡Œ ls /dev/ \u0026gt; /tmp/old.txt å°†ä¸²å£è®¾å¤‡è¿æ¥åˆ°è®¡ç®—æœºï¼Œæ‰§è¡Œ ls /dev/ \u0026gt; /tmp/new.txt æœ€åï¼Œæ¯”è¾ƒold.txtå’Œnew.txtï¼Œnew.txtä¸­å¤šå‡ºçš„è®¾å¤‡åå°±æ˜¯æˆ‘ä»¬çš„ä¸²å£è®¾å¤‡\ndiff /tmp/old.txt /tmp/new.txt ä¾‹ç¨‹ ä»¥ä¸‹æ˜¯æˆ‘è¯»å–è¶…å£°æ³¢æµ‹è·ä¼ æ„Ÿå™¨çš„ä¾‹ç¨‹ï¼Œä¼ æ„Ÿå™¨è¿”å›ä¸²å£æ•°æ®,æ¯ä¸€å¸§æ•°æ®çš„å¸§å¤´æ˜¯0xFF,å…¶åçš„2byteæ•°æ®æ˜¯è·ç¦»å€¼ã€‚\nimport serial import time with serial.Serial(\u0026#39;/dev/ttyUSB0\u0026#39;,9600,stopbits=serial.STOPBITS_ONE,bytesize=serial.EIGHTBITS) as ser: while 1: head = ser.read(1) if head == b\u0026#39;\\xFF\u0026#39;: distance = int.from_bytes(ser.read(2),byteorder=\u0026#39;big\u0026#39;,signed=False) print(str(distance/1000) + \u0026#39;m\u0026#39;) å¸¸ç”¨æ–¹æ³• åœ¨åˆ›å»ºä¸²å£å¯¹è±¡åï¼Œå³ser = serial.Serial('/dev/ttyUSB0')ï¼Œå¯ä»¥æ“ä½œä¸²å£è¯»å†™ã€‚\nser.read(size) ser.readline(size) ser.write(str_data) ser.close() å…·ä½“ä½¿ç”¨å‚è§å®˜æ–¹æ–‡æ¡£API\nå‚è€ƒ APIå‚è€ƒ\n","permalink":"https://blog.niuhemoon.win/posts/tech/pyserial-tutorial/","summary":"ç°åœ¨å¾ˆå¤šä¼ æ„Ÿå™¨éƒ½ä½¿ç”¨ä¸²å£è¿›è¡Œæ•°æ®ä¼ é€ï¼Œæˆ‘ä»¬å†windowä¸Šé€šå¸¸ä½¿ç”¨sscom33è¿™ç±»è°ƒè¯•å·¥å…·ï¼Œåœ¨linuxä¸‹é€šå¸¸ä½¿ç”¨å¸¦ç•Œé¢çš„cutecomæˆ–è€…å‘½ä»¤è¡Œç•Œé¢çš„minicomè¿›è¡Œè°ƒè¯•ã€‚ è€Œä½¿ç”¨Pythonå†™å‡ è¡Œç¨‹APIåºè¿›è¡Œè‡ªå®šä¹‰è°ƒè¯•ï¼Œå°±éå¸¸æœ‰ç”¨ã€‚å¹¶ä¸”å¯ä»¥å¿«é€Ÿçš„å¯¹ä¼ æ„Ÿå™¨è¿›è¡Œæµ‹è¯•ã€‚æœ¬æ–‡ä»‹ç»","title":"Pyserialå¿«é€Ÿä¸Šæ‰‹"},{"content":"ç®€ä»‹ LSM303DLHCæ˜¯ä¸€ä¸ªä¸‰è½´åŠ é€Ÿåº¦å’Œä¸‰è½´ç£åœºçš„ä¼ æ„Ÿå™¨ï¼Œå…·æœ‰å€¾æ–œè¡¥å¿ï¼Œå·¥ä½œç”µå‹åœ¨2.5-5.5Vä¹‹é—´ï¼Œå·¥ä½œç”µæµ10mAï¼Œæ•°æ®æ¥å£æ˜¯I2Cæ¥å£ã€‚\nå¼•è„šå®šä¹‰ VIN 2.5-5.5Vç”µå‹ä¾›ç”µå¼•è„šï¼ŒSCLå’ŒSDAå¼•è„šçš„é«˜ç”µå¹³ç”µå‹å’ŒVINå¼•è„šçš„ç”µå‹ç›¸åŒã€‚\nVDD æ ¹æ®VINå¼•è„šçš„è¿æ¥æƒ…å†µï¼ŒVDDå¼•è„šç”¨é€”ä¸åŒï¼Œè‹¥VINå¼•è„šè¿æ¥äº†å¤§äº3.3Vçš„ç”µæºï¼ŒVDDå¯ä»¥æƒ³æ­ªæä¾›3.3Vçš„ç”µå‹å’Œå¤§çº¦150mAçš„ç”µæµã€‚å¦‚æœVINæ–­å¼€è¿æ¥ï¼Œå¯ä»¥ä½¿ç”¨2.5-3.3çš„ç”µæºè¿æ¥VDDç»™LSM303DLHCæ¨¡å—ä¾›ç”µã€‚ æ³¨æ„ï¼š\nä¸èƒ½åŒæ—¶ä½¿ç”¨VINå’ŒVDDç»™LSM303DLHCä¾›ç”µï¼Œåªèƒ½é€‰å–ä¸€ä¸ªã€‚ ä¸è¦å°†VDDè¿æ¥åˆ°å¤§äº3.6Vçš„ç”µæºä¸Šï¼Œä¼šæŸåLSM303DLHCæ¨¡å— GND 0Vï¼Œè¿æ¥åˆ°ç”µæºçš„åœ°ã€‚æ³¨æ„å’ŒI2Cæ€»çº¿å…±åœ°ã€‚\nSCL æ—¶é’Ÿçº¿ï¼Œé«˜ç”µå¹³æ˜¯VINï¼Œä½ç”µå¹³æ˜¯0Vã€‚SCLå’ŒSDAéƒ½æœ‰ç”µå¹³è½¬æ¢ç”µè·¯ï¼Œå¯ä»¥ä½¿å¾—æ¨¡å—å¯ä»¥ä½¿ç”¨VINçš„é€»è¾‘ç”µå¹³è¿›è¡Œé€šä¿¡ã€‚\nSDA æ•°æ®çº¿ï¼Œé«˜ç”µå¹³æ˜¯VINï¼Œä½ç”µå¹³æ˜¯0V\nDRDY æ•°æ®å¯è¯»æŒ‡ç¤ºï¼Œ3.3Vé€»è¾‘ç”µå¹³è¾“å‡ºï¼Œé«˜ç”µå¹³(3.3V)æŒ‡ç¤ºç£åœºæ•°æ®å¯è¯»ï¼Œä½ç”µå¹³è¡¨ç¤ºæ­£åœ¨å‘æ•°æ®å¯„å­˜å™¨ä¸­å†™å…¥æ–°çš„æ•°æ®ã€‚æ­¤è¾“å‡ºæ²¡æœ‰ç”µå¹³è½¬æ¢ã€‚\nINT1 INT2 ä¸¤ä¸ªæƒ¯æ€§ä¸­æ–­ï¼Œæ²¡æœ‰ç”µå¹³è½¬æ¢ï¼Œ3.3Vè¾“å‡ºã€‚\nä¾‹ç¨‹å’Œåº“ Arduinoä¾‹ç¨‹å’Œåº“å‚è€ƒï¼š https://github.com/pololu/lsm303-arduino\nLinuxä¾‹ç¨‹ï¼š https://github.com/ControlEverythingCommunity/LSM303DLHC\nå‚è€ƒ äº§å“è¯´æ˜ä¹¦\n","permalink":"https://blog.niuhemoon.win/posts/tech/lsm303dlhc-doc/","summary":"ç®€ä»‹ LSM303DLHCæ˜¯ä¸€ä¸ªä¸‰è½´åŠ é€Ÿåº¦å’Œä¸‰è½´ç£åœºçš„ä¼ æ„Ÿå™¨ï¼Œå…·æœ‰å€¾æ–œè¡¥å¿ï¼Œå·¥ä½œç”µå‹åœ¨2.5-5.5Vä¹‹é—´ï¼Œå·¥ä½œç”µæµ10mAï¼Œæ•°æ®æ¥å£æ˜¯I2Cæ¥å£ã€‚ å¼•è„šå®šä¹‰ VIN 2.5-5.5Vç”µå‹ä¾›ç”µå¼•è„šï¼ŒSCLå’ŒSDAå¼•è„šçš„é«˜ç”µå¹³ç”µå‹å’ŒVINå¼•è„šçš„ç”µå‹ç›¸åŒã€‚ VDD æ ¹æ®VINå¼•è„šçš„è¿æ¥æƒ…å†µï¼ŒVDDå¼•è„šç”¨","title":"LSM303_Doc"},{"content":" åœ¨å±€åŸŸç½‘ä¸‹å¯ä»¥é€šè¿‡æ‰«æç«¯å£å·ï¼Œè·å¾—å±€åŸŸç½‘ä¸‹æ ‘è“æ´¾çš„ipåœ°å€ï¼Œå¦‚192.168.1.118ã€‚ä¹‹åé€šè¿‡sshæˆ–è€…VNCç­‰æ–¹æ³•è®¿é—®æ ‘è“æ´¾ã€‚é‚£ä¹ˆå¦‚æœæˆ‘ä»¬ç¦»å¼€å±€åŸŸç½‘ï¼Œæ€ä¹ˆè®¿é—®åˆ°å®¶ä¸­çš„æ ‘è“æ´¾å‘¢ï¼Ÿ å…¬ç½‘IPç›¸å½“äºè¡—é“ä¸­çš„é—¨ç‰Œå·ï¼Œå¦‚æœè¿œç¨‹è®¿é—®åˆ°äº’è”ç½‘ä¸­çš„è®¾å¤‡ï¼Œå¿…é¡»çŸ¥é“è®¾å¤‡çš„å…¬ç½‘IPã€‚\nVPS + SSHè¿œç¨‹ä»£ç†éš§é“ è¿™æ˜¯è¿™ç¯‡æ–‡ç« é‡ç‚¹ï¼Œéœ€è¦ï¼š\nä¸€ä¸ªå®‰è£…äº†linuxçš„VPSï¼Œå¦‚ä¸€å°è…¾è®¯äº‘æœåŠ¡å™¨ã€‚ï¼ˆå¦‚æœæ²¡æœ‰ï¼Œè¯·çœ‹ä¸‹ä¸€ç§æ–¹æ³•ï¼šå…¬ç½‘IP+è·¯ç”±å™¨ç«¯å£è½¬å‘ï¼‰ è¿ä¸Šç½‘ç»œçš„æ ‘è“æ´¾,å°†æ ‘è“æ´¾sshå…¬é’¥æ”¾åˆ°VPSä¸Š æ ‘è“æ´¾ä¸Šä½¿ç”¨autossh+crontab sudo apt install autossh cd ~/ echo \u0026#34;sleep 20; /usr/bin/autossh -M 5678 -NfR 9999:localhost:22 user@T.T.T.T -i /home/user/.ssh/id_rsa\u0026#34; \u0026gt; autossh.sh chmod +x autossh.sh crontab -e åœ¨crontabçš„é…ç½®æ–‡ä»¶ä¸­åŠ å…¥\n@reboot /home/nh/autossh.sh \u0026gt;\u0026gt; tunnel.log åœ¨æœåŠ¡å™¨ä¸Šæ“ä½œ ssh -fCNL \u0026#34;*:11111:localhost:9999\u0026#34; localhost è¿œç¨‹ç™»å½• ç°åœ¨å°±å¯ä»¥ä½¿ç”¨æœåŠ¡å™¨ä½œä¸ºè·³æ¿ï¼Œè¿æ¥åˆ°å®¶ä¸­çš„æ ‘è“æ´¾ã€‚\nssh -p 11111 user@T.T.T.T æ³¨ï¼šuser@T.T.T.T,useræ˜¯æ ‘è“æ´¾ç”¨æˆ·åï¼ŒT.T.T.Tæ˜¯æœåŠ¡å™¨å…¬ç½‘IPã€‚-pæŒ‡å®šå‘æœåŠ¡å™¨1111ç«¯å£å‘é€sshè¯·æ±‚ï¼Œ1111ç«¯å£è½¬å‘åˆ°9999ç«¯å£ï¼Œä¹Ÿå°±æ˜¯æ ‘è“æ´¾çš„22ç«¯å£ã€‚\næ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š\nä»¥ä¸‹æ ‘è“æ´¾é…ç½®æ–¹æ³•å‡ä¸æ¨èï¼Œæƒ³æŠ˜è…¾çš„è‡ªå·±ç©ï¼ŒæœåŠ¡å™¨é…ç½®æ–¹æ³•éƒ½ä¸€æ ·\næ ‘è“æ´¾ä¸Šå®‰è£…sshpass(å¯é€‰ï¼‰ sudo apt-get install sshpass æ ‘è“æ´¾ä¸Šç¼–è¾‘shellè„šæœ¬ #!/bin/bash #saved as create_ssh_tunnel.sh createTunnel() { sshpass -p \u0026#34;Password\u0026#34; ssh -o \u0026#34;ServerAliveInterval 300\u0026#34; -o \u0026#34;ServerAliveCountMax 2\u0026#34; -fCNR 9999:localhost:22 user@T.T.T.T if [[ $? -eq 0 ]]; then echo $(date) Tunnel to jumpbox created successfully \u0026gt;\u0026gt; /root/tunnel.log else echo $(date) An error occurred creating a tunnel to jumpbox. RC was $? \u0026gt;\u0026gt; /root/tunnel.log fi } /bin/pidof ssh if [[ $? -ne 0 ]]; then echo $(date) Creating new tunnel connection \u0026gt;\u0026gt; /root/tunnel.log createTunnel fi æ³¨ï¼šè¿™ç§æ–¹å¼éå¸¸å±é™©ï¼Œä¸æ¨èè¿™ç§æ–¹å¼ï¼Œå› ä¸ºæ˜æ–‡å­˜å‚¨äº†æœåŠ¡å™¨å¯†ç ã€‚\n\u0026ldquo;Password\u0026quot;æŒ‡çš„æ˜¯ä½ çš„æœåŠ¡å™¨å¯†ç  user@T.T.T.Tæ˜¯ä½ çš„æœåŠ¡å™¨ç”¨æˆ·åå’ŒIPåœ°å€ 9999æ˜¯å°†æ ‘è“æ´¾çš„22ç«¯å£ç»‘å®šåˆ°æœåŠ¡å™¨é¢9999ç«¯å£ æ¨èå°†æ ‘è“æ´¾ä¸Šçš„å…¬é’¥æ”¾åˆ°è¿œç¨‹æœåŠ¡å™¨ä¸Šï¼Œç„¶åä½¿ç”¨å¦‚ä¸‹è„šæœ¬\n#saved as create_ssh_tunnel.sh createTunnel() { ssh -o \u0026#34;ServerAliveInterval 300\u0026#34; -o \u0026#34;ServerAliveCountMax 2\u0026#34; -NR 9999:localhost:22 user@T.T.T.T if [[ $? -eq 0 ]]; then echo $(date) Tunnel to jumpbox created successfully \u0026gt;\u0026gt; ~/tunnel.log else echo $(date) An error occurred creating a tunnel to jumpbox. RC was $? \u0026gt;\u0026gt; ~/tunnel.log fi } /bin/pidof ssh if [[ $? -ne 0 ]]; then echo $(date) Creating new tunnel connection \u0026gt;\u0026gt; ~/tunnel.log createTunnel fi ç»™è„šæœ¬æ·»åŠ æ‰§è¡Œæƒé™\nchmod +x creat_ssh_tunnel.sh æ ‘è“æ´¾ä¸Šå¼€å¯cronå®šæ—¶ä»»åŠ¡ sudo crontab -e åœ¨æ–‡ä»¶æœ€åä¸€è¡Œæ·»åŠ ï¼š\n*/10 * * * * ï½/create_ssh_tunnel.sh \u0026gt;\u0026gt; tunnel.log 2\u0026gt;\u0026amp;1 æ„æ€æ˜¯æ¯ååˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡åˆšåˆšæˆ‘ä»¬ç¼–è¾‘çš„shellè„šæœ¬\nå…¬ç½‘IP + è·¯ç”±å™¨ç«¯å£è½¬å‘ å¦‚æœç”¨ç½‘çº¿å°†æ ‘è“æ´¾è¿æ¥åˆ°äº’è”ç½‘ä¸Šï¼Œåªè¦è·å¾—å…¬ç½‘IPï¼Œçš†å¯ä»¥é€šè¿‡sshè®¿é—®ã€‚ä½†æ˜¯æˆ‘ä»¬åœ¨å®¶ä¸­é€šå¸¸æ˜¯ç”¨wifiè¿æ¥æ ‘è“æ´¾ï¼Œæˆ‘ä»¬è·å¾—çš„å…¬ç½‘iPï¼Œåªæ˜¯è·¯ç”±å™¨çš„IPã€‚ç”±äºä¸€ä¸ªè·¯ç”±å™¨ä¸Šè¿æ¥å¾ˆå¤šè®¾å¤‡ï¼Œæˆ‘ä»¬æ— æ³•é€šè¿‡è¿™ä¸ªå…¬ç½‘IPè®¿é—®åˆ°æ ‘è“æ´¾ã€‚è€Œä¸”ç”±äºè·¯ç”±å™¨çš„å…¬ç½‘IPæ˜¯ä¼šå˜åŠ¨çš„ã€‚æ‰€ä»¥æˆ‘ä»¬è¦è§£å†³çš„é—®é¢˜æ˜¯ï¼š\næ‰¾åˆ°è·¯ç”±å™¨çš„å…¬ç½‘IP é€šè¿‡å…¬ç½‘IPæ‰¾åˆ°è·¯ç”±å™¨ä¸‹è¿æ¥çš„æ ‘è“æ´¾ å¯ä»¥åœ¨è·¯ç”±å™¨è®¾ç½®é‡Œå°†æ ‘è“æ´¾åˆ†é…å›ºå®šçš„IPï¼Œå¹¶ç»‘å®šå›ºå®šç«¯å£ã€‚è¿™æ ·å°±å¯ä»¥é€šè¿‡è®¿é—®è¿™ä¸ªç«¯å£è®¿é—®åˆ°å±€åŸŸç½‘ä¸‹çš„æ ‘è“æ´¾ã€‚ä¹‹åä¸ç®¡æ˜¯å°†å…¬ç½‘IPå‘é€åˆ°é‚®ç®±è¿˜æ˜¯ï¼Œä½¿ç”¨åŠ¨æ€DNSè§£ææœåŠ¡ï¼Œé€šè¿‡åŸŸåè®¿é—®æ ‘è“æ´¾ï¼Œéƒ½å¯ä»¥å¾ˆå®¹æ˜“å®ç°ã€‚\nå‚è€ƒ SSHåå‘ä»£ç† å¤–ç½‘è®¿é—®æ ‘è“æ´¾æ–¹æ³•æ±‡æ€» ç”¨DDNSæœåŠ¡é€šè¿‡åŸŸåè®¿é—®æ ‘è“æ´¾ ä½¿ç”¨crontabè®©SSHåå‘ä»£ç†æ›´æŒä¹… ","permalink":"https://blog.niuhemoon.win/posts/tech/raspi-remote-ssh-tunnel/","summary":"åœ¨å±€åŸŸç½‘ä¸‹å¯ä»¥é€šè¿‡æ‰«æç«¯å£å·ï¼Œè·å¾—å±€åŸŸç½‘ä¸‹æ ‘è“æ´¾çš„ipåœ°å€ï¼Œå¦‚192.168.1.118ã€‚ä¹‹åé€šè¿‡sshæˆ–è€…VNCç­‰æ–¹æ³•è®¿é—®æ ‘è“æ´¾ã€‚é‚£ä¹ˆå¦‚æœæˆ‘ä»¬ç¦»å¼€å±€åŸŸç½‘ï¼Œæ€ä¹ˆè®¿é—®åˆ°å®¶ä¸­çš„æ ‘è“æ´¾å‘¢ï¼Ÿ å…¬ç½‘IPç›¸å½“äºè¡—é“ä¸­çš„é—¨ç‰Œå·ï¼Œå¦‚æœè¿œç¨‹è®¿é—®åˆ°äº’è”ç½‘ä¸­çš„è®¾å¤‡ï¼Œå¿…é¡»çŸ¥é“è®¾å¤‡çš„å…¬ç½‘IPã€‚ VPS + SSHè¿œç¨‹","title":"è¿œç¨‹sshè¿æ¥å®¶ä¸­çš„æ ‘è“æ´¾"},{"content":" åœ¨ä½¿ç”¨è¶…å£°æµ‹è·æ¨¡å—æ—¶ï¼Œéœ€è¦ç»™è¶…å£°æ¨¡å—ä¸€ä¸ªæ–¹æ³¢ä¿¡å·ã€‚äºæ˜¯å¯ä»¥ç”¨æ ‘è“æ´¾çš„çš„PWMåŠŸèƒ½äº§ç”Ÿä¸€ä¸ªä½é¢‘çš„æ–¹æ³¢ä¿¡å·ã€‚\näº§ç”Ÿæ–¹æ³¢ä¿¡å·åï¼Œå¦‚æœæ‰‹è¾¹æ²¡æœ‰ç¤ºæ³¢å™¨ï¼Œè¿˜å¯ä»¥ä½¿ç”¨Arduinoçš„ADCé‡‡æ ·åŠŸèƒ½ï¼Œåšä¸€ä¸ªç®€å•çš„ç¤ºæ³¢å™¨ã€‚\næ ‘è“æ´¾äº§ç”Ÿæ–¹æ³¢ æ ‘è“æ´¾çš„pin12ã€pin33(GPIO_18ã€GPIO_13)æ˜¯æ ‘è“æ´¾æä¾›çš„PWMç¡¬ä»¶æ¥å£ï¼Œå¯ä»¥äº§ç”Ÿé«˜é¢‘çš„PWMä¿¡å·ã€‚ ç”±äºæˆ‘åªéœ€è¦äº§ç”Ÿä¸€ä¸ªå¤§çº¦50Hzçš„æ–¹æ³¢ä¿¡å·ã€‚ç”¨æœ€ç®€å•çš„GPIOåº“å°±å¯ä»¥äº§ç”Ÿå¯ç”¨çš„æ–¹æ³¢ã€‚\n#!/usr/bin/python3 # -*- coding: utf-8 -*- import RPi.GPIO as GPIO from time import sleep GPIO.setmode(GPIO.BOARD) GPIO.setup(12,GPIO.OUT) GPIO.setwarnings(False) p=GPIO.PWM(12,50) # 12æ˜¯pin12,50æ˜¯é¢‘ç‡ p.start(30) # 30è¡¨ç¤ºå ç©ºæ¯”30% input(\u0026#34;Press Enter key to Stop 50Hz PWM @ 30% duty cycle\u0026#34;) p.stop() GPIO.cleanup() è¿è¡Œè¯¥è„šæœ¬ï¼Œå°±å¯ä»¥åœ¨æ ‘è“æ´¾pin12ä¸Šäº§ç”Ÿæ–¹æ³¢ä¿¡å·ã€‚\nArduinoå’Œæ ‘è“æ´¾è¿çº¿ è¿çº¿å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š æ³¨æ„ï¼š è¦å°†æ ‘è“æ´¾å’ŒArduinoçš„åœ°çº¿è¿æ¥åœ¨ä¸€èµ·ï¼Œä½¿å®ƒä»¬å…±åœ°ã€‚\nArduino è¿›è¡ŒADCé‡‡æ · Arduino æœ‰A0-A5å…±6ä¸ªæ¨¡æ‹Ÿè¾“å…¥å£ï¼Œæ¯ä¸ªæ¨¡æ‹Ÿå£å¯ä»¥è¿›è¡Œ12ä½çš„é‡‡æ ·ï¼Œå¯ä»¥æ¥å—0-5Vçš„ç”µå‹è¾“å…¥ï¼Œå¯¹åº”ç€0-1023çš„é‡‡æ ·è¾“å‡ºã€‚\nä½¿ç”¨A0å£è¿›è¡Œé‡‡æ ·ï¼š\nvoid setup() { Serial.begin(9600); // Starting Serial Terminal } void loop() { int value = analogRead(A0); Serial.println(value); } æ‰“å¼€Arduinoå®˜æ–¹çš„IDEçš„ã€å·¥å…·ã€‘-\u0026gt; ã€ä¸²å£ç»˜å›¾å™¨ã€‘\nè®¾ç½®æ³¢ç‰¹ç‡ä¸º9600,å¯ä»¥è§‚å¯Ÿåˆ°ï¼š\næ³¨ï¼šæ ‘è“æ´¾GPIOå¼•è„šè¾“å‡ºç”µå‹ä¸º3.3Vï¼Œè€ŒArduinoé‡‡æ ·èŒƒå›´æ˜¯0-5V\nè¿˜å¯ä»¥ä½¿ç”¨SerialPlotè¿™ä¸ªåŠŸèƒ½æ›´ä¸°å¯Œçš„ä¸²å£ç»˜å›¾å™¨ï¼Œå½“åšç®€æ˜“çš„ç¤ºæ³¢å™¨ã€‚ æ˜¾ç¤ºçš„æ³¢å½¢å¦‚ä¸‹ï¼š Arduinoä¸²å£ç»˜å›¾å™¨ Arduinoä¸²å£ç»˜å›¾å™¨å¯ä»¥ç»˜åˆ¶å¤šä¸ªè¿ç»­å›¾å½¢ï¼Œå¦‚ä¸‹ç¨‹åºå°±æ˜¯åœ¨ä¸²å£ç»˜å›¾å™¨ä¸­ç”»å‡ºsinå’Œcoså‡½æ•°å›¾åƒã€‚\ndouble i = 0; void setup() { Serial.begin(9600); } void loop() { double temp = i*3.1415926/10.0; Serial.print(sin(temp)); Serial.print(\u0026#39;,\u0026#39;); Serial.println(cos(temp)); i+=0.1; delay(5); } æ³¨ï¼š\nè‹¥åªç»˜åˆ¶ä¸€ä¸ªå›¾åƒï¼Œä½¿ç”¨Serial.println()å‡½æ•°å³å¯ è‹¥ç»˜åˆ¶å¤šä¸ªå›¾åƒï¼Œåœ¨æ¯ä¸ªä¸²å£å€¼é—´ä½¿ç”¨Serial.print(\u0026rsquo;,\u0026rsquo;)è¿›è¡Œåˆ†éš” ","permalink":"https://blog.niuhemoon.win/posts/tech/arduino-raspberry-squrewave/","summary":"åœ¨ä½¿ç”¨è¶…å£°æµ‹è·æ¨¡å—æ—¶ï¼Œéœ€è¦ç»™è¶…å£°æ¨¡å—ä¸€ä¸ªæ–¹æ³¢ä¿¡å·ã€‚äºæ˜¯å¯ä»¥ç”¨æ ‘è“æ´¾çš„çš„PWMåŠŸèƒ½äº§ç”Ÿä¸€ä¸ªä½é¢‘çš„æ–¹æ³¢ä¿¡å·ã€‚ äº§ç”Ÿæ–¹æ³¢ä¿¡å·åï¼Œå¦‚æœæ‰‹è¾¹æ²¡æœ‰ç¤ºæ³¢å™¨ï¼Œè¿˜å¯ä»¥ä½¿ç”¨Arduinoçš„ADCé‡‡æ ·åŠŸèƒ½ï¼Œåšä¸€ä¸ªç®€å•çš„ç¤ºæ³¢å™¨ã€‚ æ ‘è“æ´¾äº§ç”Ÿæ–¹æ³¢ æ ‘è“æ´¾çš„pin12ã€pin33(GPIO_18ã€GPIO_13)","title":"Arduinoç®€æ˜“ç¤ºæ³¢å™¨æ£€æµ‹æ ‘è“æ´¾äº§ç”Ÿçš„æ–¹æ³¢"},{"content":" Arduinoå¯ä»¥ä½¿ç”¨PWMäº§ç”Ÿæ–¹æ³¢ä¿¡å·ï¼Œåœ¨æˆ‘çš„Arduino UNO R3ä¸Šï¼Œæ”¯æŒPWMçš„è¾“å‡ºå£æ˜¯pin 3,5,6,9,10,11è¿™å‡ ä¸ªå¼•è„šï¼Œæ”¯æŒå¤§çº¦980Hzçš„PWMè¾“å‡ºã€‚è¿™æ–¹é¢ä¸å†èµ˜è¿°ã€‚\næœ¬æ–‡ä»‹ç»å¦ä¸€ç§äº§ç”Ÿæ–¹æ³¢çš„æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨ä»»ä½•å¼•è„šäº§ç”Ÿæ–¹æ³¢ä¿¡å·ã€‚åŠŸèƒ½ï¼š\nå›ºå®šé¢‘ç‡ï¼Œå ç©ºæ¯”ï¼Œåç§»é‡çš„æ–¹æ³¢ é€šè¿‡æ¨¡æ‹Ÿå£è¿æ¥å¯è°ƒç”µä½å™¨ï¼Œäº§ç”Ÿå¯å˜é¢‘ç‡ã€å ç©ºæ¯”ã€åç§»é‡çš„æ–¹æ³¢ // High-accuracy square wave generator // based on Arduino UNO // with runtime adjustable frequency, PWM width and offset // Output wave at pin 13 double freq; // Hz double offset; // percent (0.0 to 1.0) double width; // percent (0.0 to 1.0) // unit: microsecond unsigned long cycle_time; unsigned long raising_edge; unsigned long falling_edge; unsigned long prev_micros; // compare 2 unsigned value // true if X \u0026gt; Y while for all possible (X, Y), X - Y \u0026lt; Z #define TIME_CMP(X, Y, Z) (((X) - (Y)) \u0026lt; (Z)) inline void setHigh() { // 2 CPU cycles to balance execution time with setLow() // this is based on measurement on Arduino UNO R3, your mileage may vary PORTB = B00100000; PORTB = B00100000; } inline void setLow() { PORTB = B00000000; } void setup() { DDRB = B00100000; prev_micros = micros(); while(1) { // read everything from analog input (potentiometer) // frequency: 0.1-102.4 Hz // width: 0-100% // offset: 0-100% //freq = (double)(analogRead(1) + 1) / 10; //width = (double)(analogRead(0) + 1) / 1024; //offset = (double)analogRead(2) / 1024; // OR manual settings // max possible frequency is around 55000Hz with \u0026lt;1KHz deviation // based on measurements on Arduino UNO R3 // you may get to ~77500Hz with significantly larger deviation // note: please uncomment the next 3 expressions, then // move the following 6 expressions ahead of while loop // if you are going to use manual settings, because it is no worth // to recalculate them. freq = 50; width = 0.3; offset = 0.0; cycle_time = 1000000 / freq; raising_edge = (unsigned long)(offset * cycle_time) % cycle_time; falling_edge = (unsigned long)((offset + width) * cycle_time) % cycle_time; if (width + offset \u0026lt; 1) { // raising edge should appear earlier while (TIME_CMP(micros(), prev_micros + raising_edge, cycle_time)); setHigh(); while (TIME_CMP(micros(), prev_micros + falling_edge, cycle_time)); setLow(); } else { // falling edge should appear earlier while (TIME_CMP(micros(), prev_micros + falling_edge, cycle_time)); setLow(); while (TIME_CMP(micros(), prev_micros + raising_edge, cycle_time)); setHigh(); }pin prev_micros += cycle_time; } } è§£é‡Šï¼š\nPORTBè¡¨ç¤ºçš„æ˜¯æ§åˆ¶pin8-pin13çš„å¯„å­˜å™¨ï¼Œæœ€é«˜çš„ä¸¤ä½6\u0026amp;7ä¸ä½¿ç”¨ã€‚ å¯ä»¥æ”¹å˜B00100000æ¥åœ¨å…¶ä»–pinè„šä¸Šäº§ç”Ÿæ–¹æ³¢ä¿¡å· åŒæ ·çš„PROTDå¯„å­˜å™¨æ§åˆ¶digital pin0-pin7 å‚è€ƒ ç¨‹åºæ¥æºï¼›James Swineson github@public.swineson.me, 2017-05\nhttps://gist.github.com/Jamesits/8d164818946a65d0cafcd6203e3e5049\nhttps://blog.swineson.me/high-frequency-square-wave-generator-based-on-arduino-uno/\næ“æ§Arduinoç«¯å£å¯„å­˜å™¨\n","permalink":"https://blog.niuhemoon.win/posts/tech/arduino-squrewave/","summary":"Arduinoå¯ä»¥ä½¿ç”¨PWMäº§ç”Ÿæ–¹æ³¢ä¿¡å·ï¼Œåœ¨æˆ‘çš„Arduino UNO R3ä¸Šï¼Œæ”¯æŒPWMçš„è¾“å‡ºå£æ˜¯pin 3,5,6,9,10,11è¿™å‡ ä¸ªå¼•è„šï¼Œæ”¯æŒå¤§çº¦980Hzçš„PWMè¾“å‡ºã€‚è¿™æ–¹é¢ä¸å†èµ˜è¿°ã€‚ æœ¬æ–‡ä»‹ç»å¦ä¸€ç§äº§ç”Ÿæ–¹æ³¢çš„æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨ä»»ä½•å¼•è„šäº§ç”Ÿæ–¹æ³¢ä¿¡å·ã€‚åŠŸèƒ½ï¼š å›ºå®šé¢‘ç‡ï¼Œå ç©ºæ¯”ï¼Œåç§»é‡çš„æ–¹æ³¢","title":"Arduinoä»»ä½•å¼•è„šäº§ç”Ÿæ–¹æ³¢"},{"content":"å®‰è£…LCDåº“ ä½¿ç”¨AdaFruitåº“æ¥æ§åˆ¶lcdåº“ï¼Œè¿™ä¸ªåº“æ”¯æŒAdaFruitå±å¹•å’Œä½¿ç”¨HD44780çš„æ˜¾ç¤ºå±ã€‚\né€šè¿‡æºç å®‰è£…ï¼š\ngit clone https://github.com/adafruit/Adafruit_Python_CharLCD.git cd ./Adafruit_Python_CharLCD sudo python setup.py install å°†æ ‘è“æ´¾å’ŒLCD1602è¿æ¥ è¿æ¥çš„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š LCDç”µå­é’Ÿç¨‹åº #!/usr/bin/python3 # -*- coding: utf-8 -*- import RPi.GPIO as gpio #to add the LCD library import Adafruit_CharLCD as LCD import time gpio.setmode(gpio.BCM) #å£°æ˜ LCD pinsï¼ˆå¯¹åº”BCMå¼•è„šï¼‰ lcd_rs = 17 lcd_en = 18 lcd_d4 = 27 lcd_d5 = 22 lcd_d6 = 23 lcd_d7 = 10 lcd_backlight = 2 lcd_columns = 16 #Lcd column lcd_rows = 2 #number of LCD rows lcd = LCD.Adafruit_CharLCD(lcd_rs, lcd_en, \\ lcd_d4, lcd_d5, lcd_d6, lcd_d7, lcd_columns, lcd_rows,\\ lcd_backlight) lcd.set_cursor(0,0) lcd.message(\u0026#39; CLOCK\u0026#39;) while True: lcd.set_cursor(0,1) localtime = time.asctime( time.localtime(time.time()) )[4:-5] print(localtime) lcd.message(localtime) time.sleep(1) æ•ˆæœå›¾ æ˜¾ç¤ºçš„æ•ˆæœå›¾å¦‚ä¸‹ï¼Œå¯ä»¥æ˜¾ç¤ºæ—¥æœŸå’Œæ—¶é—´ï¼Œæ¯ç§’é’Ÿåˆ·æ–°å±å¹•ä¸€æ¬¡ï¼š ","permalink":"https://blog.niuhemoon.win/posts/tech/raspberrypi-lcd-clock/","summary":"å®‰è£…LCDåº“ ä½¿ç”¨AdaFruitåº“æ¥æ§åˆ¶lcdåº“ï¼Œè¿™ä¸ªåº“æ”¯æŒAdaFruitå±å¹•å’Œä½¿ç”¨HD44780çš„æ˜¾ç¤ºå±ã€‚ é€šè¿‡æºç å®‰è£…ï¼š git clone https://github.com/adafruit/Adafruit_Python_CharLCD.git cd ./Adafruit_Python_CharLCD sudo python setup.py install å°†æ ‘è“æ´¾å’ŒLCD1602è¿æ¥ è¿æ¥çš„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š LCDç”µå­é’Ÿç¨‹åº #!/usr/bin/python3 # -*- coding: utf-8 -*- import RPi.GPIO as gpio #to add the LCD library import Adafruit_CharLCD as LCD import time gpio.setmode(gpio.BCM) #å£°æ˜ LCD pinsï¼ˆå¯¹åº”BCMå¼•è„š","title":"æ ‘è“æ´¾è¿æ¥LCD1602åšä¸€ä¸ªç”µå­é’Ÿ"},{"content":" åœ¨æ ‘è“æ´¾3B+é‡Œå¯ç”¨ä¸²å£ï¼Œå¹¶é€šè¿‡UARTè¯»å–GPSæ¨¡å—çš„æ•°æ®å¸§ã€‚\næ ‘è“æ´¾3å¯ç”¨UART #####å…ˆæ›´æ–°ç³»ç»Ÿ\nsudo apt-get update sudo apt-get upgrade sudo raspi-config åœ¨raspi-configä¸­è®¾ç½®ï¼š\ndisable login shell over serial enable serial hardware port #####ç„¶åé‡å¯\nsudo reboot #####ç¼–è¾‘é…ç½®æ–‡ä»¶\nsudo nano /boot/config.txt åœ¨æœ€åä¸€æ®µåŠ ä¸Šï¼š\ndtparam=spi=on dtoverlay=pi3-disable-bt core_freq=250 enable_uart=1 force_turbo=1 ç„¶åç¼–è¾‘cmdline.txt\nsudo cp boot/cmdline.txt boot/cmdline_backup.txt sudo nano /boot.cmdline.txt å°†cmdline.txtçš„å†…å®¹æ›¿æ¢ä¸ºï¼š dwc_otg.lpm_enable=0 console=tty1 root=/dev/mmcblk0p2 rootfstype=ext4 elevator=deadline fsck.repair=yes rootwait quiet splash plymouth.ignore-serial-consoles\n#####ç¦ç”¨æ ‘è“æ´¾Serial GettyæœåŠ¡\nsudo systemctl stop serial-getty@ttyS0.service sudo systemctl disable serial-getty@ttyS0.service é‡å¯ç³»ç»Ÿ\nsudo reboot #####æ¿€æ´»ttyAMAO ä¸Šä¸€æ­¥æˆ‘ä»¬ç¦ç”¨äº†ttyS0,ç°åœ¨æˆ‘ä»¬å¯ç”¨ttyAMA0.\nsudo systemctl enable serial-getty@ttyAMA0.service å¥½äº†åˆ°äº†ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»å¯ç”¨äº†æ ‘è“æ´¾çš„ä¸²å£ï¼Œå¹¶å¯ä»¥é€šè¿‡/dev/ttyAMA0æ¥è®¿é—®ä¸²å£è®¾å¤‡ã€‚\næ ‘è“æ´¾çš„ä¸²å£å¼•è„š æ ‘è“æ´¾çš„å¼•è„šå®šä¹‰å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š UARTçš„æ”¶å‘å¼•è„šåˆ†åˆ«ä¸ºï¼š\nTx â€”â€”GPIO14ï¼ˆpin8) Rx â€”â€”GPIO15ï¼ˆpin10) è¿æ¥ä¸²å£è®¾å¤‡å¹¶æµ‹è¯• æˆ‘ä»¬ä½¿ç”¨GPSä¸²å£è®¾å¤‡è¿›è¡Œæµ‹è¯•ï¼ŒGPSæ¨¡å—æœ‰å¦‚ä¸‹5ä¸ªå¼•è„šï¼š\nVCC GND TX RX PPS GPSæ¨¡å—å’Œæ ‘è“æ´¾è¿æ¥æ–¹å¼å¦‚ä¸‹ï¼š\nVCC â€”â€”pin01 GNDâ€”â€”pin06 TXâ€”â€”pin10 å…¶ä»–å¼•è„šå¯ä»¥ä¸è¿æ¥ã€‚\nä½¿ç”¨catæˆ–è€…minicomè°ƒè¯•GPSä¸²å£ï¼š\ncat /dev/ttyAMA0 #æˆ–è€… minicom -D /dev/ttyAMA0 -b 9600 èƒ½å¤Ÿè¯»å–åˆ°ç±»ä¼¼ä¸‹è¾¹çš„ä¸²å£è¾“å‡ºï¼š\n$GPTXT,01,01,01,ANTENNA OK*35 $GNGGA,115810.475,,,,,0,00,25.5,,,,,,*70 $GNGLL,,,,,115810.475,V,M*6D $GPGSA,A,1,,,,,,,,,,,,,25.5,25.5,25.5*02 $BDGSA,A,1,,,,,,,,,,,,,25.5,25.5,25.5*13 $GPGSV,3,1,09,05,05,121,,10,25,314,27,12,14,138,,13,13,058,16*73 $GPGSV,3,2,09,15,49,043,32,20,53,321,18,21,52,249,,24,77,090,*77 $GPGSV,3,3,09,32,11,265,*40 å‚è€ƒ æ ‘è“æ´¾UARTæ–‡æ¡£ Raspberry Pi GPS Module Interfacing Tutorial ","permalink":"https://blog.niuhemoon.win/posts/tech/activate-serial-uart/","summary":"åœ¨æ ‘è“æ´¾3B+é‡Œå¯ç”¨ä¸²å£ï¼Œå¹¶é€šè¿‡UARTè¯»å–GPSæ¨¡å—çš„æ•°æ®å¸§ã€‚ æ ‘è“æ´¾3å¯ç”¨UART #####å…ˆæ›´æ–°ç³»ç»Ÿ sudo apt-get update sudo apt-get upgrade sudo raspi-config åœ¨raspi-configä¸­è®¾ç½®ï¼š disable login shell over serial enable serial hardware port #####ç„¶åé‡å¯ sudo reboot #####ç¼–è¾‘é…ç½®æ–‡ä»¶ sudo nano /boot/config.txt åœ¨æœ€åä¸€æ®µåŠ ä¸Šï¼š dtparam=spi=on dtoverlay=pi3-disable-bt core_freq=250 enable_uart=1 force_turbo=1 ç„¶åç¼–è¾‘cmdline.txt sudo","title":"æ ‘è“æ´¾3å¯ç”¨UARTå¹¶è¿æ¥GPSä¼ æ„Ÿå™¨"},{"content":"æœ¬æ–‡ä»‹ç»æ ‘è“æ´¾ä¸ŠGPIOå¼•è„šçš„ä¸‰ç§ç¼–å·æ–¹å¼ï¼ŒåŒæ—¶ä»‹ç»æ§åˆ¶å¼•è„šçš„æ–¹å¼ã€‚å¹¶ä»¥BCM-17å¼•è„šä¸ºä¾‹ï¼ŒåŠ¨æ‰‹ç‚¹äº®ledç¯å¹¶ä½¿å…¶é—ªçƒã€‚\nGPIOæ˜¯é€šç”¨è¾“å…¥è¾“å‡ºæ¥å£ã€‚æ ‘è“æ´¾ä¸Šæœ‰40ä¸ªå¼•è„šï¼Œå¯¹è¿™40ä¸ªå¼•è„šä¸»è¦æœ‰ä¸¤ç§ç¼–å·æ–¹å¼ã€‚\nBOARD å’Œå¼•è„šç‰©ç†é¡ºåºä¸€è‡´ BCM wiringpiç¼–å· wiringPiæ˜¯ä¸€ä¸ªç”¨æ¥æ§åˆ¶GPIOçš„åº“ï¼Œå®ƒå¯¹40ä¸ªå¼•è„šçš„ç¼–å·æ–¹å¼å¦‚ä¸‹ï¼š\nè¯¦ç»†ä¿¡æ¯å‚è€ƒæ­¤ç½‘å€\nwiringPi å®‰è£…æ–¹å¼ åº”ç”¨äºCè¯­è¨€å’Œshell git clone git://git.drogon.net/wiringPi cd wiringPi git pull origin ./build # æµ‹è¯•å®‰è£…æˆåŠŸ gpio -vmake gpio readall åº”ç”¨äºPython sudo pip install wiringpi2 æµ‹è¯•exampleç¨‹åº å°†å‘å…‰äºŒæç®¡çš„é˜³æè¿æ¥BOARDçš„pin11,ä¹Ÿå°±æ˜¯BCM17ï¼ŒwiringPi 0ï¼Œä¸­é—´éœ€è¦ä¸²ä¸€ä¸ª100-500æ¬§å§†çš„é™æµç”µé˜»ã€‚é˜´æè¿æ¥åˆ°GNDå¼•è„šï¼ˆBOARD 9ï¼‰ã€‚ å‘½ä»¤è¡Œè¾“å…¥ï¼š\ngpio write 0 1\nå¯è§‚å¯Ÿåˆ°å‘å…‰äºŒæç®¡è¢«ç‚¹äº®\ngpioå‡½æ•°å…¶ä»–ç”¨æ³•å‚è§æ–‡æ¡£\nç¼–è¯‘ç¤ºä¾‹Cè¯­è¨€ç¨‹åºç¨‹åºï¼Œä½¿ledé—ªçƒ\ncd wiringPi/examples/ ./blink.sh # æˆ–è€… make blink ./blink ä½¿ç”¨Pythonæ§åˆ¶GPIO æ ‘è“æ´¾åŸç”Ÿç³»ç»Ÿå†…ç½®çš„pythonå·²ç»å®‰è£…äº†RPi.GPIOåº“ï¼Œé€šè¿‡å®ƒå¯ä»¥æ–¹ä¾¿çš„æ§åˆ¶GPIO\nå¯ä»¥å‚è€ƒä»¥ä¸‹ä¸¤ä»½æ–‡æ¡£ï¼š\nGeneral-RPIO\nPython-RPIO\nPythonå®ç°LEDé—ªçƒï¼Œå¼•è„šä¾ç„¶æ˜¯BCM-17\n#!/usr/bin/python3 # -*- coding: utf-8 -*- import RPi.GPIO as GPIO from time import sleep GPIO.setmode(GPIO.BCM) GPIO.setwarnings(False) GPIO.setup(17,GPIO.OUT) print(\u0026#34;All set in Python! Let\u0026#39;s blink the LCD on BCM-17\u0026#34;) for i in range(1,10): GPIO.output(17,GPIO.HIGH) sleep(1) GPIO.output(17,GPIO.LOW) sleep(1) GPIO.cleanup() ä½¿ç”¨wiringpiåº“æ¥æ§åˆ¶è¿æ¥BCM-17çš„ledç¯é—ªçƒï¼Œå…·ä½“ä½¿ç”¨è¯´æ˜å‚çœ‹ï¼š python-wiringpiä½¿ç”¨æ•™ç¨‹\n#!/usr/bin/python3 # -*- coding: utf-8 -*- import wiringpi from time import sleep # è®¾ç½®wiringpiç¼–å·0å¼•è„šä¸ºè¾“å‡ºæ¨¡å¼ wiringpi.wiringPiSetup() wiringpi.pinMode(0,1) while True: wiringpi.digitalWrite(0,True) sleep(1) wiringpi.digitalWrite(0,False) sleep(1) ä»¥ä¸‹ä¸ºwiringpiçš„ä¸‰ç§å¼•è„šç¼–å·ï¼š\nBCM BOARD wiringpi ä¸‰ç§æ§åˆ¶æ¨¡å¼ï¼š\ninput output pwm è®¾ç½®ç¤ºèŒƒå¦‚ä¸‹ï¼š\n# GPIO å¼•è„šå·å°±æ˜¯BCMç¼–å· import wiringpi wiringpi.wiringPiSetupGpio() wiringpi.pinMode(25, 0) # sets GPIO 25 to input wiringpi.pinMode(24, 1) # sets GPIO 24 to output wiringpi.pinMode(18, 2) # sets GPIO 18 to PWM mode # wiringpi ç¼–å· import wiringpi wiringpi.wiringPiSetup() wiringpi.pinMode(6, 0) # sets WP pin 6 to input wiringpi.pinMode(5, 1) # sets WP pin 5 to output wiringpi.pinMode(1, 2) # sets WP pin 1 to PWM mode # ç‰©ç†ç¼–å· BOARDç¼–å· import wiringpi wiringPiSetupPhys() wiringpi.pinMode(22, 0) # sets P1 pin 22 to input wiringpi.pinMode(18, 1) # sets P1 pin 18 to output wiringpi.pinMode(12, 2) # sets P1 pin 12 to PWM mode ","permalink":"https://blog.niuhemoon.win/posts/tech/wiringpi-gpio/","summary":"æœ¬æ–‡ä»‹ç»æ ‘è“æ´¾ä¸ŠGPIOå¼•è„šçš„ä¸‰ç§ç¼–å·æ–¹å¼ï¼ŒåŒæ—¶ä»‹ç»æ§åˆ¶å¼•è„šçš„æ–¹å¼ã€‚å¹¶ä»¥BCM-17å¼•è„šä¸ºä¾‹ï¼ŒåŠ¨æ‰‹ç‚¹äº®ledç¯å¹¶ä½¿å…¶é—ªçƒã€‚ GPIOæ˜¯é€šç”¨è¾“å…¥è¾“å‡ºæ¥å£ã€‚æ ‘è“æ´¾ä¸Šæœ‰40ä¸ªå¼•è„šï¼Œå¯¹è¿™40ä¸ªå¼•è„šä¸»è¦æœ‰ä¸¤ç§ç¼–å·æ–¹å¼ã€‚ BOARD å’Œå¼•è„šç‰©ç†é¡ºåºä¸€è‡´ BCM wiringpiç¼–å· wiringPiæ˜¯ä¸€ä¸ªç”¨æ¥æ§åˆ¶G","title":"æ ‘è“æ´¾GPIOå…¥é—¨"},{"content":"Python3å®ç°AESå’ŒDESå¯¹ç§°åŠ å¯†ç®—æ³•çš„\nå¯¹ç§°ç®—æ³•ç¼–å†™ æœ¬å®éªŒæ˜¯ä½¿ç”¨pythonæ¥å®ç°AESå’ŒDESåŠ å¯†å’Œè§£å¯†è¿‡ç¨‹ï¼Œå¹¶å¯¹åŠ å¯†è§£å¯†è¿‡ç¨‹çš„æ­£ç¡®æ€§è¿›è¡ŒéªŒè¯ã€‚\n1.å®éªŒç›®çš„ æŒæ¡åˆ†ç»„åŠ å¯†çš„åŸç† æŒæ¡æ•°æ®åŠ å¯†æ ‡å‡†DESå’Œé«˜çº§æ•°æ®åŠ å¯†æ ‡å‡†AESçš„åŸç†åŠå…¶åº”ç”¨ 2.å®éªŒå·¥å…· Jupyter Notebook Python3.5 3.å®éªŒç¯å¢ƒ Ubuntu16.04LTSæ“ä½œç³»ç»Ÿ Python3æ ‡å‡†åº“ 4.å®éªŒæ­¥éª¤ 4.1 å›é¡¾è¯¾ç¨‹ï¼ŒæŸ¥é˜…èµ„æ–™ 4.2 ç†Ÿæ‚‰AESçš„åŸç† AES(Advanced Encryption Standard)é«˜çº§åŠ å¯†æ ‡å‡†ï¼Œåœ¨å¯†ç å­¦ä¸­åˆç§°RijndaelåŠ å¯†æ³•ï¼Œæ˜¯ç¾å›½è”é‚¦æ”¿åºœé‡‡ç”¨çš„ä¸€ç§åŒºå—åŠ å¯†æ ‡å‡†ã€‚è¿™ä¸ªæ ‡å‡†ç”¨æ¥æ›¿ä»£åŸå…ˆçš„DESï¼Œå·²ç»è¢«å¤šæ–¹åˆ†æä¸”å¹¿ä¸ºå…¨ä¸–ç•Œæ‰€ä½¿ç”¨ã€‚\nAESåŠ å¯†è¿‡ç¨‹æ˜¯åœ¨ä¸€ä¸ª4Ã—4çš„å­—èŠ‚çŸ©é˜µä¸Šè¿ä½œï¼Œè¿™ä¸ªçŸ©é˜µåˆç§°ä¸ºâ€œä½“ï¼ˆstateï¼‰â€ï¼Œå…¶åˆå€¼å°±æ˜¯ä¸€ä¸ªæ˜æ–‡åŒºå—ï¼ˆçŸ©é˜µä¸­ä¸€ä¸ªå…ƒç´ å¤§å°å°±æ˜¯æ˜æ–‡åŒºå—ä¸­çš„ä¸€ä¸ªByteï¼‰ã€‚ï¼ˆRijndaelåŠ å¯†æ³•å› æ”¯æŒæ›´å¤§çš„åŒºå—ï¼Œå…¶çŸ©é˜µè¡Œæ•°å¯è§†æƒ…å†µå¢åŠ ï¼‰åŠ å¯†æ—¶ï¼Œå„è½®AESåŠ å¯†å¾ªç¯ï¼ˆé™¤æœ€åä¸€è½®å¤–ï¼‰å‡åŒ…å«4ä¸ªæ­¥éª¤ï¼š\nAddRoundKeyâ€”çŸ©é˜µä¸­çš„æ¯ä¸€ä¸ªå­—èŠ‚éƒ½ä¸è¯¥æ¬¡å›åˆå¯†é’¥ï¼ˆround keyï¼‰åšXORè¿ç®—ï¼›æ¯ä¸ªå­å¯†é’¥ç”±å¯†é’¥ç”Ÿæˆæ–¹æ¡ˆäº§ç”Ÿã€‚ SubBytesâ€”é€šè¿‡ä¸€ä¸ªéçº¿æ€§çš„æ›¿æ¢å‡½æ•°ï¼Œç”¨æŸ¥æ‰¾è¡¨çš„æ–¹å¼æŠŠæ¯ä¸ªå­—èŠ‚æ›¿æ¢æˆå¯¹åº”çš„å­—èŠ‚ã€‚ ShiftRowsâ€”å°†çŸ©é˜µä¸­çš„æ¯ä¸ªæ¨ªåˆ—è¿›è¡Œå¾ªç¯å¼ç§»ä½ã€‚ MixColumnsâ€”ä¸ºäº†å……åˆ†æ··åˆçŸ©é˜µä¸­å„ä¸ªç›´è¡Œçš„æ“ä½œã€‚è¿™ä¸ªæ­¥éª¤ä½¿ç”¨çº¿æ€§è½¬æ¢æ¥æ··åˆæ¯å†…è”çš„å››ä¸ªå­—èŠ‚ã€‚æœ€åä¸€ä¸ªåŠ å¯†å¾ªç¯ä¸­çœç•¥MixColumnsæ­¥éª¤ï¼Œè€Œä»¥å¦ä¸€ä¸ªAddRoundKeyå–ä»£ã€‚ 4.3 ç¼–å†™AESåŠ å¯†è§£å¯†çš„æµ‹è¯•ç”¨ä¾‹ å…ˆä½¿ç”¨å…¶ä»–å·²æœ‰å·¥å…·è®¡ç®—å‡ºplaintextå¯¹åº”çš„\næµ‹è¯•ç¨‹åºå¦‚ä¸‹ï¼š\nimport unittest class AES: def __init__(self, master_key): self.change_key(master_key) def change_key(self, master_key): pass def encrypt(self, plaintext): pass def decrypt(self, ciphertext): pass class AES_TEST(unittest.TestCase): def setUp(self): master_key = 0x2b7e151628aed2a6abf7158809cf4f3c self.AES = AES(master_key) def test_encryption(self): plaintext = 0x3243f6a8885a308d313198a2e0370734 encrypted = self.AES.encrypt(plaintext) self.assertEqual(encrypted, 0x3925841d02dc09fbdc118597196a0b32) def test_decryption(self): ciphertext = 0x3925841d02dc09fbdc118597196a0b32 decrypted = self.AES.decrypt(ciphertext) self.assertEqual(decrypted, 0x3243f6a8885a308d313198a2e0370734) if __name__ == \u0026#39;__main__\u0026#39;: unittest.main() 4.4 ç¼–å†™DESç®—æ³•çš„æµ‹è¯•ä»£ç  4.5 ç¼–å†™AESå’ŒDESå¯¹ç§°åŠ å¯†çš„pythonå®ç°ï¼Œå¹¶è¿›è¡Œæµ‹è¯•éªŒè¯ ä»£ç å’Œæµ‹è¯•ç»“æœåœ¨æŠ¥å‘Šæœ€å\n4.6 æ€»ç»“å®éªŒï¼Œç¼–å†™å®éªŒæŠ¥å‘Š 5. å®éªŒæ€»ç»“ éœ€è¦å–„äºå€Ÿé‰´å‰äººç»éªŒï¼Œæœé›†èµ„æ–™ å®éªŒåªæ”¯æŒasciiç ï¼Œå¯¹å…¶ä»–å­—ç¬¦ç¼–ç æ²¡æœ‰è§£å†³ åˆ©ç”¨ä¼˜ç§€çš„å·¥å…·ï¼Œå¦‚Jupyterå¯ä»¥æé«˜å­¦ä¹ æ•ˆç‡ 6. å®éªŒå®Œæ•´ä»£ç  #!/usr/bin/env python #-*- coding:utf-8 -*- \u0026#34;\u0026#34;\u0026#34; ASEçš„pythonå®ç°ï¼š æ”¯æŒ128ä½ç§˜é’¥ æ”¯æŒç§˜é’¥å’ŒåŸæ–‡å‡ä¸ºæ•°å­—çš„AESåŠ å¯†è§£å¯† \u0026#34;\u0026#34;\u0026#34; Sbox = ( 0x63, 0x7C, 0x77, 0x7B, 0xF2, 0x6B, 0x6F, 0xC5, 0x30, 0x01, 0x67, 0x2B, 0xFE, 0xD7, 0xAB, 0x76, 0xCA, 0x82, 0xC9, 0x7D, 0xFA, 0x59, 0x47, 0xF0, 0xAD, 0xD4, 0xA2, 0xAF, 0x9C, 0xA4, 0x72, 0xC0, 0xB7, 0xFD, 0x93, 0x26, 0x36, 0x3F, 0xF7, 0xCC, 0x34, 0xA5, 0xE5, 0xF1, 0x71, 0xD8, 0x31, 0x15, 0x04, 0xC7, 0x23, 0xC3, 0x18, 0x96, 0x05, 0x9A, 0x07, 0x12, 0x80, 0xE2, 0xEB, 0x27, 0xB2, 0x75, 0x09, 0x83, 0x2C, 0x1A, 0x1B, 0x6E, 0x5A, 0xA0, 0x52, 0x3B, 0xD6, 0xB3, 0x29, 0xE3, 0x2F, 0x84, 0x53, 0xD1, 0x00, 0xED, 0x20, 0xFC, 0xB1, 0x5B, 0x6A, 0xCB, 0xBE, 0x39, 0x4A, 0x4C, 0x58, 0xCF, 0xD0, 0xEF, 0xAA, 0xFB, 0x43, 0x4D, 0x33, 0x85, 0x45, 0xF9, 0x02, 0x7F, 0x50, 0x3C, 0x9F, 0xA8, 0x51, 0xA3, 0x40, 0x8F, 0x92, 0x9D, 0x38, 0xF5, 0xBC, 0xB6, 0xDA, 0x21, 0x10, 0xFF, 0xF3, 0xD2, 0xCD, 0x0C, 0x13, 0xEC, 0x5F, 0x97, 0x44, 0x17, 0xC4, 0xA7, 0x7E, 0x3D, 0x64, 0x5D, 0x19, 0x73, 0x60, 0x81, 0x4F, 0xDC, 0x22, 0x2A, 0x90, 0x88, 0x46, 0xEE, 0xB8, 0x14, 0xDE, 0x5E, 0x0B, 0xDB, 0xE0, 0x32, 0x3A, 0x0A, 0x49, 0x06, 0x24, 0x5C, 0xC2, 0xD3, 0xAC, 0x62, 0x91, 0x95, 0xE4, 0x79, 0xE7, 0xC8, 0x37, 0x6D, 0x8D, 0xD5, 0x4E, 0xA9, 0x6C, 0x56, 0xF4, 0xEA, 0x65, 0x7A, 0xAE, 0x08, 0xBA, 0x78, 0x25, 0x2E, 0x1C, 0xA6, 0xB4, 0xC6, 0xE8, 0xDD, 0x74, 0x1F, 0x4B, 0xBD, 0x8B, 0x8A, 0x70, 0x3E, 0xB5, 0x66, 0x48, 0x03, 0xF6, 0x0E, 0x61, 0x35, 0x57, 0xB9, 0x86, 0xC1, 0x1D, 0x9E, 0xE1, 0xF8, 0x98, 0x11, 0x69, 0xD9, 0x8E, 0x94, 0x9B, 0x1E, 0x87, 0xE9, 0xCE, 0x55, 0x28, 0xDF, 0x8C, 0xA1, 0x89, 0x0D, 0xBF, 0xE6, 0x42, 0x68, 0x41, 0x99, 0x2D, 0x0F, 0xB0, 0x54, 0xBB, 0x16, ) InvSbox = ( 0x52, 0x09, 0x6A, 0xD5, 0x30, 0x36, 0xA5, 0x38, 0xBF, 0x40, 0xA3, 0x9E, 0x81, 0xF3, 0xD7, 0xFB, 0x7C, 0xE3, 0x39, 0x82, 0x9B, 0x2F, 0xFF, 0x87, 0x34, 0x8E, 0x43, 0x44, 0xC4, 0xDE, 0xE9, 0xCB, 0x54, 0x7B, 0x94, 0x32, 0xA6, 0xC2, 0x23, 0x3D, 0xEE, 0x4C, 0x95, 0x0B, 0x42, 0xFA, 0xC3, 0x4E, 0x08, 0x2E, 0xA1, 0x66, 0x28, 0xD9, 0x24, 0xB2, 0x76, 0x5B, 0xA2, 0x49, 0x6D, 0x8B, 0xD1, 0x25, 0x72, 0xF8, 0xF6, 0x64, 0x86, 0x68, 0x98, 0x16, 0xD4, 0xA4, 0x5C, 0xCC, 0x5D, 0x65, 0xB6, 0x92, 0x6C, 0x70, 0x48, 0x50, 0xFD, 0xED, 0xB9, 0xDA, 0x5E, 0x15, 0x46, 0x57, 0xA7, 0x8D, 0x9D, 0x84, 0x90, 0xD8, 0xAB, 0x00, 0x8C, 0xBC, 0xD3, 0x0A, 0xF7, 0xE4, 0x58, 0x05, 0xB8, 0xB3, 0x45, 0x06, 0xD0, 0x2C, 0x1E, 0x8F, 0xCA, 0x3F, 0x0F, 0x02, 0xC1, 0xAF, 0xBD, 0x03, 0x01, 0x13, 0x8A, 0x6B, 0x3A, 0x91, 0x11, 0x41, 0x4F, 0x67, 0xDC, 0xEA, 0x97, 0xF2, 0xCF, 0xCE, 0xF0, 0xB4, 0xE6, 0x73, 0x96, 0xAC, 0x74, 0x22, 0xE7, 0xAD, 0x35, 0x85, 0xE2, 0xF9, 0x37, 0xE8, 0x1C, 0x75, 0xDF, 0x6E, 0x47, 0xF1, 0x1A, 0x71, 0x1D, 0x29, 0xC5, 0x89, 0x6F, 0xB7, 0x62, 0x0E, 0xAA, 0x18, 0xBE, 0x1B, 0xFC, 0x56, 0x3E, 0x4B, 0xC6, 0xD2, 0x79, 0x20, 0x9A, 0xDB, 0xC0, 0xFE, 0x78, 0xCD, 0x5A, 0xF4, 0x1F, 0xDD, 0xA8, 0x33, 0x88, 0x07, 0xC7, 0x31, 0xB1, 0x12, 0x10, 0x59, 0x27, 0x80, 0xEC, 0x5F, 0x60, 0x51, 0x7F, 0xA9, 0x19, 0xB5, 0x4A, 0x0D, 0x2D, 0xE5, 0x7A, 0x9F, 0x93, 0xC9, 0x9C, 0xEF, 0xA0, 0xE0, 0x3B, 0x4D, 0xAE, 0x2A, 0xF5, 0xB0, 0xC8, 0xEB, 0xBB, 0x3C, 0x83, 0x53, 0x99, 0x61, 0x17, 0x2B, 0x04, 0x7E, 0xBA, 0x77, 0xD6, 0x26, 0xE1, 0x69, 0x14, 0x63, 0x55, 0x21, 0x0C, 0x7D, ) # å‚è€ƒäº†Cè¯­è¨€å®ç° http://cs.ucsb.edu/~koc/cs178/projects/JT/aes.c xtime = lambda a: (((a \u0026lt;\u0026lt; 1) ^ 0x1B) \u0026amp; 0xFF) if (a \u0026amp; 0x80) else (a \u0026lt;\u0026lt; 1) Rcon = ( 0x00, 0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80, 0x1B, 0x36, 0x6C, 0xD8, 0xAB, 0x4D, 0x9A, 0x2F, 0x5E, 0xBC, 0x63, 0xC6, 0x97, 0x35, 0x6A, 0xD4, 0xB3, 0x7D, 0xFA, 0xEF, 0xC5, 0x91, 0x39, ) def text2matrix(text): matrix = [] for i in range(16): byte = (text \u0026gt;\u0026gt; (8 * (15 - i))) \u0026amp; 0xFF if i % 4 == 0: matrix.append([byte]) else: matrix[int(i / 4)].append(byte) return matrix def matrix2text(matrix): text = 0 for i in range(4): for j in range(4): text |= (matrix[i][j] \u0026lt;\u0026lt; (120 - 8 * (4 * i + j))) return text class AES: def __init__(self, master_key): self.change_key(master_key) def change_key(self, master_key): self.round_keys = text2matrix(master_key) # print self.round_keys for i in range(4, 4 * 11): self.round_keys.append([]) if i % 4 == 0: byte = self.round_keys[i - 4][0] \\ ^ Sbox[self.round_keys[i - 1][1]] \\ ^ Rcon[int(i / 4)] self.round_keys[i].append(byte) for j in range(1, 4): byte = self.round_keys[i - 4][j] \\ ^ Sbox[self.round_keys[i - 1][(j + 1) % 4]] self.round_keys[i].append(byte) else: for j in range(4): byte = self.round_keys[i - 4][j] \\ ^ self.round_keys[i - 1][j] self.round_keys[i].append(byte) # print self.round_keys def encrypt(self, plaintext): self.plain_state = text2matrix(plaintext) self.__add_round_key(self.plain_state, self.round_keys[:4]) for i in range(1, 10): self.__round_encrypt(self.plain_state, self.round_keys[4 * i : 4 * (i + 1)]) self.__sub_bytes(self.plain_state) self.__shift_rows(self.plain_state) self.__add_round_key(self.plain_state, self.round_keys[40:]) return matrix2text(self.plain_state) def decrypt(self, ciphertext): self.cipher_state = text2matrix(ciphertext) self.__add_round_key(self.cipher_state, self.round_keys[40:]) self.__inv_shift_rows(self.cipher_state) self.__inv_sub_bytes(self.cipher_state) for i in range(9, 0, -1): self.__round_decrypt(self.cipher_state, self.round_keys[4 * i : 4 * (i + 1)]) self.__add_round_key(self.cipher_state, self.round_keys[:4]) return matrix2text(self.cipher_state) def __add_round_key(self, s, k): for i in range(4): for j in range(4): s[i][j] ^= k[i][j] def __round_encrypt(self, state_matrix, key_matrix): self.__sub_bytes(state_matrix) self.__shift_rows(state_matrix) self.__mix_columns(state_matrix) self.__add_round_key(state_matrix, key_matrix) def __round_decrypt(self, state_matrix, key_matrix): self.__add_round_key(state_matrix, key_matrix) self.__inv_mix_columns(state_matrix) self.__inv_shift_rows(state_matrix) self.__inv_sub_bytes(state_matrix) def __sub_bytes(self, s): for i in range(4): for j in range(4): s[i][j] = Sbox[s[i][j]] def __inv_sub_bytes(self, s): for i in range(4): for j in range(4): s[i][j] = InvSbox[s[i][j]] def __shift_rows(self, s): s[0][1], s[1][1], s[2][1], s[3][1] = s[1][1], s[2][1], s[3][1], s[0][1] s[0][2], s[1][2], s[2][2], s[3][2] = s[2][2], s[3][2], s[0][2], s[1][2] s[0][3], s[1][3], s[2][3], s[3][3] = s[3][3], s[0][3], s[1][3], s[2][3] def __inv_shift_rows(self, s): s[0][1], s[1][1], s[2][1], s[3][1] = s[3][1], s[0][1], s[1][1], s[2][1] s[0][2], s[1][2], s[2][2], s[3][2] = s[2][2], s[3][2], s[0][2], s[1][2] s[0][3], s[1][3], s[2][3], s[3][3] = s[1][3], s[2][3], s[3][3], s[0][3] def __mix_single_column(self, a): # please see Sec 4.1.2 in The Design of Rijndael t = a[0] ^ a[1] ^ a[2] ^ a[3] u = a[0] a[0] ^= t ^ xtime(a[0] ^ a[1]) a[1] ^= t ^ xtime(a[1] ^ a[2]) a[2] ^= t ^ xtime(a[2] ^ a[3]) a[3] ^= t ^ xtime(a[3] ^ u) def __mix_columns(self, s): for i in range(4): self.__mix_single_column(s[i]) def __inv_mix_columns(self, s): # see Sec 4.1.3 in The Design of Rijndael for i in range(4): u = xtime(xtime(s[i][0] ^ s[i][2])) v = xtime(xtime(s[i][1] ^ s[i][3])) s[i][0] ^= u s[i][1] ^= v s[i][2] ^= u s[i][3] ^= v self.__mix_columns(s) master_key = 0x2b7e151628aed2a6abf7158809cf4f3c AESbar = AES(master_key) def test_encryption(): plaintext = 0x3243f6a8885a308d313198a2e0370734 encrypted = AESbar.encrypt(plaintext) print(\u0026#39;åŠ å¯†å¾—å¯†æ–‡ï¼š 0x%x\u0026#39; % encrypted) assert encrypted == 0x3925841d02dc09fbdc118597196a0b32 print(\u0026#39;åŠ å¯†ç»“æœæ­£ç¡®\u0026#39;) def test_decryption(): ciphertext = 0x3925841d02dc09fbdc118597196a0b32 decrypted = AESbar.decrypt(ciphertext) print(\u0026#39;è§£å¯†å¾—åŸæ–‡: 0x%x\u0026#39; % decrypted) assert decrypted == 0x3243f6a8885a308d313198a2e0370734 print(\u0026#39;è§£å¯†æˆåŠŸ\u0026#39;) if __name__ == \u0026#39;__main__\u0026#39;: print(\u0026#39;å¼€å§‹å•å…ƒæµ‹è¯•ï¼š\u0026#39;) test_encryption() test_decryption() print(\u0026#39;å•å…ƒæµ‹è¯•æˆåŠŸ\u0026#39;) å¼€å§‹å•å…ƒæµ‹è¯•ï¼š åŠ å¯†å¾—å¯†æ–‡ï¼š 0x3925841d02dc09fbdc118597196a0b32 åŠ å¯†ç»“æœæ­£ç¡® è§£å¯†å¾—åŸæ–‡: 0x3243f6a8885a308d313198a2e0370734 è§£å¯†æˆåŠŸ å•å…ƒæµ‹è¯•æˆåŠŸ #!/usr/bin/env python #-*- coding:utf-8 -*- \u0026#39;\u0026#39;\u0026#39; DESåŠ å¯†è§£å¯†çš„Python3å®ç° \u0026#39;\u0026#39;\u0026#39; #Initial permut matrix for the datas PI = [58, 50, 42, 34, 26, 18, 10, 2, 60, 52, 44, 36, 28, 20, 12, 4, 62, 54, 46, 38, 30, 22, 14, 6, 64, 56, 48, 40, 32, 24, 16, 8, 57, 49, 41, 33, 25, 17, 9, 1, 59, 51, 43, 35, 27, 19, 11, 3, 61, 53, 45, 37, 29, 21, 13, 5, 63, 55, 47, 39, 31, 23, 15, 7] #Initial permut made on the key CP_1 = [57, 49, 41, 33, 25, 17, 9, 1, 58, 50, 42, 34, 26, 18, 10, 2, 59, 51, 43, 35, 27, 19, 11, 3, 60, 52, 44, 36, 63, 55, 47, 39, 31, 23, 15, 7, 62, 54, 46, 38, 30, 22, 14, 6, 61, 53, 45, 37, 29, 21, 13, 5, 28, 20, 12, 4] #Permut applied on shifted key to get Ki+1 CP_2 = [14, 17, 11, 24, 1, 5, 3, 28, 15, 6, 21, 10, 23, 19, 12, 4, 26, 8, 16, 7, 27, 20, 13, 2, 41, 52, 31, 37, 47, 55, 30, 40, 51, 45, 33, 48, 44, 49, 39, 56, 34, 53, 46, 42, 50, 36, 29, 32] #Expand matrix to get a 48bits matrix of datas to apply the xor with Ki E = [32, 1, 2, 3, 4, 5, 4, 5, 6, 7, 8, 9, 8, 9, 10, 11, 12, 13, 12, 13, 14, 15, 16, 17, 16, 17, 18, 19, 20, 21, 20, 21, 22, 23, 24, 25, 24, 25, 26, 27, 28, 29, 28, 29, 30, 31, 32, 1] #SBOX S_BOX = [ [[14, 4, 13, 1, 2, 15, 11, 8, 3, 10, 6, 12, 5, 9, 0, 7], [0, 15, 7, 4, 14, 2, 13, 1, 10, 6, 12, 11, 9, 5, 3, 8], [4, 1, 14, 8, 13, 6, 2, 11, 15, 12, 9, 7, 3, 10, 5, 0], [15, 12, 8, 2, 4, 9, 1, 7, 5, 11, 3, 14, 10, 0, 6, 13], ], [[15, 1, 8, 14, 6, 11, 3, 4, 9, 7, 2, 13, 12, 0, 5, 10], [3, 13, 4, 7, 15, 2, 8, 14, 12, 0, 1, 10, 6, 9, 11, 5], [0, 14, 7, 11, 10, 4, 13, 1, 5, 8, 12, 6, 9, 3, 2, 15], [13, 8, 10, 1, 3, 15, 4, 2, 11, 6, 7, 12, 0, 5, 14, 9], ], [[10, 0, 9, 14, 6, 3, 15, 5, 1, 13, 12, 7, 11, 4, 2, 8], [13, 7, 0, 9, 3, 4, 6, 10, 2, 8, 5, 14, 12, 11, 15, 1], [13, 6, 4, 9, 8, 15, 3, 0, 11, 1, 2, 12, 5, 10, 14, 7], [1, 10, 13, 0, 6, 9, 8, 7, 4, 15, 14, 3, 11, 5, 2, 12], ], [[7, 13, 14, 3, 0, 6, 9, 10, 1, 2, 8, 5, 11, 12, 4, 15], [13, 8, 11, 5, 6, 15, 0, 3, 4, 7, 2, 12, 1, 10, 14, 9], [10, 6, 9, 0, 12, 11, 7, 13, 15, 1, 3, 14, 5, 2, 8, 4], [3, 15, 0, 6, 10, 1, 13, 8, 9, 4, 5, 11, 12, 7, 2, 14], ], [[2, 12, 4, 1, 7, 10, 11, 6, 8, 5, 3, 15, 13, 0, 14, 9], [14, 11, 2, 12, 4, 7, 13, 1, 5, 0, 15, 10, 3, 9, 8, 6], [4, 2, 1, 11, 10, 13, 7, 8, 15, 9, 12, 5, 6, 3, 0, 14], [11, 8, 12, 7, 1, 14, 2, 13, 6, 15, 0, 9, 10, 4, 5, 3], ], [[12, 1, 10, 15, 9, 2, 6, 8, 0, 13, 3, 4, 14, 7, 5, 11], [10, 15, 4, 2, 7, 12, 9, 5, 6, 1, 13, 14, 0, 11, 3, 8], [9, 14, 15, 5, 2, 8, 12, 3, 7, 0, 4, 10, 1, 13, 11, 6], [4, 3, 2, 12, 9, 5, 15, 10, 11, 14, 1, 7, 6, 0, 8, 13], ], [[4, 11, 2, 14, 15, 0, 8, 13, 3, 12, 9, 7, 5, 10, 6, 1], [13, 0, 11, 7, 4, 9, 1, 10, 14, 3, 5, 12, 2, 15, 8, 6], [1, 4, 11, 13, 12, 3, 7, 14, 10, 15, 6, 8, 0, 5, 9, 2], [6, 11, 13, 8, 1, 4, 10, 7, 9, 5, 0, 15, 14, 2, 3, 12], ], [[13, 2, 8, 4, 6, 15, 11, 1, 10, 9, 3, 14, 5, 0, 12, 7], [1, 15, 13, 8, 10, 3, 7, 4, 12, 5, 6, 11, 0, 14, 9, 2], [7, 11, 4, 1, 9, 12, 14, 2, 0, 6, 10, 13, 15, 3, 5, 8], [2, 1, 14, 7, 4, 10, 8, 13, 15, 12, 9, 0, 3, 5, 6, 11], ] ] #Permut made after each SBox substitution for each round P = [16, 7, 20, 21, 29, 12, 28, 17, 1, 15, 23, 26, 5, 18, 31, 10, 2, 8, 24, 14, 32, 27, 3, 9, 19, 13, 30, 6, 22, 11, 4, 25] #Final permut for datas after the 16 rounds PI_1 = [40, 8, 48, 16, 56, 24, 64, 32, 39, 7, 47, 15, 55, 23, 63, 31, 38, 6, 46, 14, 54, 22, 62, 30, 37, 5, 45, 13, 53, 21, 61, 29, 36, 4, 44, 12, 52, 20, 60, 28, 35, 3, 43, 11, 51, 19, 59, 27, 34, 2, 42, 10, 50, 18, 58, 26, 33, 1, 41, 9, 49, 17, 57, 25] #Matrix that determine the shift for each round of keys SHIFT = [1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1] def string_to_bit_array(text):#Convert a string into a list of bits array = list() for char in text: binval = binvalue(char, 8)#Get the char value on one byte array.extend([int(x) for x in list(binval)]) #Add the bits to the final list return array def bit_array_to_string(array): #Recreate the string from the bit array res = \u0026#39;\u0026#39;.join([chr(int(y,2)) for y in [\u0026#39;\u0026#39;.join([str(x) for x in bytes]) for bytes in nsplit(array,8)]]) return res def binvalue(val, bitsize): #Return the binary value as a string of the given size binval = bin(val)[2:] if isinstance(val, int) else bin(ord(val))[2:] if len(binval) \u0026gt; bitsize: raise \u0026#34;binary value larger than the expected size\u0026#34; while len(binval) \u0026lt; bitsize: binval = \u0026#34;0\u0026#34;+binval #Add as many 0 as needed to get the wanted size return binval def nsplit(s, n):#Split a list into sublists of size \u0026#34;n\u0026#34; return [s[k:k+n] for k in range(0, len(s), n)] ENCRYPT=1 DECRYPT=0 class des(): def __init__(self): self.password = None self.text = None self.keys = list() def run(self, key, text, action=ENCRYPT, padding=False): if len(key) \u0026lt; 8: raise \u0026#34;Key Should be 8 bytes long\u0026#34; elif len(key) \u0026gt; 8: key = key[:8] #If key size is above 8bytes, cut to be 8bytes long self.password = key self.text = text if padding and action==ENCRYPT: self.addPadding() elif len(self.text) % 8 != 0:#If not padding specified data size must be multiple of 8 bytes raise \u0026#34;Data size should be multiple of 8\u0026#34; self.generatekeys() #Generate all the keys text_blocks = nsplit(self.text, 8) #Split the text in blocks of 8 bytes so 64 bits result = list() for block in text_blocks:#Loop over all the blocks of data block = string_to_bit_array(block)#Convert the block in bit array block = self.permut(block,PI)#Apply the initial permutation g, d = nsplit(block, 32) #g(LEFT), d(RIGHT) tmp = None for i in range(16): #Do the 16 rounds d_e = self.expand(d, E) #Expand d to match Ki size (48bits) if action == ENCRYPT: tmp = self.xor(self.keys[i], d_e)#If encrypt use Ki else: tmp = self.xor(self.keys[15-i], d_e)#If decrypt start by the last key tmp = self.substitute(tmp) #Method that will apply the SBOXes tmp = self.permut(tmp, P) tmp = self.xor(g, tmp) g = d d = tmp result += self.permut(d+g, PI_1) #Do the last permut and append the result to result final_res = bit_array_to_string(result) if padding and action==DECRYPT: return self.removePadding(final_res) #Remove the padding if decrypt and padding is true else: return final_res #Return the final string of data ciphered/deciphered def substitute(self, d_e):#Substitute bytes using SBOX subblocks = nsplit(d_e, 6)#Split bit array into sublist of 6 bits result = list() for i in range(len(subblocks)): #For all the sublists block = subblocks[i] row = int(str(block[0])+str(block[5]),2)#Get the row with the first and last bit column = int(\u0026#39;\u0026#39;.join([str(x) for x in block[1:][:-1]]),2) #Column is the 2,3,4,5th bits val = S_BOX[i][row][column] #Take the value in the SBOX appropriated for the round (i) bin = binvalue(val, 4)#Convert the value to binary result += [int(x) for x in bin]#And append it to the resulting list return result def permut(self, block, table):#Permut the given block using the given table (so generic method) return [block[x-1] for x in table] def expand(self, block, table):#Do the exact same thing than permut but for more clarity has been renamed return [block[x-1] for x in table] def xor(self, t1, t2):#Apply a xor and return the resulting list return [x^y for x,y in zip(t1,t2)] def generatekeys(self):#Algorithm that generates all the keys self.keys = [] key = string_to_bit_array(self.password) key = self.permut(key, CP_1) #Apply the initial permut on the key g, d = nsplit(key, 28) #Split it in to (g-\u0026gt;LEFT),(d-\u0026gt;RIGHT) for i in range(16):#Apply the 16 rounds g, d = self.shift(g, d, SHIFT[i]) #Apply the shift associated with the round (not always 1) tmp = g + d #Merge them self.keys.append(self.permut(tmp, CP_2)) #Apply the permut to get the Ki def shift(self, g, d, n): #Shift a list of the given value return g[n:] + g[:n], d[n:] + d[:n] def addPadding(self):#Add padding to the datas using PKCS5 spec. pad_len = 8 - (len(self.text) % 8) self.text += pad_len * chr(pad_len) def removePadding(self, data):#Remove the padding of the plain text (it assume there is padding) pad_len = ord(data[-1]) return data[:-pad_len] def encrypt(self, key, text, padding=False): return self.run(key, text, ENCRYPT, padding) def decrypt(self, key, text, padding=False): return self.run(key, text, DECRYPT, padding) if __name__ == \u0026#39;__main__\u0026#39;: key = \u0026#34;secret_k\u0026#34; text= \u0026#34;Hello wo\u0026#34; d = des() r = d.encrypt(key,text) r2 = d.decrypt(key,r) print(\u0026#34;Ciphered: %r\u0026#34; % r) print(\u0026#34;Deciphered: \u0026#34;, r2) assert r2 == text print(\u0026#39;æˆåŠŸå®ç°DESåŠ å¯†è§£å¯†\u0026#39;) Ciphered: 'ÃŸÃ¥Ã½Ã¥Ãš\\x9f\\\\\\x9d' Deciphered: Hello wo æˆåŠŸå®ç°DESåŠ å¯†è§£å¯† ","permalink":"https://blog.niuhemoon.win/posts/tech/python-symmetric-encryption/","summary":"\u003cp\u003ePython3å®ç°AESå’ŒDESå¯¹ç§°åŠ å¯†ç®—æ³•çš„\u003c/p\u003e","title":"Pythonå¯¹ç§°AESå’ŒDESåŠ å¯†ç®—æ³•"},{"content":"Python3å®ç°å“ˆå¸Œæ•£åˆ—ç®—æ³•ï¼ŒåŒ…å«MD5å’Œsha256ã€‚\nHashå‡½æ•°ç®—æ³•ç¼–å†™ æœ¬å®éªŒæ˜¯ä½¿ç”¨pythonæ¥ç¼–å†™MD5å’ŒSHA256åŠ å¯†å‡½æ•°ï¼Œå¹¶å¯¹åŠ å¯†å‡½æ•°çš„æ­£ç¡®æ€§è¿›è¡ŒéªŒè¯ã€‚\néªŒè¯çš„æ–¹å¼æ˜¯é€šè¿‡å’Œå·²æœ‰çš„æ ‡å‡†åº“åŠ å¯†ç»“æœè¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç»“æœç›¸åŒï¼Œåˆ™åŠ å¯†å‡½æ•°æ­£ç¡®ã€‚\n1.å®éªŒç›®çš„ ç†Ÿæ‚‰MD5å’ŒSHA256åŠ å¯†å‡½æ•°çš„åŸç†å’Œåº”ç”¨ å®ç°MD5å’ŒSHA256åŠ å¯†å‡½æ•°å¹¶éªŒè¯ 2.å®éªŒå·¥å…· Jupyter Notebook Python3.5 3.å®éªŒç¯å¢ƒ Ubuntu16.04LTSæ“ä½œç³»ç»Ÿ Python3æ ‡å‡†åº“ 4.å®éªŒæ­¥éª¤ 4.1 å›é¡¾è¯¾ç¨‹ï¼ŒæŸ¥é˜…èµ„æ–™ 4.2 ç†Ÿæ‚‰MD5çš„åŸç† MD5(Message-Digest Algorithm)æ¶ˆæ¯æ‘˜è¦ç®—æ³•æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„å¯†ç æ•£åˆ—å‡½æ•°ï¼Œå¯ä»¥äº§ç”Ÿå‡ºä¸€ä¸ª128ä½ï¼ˆ16å­—èŠ‚ï¼‰çš„æ•£åˆ—å€¼ï¼ˆhash valueï¼‰ï¼Œç”¨äºç¡®ä¿ä¿¡æ¯ä¼ è¾“å®Œæ•´ä¸€è‡´ã€‚\nMD5å°†å¯å˜é•¿åº¦çš„æ¶ˆæ¯å¤„ç†æˆ128ä½çš„å›ºå®šé•¿åº¦è¾“å‡ºã€‚è¾“å…¥æ¶ˆæ¯è¢«åˆ†è§£æˆ512ä½å—ï¼ˆ16ä¸ª32ä½å­—ï¼‰å—;è¯¥æ¶ˆæ¯è¢«å¡«å……ä»¥ä½¿å…¶é•¿åº¦å¯ä»¥è¢«512æ•´é™¤ã€‚\nå¡«å……çš„å·¥ä½œåŸç†å¦‚ä¸‹ï¼š\né¦–å…ˆå°†å•ä¸ªä½1é™„åŠ åˆ°æ¶ˆæ¯çš„æœ«å°¾ æ¥ç€å¡«å……0ï¼Œç›´åˆ°æ¶ˆæ¯é•¿åº¦æ¯”512çš„æ•´æ•°å€å°‘64 åœ¨æ¥ä¸‹æ¥64ä½ä¸­å¡«å……çœŸå®æ¶ˆæ¯çš„é•¿åº¦å€¼ ä¸»MD5ç®—æ³•åœ¨128ä½çŠ¶æ€ä¸‹è¿è¡Œï¼Œåˆ†ä¸ºå››ä¸ª32ä½å­—ï¼Œåˆ†åˆ«è¡¨ç¤ºä¸ºAï¼ŒBï¼ŒCå’ŒD.è¿™äº›å­—è¢«åˆå§‹åŒ–ä¸ºæŸäº›å›ºå®šçš„å¸¸é‡ã€‚\nä¸»ç®—æ³•ç„¶åä¾æ¬¡ä½¿ç”¨æ¯ä¸ª512ä½æ¶ˆæ¯å—æ¥ä¿®æ”¹çŠ¶æ€ã€‚\næ¶ˆæ¯å—çš„å¤„ç†ç”±å››ä¸ªç›¸ä¼¼çš„é˜¶æ®µç»„æˆï¼Œç§°ä¸ºå¾ªç¯;æ¯è½®ç”±åŸºäºéçº¿æ€§å‡½æ•°Fï¼Œæ¨¡åŠ æ³•å’Œå·¦æ—‹ç­‰16ç§ç±»ä¼¼æ“ä½œç»„æˆã€‚\nå›¾1è¯´æ˜äº†ä¸€è½®å†…çš„ä¸€ä¸ªæ“ä½œæµç¨‹ã€‚ å›¾2è¡¨ç¤ºFæœ‰å››ç§å¯èƒ½çš„åŠŸèƒ½;æ¯ä¸€è½®ä½¿ç”¨ä¸åŒçš„ä¸€ä¸ªï¼š ä¸‹å›¾æ˜¯éçº¿æ€§å‡½æ•°çš„å››ç§å¯èƒ½\n4.3 æŸ¥é˜…å¾—MD5ç®—æ³•çš„ä¼ªä»£ç  //Note: All variables are unsigned 32 bit and wrap modulo 2^32 when calculating var int[64] s, K var int i //s specifies the per-round shift amounts s[ 0..15] := { 7, 12, 17, 22, 7, 12, 17, 22, 7, 12, 17, 22, 7, 12, 17, 22 } s[16..31] := { 5, 9, 14, 20, 5, 9, 14, 20, 5, 9, 14, 20, 5, 9, 14, 20 } s[32..47] := { 4, 11, 16, 23, 4, 11, 16, 23, 4, 11, 16, 23, 4, 11, 16, 23 } s[48..63] := { 6, 10, 15, 21, 6, 10, 15, 21, 6, 10, 15, 21, 6, 10, 15, 21 } //Use binary integer part of the sines of integers (Radians) as constants: for i from 0 to 63 K[i] := floor(232 Ã— abs(sin(i + 1))) end for //Initialize variables: var int a0 := 0x67452301 //A var int b0 := 0xefcdab89 //B var int c0 := 0x98badcfe //C var int d0 := 0x10325476 //D //Pre-processing: adding a single 1 bit append \u0026#34;1\u0026#34; bit to message // Notice: the input bytes are considered as bits strings, // where the first bit is the most significant bit of the byte.[48] //Pre-processing: padding with zeros append \u0026#34;0\u0026#34; bit until message length in bits â‰¡ 448 (mod 512) append original length in bits mod 264 to message //Process the message in successive 512-bit chunks: for each 512-bit chunk of padded message break chunk into sixteen 32-bit words M[j], 0 â‰¤ j â‰¤ 15 //Initialize hash value for this chunk: var int A := a0 var int B := b0 var int C := c0 var int D := d0 //Main loop: for i from 0 to 63 var int F, g if 0 â‰¤ i â‰¤ 15 then F := (B and C) or ((not B) and D) g := i else if 16 â‰¤ i â‰¤ 31 F := (D and B) or ((not D) and C) g := (5Ã—i + 1) mod 16 else if 32 â‰¤ i â‰¤ 47 F := B xor C xor D g := (3Ã—i + 5) mod 16 else if 48 â‰¤ i â‰¤ 63 F := C xor (B or (not D)) g := (7Ã—i) mod 16 //Be wary of the below definitions of a,b,c,d F := F + A + K[i] + M[g] A := D D := C C := B B := B + leftrotate(F, s[i]) end for //Add this chunk\u0026#39;s hash to result so far: a0 := a0 + A b0 := b0 + B c0 := c0 + C d0 := d0 + D end for var char digest[16] := a0 append b0 append c0 append d0 //(Output is in little-endian) //leftrotate function definition leftrotate (x, c) return (x \u0026lt;\u0026lt; c) binary or (x \u0026gt;\u0026gt; (32-c)); 4.4 ç¼–å†™MD5ç®—æ³•æµ‹è¯•ç”¨ä¾‹ Pythonæ ‡å‡†åº“hashlibä¸­æä¾›äº†ç”ŸæˆMD5å€¼çš„æ–¹æ³•ï¼Œæ˜¯é€šè¿‡Cè¯­è¨€å®ç°çš„ï¼Œæˆ‘ä»¬ç”¨è‡ªå·±å®ç°çš„MD5å‡½æ•°è®¡ç®—å‡ºMD5å€¼ï¼Œåœ¨å’Œæ ‡å‡†åº“çš„ç»“æœè¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç»“æœç›¸åŒï¼Œé‚£ä¹ˆè¯æ˜äº†MD5åŠ å¯†æ˜¯æ­£ç¡®çš„ã€‚ æ³¨æ„ï¼š\nåªå®ç°äº†å¯¹ASCIIç å­—ç¬¦ä¸²çš„å¤„ç† demoä¸­å­˜å‚¨äº†æµ‹è¯•ç”¨ä¾‹ my_md5()è¿”å›è‡ªå·±ç”Ÿæˆçš„MD5å€¼ true_md5()è¿”å›Pythonæ ‡å‡†åº“ç”Ÿæˆçš„MD5å€¼ è‹¥ä¸¤è€…ç»“æœä¸åŒï¼ŒæŠ›å‡ºAssertionErrorå¼‚å¸¸ æµ‹è¯•ç¨‹åºå¦‚ä¸‹ï¼š\nimport hashlib def my_md5(message): pass def true_md5(message): m = hashlib.md5() m.update(message) return m.hexdigest() if __name__==\u0026#39;__main__\u0026#39;: demo = [b\u0026#34;\u0026#34;, b\u0026#34;a\u0026#34;, b\u0026#34;abc\u0026#34;, b\u0026#34;message digest\u0026#34;, b\u0026#34;abcdefghijklmnopqrstuvwxyz\u0026#34;, b\u0026#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\u0026#34;, b\u0026#34;12345678901234567890123456789012345678901234567890123456789012345678901234567890\u0026#34;] for message in demo: print(my_md5(message),\u0026#39; \u0026lt;= \u0026#34;\u0026#39;,message.decode(\u0026#39;ascii\u0026#39;),\u0026#39;\u0026#34;\u0026#39;, sep=\u0026#39;\u0026#39;) assert true_md5(message)==my_md5(message) # è‹¥å’Œæ ‡å‡†åº“ä¸­ä¸åŒï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ 4.5 æŸ¥é˜…sha256ç®—æ³•åŸç†å’Œä¼ªä»£ç  sha256æ˜¯SHA2(Secure Hash Algorithm 2)ç®—æ³•çš„ä¸€ä¸ªå˜ä½“ï¼Œå…·ä½“å†…å®¹ã€‚\nç¯‡å¹…åŸå› ä¸å†è´´sha256çš„ä¼ªä»£ç ï¼Œç»´åŸºç™¾ç§‘ä¸­æœ‰è¯¦ç»†è¯´æ˜ã€‚\n4.6 ç¼–å†™sha256ç®—æ³•çš„æµ‹è¯•ä»£ç  import hashlib def my_sha256(message): pass def true_sha256(message): m = hashlib.sha256() m.update(message) return m.hexdigest() if __name__==\u0026#39;__main__\u0026#39;: demo = [b\u0026#34;\u0026#34;, b\u0026#34;a\u0026#34;, b\u0026#34;abc\u0026#34;, b\u0026#34;message digest\u0026#34;, b\u0026#34;abcdefghijklmnopqrstuvwxyz\u0026#34;, b\u0026#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\u0026#34;, b\u0026#34;12345678901234567890123456789012345678901234567890123456789012345678901234567890\u0026#34;] for message in demo: print(my_sha256(message),\u0026#39; \u0026lt;= \u0026#34;\u0026#39;,message.decode(\u0026#39;ascii\u0026#39;),\u0026#39;\u0026#34;\u0026#39;, sep=\u0026#39;\u0026#39;) assert true_sha256(message)==my_sha256(message) # è‹¥å’Œæ ‡å‡†åº“ä¸­ä¸åŒï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ 4.7 ç¼–å†™MD5å’ŒSHA256çš„pythonå®ç°ï¼Œå¹¶è¿›è¡Œæµ‹è¯•éªŒè¯ ä»£ç å’Œæµ‹è¯•ç»“æœåœ¨æŠ¥å‘Šæœ€å\n4.8 æ€»ç»“å®éªŒï¼Œç¼–å†™å®éªŒæŠ¥å‘Š 5. å®éªŒæ€»ç»“ éœ€è¦å–„äºå€Ÿé‰´å‰äººç»éªŒï¼Œæœé›†èµ„æ–™ å®éªŒåªæ”¯æŒasciiç ï¼Œå¯¹å…¶ä»–å­—ç¬¦ç¼–ç æ²¡æœ‰è§£å†³ åˆ©ç”¨ä¼˜ç§€çš„å·¥å…·ï¼Œå¦‚Jupyterå¯ä»¥æé«˜å­¦ä¹ æ•ˆç‡ 6. å®éªŒå®Œæ•´ä»£ç  5.1 MD5å®ç° # MD5 å®ç°åŠå…¶éªŒè¯ import math import hashlib rotate_amounts = [7, 12, 17, 22, 7, 12, 17, 22, 7, 12, 17, 22, 7, 12, 17, 22, 5, 9, 14, 20, 5, 9, 14, 20, 5, 9, 14, 20, 5, 9, 14, 20, 4, 11, 16, 23, 4, 11, 16, 23, 4, 11, 16, 23, 4, 11, 16, 23, 6, 10, 15, 21, 6, 10, 15, 21, 6, 10, 15, 21, 6, 10, 15, 21] constants = [int(abs(math.sin(i+1)) * 2**32) \u0026amp; 0xFFFFFFFF for i in range(64)] # A B C D init_values = [0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476] # éçº¿æ€§å‡½æ•° functions = 16*[lambda b, c, d: (b \u0026amp; c) | (~b \u0026amp; d)] + \\ 16*[lambda b, c, d: (d \u0026amp; b) | (~d \u0026amp; c)] + \\ 16*[lambda b, c, d: b ^ c ^ d] + \\ 16*[lambda b, c, d: c ^ (b | ~d)] index_functions = 16*[lambda i: i] + \\ 16*[lambda i: (5*i + 1)%16] + \\ 16*[lambda i: (3*i + 5)%16] + \\ 16*[lambda i: (7*i)%16] # å¯¹xå·¦ç§»amountä½ def left_rotate(x, amount): x \u0026amp;= 0xFFFFFFFF return ((x\u0026lt;\u0026lt;amount) | (x\u0026gt;\u0026gt;(32-amount))) \u0026amp; 0xFFFFFFFF def md5(message): message = bytearray(message) #copy our input into a mutable buffer orig_len_in_bits = (8 * len(message)) \u0026amp; 0xffffffffffffffff message.append(0x80) while len(message)%64 != 56: message.append(0) message += orig_len_in_bits.to_bytes(8, byteorder=\u0026#39;little\u0026#39;) hash_pieces = init_values[:] for chunk_ofst in range(0, len(message), 64): a, b, c, d = hash_pieces chunk = message[chunk_ofst:chunk_ofst+64] for i in range(64): f = functions[i](b, c, d) g = index_functions[i](i) to_rotate = a + f + constants[i] + int.from_bytes(chunk[4*g:4*g+4], byteorder=\u0026#39;little\u0026#39;) new_b = (b + left_rotate(to_rotate, rotate_amounts[i])) \u0026amp; 0xFFFFFFFF a, b, c, d = d, new_b, b, c for i, val in enumerate([a, b, c, d]): hash_pieces[i] += val hash_pieces[i] \u0026amp;= 0xFFFFFFFF return sum(x\u0026lt;\u0026lt;(32*i) for i, x in enumerate(hash_pieces)) def md5_to_hex(digest): raw = digest.to_bytes(16, byteorder=\u0026#39;little\u0026#39;) return \u0026#39;{:032x}\u0026#39;.format(int.from_bytes(raw, byteorder=\u0026#39;big\u0026#39;)) def true_md5(message): m = hashlib.md5() m.update(message) return m.hexdigest() def my_md5(message): return md5_to_hex(md5(message)) if __name__==\u0026#39;__main__\u0026#39;: demo = [b\u0026#34;\u0026#34;, b\u0026#34;a\u0026#34;, b\u0026#34;abc\u0026#34;, b\u0026#34;message digest\u0026#34;, b\u0026#34;abcdefghijklmnopqrstuvwxyz\u0026#34;, b\u0026#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\u0026#34;, b\u0026#34;12345678901234567890123456789012345678901234567890123456789012345678901234567890\u0026#34;] for message in demo: print(my_md5(message),\u0026#39; \u0026lt;= \u0026#34;\u0026#39;,message.decode(\u0026#39;ascii\u0026#39;),\u0026#39;\u0026#34;\u0026#39;, sep=\u0026#39;\u0026#39;) assert true_md5(message)==my_md5(message) # è‹¥å’Œæ ‡å‡†åº“ä¸­ä¸åŒï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ print(\u0026#39;\\nMD5æµ‹è¯•å…¨éƒ¨é€šè¿‡\u0026#39;) # d41d8cd98f00b204e9800998ecf8427e \u0026lt;= \u0026#34;\u0026#34; # 0cc175b9c0f1b6a831c399e269772661 \u0026lt;= \u0026#34;a\u0026#34; # 900150983cd24fb0d6963f7d28e17f72 \u0026lt;= \u0026#34;abc\u0026#34; # f96b697d7cb7938d525a2f31aaf161d0 \u0026lt;= \u0026#34;message digest\u0026#34; # c3fcd3d76192e4007dfb496cca67e13b \u0026lt;= \u0026#34;abcdefghijklmnopqrstuvwxyz\u0026#34; # d174ab98d277d9f5a5611c2c9f419d9f \u0026lt;= \u0026#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\u0026#34; # 57edf4a22be3c955ac49da2e2107b67a \u0026lt;= \u0026#34;12345678901234567890123456789012345678901234567890123456789012345678901234567890\u0026#34; # # MD5æµ‹è¯•å…¨éƒ¨é€šè¿‡ 5.2 Sha256å®ç° import copy import struct import binascii import hashlib F32 = 0xFFFFFFFF _k = [0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5, 0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174, 0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da, 0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967, 0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85, 0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070, 0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3, 0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2] _h = [0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19] def _pad(msglen): mdi = msglen \u0026amp; 0x3F length = struct.pack(\u0026#39;!Q\u0026#39;, msglen \u0026lt;\u0026lt; 3) if mdi \u0026lt; 56: padlen = 55 - mdi else: padlen = 119 - mdi return b\u0026#39;\\x80\u0026#39; + (b\u0026#39;\\x00\u0026#39; * padlen) + length def _rotr(x, y): return ((x \u0026gt;\u0026gt; y) | (x \u0026lt;\u0026lt; (32 - y))) \u0026amp; F32 def _maj(x, y, z): return (x \u0026amp; y) ^ (x \u0026amp; z) ^ (y \u0026amp; z) def _ch(x, y, z): return (x \u0026amp; y) ^ ((~x) \u0026amp; z) class SHA256: _output_size = 8 blocksize = 1 block_size = 64 digest_size = 32 def __init__(self, m=None): self._counter = 0 self._cache = b\u0026#39;\u0026#39; self._k = copy.deepcopy(_k) self._h = copy.deepcopy(_h) self.update(m) def _compress(self, c): w = [0] * 64 w[0:16] = struct.unpack(\u0026#39;!16L\u0026#39;, c) for i in range(16, 64): s0 = _rotr(w[i-15], 7) ^ _rotr(w[i-15], 18) ^ (w[i-15] \u0026gt;\u0026gt; 3) s1 = _rotr(w[i-2], 17) ^ _rotr(w[i-2], 19) ^ (w[i-2] \u0026gt;\u0026gt; 10) w[i] = (w[i-16] + s0 + w[i-7] + s1) \u0026amp; F32 a, b, c, d, e, f, g, h = self._h for i in range(64): s0 = _rotr(a, 2) ^ _rotr(a, 13) ^ _rotr(a, 22) t2 = s0 + _maj(a, b, c) s1 = _rotr(e, 6) ^ _rotr(e, 11) ^ _rotr(e, 25) t1 = h + s1 + _ch(e, f, g) + self._k[i] + w[i] h = g g = f f = e e = (d + t1) \u0026amp; F32 d = c c = b b = a a = (t1 + t2) \u0026amp; F32 for i, (x, y) in enumerate(zip(self._h, [a, b, c, d, e, f, g, h])): self._h[i] = (x + y) \u0026amp; F32 def update(self, m): if not m: return self._counter += len(m) m = self._cache + m for i in range(0, len(m) // 64): self._compress(m[64 * i:64 * (i + 1)]) self._cache = m[-(len(m) % 64):] def digest(self): r = copy.deepcopy(self) r.update(_pad(self._counter)) data = [struct.pack(\u0026#39;!L\u0026#39;, i) for i in r._h[:self._output_size]] return b\u0026#39;\u0026#39;.join(data) def hexdigest(self): return binascii.hexlify(self.digest()).decode(\u0026#39;ascii\u0026#39;) def true_sha256(message): m = hashlib.sha256() m.update(message) return m.hexdigest() def my_sha256(message): return SHA256(message).hexdigest() if __name__==\u0026#39;__main__\u0026#39;: demo = [b\u0026#34;\u0026#34;, b\u0026#34;a\u0026#34;, b\u0026#34;abc\u0026#34;, b\u0026#34;message digest\u0026#34;, b\u0026#34;abcdefghijklmnopqrstuvwxyz\u0026#34;, b\u0026#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\u0026#34;, b\u0026#34;12345678901234567890123456789012345678901234567890123456789012345678901234567890\u0026#34;] for message in demo: print(my_sha256(message),\u0026#39; \u0026lt;= \u0026#34;\u0026#39;,message.decode(\u0026#39;ascii\u0026#39;),\u0026#39;\u0026#34;\u0026#39;, sep=\u0026#39;\u0026#39;) assert true_sha256(message)==my_sha256(message) # è‹¥å’Œæ ‡å‡†åº“ä¸­ä¸åŒï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ print(\u0026#39;\\nSHA256æµ‹è¯•å…¨éƒ¨é€šè¿‡\u0026#39;) # e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855 \u0026lt;= \u0026#34;\u0026#34; # ca978112ca1bbdcafac231b39a23dc4da786eff8147c4e72b9807785afee48bb \u0026lt;= \u0026#34;a\u0026#34; # ba7816bf8f01cfea414140de5dae2223b00361a396177a9cb410ff61f20015ad \u0026lt;= \u0026#34;abc\u0026#34; # f7846f55cf23e14eebeab5b4e1550cad5b509e3348fbc4efa3a1413d393cb650 \u0026lt;= \u0026#34;message digest\u0026#34; # 71c480df93d6ae2f1efad1447c66c9525e316218cf51fc8d9ed832f2daf18b73 \u0026lt;= \u0026#34;abcdefghijklmnopqrstuvwxyz\u0026#34; # db4bfcbd4da0cd85a60c3c37d3fbd8805c77f15fc6b1fdfe614ee0a7c8fdb4c0 \u0026lt;= \u0026#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\u0026#34; # f371bc4a311f2b009eef952dd83ca80e2b60026c8e935592d0f9c308453c813e \u0026lt;= \u0026#34;12345678901234567890123456789012345678901234567890123456789012345678901234567890\u0026#34; # # SHA256æµ‹è¯•å…¨éƒ¨é€šè¿‡ ","permalink":"https://blog.niuhemoon.win/posts/tech/python-hash-experiment/","summary":"Python3å®ç°å“ˆå¸Œæ•£åˆ—ç®—æ³•ï¼ŒåŒ…å«MD5å’Œsha256ã€‚ Hashå‡½æ•°ç®—æ³•ç¼–å†™ æœ¬å®éªŒæ˜¯ä½¿ç”¨pythonæ¥ç¼–å†™MD5å’ŒSHA256åŠ å¯†å‡½æ•°ï¼Œå¹¶å¯¹åŠ å¯†å‡½æ•°çš„æ­£ç¡®æ€§è¿›è¡ŒéªŒè¯ã€‚ éªŒè¯çš„æ–¹å¼æ˜¯é€šè¿‡å’Œå·²æœ‰çš„æ ‡å‡†åº“åŠ å¯†ç»“æœè¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç»“æœç›¸åŒï¼Œåˆ™åŠ å¯†å‡½æ•°æ­£ç¡®ã€‚ 1.å®éªŒç›®çš„ ç†Ÿæ‚‰MD5å’ŒSHA25","title":"Pythonå®ç°MD5å’ŒSha256"},{"content":"ç¨‹åºæ•ˆæœå›¾å¦‚ä¸‹ï¼š\nç¨‹åºçš„æ•ˆæœå°±æ˜¯å¯ä»¥åœ¨Terminalæµè§ˆä¸€ä¸‹æ¯å¤©çŸ¥ä¹æ—¥æŠ¥çš„æ ‡é¢˜å’Œurlï¼Œç„¶åæ ¹æ®å…´è¶£é€‰æ‹©æ˜¯å¦ç»§ç»­é˜…è¯»ã€‚\nç¨‹åºååˆ†ç®€å•ï¼Œåªåå‡ è¡Œä»£ç ã€‚ä½¿ç”¨python3ï¼Œéœ€è¦å®‰è£…requestsåŒ…ã€‚\næºä»£ç å¦‚ä¸‹ï¼Œä¹Ÿå¯ä»¥ä»æˆ‘çš„githubä¸‹è½½ã€‚\n#!/usr/bin/python3 #-*- coding: utf-8 -*- import requests import json headers = {\u0026#39;User-Agent\u0026#39; : \u0026#39;Mozilla/4.0 (compatible; MSIE 5.5; Windows NT)\u0026#39;} def get_daily(): page = requests.get(\u0026#39;http://news-at.zhihu.com/api/3/news/latest\u0026#39;, headers=headers).text response = json.loads(page) date = response[\u0026#39;date\u0026#39;] stories = response[\u0026#39;stories\u0026#39;] date = \u0026#39;\\n%så¹´%sæœˆ%sæ—¥\u0026#39; % (date[:4], date[4:6], date[6:]) print(\u0026#39;%s å…±%dæ¡æ—¥æŠ¥\\n\u0026#39; % (date, len(stories))) for index,story in enumerate(stories, 1): print(\u0026#39;{0:\u0026lt;2d}ï¼š{1:s}\\n urlï¼šhttp://news-at.zhihu.com/story/{2:d}\u0026#39;.format(index, story[\u0026#39;title\u0026#39;], story[\u0026#39;id\u0026#39;])) if __name__ == \u0026#39;__main__\u0026#39;: get_daily() ä¿å­˜ä¸ºzhdaily.pyæ–‡ä»¶ï¼Œç„¶åå°†æ–‡ä»¶æ”¾åˆ°/usr/local/bin/ç›®å½•ä¸‹ï¼Œå¹¶ç»™zhdaily.pyå¢åŠ æ‰§è¡Œæƒé™ï¼š\n$ sudo mv zhdaily.py /usr/local/bin/ $ cd /usr/local/bin/ $ sudo chmod +x zhdaily.py è¿™æ ·ï¼Œå½“ä½ ä¸‹æ¬¡è¿›å…¥ç»ˆç«¯ï¼Œå¯ä»¥ç›´æ¥æ‰§è¡Œï¼š\n$ zhdaily.py å°±å¯ä»¥è·å¾—å›¾ç¤ºçš„æ•ˆæœã€‚\nç¢ç¢å¿µï¼š\næ›¾ç»çŸ¥ä¹æ˜¯ä¸€ä¸ªä¼˜ç§€çš„ç¤¾åŒºï¼Œä¹Ÿç¡®å®è®©æˆ‘å‘ç°äº†æ›´å¤§çš„ä¸–ç•Œã€‚å¯æ˜¯ï¼Œä»æŸä¸ªæ—¶åˆ»å¼€å§‹ï¼Œå……æ–¥æˆ‘æ—¶é—´çº¿çš„å†…å®¹éƒ½æ˜¯è¢«çŸ¥ä¹å®˜æ–¹ç­›é€‰çš„ã€‚æ•´ä¸ªç¤¾åŒºå……æ–¥ç€å–§åš£ã€å¹¿å‘Šã€è¥é”€å’Œå¸¦èŠ‚å¥ã€‚\næˆ‘ä¸å–œæ¬¢ï¼š\nè¢«ç…½åŠ¨çš„æ„¤æ€’\nè¢«ç­–åˆ’çš„æ¬¢ä¹\næœ€åï¼Œæˆ‘åˆå›åˆ°äº†RSSçš„æ€€æŠ±ï¼Œå¯ä»¥æ§åˆ¶æˆ‘æ¥æ”¶åˆ°ç›¸å¯¹æœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚\nä¸è¿‡ï¼Œæµè§ˆçŸ¥ä¹æ—¥æŠ¥èƒ½äº†è§£ä¸‹å½“ä¸‹çƒ­ç‚¹ï¼Œå¢åŠ èŠå¤©è°ˆèµ„ã€‚çœçš„èŠå¤©æ—¶éƒ½ä¸çŸ¥é“ã€Šåˆ›é€ 101ã€‹æ˜¯å•¥ï¼Ÿèµ«èµ«:)\næˆ‘åŸºæœ¬æ¯å¤©åªæµè§ˆæ—¥æŠ¥çš„æ ‡é¢˜ï¼Œè¿™ä¸ªå°ç¨‹åºæ­£å¥½æ»¡è¶³éœ€æ±‚ã€‚\n","permalink":"https://blog.niuhemoon.win/posts/tech/zhihu-daily-crawler/","summary":"ç¨‹åºæ•ˆæœå›¾å¦‚ä¸‹ï¼š ç¨‹åºçš„æ•ˆæœå°±æ˜¯å¯ä»¥åœ¨Terminalæµè§ˆä¸€ä¸‹æ¯å¤©çŸ¥ä¹æ—¥æŠ¥çš„æ ‡é¢˜å’Œurlï¼Œç„¶åæ ¹æ®å…´è¶£é€‰æ‹©æ˜¯å¦ç»§ç»­é˜…è¯»ã€‚ ç¨‹åºååˆ†ç®€å•ï¼Œåªåå‡ è¡Œä»£ç ã€‚ä½¿ç”¨python3ï¼Œéœ€è¦å®‰è£…requestsåŒ…ã€‚ æºä»£ç å¦‚ä¸‹ï¼Œä¹Ÿå¯ä»¥ä»æˆ‘çš„githubä¸‹è½½ã€‚ #!/usr/bin/python3 #-*- coding: utf-8 -*- import requests import json headers = {\u0026#39;User-Agent\u0026#39; : \u0026#39;Mozilla/4.0 (compatible; MSIE 5.5; Windows NT)\u0026#39;} def get_daily(): page","title":"åœ¨Linuxç»ˆç«¯é‡Œæµè§ˆçŸ¥ä¹æ—¥æŠ¥"},{"content":"ä¸Šä¸€èŠ‚ä¸­ï¼ŒIntegralOccupancyMap()å‡½æ•°ç”¨æ¥ç¡®å®šå•è¯ä½ç½®ï¼Œå…¶ä¸­è°ƒç”¨äº†query_integral_image()æ–¹æ³•ã€‚è€Œquery_integral_imageæ˜¯ç”¨æ¥Cythonã€‚ä¸‹è¾¹ä»‹ç»Cythonã€‚\nCythonä»‹ç» Cython çš„æœ¬è´¨å¯ä»¥æ€»ç»“å¦‚ä¸‹ï¼šCython æ˜¯åŒ…å«C æ•°æ®ç±»å‹çš„Pythonã€‚\nCythonå¯ä»¥å°†Pythonä»£ç ç¼–è¯‘æˆåŠ¨æ€é“¾æ¥åº“ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯ä»¥æå¤§æé«˜Pythonç¨‹åºçš„è¿è¡Œæ•ˆç‡ã€‚\nå¯ä»¥çœ‹åˆ°æºç ä¸­åŒ…æ‹¬äº†query_integral_image.pyxå’Œquery_integral_image.cä¸¤ä¸ªæ–‡ä»¶ã€‚å…¶ä¸­.cæ–‡ä»¶æ˜¯Cythonè‡ªåŠ¨ç”Ÿäº§çš„å¯¹åº”query_integral_image.pyxCè¯­è¨€ç¨‹åºã€‚\nCythonçš„å·¥ä½œæµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š\næˆ‘ä»¬åªéœ€è¦å…³å¿ƒ.pyxæ–‡ä»¶ä¸­çš„ä»£ç \nä¸ºäº†æµ‹è¯•ä½¿ç”¨Cythonæ˜¯å¦çœŸçš„å¯ä»¥æé«˜ç¨‹åºæ•ˆç‡ï¼Œæˆ‘ä»¬åšå¦‚ä¸‹æµ‹è¯•ï¼Œ\nç³»ç»Ÿï¼šUbuntu 16\nç¯å¢ƒï¼špython3.5\nä¾èµ–ï¼š\nCython==0.28.2\nnumpy==1.14.2\nPillow==5.1.0\næµ‹è¯•ä»£ç å‡å¯ä»githubä¸‹è½½\næµ‹è¯•è¿‡ç¨‹ ç›®å½•tree\n. â”œâ”€â”€ python_query_integral_image.py â”œâ”€â”€ query_integral_image.pyx â”œâ”€â”€ setup.py â”œâ”€â”€ test.py â””â”€â”€ venv setup.pyç”¨æ¥ç¼–è¯‘åŠ¨æ€é“¾æ¥åº“,å†…å®¹å¦‚ä¸‹ï¼š\nfrom distutils.core import setup from Cython.Build import cythonize setup( ext_modules = cythonize(\u0026#34;query_integral_image.pyx\u0026#34;) ) æ‰§è¡Œï¼š\npython setup.py build_ext --inplace ç„¶åç›®å½•å˜ä¸ºäº†ï¼š\n. â”œâ”€â”€ build â”œâ”€â”€ python_query_integral_image.py â”œâ”€â”€ query_integral_image.c â”œâ”€â”€ query_integral_image.cpython-35m-i386-linux-gnu.so â”œâ”€â”€ query_integral_image.pyx â”œâ”€â”€ setup.py â”œâ”€â”€ test.py â””â”€â”€ venv ä¸‹è¾¹æˆ‘ä»¬å°±å¯ä»¥åœ¨pythonç¨‹åºä¸­importç¼–è¯‘åçš„.soæ–‡ä»¶äº†, æµ‹è¯•ç¨‹åºtest.pyå¦‚ä¸‹ï¼š\n# å¯¼å…¥pythonç¼–å†™çš„ç¨‹åºï¼Œä¸ºäº†å’Œ.soåŒºåˆ«ï¼Œæ”¹åä¸ºpython_query_integral_image from python_query_integral_image import query_integral_image as q1 # å¯¼å…¥ç»è¿‡Cythonå¤„ç†çš„.soé“¾æ¥åº“ from query_integral_image import query_integral_image as q2 from random import Random import numpy as np import timeit DX = 3000 DY = 3000 # ç›¸å½“äºä¸€ä¸ª3000*3000=900ä¸‡åƒç´ çš„å›¾ç‰‡ integral = np.zeros((DX, DY), dtype=np.uint32) random_state = Random() start_time = timeit.default_timer() q1(integral, 50, 50, random_state) end_time = timeit.default_timer() q1_dur = (end_time - start_time)/60. start_time = timeit.default_timer() q2(integral, 50, 50, random_state) end_time = timeit.default_timer() q2_dur = (end_time - start_time)/60. print(\u0026#39;Cç¨‹åºè€—æ—¶\u0026#39;, q2_dur, \u0026#39;Pythonè€—æ—¶\u0026#39;, q1_dur) print(\u0026#39;ç›¸å·®%få€\u0026#39; % (float(q1_dur) / float(q2_dur))) è¿è¡Œæµ‹è¯•ç¨‹åºï¼Œç»“æœä»¤äººåƒæƒŠï¼š\nCç¨‹åºè€—æ—¶ 0.0007940871333024309 Pythonè€—æ—¶ 0.6854850105833369 ç›¸å·®863.236516å€\nç»è¿‡Cythonç®€å•çš„å¤„ç†ï¼ŒåŒæ ·çš„ä»£ç ï¼Œè¿è¡Œæ•ˆç‡æé«˜äº†800å¤šå€ã€‚åˆºä¸åˆºæ¿€ï¼Ÿ\nå¯è§åœ¨ä½œçŸ©é˜µè®¡ç®—æˆ–è€…å¾ªç¯æ¬¡æ•°è¾ƒå¤šæ—¶ï¼ŒCythonå…·æœ‰è¾ƒå¤§ä½œç”¨ã€‚\nå‚è€ƒ Cythonä¸‰åˆ†é’Ÿå…¥é—¨ Cythonå®˜æ–¹æ–‡æ¡£ä¸­æ–‡ç‰ˆ ","permalink":"https://blog.niuhemoon.win/posts/tech/wordcloud-src-note2/","summary":"ä¸Šä¸€èŠ‚ä¸­ï¼ŒIntegralOccupancyMap()å‡½æ•°ç”¨æ¥ç¡®å®šå•è¯ä½ç½®ï¼Œå…¶ä¸­è°ƒç”¨äº†query_integral_image()æ–¹æ³•ã€‚è€Œquery_integral_imageæ˜¯ç”¨æ¥Cythonã€‚ä¸‹è¾¹ä»‹ç»Cythonã€‚ Cythonä»‹ç» Cython çš„æœ¬è´¨å¯ä»¥æ€»ç»“å¦‚ä¸‹ï¼šCython æ˜¯åŒ…å«C æ•°","title":"wordcloudæºç é˜…è¯»2â€”â€”Cython"},{"content":"wordcloudæ˜¯pythonç”¨æ¥ç”Ÿæˆè¯äº‘çš„ç¬¬ä¸‰æ–¹åº“ï¼Œgithubåœ°å€æ˜¯word_cloud\nä¸‹è½½æºç ï¼š\ngit clone https://github.com/amueller/word_cloud ç„¶åï¼Œç›´æ¥çœ‹æœ€è€çš„ç‰ˆæœ¬ï¼Œæœ‰ç²¾åŠ›çš„è¯çœ‹å®Œæœ€è€ç‰ˆæœ¬å¯ä»¥å†çœ‹æœ€æ–°çš„ç‰ˆæœ¬ã€‚\ngit tag git checkout 1.2.1 ç°åœ¨æˆ‘ä»¬çš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š å¯ä»¥çœ‹åˆ°ï¼Œæ ¸å¿ƒä»£ç éƒ½åœ¨wordcloudç›®å½•ä¸‹ï¼š\nwordcloudé¡¹ç›®ä¸»è¦ç”¨äº†ä»¥ä¸‹ç¬¬ä¸‰æ–¹åº“ï¼š\nNumpy PIL Cython å‚¨å¤‡çŸ¥è¯†ï¼š\nHSLå’ŒHSVè‰²å½©ç©ºé—´ å›¾ç‰‡RGB æ¡†æ¶å¤§ä½“æµç¨‹ï¼š å¯ä»¥çœ‹å‡ºwordcloudç±»çš„ä¸¤ä¸ªæ ¸å¿ƒæ–¹æ³•process_text()å’Œgenerate_from_frequencies()ã€‚\nå¦‚æœè¾“å…¥æ˜¯å¤„ç†åçš„{string:frequency}å­—å…¸ç±»å‹ï¼Œç›´æ¥ç”Ÿæˆè¯äº‘çš„layoutï¼Œè‹¥è¾“å…¥æ˜¯æœªå¤„ç†è¿‡çš„å­—ç¬¦ä¸²ï¼Œå°±è¦å…ˆè¿›è¡Œprocess_text()ç»Ÿè®¡è¯é¢‘ç­‰å·¥ä½œã€‚\nç»§ç»­çœ‹generate_from_frequencies()çš„æµç¨‹ï¼š\nå°±å¾—åˆ°äº†è¯äº‘çš„layoutï¼Œåè¾¹å¯ä»¥é€šè¿‡recolor()é‡æ–°ä¸Šè‰²ã€‚\nmaskæ˜¯ä¸€ä¸ªnç»´æ•°ç»„ï¼ˆå›¾ç‰‡ï¼‰ï¼Œåœ¨æˆ‘çš„ç†è§£æ˜¯photoshopé‡Œçš„è’™æ¿ï¼Œä¹Ÿå«é®è‰²ç‰‡ã€‚åœ¨wordcloudé‡Œmaskå†³å®šäº†ç”Ÿæˆè¯äº‘çš„ä½ç½®ã€‚ç™½è‰²#FFFFFFç§°ä¸ºmask outï¼Œå³ä¸åœ¨ç™½è‰²åŒºåŸŸç»˜åˆ¶è¯äº‘ã€‚\nlayout is list of tuple ,æ ¼å¼(string, int, (int, int), int, color)) å®šä¹‰äº†æ¯ä¸ªå•è¯çš„ï¼ˆå­—ç¬¦ä¸²ï¼Œå­—ä½“å¤§å°ï¼Œï¼ˆxä½ç½®ï¼Œyä½ç½®), æ–¹å‘ï¼Œ é¢œè‰²ï¼‰\nå‚è€ƒï¼š\nwordcloudçš„APIå¯ä»¥å‚è€ƒwordcloudæ–‡æ¡£ä¸­æ–‡ç¿»è¯‘ å…·ä½“ä½¿ç”¨ä¹Ÿå¯ä»¥å‚è€ƒç½‘æ˜“äº‘éŸ³ä¹æ­Œæ‰‹è¯äº‘\n","permalink":"https://blog.niuhemoon.win/posts/tech/wordcloud-src-note1/","summary":"wordcloudæ˜¯pythonç”¨æ¥ç”Ÿæˆè¯äº‘çš„ç¬¬ä¸‰æ–¹åº“ï¼Œgithubåœ°å€æ˜¯word_cloud ä¸‹è½½æºç ï¼š git clone https://github.com/amueller/word_cloud ç„¶åï¼Œç›´æ¥çœ‹æœ€è€çš„ç‰ˆæœ¬ï¼Œæœ‰ç²¾åŠ›çš„è¯çœ‹å®Œæœ€è€ç‰ˆæœ¬å¯ä»¥å†çœ‹æœ€æ–°çš„ç‰ˆæœ¬ã€‚ git tag git checkout 1.2.1 ç°åœ¨æˆ‘ä»¬çš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š å¯ä»¥çœ‹åˆ°ï¼Œæ ¸å¿ƒä»£ç éƒ½åœ¨wordcloudç›®å½•ä¸‹ï¼š wordcloudé¡¹ç›®","title":"wordcloudæºç é˜…è¯»1â€”â€”åˆæ¢"},{"content":"Pythonæ¨¡å—wordcloudå‚è€ƒæ–‡æ¡£çš„ä¸­æ–‡ç¿»è¯‘ å®˜ç½‘é“¾æ¥ï¼šwordcloud api reference\nGithubé“¾æ¥ï¼šwordcloud\næ‰€æœ‰å‡½æ•°å‡å°è£…åœ¨WordCloudç±»é‡Œ:\nWordCloud([\u0026hellip;]) ç”Ÿæˆå¹¶ç»˜åˆ¶WordCloudå¯¹è±¡ ImageColorGenerator(image) è¯äº‘é¢œè‰²ç”Ÿæˆå™¨ï¼ˆåŸºäºå›¾ç‰‡é¢œè‰²ï¼‰ random_color_func([]) è¯äº‘é¢œè‰²éšæœºç”Ÿæˆ wordcloud.WordCloud class wordcloud.WordCloud(font_path=None, width=400, height=200, margin=2, ranks_only=None, prefer_horizontal=0.9, mask=None, scale=1, color_func=None, max_words=200, min_font_size=4, stopwords=None, random_state=None, background_color=\u0026#39;black\u0026#39;, max_font_size=None, font_step=1, mode=\u0026#39;RGB\u0026#39;, relative_scaling=0.5, regexp=None, collocations=True, colormap=None, normalize_plurals=True) å‚æ•°ï¼š font_path : string\néœ€è¦ä½¿ç”¨çš„å­—ä½“è·¯å¾„(æ”¯æŒOTFå’ŒTTF)ã€‚Linuxç³»ç»Ÿä¸Šé»˜è®¤æŒ‡å‘DroidSansMonoè·¯å¾„ã€‚è‹¥ä½¿ç”¨å…¶ä»–æ“ä½œç³»ç»Ÿæˆ–è€…æ²¡æœ‰DroidSansMonoå­—ä½“ï¼Œéœ€è¦æŒ‡å®šå­—ä½“è·¯å¾„ã€‚\nwidth : int (default=400)\nç”»å¸ƒçš„å®½åº¦ã€‚\nheight : int (default=200)\nç”»å¸ƒçš„é«˜åº¦ã€‚\nprefer_horizontal : float (default=0.90)\nå°è¯•æ°´å¹³æ‘†æ”¾å­—ä½“å’Œå‚ç›´æ‘†æ”¾å­—ä½“çš„æ¯”ä¾‹ï¼Œè‹¥prefer_horizontal \u0026lt; 1ï¼Œå½“æ‘†æ”¾ä¸åˆé€‚çš„æ—¶å€™ï¼Œç®—æ³•å°†å°è¯•æ—‹è½¬å•è¯ã€‚ç›®å‰æ²¡æœ‰å†…ç½®çš„æ–¹æ³•æ¥è·å–å‚ç›´å•è¯\nmask : nd-array or None (default=None)\nå¦‚æœä¸æ˜¯Noneï¼Œåˆ™åœ¨å“ªé‡Œç»˜åˆ¶å•è¯æ—¶ç»™å‡ºäºŒè¿›åˆ¶æ©ç ã€‚ å¦‚æœmaskä¸æ˜¯Noneï¼Œé‚£ä¹ˆå®½åº¦å’Œé«˜åº¦å°†è¢«å¿½ç•¥ï¼Œå¹¶ä¸”å°†ä½¿ç”¨maskçš„å½¢çŠ¶ã€‚ æ‰€æœ‰ç™½è‰²ï¼ˆ#FFæˆ–#FFFFFFï¼‰æ¡ç›®å°†è¢«è§†ä¸ºâ€œè¢«é®ç›–â€ï¼Œè€Œå…¶ä»–æ¡ç›®å°†è¢«è‡ªç”±ç»˜åˆ¶ã€‚ [è¿™åœ¨æœ€æ–°ç‰ˆæœ¬ä¸­å‘ç”Ÿäº†å˜åŒ–ï¼]\nscale : float (default=1)\nè®¡ç®—å€¼å’Œç»˜å›¾ä¹‹é—´çš„ç¼©æ”¾æ¯”ä¾‹ã€‚ å¯¹äºå¤§å‹æ–‡å­—äº‘å›¾åƒï¼Œä½¿ç”¨ç¼©æ”¾è€Œä¸æ˜¯è¾ƒå¤§çš„ç”»å¸ƒå°ºå¯¸è¦å¿«å¾—å¤šï¼Œä½†å¯èƒ½å¯¼è‡´è¾ƒç²—ç³™çš„æ–‡å­—ã€‚\nmin_font_size : int (default=4)\nä½¿ç”¨æœ€å°çš„å­—ä½“å¤§å°ã€‚ å½“æ²¡æœ‰æ›´å¤šçš„ç©ºé—´æ—¶åœæ­¢ç»˜åˆ¶ã€‚\nfont_step : int (default=1)\nå­—ä½“çš„æ­¥é•¿ã€‚ font_step \u0026gt; 1æ—¶å¯èƒ½ä¼šåŠ å¿«è®¡ç®—é€Ÿåº¦ï¼Œä½†ä¼šå¯¼è‡´ç³Ÿç³•çš„å­—ä½“é€‚åº”æ€§å¸ƒå±€ã€‚\nmax_words : number (default=200)\nå•è¯çš„æœ€å¤§æ•°ç›®ã€‚\nstopwords : set of strings or None\næ•æ„Ÿè¯é›†åˆï¼Œè¿™äº›è¯å°†è¢«å¿½ç•¥ã€‚ å¦‚æœæ²¡æœ‰ï¼Œåˆ™å°†ä½¿ç”¨å†…ç½®çš„STOPWORDSåˆ—è¡¨ã€‚\nbackground_color : color value (default=â€blackâ€)\nè¯äº‘å›¾åƒçš„èƒŒæ™¯é¢œè‰²ã€‚\nmax_font_size : int or None (default=None)\nä½¿ç”¨çš„æœ€å¤§å­—ä½“å¤§å°ã€‚ é»˜è®¤ä½¿ç”¨å›¾åƒçš„é«˜åº¦ã€‚\nmode : string (default=â€RGBâ€)\nå½“æ¨¡å¼ä¸ºâ€œRGBAâ€ä¸”background_colorä¸ºNoneæ—¶ï¼Œä¼šç”Ÿæˆé€æ˜èƒŒæ™¯ã€‚\nrelative_scaling : float (default=.5)\nå­—ä½“å¤§å°çš„ç›¸å¯¹å•è¯é¢‘ç‡çš„é‡è¦æ€§ã€‚ relative_scaling = 0æ—¶ï¼Œåªè€ƒè™‘å•è¯ç­‰çº§ã€‚ ä½¿ç”¨relative_scaling = 1æ—¶ï¼Œé¢‘ç¹ä¸¤å€çš„å•è¯å°†å…·æœ‰ä¸¤å€çš„å¤§å°ã€‚ å¦‚æœä½ æƒ³è€ƒè™‘å•è¯çš„é¢‘ç‡ï¼Œè€Œä¸ä»…ä»…æ˜¯ä»–ä»¬çš„ç­‰çº§ï¼Œé‚£ä¹ˆ0.5å·¦å³çš„relative_scalingé€šå¸¸çœ‹èµ·æ¥ä¸é”™ã€‚\ncolor_func : callable, default=None\nå¯ç”¨å‚æ•°å…³é”®å­—font_size, position, orientation, font_path, random_stateè°ƒç”¨ï¼Œå®ƒä¸ºæ¯ä¸ªå•è¯è¿”å›ä¸€ä¸ªPILé¢œè‰²ã€‚ è¦†ç›–\u0026quot;colormap\u0026quot;ã€‚ è¯·å‚é˜…colormapæ¥æŒ‡å®šmatplotlibçš„é¢œè‰²æ˜ å°„ã€‚\nregexp : string or None (optional)\næ­£åˆ™è¡¨è¾¾å¼å°†è¾“å…¥æ–‡æœ¬æ‹†åˆ†ä¸ºå¾…å¤„ç†æ–‡æœ¬ä¸­çš„æ ‡è®°ã€‚ å¦‚æœæŒ‡å®šNoneï¼Œåˆ™ä½¿ç”¨râ€œ\\ w [\\ w\u0026rsquo;] +â€ã€‚\ncollocations : bool, default=True\næ˜¯å¦åŒ…å«ä¸¤ä¸ªè¯çš„æ­é…ï¼ˆbigramsï¼‰ï¼Œé»˜è®¤ä¸ºTrueã€‚\ncolormap : string or matplotlib colormap, default=â€viridisâ€\nMatplotlibè‰²å½©æ˜ å°„è¡¨ä¸ºæ¯ä¸ªå•è¯éšæœºç»˜åˆ¶é¢œè‰²ã€‚ å¦‚æœæŒ‡å®šäº†â€œcolor_funcâ€ï¼Œåˆ™å¿½ç•¥ã€‚\nnormalize_plurals : bool, default=True\næ˜¯å¦ä»æ–‡å­—ä¸­åˆ é™¤â€œå°¾éšâ€ã€‚ å¦‚æœä¸ºçœŸï¼Œå½“å‡ºç°ä»¥\u0026rsquo;s\u0026rsquo;ç»“å°¾çš„å•è¯ï¼Œåˆ™ä»¥\u0026rsquo;s\u0026rsquo;ç»“å°¾çš„å•è¯å°†è¢«åˆ é™¤ï¼Œå¹¶å°†å…¶è®¡æ•°æ·»åŠ åˆ°æ²¡æœ‰\u0026rsquo;s\u0026rsquo;ç»“å°¾çš„ç‰ˆæœ¬\nä»¥\u0026rsquo;ss\u0026rsquo;ç»“å°¾çš„å•è¯è¢«å¿½ç•¥ã€‚\næ³¨æ„ï¼š è¾ƒå¤§çš„ç”»å¸ƒä½¿ä»£ç æ˜æ˜¾å˜æ…¢ã€‚ å¦‚æœæ‚¨éœ€è¦è¾ƒå¤§çš„å•è¯äº‘ï¼Œè¯·å°è¯•è¾ƒå°çš„ç”»å¸ƒå¤§å°ï¼Œç„¶åè®¾ç½®ç¼©æ”¾å‚æ•°ã€‚\næ ¹æ®æœ€å¤§å­—ä½“å¤§å°å’Œç¼©æ”¾å¯å‘å¼ç®—æ³•ï¼Œç›¸æ¯”å•è¯å®é™…å‡ºç°çš„é¢‘ç‡ï¼Œç®—æ³•å¯èƒ½ä¼šç»™å•è¯çš„ç­‰çº§æ›´å¤šçš„æƒé‡ã€‚\nå±æ€§ï¼š words_\n(dict of string to float) å•è¯æ ‡è¯†å¯¹åº”å…¶å‡ºç°æ¬¡æ•°ï¼Œå¦‚{\u0026lsquo;hello\u0026rsquo;:90, \u0026lsquo;good\u0026rsquo;:30}\n.. versionchanged: 2.0 words_: ç°åœ¨æ˜¯ä¸€ä¸ªå­—å…¸\nlayout_\n(list of tuples (string, int, (int, int), int, color)))\nç¼–ç æ‹Ÿåˆè¯äº‘ï¼Œä¸ºæ¯ä¸ªå•è¯ç¼–ç å­—ç¬¦ä¸²ï¼Œå­—ä½“å¤§å°ï¼Œä½ç½®ï¼Œæ–¹å‘å’Œé¢œè‰²ã€‚\næ–¹æ³•ï¼š # åˆå§‹åŒ–å®ä¾‹ __init__(font_path=None, width=400, height=200, margin=2, ranks_only=None, prefer_horizontal=0.9, mask=None, scale=1, color_func=None, max_words=200, min_font_size=4, stopwords=None, random_state=None, background_color=\u0026#39;black\u0026#39;, max_font_size=None, font_step=1, mode=\u0026#39;RGB\u0026#39;, relative_scaling=0.5, regexp=None, collocations=True, colormap=None, normalize_plurals=True) fit_words(frequencies)\næ ¹æ®å•è¯å’Œé¢‘ç‡åˆ›å»ºä¸€ä¸ªword_cloudã€‚\nåˆ«åä¸ºgenerate_from_frequenciesã€‚\nå‚æ•°:\nfrequencies : array of tuples\nå…ƒç»„åŒ…å«å•è¯åŠå…¶é¢‘ç‡ã€‚Note:æœ€æ–°ç‰ˆå·²ç»æ”¹ä¸ºå­—å…¸äº†ã€‚\nè¿”å›å€¼ï¼š\nself\ngenerate(text)\nä»æ–‡æœ¬ç”Ÿæˆwordcloudã€‚\nåˆ«ågenerate_from_textã€‚\nå®é™…è°ƒç”¨process_textå’Œgenerate_from_frequenciesã€‚\nè¿”å›å€¼ï¼š\nself\ngenerate_from_frequencies(frequencies, max_font_size=None)\næ ¹æ®å•è¯å’Œé¢‘ç‡åˆ›å»ºè¯äº‘ã€‚\nå‚æ•°:\nfrequencies : dict from string to float\nå­—å…¸åŒ…å«å•è¯åŠå…¶é¢‘ç‡ã€‚\nmax_font_size : int\nä½¿ç”¨æ­¤æœ€å¤§å­—ä½“å¤§ï¼Œè€Œä¸æ˜¯self.max_font_size\nè¿”å›å€¼ï¼š\nself\ngenerate_from_text(text)\nä»æ–‡æœ¬ç”Ÿæˆwordcloudã€‚\nå®é™…è°ƒç”¨process_textå’Œgenerate_from_frequenciesã€‚\n..versionchanged:: 1.2.2 process_textï¼ˆ)çš„è¿”å›å€¼ä¸å†æ˜¯generate_from_frequenciesï¼ˆï¼‰çš„å‚æ•°ã€‚\nè¿”å›å€¼ï¼š\nself\nprocess_text(text)\nå°†é•¿æ–‡æœ¬æ‹†åˆ†ä¸ºå•è¯ï¼Œå»é™¤åœç”¨è¯(æ•æ„Ÿè¯)ã€‚\nå‚æ•°:\ntext : string\nå¾…å¤„ç†çš„æ–‡æœ¬\nè¿”å›å€¼ï¼š\nwords : dict (string, int)\nå¸¦æœ‰å…³è”é¢‘ç‡çš„è¯è¯­æ ‡è®°ã€‚\n..versionchanged:: 1.2.2 å°†è¿”å›ç±»å‹ä»å…ƒç»„åˆ—è¡¨æ›´æ”¹ä¸ºå­—å…¸ã€‚\nNotes\næœ‰æ›´å¥½çš„æ–¹æ³•åšè¯é¢‘åˆ†æï¼Œåœ¨æ­¤ä¸åšèµ˜è¿°ã€‚\nrecolor(random_state=None, color_func=None, colormap=None)\né‡æ–°ç€è‰²ç°æœ‰å¸ƒå±€ã€‚\nåº”ç”¨æ–°çš„ç€è‰²è¦æ¯”ç”Ÿæˆæ•´ä¸ªè¯äº‘å¿«å¾—å¤šã€‚\nå‚æ•°:\nrandom_state : RandomState, int, or None, default=None\nå¦‚æœä¸æ˜¯Noneï¼Œåˆ™ä½¿ç”¨å›ºå®šçš„éšæœºçŠ¶æ€ã€‚ å¦‚æœç»™å‡ºäº†ä¸€ä¸ªintï¼Œå®ƒå°†ç”¨ä½œrandom.RandomçŠ¶æ€çš„ç§å­ã€‚\ncolor_func : function or None, default=None\næ ¹æ®(word count, font size, position and orientation)å­—æ•°ï¼Œå­—ä½“å¤§å°ï¼Œä½ç½®å’Œæ–¹å‘ç”Ÿæˆæ–°é¢œè‰²çš„å‡½æ•°ã€‚ å¦‚æœä¸ºNoneï¼Œåˆ™ä½¿ç”¨self.color_funcã€‚\ncolormap : string or matplotlib colormap, default=None\nä½¿ç”¨æ­¤é¢œè‰²æ˜ å°„è¡¨æ¥ç”Ÿæˆæ–°çš„é¢œè‰²ã€‚ å¦‚æœæŒ‡å®šäº†color_funcï¼Œåˆ™å¿½ç•¥ã€‚ å¦‚æœæ²¡æœ‰ï¼Œåˆ™ä½¿ç”¨self.color_funcï¼ˆæˆ–self.color_mapï¼‰ã€‚\nè¿”å›å€¼ï¼š\nself\nto_array()\nè½¬æ¢ä¸ºnumpyæ•°ç»„ã€‚\nè¿”å›å€¼ï¼š\nimage : nç»´æ•°ç»„ (width, height, 3)\nè¯äº‘å›¾åƒä½œä¸ºnumpyçŸ©é˜µã€‚\nto_file(filename)\nå¯¼å‡ºä¸ºå›¾åƒæ–‡ä»¶ã€‚\nå‚æ•°:\nfilename : string\nè¦å†™å…¥çš„ä½ç½®ã€‚\nè¿”å›å€¼ï¼š\nself\nwordcloud.ImageColorGenerator class wordcloud.ImageColorGenerator(image) åŸºäºå½©è‰²å›¾åƒçš„é¢œè‰²ç”Ÿæˆå™¨.\næ ¹æ®RGBå›¾åƒç”Ÿæˆé¢œè‰²ã€‚ ä¸€ä¸ªå•è¯å°†ä½¿ç”¨å½©è‰²å›¾åƒä¸­åŒ…å›´çŸ©å½¢çš„å¹³å‡é¢œè‰²è¿›è¡Œç€è‰²ã€‚ æ„é€ å®Œæˆåï¼Œè¯¥å¯¹è±¡å……å½“å¯è°ƒç”¨å¯¹è±¡ï¼Œå¯ä»¥å°†å…¶ä½œä¸ºcolor_funcä¼ é€’ç»™WordCloudç±»çš„æ„é€ å‡½æ•°æˆ–recolorè¿™ä¸ªé‡æ–°ç€è‰²æ–¹æ³•ã€‚\nå‚æ•°:\nimage : nç»´çŸ©é˜µ, shape (height, width, 3)\nç”¨äºç”Ÿæˆæ–‡å­—é¢œè‰²çš„å›¾åƒã€‚ Alphaé€šé“è¢«å¿½ç•¥ã€‚å¯¹äºwordcloudå®ä¾‹ï¼Œè¿™åº”è¯¥å’Œç”»å¸ƒå¤§å°ç›¸åŒã€‚\næ–¹æ³•\n__call__(word, font_size, font_path, ...)\nä½¿ç”¨ç‰¹å®šå›¾åƒä¸ºç»™å®šå•è¯ç”Ÿæˆé¢œè‰²ã€‚\n__init__(image)\nwordcloud.random_color_func wordcloud.random_color_func(word=None, font_size=None, position=None, orientation=None, font_path=None, random_state=None) éšæœºè‰²è°ƒé¢œè‰²ç”Ÿæˆ.\né»˜è®¤ç€è‰²æ–¹æ³•ã€‚ è¿™åªæ˜¯éšæœºé€‰æ‹©ä¸€ä¸ªå€¼ä¸º80ï¼…å’Œå…‰ç…§50ï¼…çš„è‰²è°ƒã€‚\nå‚æ•°:\nword, font_size, position, orientation: ignored.\nrandom_state : random.Random object or None, (default=None)\nå¦‚æœç»™å®šäº†ä¸€ä¸ªéšæœºå¯¹è±¡ï¼Œåˆ™ç”¨å®ƒæ¥ç”Ÿæˆéšæœºæ•°ã€‚\n","permalink":"https://blog.niuhemoon.win/posts/tech/word-cloud-doc-cn/","summary":"Pythonæ¨¡å—wordcloudå‚è€ƒæ–‡æ¡£çš„ä¸­æ–‡ç¿»è¯‘ å®˜ç½‘é“¾æ¥ï¼šwordcloud api reference Githubé“¾æ¥ï¼šwordcloud æ‰€æœ‰å‡½æ•°å‡å°è£…åœ¨WordCloudç±»é‡Œ: WordCloud([\u0026hellip;]) ç”Ÿæˆå¹¶ç»˜åˆ¶WordCloudå¯¹è±¡ ImageColorGenerator(image) è¯äº‘é¢œè‰²ç”Ÿæˆå™¨ï¼ˆåŸºäºå›¾ç‰‡é¢œè‰²ï¼‰ random_color_func([]) è¯äº‘é¢œè‰²éšæœºç”Ÿæˆ wordcloud.WordCloud class wordcloud.WordCloud(font_path=None, width=400, height=200, margin=2, ranks_only=None, prefer_horizontal=0.9, mask=None, scale=1, color_func=None, max_words=200, min_font_size=4, stopwords=None, random_state=None, background_color=\u0026#39;black\u0026#39;, max_font_size=None, font_step=1,","title":"WordCloudæ–‡æ¡£ä¸­æ–‡ç¿»è¯‘"},{"content":"This is my first blog ç¾å›½è¯—äººçº³Â·æ–¯å¾…å°”åœ¨87å²é‚£å¹´å†™è¿‡ä¸€é¦–è¯—ï¼šã€Šæˆ‘ä¼šé‡‡æ›´å¤šçš„é›èŠã€‹ï¼Œæ‘˜å–ç‰‡æ®µäºä¸‹ã€‚\nå¦‚æœæˆ‘èƒ½å¤Ÿä»å¤´æ´»è¿‡ï¼Œ\næˆ‘ä¼šè¯•ç€çŠ¯æ›´å¤šçš„é”™ã€‚\næˆ‘ä¼šæ”¾æ¾ä¸€ç‚¹ï¼Œæˆ‘ä¼šçµæ´»ä¸€ç‚¹ã€‚\næˆ‘ä¼šæ¯”è¿™ä¸€è¶Ÿè¿‡å¾—å‚»ã€‚\nå¾ˆå°‘æœ‰ä»€ä¹ˆäº‹æƒ…èƒ½è®©æˆ‘å½“çœŸã€‚\næˆ‘ä¼šç–¯ç‹‚ä¸€äº›ï¼Œæˆ‘ä¼šå°‘è®²ç‚¹å«ç”Ÿã€‚\næˆ‘ä¼šå†’æ›´å¤šçš„é™©ã€‚æˆ‘ä¼šæ›´ç»å¸¸çš„æ—…è¡Œã€‚\næˆ‘ä¼šçˆ¬æ›´å¤šçš„å±±ï¼Œæ¸¸æ›´å¤šçš„æ²³ï¼Œçœ‹æ›´å¤šçš„æ—¥è½ã€‚\næˆ‘ä¼šå¤šåƒå†°æ¿€å‡Œï¼Œå°‘åƒè±†å­ã€‚\næˆ‘ä¼šæƒ¹æ›´å¤šçš„éº»çƒ¦ï¼Œå¯æ˜¯ä¸åœ¨æƒ³è±¡ä¸­æ‹…å¿§ã€‚\nå™¢ï¼Œæˆ‘æœ‰è¿‡éš¾å¿˜çš„æ—¶åˆ»ã€‚ å¦‚æœæˆ‘èƒ½å¤Ÿé‡æ¥ä¸€æ¬¡ï¼Œæˆ‘ä¼šè¦æ›´å¤šè¿™æ ·çš„æ—¶åˆ»ã€‚\næˆ‘ä¼šæ›´ç»å¸¸çš„é€ƒå­¦ã€‚\næˆ‘ä¸ä¼šè€ƒé‚£ä¹ˆé«˜çš„åˆ†æ•°ï¼Œé™¤éæ˜¯ä¸€ä¸å°å¿ƒã€‚\næˆ‘ä¼šå¤šéª‘äº›æ—‹è½¬æœ¨é©¬ï¼Œ\næˆ‘ä¼šé‡‡æ›´å¤šçš„é›èŠã€‚\näººä¸ä»…è¦æ‹¥æœ‰æ­¤ç”Ÿæ­¤ä¸–ï¼Œè¿˜è¦é‚£è¯—æ„çš„ä¸–ç•Œ\n","permalink":"https://blog.niuhemoon.win/posts/read/my-first-blog/","summary":"This is my first blog ç¾å›½è¯—äººçº³Â·æ–¯å¾…å°”åœ¨87å²é‚£å¹´å†™è¿‡ä¸€é¦–è¯—ï¼šã€Šæˆ‘ä¼šé‡‡æ›´å¤šçš„é›èŠã€‹ï¼Œæ‘˜å–ç‰‡æ®µäºä¸‹ã€‚ å¦‚æœæˆ‘èƒ½å¤Ÿä»å¤´æ´»è¿‡ï¼Œ æˆ‘ä¼šè¯•ç€çŠ¯æ›´å¤šçš„é”™ã€‚ æˆ‘ä¼šæ”¾æ¾ä¸€ç‚¹ï¼Œæˆ‘ä¼šçµæ´»ä¸€ç‚¹ã€‚ æˆ‘ä¼šæ¯”è¿™ä¸€è¶Ÿè¿‡å¾—å‚»ã€‚ å¾ˆå°‘æœ‰ä»€ä¹ˆäº‹æƒ…èƒ½è®©æˆ‘å½“çœŸã€‚ æˆ‘ä¼šç–¯ç‹‚ä¸€äº›ï¼Œæˆ‘ä¼šå°‘è®²ç‚¹å«ç”Ÿã€‚ æˆ‘ä¼šå†’æ›´å¤šçš„é™©ã€‚æˆ‘ä¼šæ›´ç»å¸¸çš„æ—…è¡Œã€‚ æˆ‘ä¼šçˆ¬æ›´å¤šçš„å±±","title":"ä¸€é¦–å°è¯—"},{"content":" ","permalink":"https://blog.niuhemoon.win/about/","summary":"","title":"ğŸ™‹ğŸ»â€â™‚ï¸å…³äºæˆ‘"},{"content":"matlbaåŸºç¡€å’Œç®€å•ç”¨æ³•\nå‘½ä»¤è¡ŒåŸºç¡€ x = [1,2,3] x = 1:3 A = [1,2;3,4;5,6] B = ones(3,4) C = eye(4) #å•ä½çŸ©é˜µ D = zeros(3,4)\t#é›¶çŸ©é˜µ det(C)\t#è¡Œåˆ—å¼ x = inv(A)*b\u0026#39;\t#è§£çº¿æ€§æ–¹ç¨‹,ç­‰ä»·äºA^-1*b\u0026#39; e = eig(A) #è¿”å›ä¸€ä¸ªåˆ—å‘é‡ï¼Œå…¶ä¸­åŒ…å«æ–¹é˜µ A çš„ç‰¹å¾å€¼ã€‚ [V,D] = eig(A) #è¿”å›ç‰¹å¾å€¼çš„å¯¹è§’çŸ©é˜µ D å’ŒçŸ©é˜µ Vï¼Œå…¶åˆ—æ˜¯å¯¹åº”çš„å³ç‰¹å¾å‘é‡ï¼Œä½¿å¾— A*V = V*D norm(x) #è®¡ç®—å‘é‡èŒƒæ•°å’ŒçŸ©é˜µèŒƒæ•° gallery()\t#ç”Ÿæˆæµ‹è¯•çŸ©é˜µ dot(x,y)\t#å‘é‡ç‚¹ä¹˜ cross(x,y)\t#å‘é‡å‰ä¹˜ A.*B\t#çŸ©é˜µç‚¹ä¹˜ï¼ˆå¯¹åº”å…ƒç´ ç›¸åŒï¼Œè¦æ±‚ä¸¤ä¸ªçŸ©é˜µå¤§å°ç›¸åŒï¼‰ A*B\t#çŸ©é˜µå‰ä¹˜ï¼ˆè¦æ±‚Açš„åˆ—æ•°ç­‰äºBçš„è¡Œæ•°ï¼‰ whos\t#æŸ¥çœ‹å½“å‰å·¥ä½œç©ºé—´ class()\t#æ•°æ®ç±»å‹ å‡½æ•° function y = sinh( x ) %UNTITLED Summary of this function goes here % Detailed explanation goes here y = (exp(x) - exp(-x))/2; end å¾ªç¯ \u0026gt;\u0026gt; for i = [1 3 5 7 9] disp(i); end \u0026gt;\u0026gt; E = randn(1000,1); \u0026gt;\u0026gt; SSE = 0; \u0026gt;\u0026gt; for i = 1:1000 SSE = SSE + E(i)*E(i); end \u0026gt;\u0026gt; SSE SSE = 983.5102 \u0026gt;\u0026gt; SSE/1000 ans = 0.9835 #å¯¹ä¸€æ®µç¨‹åºè®¡æ—¶ tic E = randn(1000,1); SSE = 0; for i = 1:1000 SSE = SSE + E(i)*E(i); end MSE = SSE/1000; toc #Elapsed time is 0.016618 seconds. # å’Œç‚¹ä¹˜æ¯”è¾ƒé€Ÿåº¦,æ˜æ˜¾ç‚¹ä¹˜è¾ƒå¿« tic E = randn(1000,1); MSE = E.*E /1000; toc # Elapsed time is 0.010042 seconds. é€‰æ‹© x=1:10; y=zeros(1,10); for i =1:10 if mod(x(i),2) == 0 y(i) = 1; else y(i) = 0; end end #å¦ä¸€ç§å†™æ³•ï¼ŒSumè¾“å‡ºä¸º18 X = 1:10;\tSum = 0; for x = X\t#xä¼šéå†Xä¸­çš„å…ƒç´  if mod(x,3) == 0 Sum =Sum +x; end end x = 1:10 found = 0; i = 0; while ~found i = i +1 if x(i) == 8 disp(\u0026#39;I found it\u0026#39;); found = 1; end end # or for i =1:10 fprintf(\u0026#39;i = %d\\n\u0026#39;,i); if x(i) ==8 disp(\u0026#39;i found it\u0026#39;); break; end end æ•°æ®ç»“æ„ ç»“æ„ä½“ \u0026gt;\u0026gt; my_struct.name=\u0026#39;niuhe\u0026#39; my_struct = name: \u0026#39;niuhe\u0026#39; \u0026gt;\u0026gt; class(my_struct) ans = struct \u0026gt;\u0026gt; my_struct.age = 25 my_struct = name: \u0026#39;niuhe\u0026#39; age: 25 \u0026gt;\u0026gt; class(my_struct.name) ans = char \u0026gt;\u0026gt; isfield(my_struct,\u0026#39;name\u0026#39;) ans = 1 \u0026gt;\u0026gt; isfield(my_struct,\u0026#39;gender\u0026#39;) ans = 0 \u0026gt;\u0026gt; rmfield(my_struct,\u0026#39;age\u0026#39;) ans = name: \u0026#39;niuhe\u0026#39; \u0026gt;\u0026gt; setfield(my_struct,\u0026#39;gender\u0026#39;,\u0026#39;f\u0026#39;) ans = name: \u0026#39;niuhe\u0026#39; age: 25 gender: \u0026#39;f\u0026#39; \u0026gt;\u0026gt; S = struct(\u0026#39;name\u0026#39;,\u0026#39;bob\u0026#39;,\u0026#39;age\u0026#39;,32,\u0026#39;email\u0026#39;,\u0026#39;123@gmail.com\u0026#39;) S = name: \u0026#39;bob\u0026#39; age: 32 email: \u0026#39;123@gmail.com\u0026#39; å“ˆå¸Œè¡¨ \u0026gt;\u0026gt; my_cell{1} = \u0026#39;hello world.\u0026#39; my_cell = \u0026#39;hello world.\u0026#39; \u0026gt;\u0026gt; my_cell{\u0026#39;A\u0026#39;} = [1,2,3,4,5] my_cell = Columns 1 through 9 \u0026#39;hello world.\u0026#39; [] [] [] [] [] [] [] [] Columns 10 through 20 [] [] [] [] [] [] [] [] [] [] [] Columns 21 through 31 [] [] [] [] [] [] [] [] [] [] [] Columns 32 through 42 [] [] [] [] [] [] [] [] [] [] [] Columns 43 through 53 [] [] [] [] [] [] [] [] [] [] [] Columns 54 through 64 [] [] [] [] [] [] [] [] [] [] [] Column 65 [1x5 double] \u0026gt;\u0026gt; my_cell{1} ans = hello world. \u0026gt;\u0026gt; my_cell{\u0026#39;A\u0026#39;} ans = 1 2 3 4 5 plotç”»å›¾ \u0026gt;\u0026gt; x = [0 0.1 0.2 0.3 ]; \u0026gt;\u0026gt; y = 1:4; \u0026gt;\u0026gt; plot(x,y); \u0026gt;\u0026gt; x = linspace(0,100,200); \u0026gt;\u0026gt; y =sin(x); \u0026gt;\u0026gt; plot(x,y); \u0026gt;\u0026gt; x = linspace(0,2*pi,100); \u0026gt;\u0026gt; y1 = sin(x); \u0026gt;\u0026gt; y2 = cos(x); \u0026gt;\u0026gt; plot(x,y1,x,y2); \u0026gt;\u0026gt; plot(x,y1,\u0026#39;-\u0026#39;,x,y2,\u0026#39;.\u0026#39;); \u0026gt;\u0026gt; plot(x,y1,\u0026#39;--\u0026#39;,x,y2,\u0026#39;.\u0026#39;); \u0026gt;\u0026gt; bar(x)\t#ç”»æŸ±çŠ¶å›¾ \u0026gt;\u0026gt; x = randn(1000,1)\t#ç”Ÿæˆ1000*1çš„éšæœºæ•°çŸ©é˜µï¼Œæœä»å‡å€¼æ˜¯0ï¼Œæ–¹å·®æ˜¯1çš„æ­£å¤ªåˆ†å¸ƒ\t\u0026gt;\u0026gt; hist(x) \u0026gt;\u0026gt; hist(x,50) \u0026gt;\u0026gt; x = 1:5; \u0026gt;\u0026gt; pie(x); \u0026gt;\u0026gt; x = linspace(0,2*pi,1000); \u0026gt;\u0026gt; y = 10*sin(x) + randn(1,1000); \u0026gt;\u0026gt; plot(x,y); \u0026gt;\u0026gt; scatter(x,y); \u0026gt;\u0026gt; x = randn(1000,1) * 2; \u0026gt;\u0026gt; y = 5*sin(x) + rand(1000,1); \u0026gt;\u0026gt; plot(x,y); \u0026gt;\u0026gt; scatter(x,y); subplot()\t#å­å›¾ surf() contour() title() xlabel() ylabel() è¯»å†™æ–‡ä»¶ CSVæ–‡ä»¶\ncsvread() csvwrite() # ä¿å­˜ç°æœ‰å·¥ä½œç©ºé—´ save() load() ","permalink":"https://blog.niuhemoon.win/posts/tech/matlab-basic/","summary":"\u003cp\u003ematlbaåŸºç¡€å’Œç®€å•ç”¨æ³•\u003c/p\u003e","title":"Matlab åŸºç¡€"},{"content":"Ankidroidå’Œæ’ä»¶ ankidroidä¸‹è½½ç½‘å€https://apps.ankiweb.net/\nç›®å‰è¿˜æ˜¯æ¨èä¸‹è½½anki2.0æ—§ç‰ˆï¼Œ2.1ç‰ˆæ’ä»¶æ”¯æŒçš„ä¸å…¨ã€‚\nå¿…è£…æ’ä»¶åˆ—è¡¨ï¼š\nAwesome TTS:301952613 Review Heatmap:1771074083 Night Mode:1496166067 è¯åº“åˆ†äº«\nanki-deck ä»ç½‘ç»œæŠ“å–å•è¯/ä¾‹å¥æ–‡æœ¬ ç¤ºä¾‹ä»è½»æ¾èƒŒå•è¯ç½‘ç«™æŠ“å–ï¼Œç½‘ç«™ä¸Šæ¶µç›–äº†ä»å°å­¦åˆ°GREä»¥åŠå„ä¸ªä¸“ä¸šçš„å•è¯å’Œä¾‹å¥ã€‚å†…å®¹éå¸¸ä¸°å¯Œï¼Œå¸Œæœ›å¤§å®¶å¤šæ”¯æŒè¿™ä¸ªè‰¯å¿ƒç½‘ç«™ã€‚æœ¬æŠ“å–æ–¹æ³•ä»…ä½œç¤ºä¾‹ï¼Œä¾µåˆ ã€‚ ç½‘ç«™çˆ¬å–éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼š\nbook_id group_id å…·ä½“çˆ¬å–ä»£ç å‚è§æˆ‘çš„github,anki_spider\né£Ÿç”¨æ–¹æ³• å°†çˆ¬å–ä¸‹æ¥çš„æ–‡æœ¬ï¼Œä¿å­˜ä¸ºæ–‡æœ¬æ–‡ä»¶\nç¼–è¾‘å•è¯ä¹¦çš„å­—æ®µï¼Œå¯è‡ªå®šä¹‰æ ·å¼è¿›è¡Œç¾åŒ–\næ‰“å¼€anki,é€‰æ‹©æ–‡ä»¶ â€”â€”\u0026gt; å¯¼å…¥ï¼Œæ–‡ä»¶ç±»å‹ä¸ºä»¥tabåˆ†å‰²çš„æ–‡ä»¶ç±»å‹ï¼Œå¹¶å…è®¸ä½¿ç”¨HTMLï¼ŒåŒ¹é…å¯¹åº”å­—æ®µ\nå¯¼å…¥ç»“æœç¤ºæ„å›¾\nç”¨awesomeTTSæ‰¹é‡æ·»åŠ å•è¯å’Œå¥å­å‘éŸ³\nå¯¼å‡ºåˆ¶ä½œå¥½çš„ankidroidå•è¯åŒ…ï¼Œå¹¶åˆ†äº«\nå®Œæ¯•\n","permalink":"https://blog.niuhemoon.win/posts/tech/anki-python/","summary":"Ankidroidå’Œæ’ä»¶ ankidroidä¸‹è½½ç½‘å€https://apps.ankiweb.net/ ç›®å‰è¿˜æ˜¯æ¨èä¸‹è½½anki2.0æ—§ç‰ˆï¼Œ2.1ç‰ˆæ’ä»¶æ”¯æŒçš„ä¸å…¨ã€‚ å¿…è£…æ’ä»¶åˆ—è¡¨ï¼š Awesome TTS:301952613 Review Heatmap:1771074083 Night Mode:1496166067 è¯åº“åˆ†äº« anki-deck ä»ç½‘ç»œæŠ“å–å•è¯/ä¾‹å¥æ–‡æœ¬ ç¤ºä¾‹ä»è½»æ¾èƒŒå•è¯ç½‘ç«™æŠ“å–ï¼Œç½‘ç«™ä¸Šæ¶µç›–äº†ä»å°å­¦åˆ°GREä»¥åŠå„ä¸ª","title":"Python ç”Ÿæˆankidroidå•è¯è¡¨/è¯­éŸ³åŒ…"},{"content":"STM32F103å­¦ä¹ ç¬”è®° GPIOåˆå§‹åŒ–å’Œè¯»å†™æ“ä½œ STM32çš„GPIOå¼•è„šæœ‰å¤šç§æ¨¡å¼ä½¿ç”¨ï¼Œåœ¨ä½¿ç”¨å‰éœ€è¦è¿›è¡Œé…ç½®ã€‚\nLEDç¯å®éªŒ #include \u0026#34;stm32f10x.h\u0026#34; #define LED GPIO_Pin_All\tvoid delay(u32 i) { while(i--); } //LEDçš„GPIOåˆå§‹åŒ–ç¨‹åº void LED_Init() { GPIO_InitTypeDef GPIO_InitStructure; //GPIOæ—¶é’Ÿåˆå§‹åŒ– SystemInit(); RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOC,ENABLE); //é…ç½®GPIOæ¨¡å¼å’Œç«¯å£ GPIO_InitStructure.GPIO_Pin = LED; GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; //æ¨æŒ½æ¨¡å¼ GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; GPIO_Init(GPIOC,\u0026amp;GPIO_InitStructure);\t//åˆå§‹åŒ–GPIO } void led_display() { GPIO_SetBits(GPIOC,LED); delay(6000000); GPIO_ResetBits(GPIOC,LED); delay(6000000); } int main() { LED_Init(); while(1) { led_display(); } } èœ‚é¸£å™¨å®éªŒ ä½¿ç”¨æ— æºèœ‚é¸£å™¨\n#include \u0026#34;stm32f10x.h\u0026#34; #define BZ GPIO_Pin_5 //PB5\tå®šä¹‰ç«¯å£PB5 void delay(u32 i) { while(i--); } void BEEP_Init() { GPIO_InitTypeDef GPIO_InitStructure; //GPIOæ—¶é’Ÿåˆå§‹åŒ– SystemInit(); RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOB,ENABLE); //é…ç½®GPIOæ¨¡å¼å’Œç«¯å£ GPIO_InitStructure.GPIO_Pin = BZ; GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; //æ¨æŒ½æ¨¡å¼ GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; GPIO_Init(GPIOB,\u0026amp;GPIO_InitStructure);\t//åˆå§‹åŒ–GPIO } void sound(u32 i) // i= 5000æ•‘æŠ¤è½¦ï¼Œi=1000ç”µåŠ¨è½¦ { while(i--) { GPIO_SetBits(GPIOB,BZ); delay(i); GPIO_ResetBits(GPIOB,BZ); delay(i); } } int main() {\tBEEP_Init();\t//ç«¯å£åˆå§‹åŒ– while(1) { sound(5000);\t}\t} SysTickå®éªŒ ç³»ç»Ÿæ»´ç­”è®¡æ—¶å™¨æ¯”å»¶æ—¶å‡½æ•°æ›´åŠ ç²¾ç¡®ï¼Œå¯ç§»æ¤æ€§æ›´é«˜ã€‚systickå®šæ—¶å™¨æ˜¯24ä½çš„å®šæ—¶å™¨ï¼Œå½“å®šæ—¶å™¨è®¡æ•°åˆ°0æ—¶ï¼Œå°†è‡ªåŠ¨ä»RELOADå¯„å­˜å™¨ä¸­é‡è£…å®šæ—¶å™¨åˆå€¼ï¼Œå¦‚æœå¼€å¯äº†ä¸­æ–­ï¼Œæ­¤æ—¶è¿˜ä¼šäº§ç”Ÿå¼‚å¸¸ä¸­æ–­ä¿¡å·ã€‚\nå®šæ—¶å™¨å¿…é¡»è¦ä¸€ä¸ªæ—¶é’Ÿæ¥é©±åŠ¨ï¼Œsystickå®šæ—¶å™¨çš„æ—¶é’Ÿæ¥æºæ—¶ç³»ç»Ÿæ—¶é’Ÿï¼Œä¸è¿‡å®ƒçš„æ—¶é’Ÿå¯ä»¥é€‰æ‹©æˆç›´æ¥å–è‡ªç³»ç»Ÿæ—¶é’Ÿï¼Œä¹Ÿå¯ä»¥å°†ç³»ç»Ÿæ—¶é’Ÿ8åˆ†é¢‘åå†èµ‹ç»™systickå®šæ—¶å™¨ã€‚\nsystickå®šæ—¶å™¨çš„æ“ä½œæ­¥éª¤ï¼š\nè®¾ç½®systickå®šæ—¶å™¨çš„æ—¶é’Ÿæº è®¾ç½®systickå®šæ—¶å™¨çš„é‡è£…åˆå§‹å€¼ï¼ˆè‹¥ä½¿ç”¨ä¸­æ–­ï¼Œå°±å°†ä¸­æ–­ä½¿èƒ½æ‰“å¼€ï¼‰ æ¸…é›¶systickå®šæ—¶å™¨è®¡æ•°å™¨çš„å€¼ æ‰“å¼€systickå®šæ—¶å™¨ #include \u0026#34;stm32f10x.h\u0026#34; #define LED GPIO_Pin_All void delay_us(u32 i) { u32 temp; SysTick-\u0026gt;LOAD = 9*i;\t//è®¾ç½®é‡è£…æ•°å€¼ 72MHzæ—¶ SysTick-\u0026gt;CTRL = 0x01;\t//ä½¿èƒ½ï¼Œå‡åˆ°é›¶æ—¶æ— åŠ¨ä½œï¼Œé‡‡ç”¨å¤–éƒ¨æ—¶é’Ÿæº(8åˆ†é¢‘ç³»ç»Ÿæ—¶é’Ÿ) SysTick-\u0026gt;VAL = 0;\t//æ¸…é›¶è®¡æ•°å™¨ do { temp = SysTick-\u0026gt;CTRL;\t//è¯»å–å½“å‰è®¡æ•°å€¼ } while((temp \u0026amp; 0x01) \u0026amp;\u0026amp; (!(temp \u0026amp;(1\u0026lt;\u0026lt;16))));\t//ä¸è¿ç®—å–å‡ºæŒ‡å®šä½çš„æ•°å€¼ //å®é™…ä¸Šå°±æ˜¯CTRLå¯„å­˜å™¨çš„ç¬¬1ä½ä¸º0æˆ–ç¬¬16ä½ä¸º1æ—¶ï¼Œé€€å‡ºå¾ªç¯ SysTick-\u0026gt;CTRL=0;\t//å…³é—­è®¡æ•°å™¨ SysTick-\u0026gt;VAL = 0;\t//æ¸…ç©ºè®¡æ•°å™¨ } void delay_ms(u32 i) { u32 temp; SysTick-\u0026gt;LOAD=9000*i;\t//è®¾ç½®é‡è£…æ•°å€¼, 72MHZæ—¶ SysTick-\u0026gt;CTRL=0x01;\t//ä½¿èƒ½ï¼Œå‡åˆ°é›¶æ˜¯æ— åŠ¨ä½œï¼Œé‡‡ç”¨å¤–éƒ¨æ—¶é’Ÿæº SysTick-\u0026gt;VAL=0;\t//æ¸…é›¶è®¡æ•°å™¨ do { temp=SysTick-\u0026gt;CTRL;\t//è¯»å–å½“å‰å€’è®¡æ•°å€¼ } while((temp\u0026amp;0x01)\u0026amp;\u0026amp;(!(temp\u0026amp;(1\u0026lt;\u0026lt;16))));\t//ç­‰å¾…æ—¶é—´åˆ°è¾¾ SysTick-\u0026gt;CTRL=0;\t//å…³é—­è®¡æ•°å™¨ SysTick-\u0026gt;VAL=0;\t//æ¸…ç©ºè®¡æ•°å™¨ } //LEDçš„GPIOåˆå§‹åŒ–ç¨‹åº void LED_Init() { GPIO_InitTypeDef GPIO_InitStructure; //GPIOæ—¶é’Ÿåˆå§‹åŒ– SystemInit(); RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOC,ENABLE); //é…ç½®GPIOæ¨¡å¼å’Œç«¯å£ GPIO_InitStructure.GPIO_Pin = LED; GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; //æ¨æŒ½æ¨¡å¼ GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; GPIO_Init(GPIOC,\u0026amp;GPIO_InitStructure);\t//åˆå§‹åŒ–GPIO } int main() { u8 i; LED_Init(); while(1) { for(i=0;i\u0026lt;8;i++) { GPIO_Write(GPIOC,(u16)~(0x01\u0026lt;\u0026lt;i)); delay_ms(1000);\t//ç²¾ç¡®å»¶æ—¶1ç§’ } } } ç³»ç»Ÿæ—¶é’Ÿå®éªŒ STM32ä¸€å…±å¯ä»¥æœ‰4ä¸ªæ—¶é’Ÿæº\nHSIï¼ˆHigh Speed Inner)å†…éƒ¨è‡ªå¸¦çš„é«˜é€Ÿæ—¶é’Ÿï¼Œå•ç‰‡æœºå¯åŠ¨åé»˜è®¤ä½¿ç”¨çš„æ—¶é’Ÿæº HSE (High Speed External)å¤–éƒ¨é«˜é€Ÿæ—¶é’Ÿï¼Œå¤§å¤šæ•°æ—¶8Mæ™¶æŒ¯ LSEï¼ˆLow Speed Externalï¼‰å¤–éƒ¨ä½é€Ÿæ—¶é’Ÿï¼Œç»™å•ç‰‡æœºå†…éƒ¨RTCæä¾›æ—¶é’Ÿ LSIï¼Œå†…éƒ¨ä½é€Ÿæ—¶é’Ÿï¼Œä¸»è¦ç»™å•ç‰‡æœºå†…éƒ¨RTCå’Œçœ‹é—¨ç‹—æä¾›æ—¶é’Ÿ STM32çš„ç³»ç»Ÿæ—¶é’Ÿæºï¼Œæœ‰3ä¸ªæ—¶é’Ÿæ¥æºï¼š\nç›´æ¥æ¥è‡ªå†…éƒ¨é«˜é€Ÿæ—¶é’ŸHSI ç›´æ¥æ¥è‡ªå¤–éƒ¨çš„é«˜é€Ÿæ—¶é’ŸHSE å°†HSIæˆ–HSEè¿›è¡Œå¤„ç†ï¼Œå€é¢‘ä¹‹åçš„PLLæ—¶é’Ÿï¼ˆPhase-Locked Loopsé”ç›¸ç¯ï¼‰ STM32è®¾ç½®RCCï¼ˆå¤ä½å’Œæ—¶é’Ÿæ§åˆ¶ï¼‰æ—¶é’Ÿçš„æ­¥éª¤\nä»¥è®¾ç½®å¤–éƒ¨é«˜é€Ÿæ—¶é’Ÿä½œä¸ºPLLè¾“å…¥ï¼Œç„¶åä»¥PLLä½œä¸ºæ—¶é’Ÿæºçš„ä¾‹å­ï¼š\nå¤ä½RCCæ—¶é’Ÿ æ‰“å¼€HSEå¤–éƒ¨é«˜é€Ÿæ—¶é’Ÿ ç›‘æµ‹HSEå¤–éƒ¨é«˜é€Ÿæ—¶é’Ÿæ˜¯å¦å¼€å¯æˆåŠŸ è®¾ç½®FLASHè¯»å†™ è®¾ç½®AHBæ€»çº¿çš„åˆ†é¢‘ï¼Œè¿˜æœ‰APB1å’ŒAPB2çš„åˆ†é¢‘ï¼Œæ³¨ï¼šAHBå’ŒAPB2æœ€å¤§é¢‘ç‡72MHzï¼ŒAPB1åšå¤§é¢‘ç‡36MHz è®¾ç½®HSEå¤–éƒ¨é«˜é€Ÿæ—¶é’Ÿä½œä¸ºPLLsæ—¶é’Ÿçš„æ—¶é’Ÿè¾“å…¥ è®¾ç½®PLLæ—¶é’Ÿçš„å€é¢‘å€æ•° æ‰“å¼€PLLæ—¶é’Ÿçš„ä½¿èƒ½ ç­‰å¾…PLLæ—¶é’Ÿçš„å¼€å¯æˆåŠŸ å°†ç³»ç»Ÿæ—¶é’Ÿæºè®¾ç½®ä¸ºPLLæ—¶ ç­‰å¾…æ—¶é’Ÿæºåˆ‡æ¢æˆåŠŸ //åœ¨ä¸Šä¸€ä¸ªå®éªŒåŸºç¡€ä¸Š //è‡ªå®šä¹‰ç³»ç»Ÿæ—¶é’Ÿ void RCC_HSE_Configuration() { RCC_DeInit();\t//é‡ç½®RCCå¤–è®¾å¯„å­˜å™¨ RCC_HSEConfig(RCC_HSE_ON);\t//è®¾ç½®å¤–éƒ¨é«˜é€Ÿæ™¶æŒ¯ï¼ˆHSEï¼‰ if(RCC_WaitForHSEStartUp() == SUCCESS)\t//ç­‰å¾…HSEèµ·æŒ¯ { RCC_HCLKConfig(RCC_SYSCLK_Div1);\t//è®¾ç½®AHBæ—¶é’Ÿ RCC_PCLK1Config(RCC_HCLK_Div2);\t//è®¾ç½®ä½é€ŸAHBæ—¶é’Ÿï¼ˆPCLK1ï¼‰ RCC_PCLK2Config(RCC_HCLK_Div1);\t//è®¾ç½®é«˜é€ŸAHBæ—¶é’Ÿï¼ˆPCLK2ï¼‰ RCC_PLLConfig(RCC_PLLSource_HSE_Div2,RCC_PLLMul_9);//è®¾ç½®PLLæ—¶é’ŸæºåŠå€é¢‘ç³»æ•°ï¼Œå®é™…ç³»ç»Ÿæ—¶é’Ÿ36MHz RCC_PLLCmd(ENABLE);\t//PLLä½¿èƒ½ while(RCC_GetFlagStatus(RCC_FLAG_PLLRDY)==RESET);//æ£€æŸ¥æŒ‡å®šçš„RCCæ ‡å¿—ä½è®¾ç½®ä¸å¦ï¼ŒPLLå°±ç»ª RCC_SYSCLKConfig(RCC_SYSCLKSource_PLLCLK);\t//è®¾ç½®ç³»ç»Ÿæ—¶é’Ÿï¼ˆSYSCLKï¼‰ while(RCC_GetSYSCLKSource()ç½‘æ˜“ != 0x08);\t//è¿”å›ç”¨ä½œç³»ç»Ÿæ—¶é’Ÿçš„æ—¶é’Ÿæºï¼Œ0x08ï¼ŒPLLä½œä¸ºç³»ç»Ÿæ—¶é’Ÿ } } int main() { LED_Init(); RCC_HSE_Configuration();\t//è‡ªå®šä¹‰ç³»ç»Ÿæ—¶é’Ÿï¼Œä¿®æ”¹å€é¢‘æˆ–åˆ†é¢‘å‚æ•° while(1) { GPIO_SetBits(GPIOC,LED); delay_ms(500);\t//ç²¾ç¡®å»¶æ—¶0.5sï¼Œå®é™…å»¶æ—¶1s GPIO_ResetBits(GPIOC,LED); delay_ms(500); } } æŒ‰é”®å®éªŒ æ³¨æ„æŒ‰é”®5ms-10mså·¦å³çš„å»¶æ—¶æ¶ˆæŠ–ï¼Œæ³¨æ„æŒ‰é”®çš„ä¸Šæ‹‰è¿˜æ˜¯ä¸‹æ‹‰\n#include \u0026#34;stm32f10x.h\u0026#34; #define K_UP GPIO_Pin_0 //PA0 #define K_DOWN GPIO_Pin_3 //PE3 #define K_LEFT GPIO_Pin_2 //PE2 #define K_RIGHT GPIO_Pin_4 //PE4 #define k_up GPIO_ReadInputDataBit(GPIOA,K_UP)\t//è·å–æŒ‰é”®çš„çŠ¶æ€ #define k_down GPIO_ReadInputDataBit(GPIOE,K_DOWN) #define k_left GPIO_ReadInputDataBit(GPIOE,K_LEFT) #define k_right GPIO_ReadInputDataBit(GPIOE,K_RIGHT) #define LED GPIO_Pin_All\tvoid delay_ms(u32 i) { u32 temp; SysTick-\u0026gt;LOAD=9000*i;\t//è®¾ç½®é‡è£…æ•°å€¼, 72MHZæ—¶ SysTick-\u0026gt;CTRL=0x01;\t//ä½¿èƒ½ï¼Œå‡åˆ°é›¶æ˜¯æ— åŠ¨ä½œï¼Œé‡‡ç”¨å¤–éƒ¨æ—¶é’Ÿæº SysTick-\u0026gt;VAL=0;\t//æ¸…é›¶è®¡æ•°å™¨ do { temp=SysTick-\u0026gt;CTRL;\t//è¯»å–å½“å‰å€’è®¡æ•°å€¼ } while((temp\u0026amp;0x01)\u0026amp;\u0026amp;(!(temp\u0026amp;(1\u0026lt;\u0026lt;16))));\t//ç­‰å¾…æ—¶é—´åˆ°è¾¾ SysTick-\u0026gt;CTRL=0;\t//å…³é—­è®¡æ•°å™¨ SysTick-\u0026gt;VAL=0;\t//æ¸…ç©ºè®¡æ•°å™¨ } //LEDçš„GPIOåˆå§‹åŒ–ç¨‹åº void LED_Init() { GPIO_InitTypeDef GPIO_InitStructure; //GPIOæ—¶é’Ÿåˆå§‹åŒ– SystemInit(); RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOC,ENABLE); //é…ç½®GPIOæ¨¡å¼å’Œç«¯å£ GPIO_InitStructure.GPIO_Pin = LED; GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; //æ¨æŒ½æ¨¡å¼ GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; GPIO_Init(GPIOC,\u0026amp;GPIO_InitStructure);\t//åˆå§‹åŒ–GPIO } void key_init(void) { GPIO_InitTypeDef GPIO_InitStructure; SystemInit(); //å¼€å¯GPIOæ—¶é’Ÿ RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA|RCC_APB2Periph_GPIOE,ENABLE); /* é…ç½®GPIOçš„æ¨¡å¼å’ŒIOå£ */ GPIO_InitStructure.GPIO_Pin=K_UP;\t//é€‰æ‹©ä½ è¦è®¾ç½®çš„IOå£ GPIO_InitStructure.GPIO_Mode=GPIO_Mode_IPD;//ä¸‹æ‹‰è¾“å…¥ GPIO_InitStructure.GPIO_Speed=GPIO_Speed_50MHz;\t//è®¾ç½®ä¼ è¾“é€Ÿç‡ GPIO_Init(GPIOA,\u0026amp;GPIO_InitStructure);\t/* åˆå§‹åŒ–GPIO */ GPIO_InitStructure.GPIO_Pin=K_DOWN|K_LEFT|K_RIGHT; GPIO_InitStructure.GPIO_Mode=GPIO_Mode_IPU;\t//ä¸Šæ‹‰è¾“å…¥ GPIO_InitStructure.GPIO_Speed=GPIO_Speed_50MHz; GPIO_Init(GPIOE,\u0026amp;GPIO_InitStructure); GPIO_ResetBits(GPIOA,K_UP);\t//å¯¹K_UPåˆå§‹åŒ–è¾“å‡º0 } void key_pros()\t//æŒ‰é”®å¤„ç†å‡½æ•° { if(k_up==1)\t//åˆ¤æ–­æŒ‰é”®k_upæ˜¯å¦æŒ‰ä¸‹ { delay_ms(10); //æ¶ˆæŠ–å¤„ç† if(k_up==1)\t//å†æ¬¡åˆ¤æ–­æŒ‰é”®k_upæ˜¯å¦æŒ‰ä¸‹ { GPIO_Write(GPIOC,(u16)0xfe);\t} while(k_up); //ç­‰å¾…æŒ‰é”®æ¾å¼€ } if(k_down==0) { delay_ms(10); if(k_down==0) { GPIO_Write(GPIOC,(u16)(0xfd));\t} while(!k_down); } if(k_left==0) { delay_ms(10); if(k_left==0) { GPIO_Write(GPIOC,(u16)(0xfb));\t} while(!k_left); } if(k_right==0) { delay_ms(10); if(k_right==0) { GPIO_Write(GPIOC,(u16)(0xf7));\t} while(!k_right); }\t} int main() {\tLED_Init();\t//LEDåˆå§‹åŒ– key_init();\t//æŒ‰é”®ç«¯å£åˆå§‹åŒ–å‡½æ•° GPIO_Write(GPIOC,(u16)(0xff)); while(1) {\tkey_pros();\t//æŒ‰é”®å¤„ç†å‡½æ•°\t}\t} æ•°ç ç®¡å®éªŒ #include \u0026#34;stm32f10x.h\u0026#34; #define smg_duan (GPIO_Pin_0|GPIO_Pin_1|GPIO_Pin_2|GPIO_Pin_3|GPIO_Pin_4|GPIO_Pin_5|GPIO_Pin_6|GPIO_Pin_7)//PC0~PC7 u8 smgduan[16]={0x3F, 0x06, 0x5B, 0x4F, 0x66, 0x6D, 0x7D, 0x07, 0x7F, 0x6F, 0x77, 0x7C, 0x39, 0x5E, 0x79, 0x71};//0~F æ•°ç ç®¡æ®µé€‰æ•°æ® void delay_ms(u32 i) { u32 temp; SysTick-\u0026gt;LOAD=9000*i;\t//è®¾ç½®é‡è£…æ•°å€¼, 72MHZæ—¶ SysTick-\u0026gt;CTRL=0x01;\t//ä½¿èƒ½ï¼Œå‡åˆ°é›¶æ˜¯æ— åŠ¨ä½œï¼Œé‡‡ç”¨å¤–éƒ¨æ—¶é’Ÿæº SysTick-\u0026gt;VAL=0;\t//æ¸…é›¶è®¡æ•°å™¨ do { temp=SysTick-\u0026gt;CTRL;\t//è¯»å–å½“å‰å€’è®¡æ•°å€¼ } while((temp\u0026amp;0x01)\u0026amp;\u0026amp;(!(temp\u0026amp;(1\u0026lt;\u0026lt;16))));\t//ç­‰å¾…æ—¶é—´åˆ°è¾¾ SysTick-\u0026gt;CTRL=0;\t//å…³é—­è®¡æ•°å™¨ SysTick-\u0026gt;VAL=0;\t//æ¸…ç©ºè®¡æ•°å™¨ } void smg_init() { GPIO_InitTypeDef GPIO_InitStructure; //å£°æ˜ä¸€ä¸ªç»“æ„ä½“å˜é‡ï¼Œç”¨æ¥åˆå§‹åŒ–GPIO /* å¼€å¯GPIOæ—¶é’Ÿ */ RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOC,ENABLE); /* é…ç½®GPIOçš„æ¨¡å¼å’ŒIOå£ */ GPIO_InitStructure.GPIO_Pin=smg_duan;\t//é€‰æ‹©ä½ è¦è®¾ç½®çš„IOå£ GPIO_InitStructure.GPIO_Mode=GPIO_Mode_Out_PP; GPIO_InitStructure.GPIO_Speed=GPIO_Speed_50MHz; GPIO_Init(GPIOC,\u0026amp;GPIO_InitStructure);\t/* åˆå§‹åŒ–GPIO */ } void static_smg_display()\t//é™æ€æ•°ç ç®¡æ˜¾ç¤º {\tu8 i; for(i=0;i\u0026lt;16;i++) { GPIO_Write(GPIOC,(u16)(~smgduan[i])); delay_ms(1000);\t}\t} int main() {\tsmg_init();\t//æ•°ç ç®¡ç«¯å£åˆå§‹åŒ–å‡½æ•° while(1) { static_smg_display();\t//é™æ€æ•°ç ç®¡æ˜¾ç¤º }\t} ä¸­æ–­å’Œå®šæ—¶å™¨ å¤–éƒ¨ä¸­æ–­å®éªŒ æ³¨æ„å°†ç«¯å£å¼•è„šæ˜ å°„åˆ°å¤–éƒ¨ä¸­æ–­çº¿è·¯ä¸Šï¼Œæ³¨æ„é…ç½®ä¸­æ–­ä¼˜å…ˆçº§\n#include \u0026#34;stm32f10x.h\u0026#34; #include \u0026#34;stm32f10x_exti.h\u0026#34; #include \u0026#34;misc.h\u0026#34; #define k_left GPIO_Pin_2 #define LED GPIO_Pin_All void delay_ms(u32 i) { u32 temp; SysTick-\u0026gt;LOAD=9000*i;\t//è®¾ç½®é‡è£…æ•°å€¼, 72MHZæ—¶ SysTick-\u0026gt;CTRL=0x01;\t//ä½¿èƒ½ï¼Œå‡åˆ°é›¶æ˜¯æ— åŠ¨ä½œï¼Œé‡‡ç”¨å¤–éƒ¨æ—¶é’Ÿæº SysTick-\u0026gt;VAL=0;\t//æ¸…é›¶è®¡æ•°å™¨ do { temp=SysTick-\u0026gt;CTRL;\t//è¯»å–å½“å‰å€’è®¡æ•°å€¼ } while((temp\u0026amp;0x01)\u0026amp;\u0026amp;(!(temp\u0026amp;(1\u0026lt;\u0026lt;16))));\t//ç­‰å¾…æ—¶é—´åˆ°è¾¾ SysTick-\u0026gt;CTRL=0;\t//å…³é—­è®¡æ•°å™¨ SysTick-\u0026gt;VAL=0;\t//æ¸…ç©ºè®¡æ•°å™¨ } //LEDçš„GPIOåˆå§‹åŒ–ç¨‹åº void led_init(void) { GPIO_InitTypeDef GPIO_InitStructure; //GPIOæ—¶é’Ÿåˆå§‹åŒ– SystemInit(); RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOC,ENABLE); //é…ç½®GPIOæ¨¡å¼å’Œç«¯å£ GPIO_InitStructure.GPIO_Pin = LED; GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; //æ¨æŒ½æ¨¡å¼ GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; GPIO_Init(GPIOC,\u0026amp;GPIO_InitStructure);\t//åˆå§‹åŒ–GPIO GPIO_SetBits(GPIOC,LED); } void exti_init(void)\t//å¤–éƒ¨ä¸­æ–­åˆå§‹åŒ– { GPIO_InitTypeDef GPIO_InitStructure; EXTI_InitTypeDef EXTI_InitStructure; NVIC_InitTypeDef NVIC_InitStructure; SystemInit(); //å¼€å¯GPIOæ—¶é’Ÿï¼Œç”¨åˆ°äº†æ—¶å¼•è„šå¤ç”¨åŠŸèƒ½ï¼Œå¼€å¯å¤ç”¨æ—¶é’Ÿ RCC_APB2PeriphClockCmd(RCC_APB2Periph_AFIO,ENABLE); RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOE,ENABLE); GPIO_InitStructure.GPIO_Pin = k_left; GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IPU;\t//ä¸Šæ‹‰è¾“å…¥ GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; GPIO_Init(GPIOE,\u0026amp;GPIO_InitStructure); //é€‰æ‹©å¤–éƒ¨ä¸­æ–­çº¿è·¯å¯¹åº”çš„GPIOç®¡è„šï¼Œæ­¤å¤„æ˜¯PE2 GPIO_EXTILineConfig(GPIO_PortSourceGPIOE,GPIO_PinSource2); //è®¾ç½®å¤–éƒ¨ä¸­æ–­çš„æ¨¡å¼ EXTI_InitStructure.EXTI_Line = EXTI_Line2; EXTI_InitStructure.EXTI_Mode = EXTI_Mode_Interrupt; EXTI_InitStructure.EXTI_Trigger = EXTI_Trigger_Falling;\t//ä¸‹é™æ²¿è§¦å‘ EXTI_InitStructure.EXTI_LineCmd = ENABLE; EXTI_Init(\u0026amp;EXTI_InitStructure); //è®¾ç½®NVICå‚æ•°ï¼ˆnested vector interrupt config) NVIC_PriorityGroupConfig(NVIC_PriorityGroup_1); NVIC_InitStructure.NVIC_IRQChannel = EXTI2_IRQn;\t//æ‰“å¼€EXTI2çš„å…¨å±€ä¸­æ–­ NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 0;\t//æŠ¢å ä¼˜å…ˆçº§ä¸º0 NVIC_InitStructure.NVIC_IRQChannelSubPriority = 0;\t//å“åº”ä¼˜å…ˆçº§ä¸º0 NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;\t//ä½¿èƒ½ NVIC_Init(\u0026amp;NVIC_InitStructure); } void EXTI2_IRQHandler(void)\t//å¤–éƒ¨ä¸­æ–­2ä¸­æ–­å¤„ç†å‡½æ•° { if(EXTI_GetITStatus(EXTI_Line2)==SET) { EXTI_ClearITPendingBit(EXTI_Line2);//æ¸…é™¤EXTI2çº¿è·¯æŒ‚èµ·ä½ delay_ms(10);//æ¶ˆæŠ– if(GPIO_ReadInputDataBit(GPIOE,k_left)==Bit_RESET)\t//k_leftæŒ‰ä¸‹ { delay_ms(10);//æ¶ˆæŠ– if(GPIO_ReadOutputDataBit(GPIOC,GPIO_Pin_0)==Bit_RESET) { //LEDç†„ç­ GPIO_SetBits(GPIOC,GPIO_Pin_0);\t} else { //LEDå‘å…‰ GPIO_ResetBits(GPIOC,GPIO_Pin_0); } } while(GPIO_ReadInputDataBit(GPIOE,GPIO_Pin_2)==0);\t//ç­‰å¾…æŒ‰é”®æ¾å¼€ }\t} int main() { led_init(); exti_init(); while(1); } å®šæ—¶å™¨å®éªŒ STM32ä¸­ä¸€å…±æœ‰11ä¸ªå®šæ—¶å™¨ï¼š\n2ä¸ªé«˜çº§æ§åˆ¶å®šæ—¶å™¨\tï¼ˆTIM1,TIM8) 4ä¸ªé€šç”¨å®šæ—¶å™¨ ï¼ˆTIM2-TIM5ï¼‰ 2ä¸ªåŸºæœ¬å®šæ—¶å™¨ (TIM6,TIm7) 2ä¸ªçœ‹é—¨ç‹—å®šæ—¶å™¨ 1ä¸ªç³»ç»Ÿæ»´ç­”å®šæ—¶å™¨ æ³¨:TIM2-TIM7çš„æ—¶é’Ÿç”±APB1äº§ç”Ÿï¼ŒTIM1å’ŒTIM8æ˜¯ç”±APB2äº§ç”Ÿæ—¶é’Ÿ\n//å®ç°1sæµæ°´ç¯å®éªŒ #include \u0026#34;stm32f10x.h\u0026#34; #include \u0026#34;stm32f10x_tim.h\u0026#34; #include \u0026#34;stm32f10x_exti.h\u0026#34; #include \u0026#34;misc.h\u0026#34; #define LED GPIO_Pin_All //LEDçš„GPIOåˆå§‹åŒ–ç¨‹åº void led_init(void) { GPIO_InitTypeDef GPIO_InitStructure; //GPIOæ—¶é’Ÿåˆå§‹åŒ– SystemInit(); RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOC,ENABLE); //é…ç½®GPIOæ¨¡å¼å’Œç«¯å£ GPIO_InitStructure.GPIO_Pin = LED; GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; //æ¨æŒ½æ¨¡å¼ GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; GPIO_Init(GPIOC,\u0026amp;GPIO_InitStructure);\t//åˆå§‹åŒ–GPIO } void time_init() { TIM_TimeBaseInitTypeDef TIM_TimeBaseInitStructure;\t//å®šæ—¶å™¨åˆå§‹åŒ–ç»“æ„ä½“ NVIC_InitTypeDef NVIC_InitStructure; //å¼€å¯å®šæ—¶å™¨3æ—¶é’Ÿ RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM3,ENABLE); TIM_ClearITPendingBit(TIM3,TIM_IT_Update);\t//æ¸…é™¤TIMxçš„ä¸­æ–­å¾…å¤„ç†ä½ï¼šTIMä¸­æ–­æº TIM_TimeBaseInitStructure.TIM_Period = 2000;//è®¾ç½®è‡ªåŠ¨é‡è£…å¯„å­˜å™¨å‘¨æœŸçš„å€¼ TIM_TimeBaseInitStructure.TIM_Prescaler = 36000-1;//è®¾ç½®ä½œä¸ºTIMxæ—¶é’Ÿé¢‘ç‡çš„é¢„åˆ†é¢‘å€¼ï¼Œ2Khzè®¡æ•°é¢‘ç‡ TIM_TimeBaseInitStructure.TIM_ClockDivision = 0;//è®¾ç½®æ—¶é’Ÿåˆ†å‰²ï¼šTDTS = Tck_tim TIM_TimeBaseInitStructure.TIM_CounterMode = TIM_CounterMode_Up;//å‘ä¸Šè®¡æ•°æ¨¡å¼ TIM_TimeBaseInit(TIM3,\u0026amp;TIM_TimeBaseInitStructure); TIM_Cmd(TIM3,ENABLE);\t//ä½¿èƒ½æˆ–å¤±èƒ½TIMxå¤–è®¾ //è®¾ç½®ä¸­æ–­å‚æ•°ï¼Œå¹¶æ‰“å¼€ä¸­æ–­ TIM_ITConfig(TIM3,TIM_IT_Update,ENABLE);\t//ä½¿èƒ½æˆ–å¤±èƒ½æŒ‡å®šçš„TIMä¸­æ–­ //è®¾ç½®NVICå‚æ•° NVIC_PriorityGroupConfig(NVIC_PriorityGroup_1); NVIC_InitStructure.NVIC_IRQChannel = TIM3_IRQn;\t//æ‰“å¼€EXTI2çš„å…¨å±€ä¸­æ–­ NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 0;\t//æŠ¢å ä¼˜å…ˆçº§ä¸º0 NVIC_InitStructure.NVIC_IRQChannelSubPriority = 1;\t//å“åº”ä¼˜å…ˆçº§ä¸º1 NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;\t//ä½¿èƒ½ NVIC_Init(\u0026amp;NVIC_InitStructure); } void TIM3_IRQHandler()\t//å®šæ—¶å™¨3çš„ä¸­æ–­å¤„ç†å‡½æ•° { static u8 i = 0; TIM_ClearITPendingBit(TIM3,TIM_IT_Update); GPIO_Write(GPIOC,(u16)~(0x01\u0026lt;\u0026lt;i++)); if(i==8)i=0; } int main() { time_init(); led_init(); while(1); } ","permalink":"https://blog.niuhemoon.win/posts/tech/stm32-example-1/","summary":"STM32F103å­¦ä¹ ç¬”è®° GPIOåˆå§‹åŒ–å’Œè¯»å†™æ“ä½œ STM32çš„GPIOå¼•è„šæœ‰å¤šç§æ¨¡å¼ä½¿ç”¨ï¼Œåœ¨ä½¿ç”¨å‰éœ€è¦è¿›è¡Œé…ç½®ã€‚ LEDç¯å®éªŒ #include \u0026#34;stm32f10x.h\u0026#34; #define LED GPIO_Pin_All void delay(u32 i) { while(i--); } //LEDçš„GPIOåˆå§‹åŒ–ç¨‹åº void LED_Init() { GPIO_InitTypeDef GPIO_InitStructure; //GPIOæ—¶é’Ÿåˆå§‹åŒ– SystemInit(); RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOC,ENABLE); //é…ç½®GPIOæ¨¡å¼å’Œç«¯å£ GPIO_InitStructure.GPIO_Pin = LED; GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; //æ¨æŒ½æ¨¡å¼ GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; GPIO_Init(GPIOC,\u0026amp;GPIO_InitStructure); //åˆå§‹åŒ–","title":"STM32ç¬”è®°"},{"content":" ç›®å‰ROSåªæ”¯æŒLinuxç‰ˆï¼Œå¦‚æœä¸æ–¹ä¾¿è£…Linuxä¸»æœºï¼Œå¯ä»¥é€šè¿‡ä»¥å¤ªç½‘æ¡¥æ¥çš„æ–¹å¼è·å¾—é›·è¾¾çš„æ•°æ®å¸§ï¼›å¯¹ä¸€äº›ä¸²å£ä¼ æ„Ÿå™¨ï¼Œä¹Ÿå¯ä»¥é€šè¿‡Serial to USBï¼Œç„¶ååœ¨virtualboxé‡Œé€‰æ‹©å¯¹åº”çš„USBè®¾å¤‡è¿›è¡Œè°ƒè¯•ã€‚\næœ¬æ–¹æ³•é€‚ç”¨äºé€šè¿‡ä»¥å¤ªç½‘/WLANæ¥ä¼ é€æ•°æ®åŒ…çš„é›·è¾¾ã€‚\nä½¿ç”¨Virtualboxé‡Œå»ºç«‹è™šæ‹Ÿæœºï¼Œå°†é›·è¾¾è¿æ¥åˆ°ä¸»æœºç”µè„‘ï¼Œ è®¾ç½®ä»¥å¤ªç½‘çš„IPåœ°å€ä¸ºé›·è¾¾çš„ç›®æ ‡åœ°å€ è™šæ‹Ÿæœºæ¡¥æ¥åˆ°å¯¹åº”çš„ä»¥å¤ªç½‘ åœ¨è™šæ‹Ÿæœºä¸­æµ‹è¯•æ”¶å‘æ•°æ®å¸§ tcpdump ","permalink":"https://blog.niuhemoon.win/posts/tech/virual-lidar/","summary":"ç›®å‰ROSåªæ”¯æŒLinuxç‰ˆï¼Œå¦‚æœä¸æ–¹ä¾¿è£…Linuxä¸»æœºï¼Œå¯ä»¥é€šè¿‡ä»¥å¤ªç½‘æ¡¥æ¥çš„æ–¹å¼è·å¾—é›·è¾¾çš„æ•°æ®å¸§ï¼›å¯¹ä¸€äº›ä¸²å£ä¼ æ„Ÿå™¨ï¼Œä¹Ÿå¯ä»¥é€šè¿‡Serial to USBï¼Œç„¶ååœ¨virtualboxé‡Œé€‰æ‹©å¯¹åº”çš„USBè®¾å¤‡è¿›è¡Œè°ƒè¯•ã€‚ æœ¬æ–¹æ³•é€‚ç”¨äºé€šè¿‡ä»¥å¤ªç½‘/WLANæ¥ä¼ é€æ•°æ®åŒ…çš„é›·è¾¾ã€‚ ä½¿ç”¨Virtualb","title":"Virtualboxè™šæ‹Ÿæœºè¿æ¥é›·è¾¾å’ŒUARTä¸²å£"}]